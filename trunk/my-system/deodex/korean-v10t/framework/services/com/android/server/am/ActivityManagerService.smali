.class public final Lcom/android/server/am/ActivityManagerService;
.super Landroid/app/ActivityManagerNative;
.source "ActivityManagerService.java"

# interfaces
.implements Lcom/android/server/Watchdog$Monitor;


# annotations
.annotation system Ldalvik/annotation/MemberClasses;
    value = {
        Lcom/android/server/am/ActivityManagerService$ServiceRestarter;,
        Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;,
        Lcom/android/server/am/ActivityManagerService$PermissionController;,
        Lcom/android/server/am/ActivityManagerService$CpuBinder;,
        Lcom/android/server/am/ActivityManagerService$MemBinder;,
        Lcom/android/server/am/ActivityManagerService$ProvidersBinder;,
        Lcom/android/server/am/ActivityManagerService$SendersBinder;,
        Lcom/android/server/am/ActivityManagerService$ServicesBinder;,
        Lcom/android/server/am/ActivityManagerService$BroadcastsBinder;,
        Lcom/android/server/am/ActivityManagerService$AThread;,
        Lcom/android/server/am/ActivityManagerService$AppDeathRecipient;,
        Lcom/android/server/am/ActivityManagerService$Identity;,
        Lcom/android/server/am/ActivityManagerService$ForegroundToken;,
        Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;,
        Lcom/android/server/am/ActivityManagerService$ActivityState;
    }
.end annotation


# static fields
.field static final ACTIVITY_INACTIVE_RESET_TIME:J = 0x1b7740L

.field static final APP_SWITCH_DELAY_TIME:J = 0x1388L

.field static final BATTERY_STATS_TIME:J = 0x1b7740L

.field static final BROADCAST_INTENT_MSG:I = 0x7

.field static final BROADCAST_TIMEOUT:I = 0x2710

.field static final BROADCAST_TIMEOUT_MSG:I = 0x8

.field static CONTENT_PROVIDER_ADJ:I = 0x0

.field static final CORE_SERVER_ADJ:I = -0xc

.field static final DEBUG:Z = false

.field static final DEBUG_BACKUP:Z = true

.field static final DEBUG_BROADCAST:Z = false

.field static final DEBUG_BROADCAST_LIGHT:Z = false

.field static final DEBUG_OOM_ADJ:Z = false

.field static final DEBUG_PAUSE:Z = false

.field static final DEBUG_PROCESSES:Z = false

.field static final DEBUG_RESULTS:Z = false

.field static final DEBUG_SERVICE:Z = false

.field static final DEBUG_SWITCH:Z = false

.field static final DEBUG_TASKS:Z = false

.field static final DEBUG_TRANSITION:Z = false

.field static final DEBUG_USER_LEAVING:Z = false

.field static final DEBUG_VISBILITY:Z = false

.field static final DESTROY_TIMEOUT:I = 0x2710

.field static final DESTROY_TIMEOUT_MSG:I = 0x11

.field static final DO_PENDING_ACTIVITY_LAUNCHES_MSG:I = 0x15

.field static EMPTY_APP_ADJ:I = 0x0

.field static final EMPTY_STRING_ARRAY:[Ljava/lang/String; = null

.field static final ENFORCE_PROCESS_LIMIT:Z = false

.field private static final FINISH_AFTER_PAUSE:I = 0x1

.field private static final FINISH_AFTER_VISIBLE:I = 0x2

.field private static final FINISH_IMMEDIATELY:I = 0x0

.field static final GC_BACKGROUND_PROCESSES_MSG:I = 0x5

.field static final GC_MIN_INTERVAL:I = 0xea60

.field static final GC_TIMEOUT:I = 0x1388

.field static HIDDEN_APP_MIN_ADJ:I = 0x0

.field static final IDLE_NOW_MSG:I = 0xb

.field static final IDLE_TIMEOUT:I = 0x2710

.field static final IDLE_TIMEOUT_MSG:I = 0xa

.field static final IM_FEELING_LUCKY_MSG:I = 0xf

.field static final INSTRUMENTATION_KEY_DISPATCHING_TIMEOUT:I = 0xea60

.field static final KEY_DISPATCHING_TIMEOUT:I = 0x2710

.field static final KILL_APPLICATION_MSG:I = 0x16

.field static final LAUNCH_TIMEOUT:I = 0x2710

.field static final LAUNCH_TIMEOUT_MSG:I = 0x10

.field static final LOG_ACTIVITY_LAUNCH_TIME:I = 0x7539

.field static final LOG_AM_BROADCAST_DISCARD_APP:I = 0x7549

.field static final LOG_AM_BROADCAST_DISCARD_FILTER:I = 0x7548

.field static final LOG_AM_CREATE_ACTIVITY:I = 0x7535

.field static final LOG_AM_CREATE_SERVICE:I = 0x754e

.field static final LOG_AM_CREATE_TASK:I = 0x7534

.field static final LOG_AM_DESTROY_ACTIVITY:I = 0x7542

.field static final LOG_AM_DESTROY_SERVICE:I = 0x754f

.field static final LOG_AM_DROP_PROCESS:I = 0x7551

.field static final LOG_AM_FAILED_TO_PAUSE_ACTIVITY:I = 0x753c

.field static final LOG_AM_FINISH_ACTIVITY:I = 0x7531

.field static final LOG_AM_KILL_FOR_MEMORY:I = 0x7547

.field static final LOG_AM_LOW_MEMORY:I = 0x7541

.field static final LOG_AM_NEW_INTENT:I = 0x7533

.field static final LOG_AM_PAUSE_ACTIVITY:I = 0x753d

.field static final LOG_AM_PROCESS_BAD:I = 0x753f

.field static final LOG_AM_PROCESS_BOUND:I = 0x753a

.field static final LOG_AM_PROCESS_CRASHED_TOO_MUCH:I = 0x7550

.field static final LOG_AM_PROCESS_DIED:I = 0x753b

.field static final LOG_AM_PROCESS_GOOD:I = 0x7540

.field static final LOG_AM_PROCESS_START:I = 0x753e

.field static final LOG_AM_PROVIDER_LOST_PROCESS:I = 0x7554

.field static final LOG_AM_RELAUNCH_ACTIVITY:I = 0x7544

.field static final LOG_AM_RELAUNCH_RESUME_ACTIVITY:I = 0x7543

.field static final LOG_AM_RESTART_ACTIVITY:I = 0x7536

.field static final LOG_AM_RESUME_ACTIVITY:I = 0x7537

.field static final LOG_AM_SCHEDULE_SERVICE_RESTART:I = 0x7553

.field static final LOG_AM_SERVICE_CRASHED_TOO_MUCH:I = 0x7552

.field static final LOG_ANR:I = 0x7538

.field static final LOG_BOOT_PROGRESS_AMS_READY:I = 0xbe0

.field static final LOG_BOOT_PROGRESS_ENABLE_SCREEN:I = 0xbea

.field static final LOG_CONFIGURATION_CHANGED:I = 0xa9f

.field static final LOG_CPU:I = 0xaa1

.field static final LOG_TASK_TO_FRONT:I = 0x7532

.field static final MAX_ACTIVITIES:I = 0x14

.field static final MAX_PROCESSES:I = 0x2

.field static final MAX_RECENT_TASKS:I = 0x14

.field static final MAX_SERVICE_INACTIVITY:I = 0x1b7740

.field static final MIN_CRASH_INTERVAL:I = 0xea60

.field static final MONITOR_CPU_MAX_TIME:J = 0xfffffffL

.field static final MONITOR_CPU_MIN_TIME:J = 0x1388L

.field static final MONITOR_CPU_USAGE:Z = true

.field static final MONITOR_THREAD_CPU_USAGE:Z = false

.field static final PAGE_SIZE:I = 0x1000

.field static final PAUSE_TIMEOUT:I = 0x1f4

.field static final PAUSE_TIMEOUT_MSG:I = 0x9

.field static final PROC_START_TIMEOUT:I = 0x2710

.field static final PROC_START_TIMEOUT_MSG:I = 0x14

.field static final RESUME_TOP_ACTIVITY_MSG:I = 0x13

.field static final SERVICE_ERROR_MSG:I = 0x12

.field static final SERVICE_MIN_RESTART_TIME_BETWEEN:I = 0x2710

.field static final SERVICE_RESET_RUN_DURATION:I = 0xea60

.field static final SERVICE_RESTART_DURATION:I = 0x1388

.field static final SERVICE_RESTART_DURATION_FACTOR:I = 0x4

.field static final SERVICE_TIMEOUT:I = 0x4e20

.field static final SERVICE_TIMEOUT_MSG:I = 0xc

.field static final SHOW_ACTIVITY_START_TIME:Z = true

.field static final SHOW_APP_STARTING_ICON:Z = true

.field static final SHOW_ERROR_MSG:I = 0x1

.field static final SHOW_FACTORY_ERROR_MSG:I = 0x3

.field static final SHOW_NOT_RESPONDING_MSG:I = 0x2

.field static final SHOW_UID_ERROR_MSG:I = 0xe

.field static final STOCK_PM_FLAGS:I = 0x400

.field static final SYSTEM_ADJ:I = -0x10

.field private static final SYSTEM_SECURE:Ljava/lang/String; = "ro.secure"

.field static final TAG:Ljava/lang/String; = "ActivityManager"

.field static final UPDATE_CONFIGURATION_MSG:I = 0x4

.field static final UPDATE_TIME_ZONE:I = 0xd

.field static final VALIDATE_TOKENS:Z = false

.field static final WAIT_FOR_DEBUGGER_MSG:I = 0x6

.field static final localLOGV:Z

.field static mSelf:Lcom/android/server/am/ActivityManagerService;

.field static mSystemThread:Landroid/app/ActivityThread;

.field private static sCallerIdentity:Ljava/lang/ThreadLocal;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/lang/ThreadLocal",
            "<",
            "Lcom/android/server/am/ActivityManagerService$Identity;",
            ">;"
        }
    .end annotation
.end field


# instance fields
.field final BACKUP_APP_ADJ:I

.field final BACKUP_APP_MEM:I

.field final EMPTY_APP_MEM:I

.field final FOREGROUND_APP_ADJ:I

.field final FOREGROUND_APP_MEM:I

.field final GL_ES_VERSION:I

.field final HIDDEN_APP_MAX_ADJ:I

.field final HIDDEN_APP_MEM:I

.field final HOME_APP_ADJ:I

.field final HOME_APP_MEM:I

.field final MY_PID:I

.field final SECONDARY_SERVER_ADJ:I

.field final SECONDARY_SERVER_MEM:I

.field final VISIBLE_APP_ADJ:I

.field final VISIBLE_APP_MEM:I

.field mAdjSeq:I

.field mAlwaysFinishActivities:Z

.field mAppBindArgs:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Landroid/os/IBinder;",
            ">;"
        }
    .end annotation
.end field

.field mAppSwitchesAllowedTime:J

.field mBackupAppName:Ljava/lang/String;

.field mBackupTarget:Lcom/android/server/am/BackupRecord;

.field final mBadProcesses:Lcom/android/server/ProcessMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/ProcessMap",
            "<",
            "Ljava/lang/Long;",
            ">;"
        }
    .end annotation
.end field

.field final mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

.field mBooted:Z

.field mBooting:Z

.field mBroadcastsScheduled:Z

.field final mCancelledThumbnails:Ljava/util/ArrayList;

.field mCheckedForSetup:Z

.field mConfiguration:Landroid/content/res/Configuration;

.field mContext:Landroid/content/Context;

.field mController:Landroid/app/IActivityController;

.field mCurTask:I

.field mDebugApp:Ljava/lang/String;

.field mDebugTransient:Z

.field mDidAppSwitch:Z

.field mDidDexOpt:Z

.field mFactoryTest:I

.field final mFinishingActivities:Ljava/util/ArrayList;

.field mFocusedActivity:Lcom/android/server/am/HistoryRecord;

.field final mForegroundProcesses:Landroid/util/SparseArray;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray",
            "<",
            "Lcom/android/server/am/ActivityManagerService$ForegroundToken;",
            ">;"
        }
    .end annotation
.end field

.field mGoingToSleep:Landroid/os/PowerManager$WakeLock;

.field private final mGrantedUriPermissions:Landroid/util/SparseArray;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray",
            "<",
            "Ljava/util/HashMap",
            "<",
            "Landroid/net/Uri;",
            "Lcom/android/server/am/UriPermission;",
            ">;>;"
        }
    .end annotation
.end field

.field final mHandler:Landroid/os/Handler;

.field final mHistory:Ljava/util/ArrayList;

.field private mHomeProcess:Lcom/android/server/am/ProcessRecord;

.field mInitialStartTime:J

.field final mIntentSenderRecords:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Lcom/android/server/am/PendingIntentRecord$Key;",
            "Ljava/lang/ref/WeakReference",
            "<",
            "Lcom/android/server/am/PendingIntentRecord;",
            ">;>;"
        }
    .end annotation
.end field

.field private final mLRUActivities:Ljava/util/ArrayList;

.field final mLRUProcesses:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field mLastCpuTime:J

.field mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

.field mLastWriteTime:J

.field mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

.field final mLaunchingProviders:Ljava/util/ArrayList;

.field final mOrderedBroadcasts:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/BroadcastRecord;",
            ">;"
        }
    .end annotation
.end field

.field mOrigDebugApp:Ljava/lang/String;

.field mOrigWaitForDebugger:Z

.field final mParallelBroadcasts:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/BroadcastRecord;",
            ">;"
        }
    .end annotation
.end field

.field mPausingActivity:Lcom/android/server/am/HistoryRecord;

.field final mPendingActivityLaunches:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;",
            ">;"
        }
    .end annotation
.end field

.field mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

.field final mPendingResultRecords:Ljava/util/HashSet;

.field final mPendingServices:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mPendingThumbnails:Ljava/util/ArrayList;

.field final mPersistentStartingProcesses:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mPidsSelfLocked:Landroid/util/SparseArray;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/util/SparseArray",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field mProcDeaths:[I

.field final mProcessCrashTimes:Lcom/android/server/ProcessMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/ProcessMap",
            "<",
            "Ljava/lang/Long;",
            ">;"
        }
    .end annotation
.end field

.field mProcessLimit:I

.field final mProcessNames:Lcom/android/server/ProcessMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/ProcessMap",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mProcessStats:Lcom/android/server/ProcessStats;

.field final mProcessStatsThread:Ljava/lang/Thread;

.field final mProcessesOnHold:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mProcessesToGc:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mProvidersByClass:Ljava/util/HashMap;

.field final mProvidersByName:Ljava/util/HashMap;

.field final mReceiverResolver:Lcom/android/server/IntentResolver;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/IntentResolver",
            "<",
            "Lcom/android/server/am/BroadcastFilter;",
            "Lcom/android/server/am/BroadcastFilter;",
            ">;"
        }
    .end annotation
.end field

.field final mRecentTasks:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/TaskRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mRegisteredReceivers:Ljava/util/HashMap;

.field final mRemovedProcesses:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field mRequestPssCallback:Ljava/lang/Runnable;

.field final mRequestPssList:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mRestartingServices:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field mResumedActivity:Lcom/android/server/am/HistoryRecord;

.field final mServiceConnections:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Landroid/os/IBinder;",
            "Lcom/android/server/am/ConnectionRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mServices:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Landroid/content/ComponentName;",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mServicesByIntent:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Landroid/content/Intent$FilterComparison;",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field mShuttingDown:Z

.field mSimpleProcessManagement:Z

.field mSleeping:Z

.field mStartRunning:Z

.field final mStartingProcesses:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ProcessRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mStickyBroadcasts:Ljava/util/HashMap;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Ljava/util/ArrayList",
            "<",
            "Landroid/content/Intent;",
            ">;>;"
        }
    .end annotation
.end field

.field final mStoppingActivities:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/HistoryRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mStoppingServices:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/ServiceRecord;",
            ">;"
        }
    .end annotation
.end field

.field final mStringBuilder:Ljava/lang/StringBuilder;

.field mSystemReady:Z

.field mTopAction:Ljava/lang/String;

.field mTopComponent:Landroid/content/ComponentName;

.field mTopData:Ljava/lang/String;

.field mUidAlert:Landroid/app/AlertDialog;

.field final mUsageStatsService:Lcom/android/server/am/UsageStatsService;

.field mUserLeaving:Z

.field mWaitForDebugger:Z

.field final mWaitingVisibleActivities:Ljava/util/ArrayList;

.field final mWatchers:Landroid/os/RemoteCallbackList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Landroid/os/RemoteCallbackList",
            "<",
            "Landroid/app/IActivityWatcher;",
            ">;"
        }
    .end annotation
.end field

.field mWindowManager:Lcom/android/server/WindowManagerService;


# direct methods
.method static constructor <clinit>()V
    .registers 1

    .prologue
    .line 363
    const/4 v0, 0x0

    new-array v0, v0, [Ljava/lang/String;

    sput-object v0, Lcom/android/server/am/ActivityManagerService;->EMPTY_STRING_ARRAY:[Ljava/lang/String;

    .line 736
    new-instance v0, Ljava/lang/ThreadLocal;

    invoke-direct {v0}, Ljava/lang/ThreadLocal;-><init>()V

    sput-object v0, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    return-void
.end method

.method private constructor <init>()V
    .registers 11

    .prologue
    const-wide/16 v8, 0x0

    const/4 v7, 0x1

    const/4 v5, 0x0

    const/4 v6, 0x0

    .line 1419
    invoke-direct {p0}, Landroid/app/ActivityManagerNative;-><init>()V

    .line 381
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    .line 395
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    .line 404
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    .line 412
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    .line 418
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    .line 424
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    .line 430
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 435
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 440
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    .line 447
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    .line 454
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    .line 461
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    .line 467
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    .line 475
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    .line 483
    new-instance v3, Lcom/android/server/ProcessMap;

    invoke-direct {v3}, Lcom/android/server/ProcessMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    .line 489
    new-instance v3, Lcom/android/server/ProcessMap;

    invoke-direct {v3}, Lcom/android/server/ProcessMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    .line 499
    new-instance v3, Lcom/android/server/ProcessMap;

    invoke-direct {v3}, Lcom/android/server/ProcessMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    .line 508
    new-instance v3, Landroid/util/SparseArray;

    invoke-direct {v3}, Landroid/util/SparseArray;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    .line 520
    new-instance v3, Landroid/util/SparseArray;

    invoke-direct {v3}, Landroid/util/SparseArray;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    .line 528
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    .line 537
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    .line 544
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    .line 550
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    .line 559
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    .line 565
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    .line 579
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    .line 584
    new-instance v3, Ljava/util/HashSet;

    invoke-direct {v3}, Ljava/util/HashSet;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingResultRecords:Ljava/util/HashSet;

    .line 589
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    .line 599
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 606
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    .line 612
    new-instance v3, Lcom/android/server/am/ActivityManagerService$1;

    invoke-direct {v3, p0}, Lcom/android/server/am/ActivityManagerService$1;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    .line 632
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    .line 638
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    .line 644
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    .line 651
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    .line 660
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    .line 666
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    .line 672
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    .line 678
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    .line 679
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    .line 685
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    .line 691
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    .line 700
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    .line 707
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    .line 714
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    .line 719
    new-instance v3, Landroid/util/SparseArray;

    invoke-direct {v3}, Landroid/util/SparseArray;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    .line 754
    new-instance v3, Landroid/content/res/Configuration;

    invoke-direct {v3}, Landroid/content/res/Configuration;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    .line 770
    new-instance v3, Ljava/lang/StringBuilder;

    const/16 v4, 0x100

    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(I)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    .line 775
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    .line 779
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    .line 780
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    .line 804
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    .line 809
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    .line 832
    iput v7, p0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 837
    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    .line 845
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mSimpleProcessManagement:Z

    .line 851
    const/16 v3, 0x14

    new-array v3, v3, [I

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    .line 859
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    .line 860
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    .line 861
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mDebugTransient:Z

    .line 862
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    .line 863
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    .line 864
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    .line 865
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    .line 867
    new-instance v3, Landroid/os/RemoteCallbackList;

    invoke-direct {v3}, Landroid/os/RemoteCallbackList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    .line 879
    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    .line 892
    new-instance v3, Lcom/android/server/ProcessStats;

    invoke-direct {v3, v6}, Lcom/android/server/ProcessStats;-><init>(Z)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    .line 894
    iput-wide v8, p0, Lcom/android/server/am/ActivityManagerService;->mLastCpuTime:J

    .line 895
    iput-wide v8, p0, Lcom/android/server/am/ActivityManagerService;->mLastWriteTime:J

    .line 897
    iput-wide v8, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    .line 902
    iput-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    .line 904
    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    .line 962
    new-instance v3, Lcom/android/server/am/ActivityManagerService$2;

    invoke-direct {v3, p0}, Lcom/android/server/am/ActivityManagerService$2;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    .line 1420
    const-string v3, "ANDROID_SIMPLE_PROCESS_MANAGEMENT"

    invoke-static {v3}, Ljava/lang/System;->getenv(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    .line 1421
    .local v2, v:Ljava/lang/String;
    if-eqz v2, :cond_18b

    invoke-static {v2}, Ljava/lang/Integer;->getInteger(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    if-eqz v3, :cond_18b

    .line 1422
    iput-boolean v7, p0, Lcom/android/server/am/ActivityManagerService;->mSimpleProcessManagement:Z

    .line 1424
    :cond_18b
    const-string v3, "ANDROID_DEBUG_APP"

    invoke-static {v3}, Ljava/lang/System;->getenv(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    .line 1425
    if-eqz v2, :cond_195

    .line 1426
    iput-boolean v7, p0, Lcom/android/server/am/ActivityManagerService;->mSimpleProcessManagement:Z

    .line 1429
    :cond_195
    invoke-static {}, Landroid/os/Process;->myPid()I

    move-result v3

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    .line 1431
    invoke-static {}, Landroid/os/Environment;->getDataDirectory()Ljava/io/File;

    move-result-object v0

    .line 1432
    .local v0, dataDir:Ljava/io/File;
    new-instance v1, Ljava/io/File;

    const-string v3, "system"

    invoke-direct {v1, v0, v3}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    .line 1433
    .local v1, systemDir:Ljava/io/File;
    invoke-virtual {v1}, Ljava/io/File;->mkdirs()Z

    .line 1434
    new-instance v3, Lcom/android/server/am/BatteryStatsService;

    new-instance v4, Ljava/io/File;

    const-string v5, "batterystats.bin"

    invoke-direct {v4, v1, v5}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-virtual {v4}, Ljava/io/File;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Lcom/android/server/am/BatteryStatsService;-><init>(Ljava/lang/String;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    .line 1436
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v3}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/internal/os/BatteryStatsImpl;->readLocked()V

    .line 1437
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v3}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/internal/os/BatteryStatsImpl;->writeLocked()V

    .line 1439
    new-instance v3, Lcom/android/server/am/UsageStatsService;

    new-instance v4, Ljava/io/File;

    const-string v5, "usagestats"

    invoke-direct {v4, v1, v5}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-virtual {v4}, Ljava/io/File;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Lcom/android/server/am/UsageStatsService;-><init>(Ljava/lang/String;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    .line 1442
    const-string v3, "ro.opengles.version"

    invoke-static {v3, v6}, Landroid/os/SystemProperties;->getInt(Ljava/lang/String;I)I

    move-result v3

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->GL_ES_VERSION:I

    .line 1445
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    invoke-virtual {v3}, Landroid/content/res/Configuration;->makeDefault()V

    .line 1446
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    invoke-virtual {v3}, Lcom/android/server/ProcessStats;->init()V

    .line 1449
    invoke-static {}, Lcom/android/server/Watchdog;->getInstance()Lcom/android/server/Watchdog;

    move-result-object v3

    invoke-virtual {v3, p0}, Lcom/android/server/Watchdog;->addMonitor(Lcom/android/server/Watchdog$Monitor;)V

    .line 1452
    const-string v3, "ro.FOREGROUND_APP_ADJ"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    .line 1454
    const-string v3, "ro.VISIBLE_APP_ADJ"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    .line 1456
    const-string v3, "ro.SECONDARY_SERVER_ADJ"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    .line 1458
    const-string v3, "ro.BACKUP_APP_ADJ"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_ADJ:I

    .line 1460
    const-string v3, "ro.HOME_APP_ADJ"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->HOME_APP_ADJ:I

    .line 1462
    const-string v3, "ro.HIDDEN_APP_MIN_ADJ"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    sput v3, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    .line 1464
    const-string v3, "ro.CONTENT_PROVIDER_ADJ"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    sput v3, Lcom/android/server/am/ActivityManagerService;->CONTENT_PROVIDER_ADJ:I

    .line 1466
    sget v3, Lcom/android/server/am/ActivityManagerService;->CONTENT_PROVIDER_ADJ:I

    sub-int/2addr v3, v7

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MAX_ADJ:I

    .line 1467
    const-string v3, "ro.EMPTY_APP_ADJ"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    sput v3, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    .line 1469
    const-string v3, "ro.FOREGROUND_APP_MEM"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    mul-int/lit16 v3, v3, 0x1000

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_MEM:I

    .line 1471
    const-string v3, "ro.VISIBLE_APP_MEM"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    mul-int/lit16 v3, v3, 0x1000

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_MEM:I

    .line 1473
    const-string v3, "ro.SECONDARY_SERVER_MEM"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    mul-int/lit16 v3, v3, 0x1000

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_MEM:I

    .line 1475
    const-string v3, "ro.BACKUP_APP_MEM"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    mul-int/lit16 v3, v3, 0x1000

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_MEM:I

    .line 1477
    const-string v3, "ro.HOME_APP_MEM"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    mul-int/lit16 v3, v3, 0x1000

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->HOME_APP_MEM:I

    .line 1479
    const-string v3, "ro.HIDDEN_APP_MEM"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    mul-int/lit16 v3, v3, 0x1000

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MEM:I

    .line 1481
    const-string v3, "ro.EMPTY_APP_MEM"

    invoke-static {v3}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v3

    mul-int/lit16 v3, v3, 0x1000

    iput v3, p0, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_MEM:I

    .line 1484
    new-instance v3, Lcom/android/server/am/ActivityManagerService$3;

    const-string v4, "ProcessStats"

    invoke-direct {v3, p0, v4}, Lcom/android/server/am/ActivityManagerService$3;-><init>(Lcom/android/server/am/ActivityManagerService;Ljava/lang/String;)V

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    .line 1512
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    invoke-virtual {v3}, Ljava/lang/Thread;->start()V

    .line 1513
    return-void
.end method

.method synthetic constructor <init>(Lcom/android/server/am/ActivityManagerService$1;)V
    .registers 2
    .parameter "x0"

    .prologue
    .line 137
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;-><init>()V

    return-void
.end method

.method static synthetic access$000(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V
    .registers 4
    .parameter "x0"
    .parameter "x1"
    .parameter "x2"
    .parameter "x3"

    .prologue
    .line 137
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/am/ActivityManagerService;->appDiedLocked(Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V

    return-void
.end method

.method static synthetic access$100(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I
    .registers 15
    .parameter "x0"
    .parameter "x1"
    .parameter "x2"
    .parameter "x3"
    .parameter "x4"
    .parameter "x5"
    .parameter "x6"
    .parameter "x7"
    .parameter "x8"
    .parameter "x9"
    .parameter "x10"
    .parameter "x11"
    .parameter "x12"
    .parameter "x13"

    .prologue
    .line 137
    invoke-direct/range {p0 .. p13}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    move-result v0

    return v0
.end method

.method static synthetic access$200(Lcom/android/server/am/ActivityManagerService;Z)V
    .registers 2
    .parameter "x0"
    .parameter "x1"

    .prologue
    .line 137
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->processNextBroadcast(Z)V

    return-void
.end method

.method static synthetic access$300(Lcom/android/server/am/ActivityManagerService;)V
    .registers 1
    .parameter "x0"

    .prologue
    .line 137
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->broadcastTimeout()V

    return-void
.end method

.method static synthetic access$400(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/HistoryRecord;)Z
    .registers 3
    .parameter "x0"
    .parameter "x1"

    .prologue
    .line 137
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    move-result v0

    return v0
.end method

.method static synthetic access$500(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;)V
    .registers 2
    .parameter "x0"
    .parameter "x1"

    .prologue
    .line 137
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->processStartTimedOutLocked(Lcom/android/server/am/ProcessRecord;)V

    return-void
.end method

.method static synthetic access$600(Lcom/android/server/am/ActivityManagerService;Z)V
    .registers 2
    .parameter "x0"
    .parameter "x1"

    .prologue
    .line 137
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->doPendingActivityLaunchesLocked(Z)V

    return-void
.end method

.method static synthetic access$700(Lcom/android/server/am/ActivityManagerService;Ljava/lang/String;IZ)V
    .registers 4
    .parameter "x0"
    .parameter "x1"
    .parameter "x2"
    .parameter "x3"

    .prologue
    .line 137
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/am/ActivityManagerService;->uninstallPackageLocked(Ljava/lang/String;IZ)V

    return-void
.end method

.method static synthetic access$900(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;[Ljava/lang/String;)V
    .registers 5
    .parameter "x0"
    .parameter "x1"
    .parameter "x2"
    .parameter "x3"
    .parameter "x4"

    .prologue
    .line 137
    invoke-static {p0, p1, p2, p3, p4}, Lcom/android/server/am/ActivityManagerService;->dumpApplicationMemoryUsage(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;[Ljava/lang/String;)V

    return-void
.end method

.method private final addRecentTask(Lcom/android/server/am/TaskRecord;)V
    .registers 7
    .parameter "task"

    .prologue
    .line 3781
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 3782
    .local v0, N:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_7
    if-ge v1, v0, :cond_3e

    .line 3783
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/TaskRecord;

    .line 3784
    .local v2, tr:Lcom/android/server/am/TaskRecord;
    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    if-eqz v3, :cond_1f

    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    iget-object v4, v2, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_2d

    :cond_1f
    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-eqz v3, :cond_3b

    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    iget-object v4, v2, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v3, v4}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v3

    if-eqz v3, :cond_3b

    .line 3786
    :cond_2d
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v3, v1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 3787
    add-int/lit8 v1, v1, -0x1

    .line 3788
    add-int/lit8 v0, v0, -0x1

    .line 3789
    iget-object v3, p1, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-nez v3, :cond_3b

    .line 3792
    move-object p1, v2

    .line 3782
    :cond_3b
    add-int/lit8 v1, v1, 0x1

    goto :goto_7

    .line 3796
    .end local v2           #tr:Lcom/android/server/am/TaskRecord;
    :cond_3e
    const/16 v3, 0x14

    if-lt v0, v3, :cond_4a

    .line 3797
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    const/4 v4, 0x1

    sub-int v4, v0, v4

    invoke-virtual {v3, v4}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 3799
    :cond_4a
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    const/4 v4, 0x0

    invoke-virtual {v3, v4, p1}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 3800
    return-void
.end method

.method private final appDiedLocked(Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V
    .registers 15
    .parameter "app"
    .parameter "pid"
    .parameter "thread"

    .prologue
    .line 4478
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    const/4 v8, 0x0

    aget v9, v7, v8

    add-int/lit8 v9, v9, 0x1

    aput v9, v7, v8

    .line 4480
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v7, :cond_dc

    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v7}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v7

    invoke-interface {p3}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v8

    if-ne v7, v8, :cond_dc

    .line 4481
    const-string v7, "ActivityManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Process "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, " (pid "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, ") has died."

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v7, v8}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4483
    const/16 v7, 0x753b

    const/4 v8, 0x2

    new-array v8, v8, [Ljava/lang/Object;

    const/4 v9, 0x0

    iget v10, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v10

    aput-object v10, v8, v9

    const/4 v9, 0x1

    iget-object v10, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v10, v8, v9

    invoke-static {v7, v8}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 4487
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    if-nez v7, :cond_cd

    const/4 v7, 0x1

    move v1, v7

    .line 4488
    .local v1, doLowMem:Z
    :goto_5f
    const/4 v7, 0x0

    invoke-direct {p0, p1, v7}, Lcom/android/server/am/ActivityManagerService;->handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 4490
    if-eqz v1, :cond_db

    .line 4494
    const/4 v2, 0x0

    .line 4495
    .local v2, haveBg:Z
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 4497
    .local v0, count:I
    const/4 v3, 0x0

    .local v3, i:I
    :goto_6d
    if-ge v3, v0, :cond_82

    .line 4498
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/am/ProcessRecord;

    .line 4499
    .local v6, rec:Lcom/android/server/am/ProcessRecord;
    iget-object v7, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v7, :cond_d0

    iget v7, v6, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v8, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v7, v8, :cond_d0

    .line 4500
    const/4 v2, 0x1

    .line 4505
    .end local v6           #rec:Lcom/android/server/am/ProcessRecord;
    :cond_82
    if-nez v2, :cond_db

    .line 4506
    const-string v7, "ActivityManager"

    const-string v8, "Low Memory: No more background processes."

    invoke-static {v7, v8}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4507
    const/16 v7, 0x7541

    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I

    move-result v8

    invoke-static {v7, v8}, Landroid/util/EventLog;->writeEvent(II)I

    .line 4508
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v4

    .line 4509
    .local v4, now:J
    const/4 v3, 0x0

    :goto_9b
    if-ge v3, v0, :cond_d8

    .line 4510
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/am/ProcessRecord;

    .line 4511
    .restart local v6       #rec:Lcom/android/server/am/ProcessRecord;
    iget-object v7, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v7, :cond_ca

    iget-wide v7, v6, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    const-wide/32 v9, 0xea60

    add-long/2addr v7, v9

    cmp-long v7, v7, v4

    if-gtz v7, :cond_ca

    .line 4516
    iget v7, v6, Lcom/android/server/am/ProcessRecord;->setAdj:I

    iget v8, p0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-gt v7, v8, :cond_d3

    .line 4517
    const-wide/16 v7, 0x0

    iput-wide v7, v6, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    .line 4521
    :goto_bd
    const/4 v7, 0x1

    iput-boolean v7, v6, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    .line 4522
    iput-wide v4, v6, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    .line 4523
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v7, v6}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4524
    invoke-virtual {p0, v6}, Lcom/android/server/am/ActivityManagerService;->addProcessToGcListLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 4509
    :cond_ca
    add-int/lit8 v3, v3, 0x1

    goto :goto_9b

    .line 4487
    .end local v0           #count:I
    .end local v1           #doLowMem:Z
    .end local v2           #haveBg:Z
    .end local v3           #i:I
    .end local v4           #now:J
    .end local v6           #rec:Lcom/android/server/am/ProcessRecord;
    :cond_cd
    const/4 v7, 0x0

    move v1, v7

    goto :goto_5f

    .line 4497
    .restart local v0       #count:I
    .restart local v1       #doLowMem:Z
    .restart local v2       #haveBg:Z
    .restart local v3       #i:I
    .restart local v6       #rec:Lcom/android/server/am/ProcessRecord;
    :cond_d0
    add-int/lit8 v3, v3, 0x1

    goto :goto_6d

    .line 4519
    .restart local v4       #now:J
    :cond_d3
    iget-wide v7, v6, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    iput-wide v7, v6, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    goto :goto_bd

    .line 4527
    .end local v6           #rec:Lcom/android/server/am/ProcessRecord;
    :cond_d8
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    .line 4534
    .end local v0           #count:I
    .end local v1           #doLowMem:Z
    .end local v2           #haveBg:Z
    .end local v3           #i:I
    .end local v4           #now:J
    :cond_db
    :goto_db
    return-void

    .line 4531
    :cond_dc
    const-string v7, "ActivityManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Received spurious death notification for thread "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-interface {p3}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v9

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v7, v8}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_db
.end method

.method private final attachApplicationLocked(Landroid/app/IApplicationThread;I)Z
    .registers 34
    .parameter "thread"
    .parameter "pid"

    .prologue
    .line 5109
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move v5, v0

    move/from16 v0, p2

    move v1, v5

    if-eq v0, v1, :cond_6d

    if-ltz p2, :cond_6d

    .line 5110
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    monitor-enter v5

    .line 5111
    :try_start_12
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v6, v0

    move-object v0, v6

    move/from16 v1, p2

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v22

    check-cast v22, Lcom/android/server/am/ProcessRecord;

    .line 5112
    .local v22, app:Lcom/android/server/am/ProcessRecord;
    monitor-exit v5
    :try_end_21
    .catchall {:try_start_12 .. :try_end_21} :catchall_6a

    .line 5120
    :goto_21
    if-nez v22, :cond_95

    .line 5121
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "No pending application record for pid "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " (IApplicationThread "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "); dropping process"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5123
    const/16 v5, 0x7551

    move v0, v5

    move/from16 v1, p2

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(II)I

    .line 5124
    if-lez p2, :cond_8f

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move v5, v0

    move/from16 v0, p2

    move v1, v5

    if-eq v0, v1, :cond_8f

    .line 5125
    invoke-static/range {p2 .. p2}, Landroid/os/Process;->killProcess(I)V

    .line 5133
    :goto_68
    const/4 v5, 0x0

    .line 5305
    :goto_69
    return v5

    .line 5112
    .end local v22           #app:Lcom/android/server/am/ProcessRecord;
    :catchall_6a
    move-exception v6

    :try_start_6b
    monitor-exit v5
    :try_end_6c
    .catchall {:try_start_6b .. :try_end_6c} :catchall_6a

    throw v6

    .line 5113
    :cond_6d
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_8c

    .line 5114
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v22

    check-cast v22, Lcom/android/server/am/ProcessRecord;

    .line 5115
    .restart local v22       #app:Lcom/android/server/am/ProcessRecord;
    move-object/from16 v0, v22

    move/from16 v1, p2

    invoke-virtual {v0, v1}, Lcom/android/server/am/ProcessRecord;->setPid(I)V

    goto :goto_21

    .line 5117
    .end local v22           #app:Lcom/android/server/am/ProcessRecord;
    :cond_8c
    const/16 v22, 0x0

    .restart local v22       #app:Lcom/android/server/am/ProcessRecord;
    goto :goto_21

    .line 5128
    :cond_8f
    :try_start_8f
    invoke-interface/range {p1 .. p1}, Landroid/app/IApplicationThread;->scheduleExit()V
    :try_end_92
    .catch Ljava/lang/Exception; {:try_start_8f .. :try_end_92} :catch_93

    goto :goto_68

    .line 5129
    :catch_93
    move-exception v5

    goto :goto_68

    .line 5138
    :cond_95
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v5, v0

    if-eqz v5, :cond_a5

    .line 5139
    const/4 v5, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, v22

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 5147
    :cond_a5
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v6, v0

    .line 5149
    .local v6, processName:Ljava/lang/String;
    :try_start_aa
    invoke-interface/range {p1 .. p1}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v5

    new-instance v7, Lcom/android/server/am/ActivityManagerService$AppDeathRecipient;

    move-object v0, v7

    move-object/from16 v1, p0

    move-object/from16 v2, v22

    move/from16 v3, p2

    move-object/from16 v4, p1

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService$AppDeathRecipient;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V

    const/4 v8, 0x0

    invoke-interface {v5, v7, v8}, Landroid/os/IBinder;->linkToDeath(Landroid/os/IBinder$DeathRecipient;I)V
    :try_end_c0
    .catch Landroid/os/RemoteException; {:try_start_aa .. :try_end_c0} :catch_2a0

    .line 5157
    const/16 v5, 0x753a

    const/4 v7, 0x2

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    move-object/from16 v0, v22

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v9, v0

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    const/4 v8, 0x1

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v9, v0

    aput-object v9, v7, v8

    invoke-static {v5, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 5159
    move-object/from16 v0, p1

    move-object/from16 v1, v22

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    .line 5160
    const/16 v5, -0x64

    move v0, v5

    move-object/from16 v1, v22

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->setAdj:I

    move v0, v5

    move-object/from16 v1, v22

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 5161
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v22

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->setSchedGroup:I

    move v0, v5

    move-object/from16 v1, v22

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    .line 5162
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, v22

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 5163
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v22

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 5164
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v22

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->debugging:Z

    .line 5166
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v7, 0x14

    move-object v0, v5

    move v1, v7

    move-object/from16 v2, v22

    invoke-virtual {v0, v1, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 5168
    move-object/from16 v0, p0

    move-object/from16 v1, v22

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->generateApplicationProvidersLocked(Lcom/android/server/am/ProcessRecord;)Ljava/util/List;

    move-result-object v8

    .line 5174
    .local v8, providers:Ljava/util/List;
    const/4 v13, 0x0

    .line 5175
    .local v13, testMode:I
    :try_start_122
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    move-object v5, v0

    if-eqz v5, :cond_15e

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_15e

    .line 5176
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    move v5, v0

    if-eqz v5, :cond_2b4

    const/4 v5, 0x2

    move v13, v5

    .line 5179
    :goto_13d
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v22

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->debugging:Z

    .line 5180
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugTransient:Z

    move v5, v0

    if-eqz v5, :cond_15e

    .line 5181
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    .line 5182
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    move v5, v0

    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    .line 5186
    :cond_15e
    const/4 v14, 0x0

    .line 5187
    .local v14, isRestrictedBackupMode:Z
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    if-eqz v5, :cond_187

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_187

    .line 5188
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/BackupRecord;->backupMode:I

    const/4 v7, 0x2

    if-eq v5, v7, :cond_185

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/BackupRecord;->backupMode:I

    const/4 v7, 0x1

    if-ne v5, v7, :cond_2b8

    :cond_185
    const/4 v5, 0x1

    move v14, v5

    .line 5191
    :cond_187
    :goto_187
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    if-eqz v5, :cond_2bc

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    :goto_195
    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 5194
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v5, v0

    if-eqz v5, :cond_1b1

    .line 5195
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 5197
    :cond_1b1
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    if-eqz v5, :cond_2c5

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    move-object v7, v5

    :goto_1be
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v9, v0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationProfileFile:Ljava/lang/String;

    move-object v10, v0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationArguments:Landroid/os/Bundle;

    move-object v11, v0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    move-object v12, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v15, v0

    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->getCommonServicesLocked()Ljava/util/HashMap;

    move-result-object v16

    move-object/from16 v5, p1

    invoke-interface/range {v5 .. v16}, Landroid/app/IApplicationThread;->bindApplication(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;Ljava/util/List;Landroid/content/ComponentName;Ljava/lang/String;Landroid/os/Bundle;Landroid/app/IInstrumentationWatcher;IZLandroid/content/res/Configuration;Ljava/util/Map;)V

    .line 5202
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v22

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->updateLRUListLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 5203
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v9

    move-wide v0, v9

    move-object/from16 v2, v22

    iput-wide v0, v2, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    move-wide v0, v9

    move-object/from16 v2, v22

    iput-wide v0, v2, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J
    :try_end_1f7
    .catch Ljava/lang/Exception; {:try_start_122 .. :try_end_1f7} :catch_2cd

    .line 5216
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v22

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 5217
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v22

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 5219
    const/16 v23, 0x0

    .line 5220
    .local v23, badApp:Z
    const/16 v25, 0x0

    .line 5223
    .local v25, didSomething:Z
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v27

    .line 5224
    .local v27, hr:Lcom/android/server/am/HistoryRecord;
    if-eqz v27, :cond_251

    .line 5225
    move-object/from16 v0, v27

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    if-nez v5, :cond_31a

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move-object/from16 v0, v27

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    if-ne v5, v7, :cond_31a

    move-object/from16 v0, v27

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v6, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_31a

    .line 5228
    const/4 v5, 0x1

    const/4 v7, 0x1

    :try_start_241
    move-object/from16 v0, p0

    move-object/from16 v1, v27

    move-object/from16 v2, v22

    move v3, v5

    move v4, v7

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->realStartActivityLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/ProcessRecord;ZZ)Z
    :try_end_24c
    .catch Ljava/lang/Exception; {:try_start_241 .. :try_end_24c} :catch_2ec

    move-result v5

    if-eqz v5, :cond_251

    .line 5229
    const/16 v25, 0x1

    .line 5242
    .end local v8           #providers:Ljava/util/List;
    :cond_251
    :goto_251
    if-nez v23, :cond_368

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_368

    .line 5243
    const/16 v29, 0x0

    .line 5245
    .local v29, sr:Lcom/android/server/am/ServiceRecord;
    const/16 v28, 0x0

    .local v28, i:I
    :goto_262
    :try_start_262
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    move/from16 v0, v28

    move v1, v5

    if-ge v0, v1, :cond_368

    .line 5246
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v28

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v30

    move-object/from16 v0, v30

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object/from16 v29, v0

    .line 5247
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    move-object v7, v0

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    if-ne v5, v7, :cond_29d

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v6, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
    :try_end_29a
    .catch Ljava/lang/Exception; {:try_start_262 .. :try_end_29a} :catch_342

    move-result v5

    if-nez v5, :cond_328

    .line 5245
    :cond_29d
    :goto_29d
    add-int/lit8 v28, v28, 0x1

    goto :goto_262

    .line 5151
    .end local v13           #testMode:I
    .end local v14           #isRestrictedBackupMode:Z
    .end local v23           #badApp:Z
    .end local v25           #didSomething:Z
    .end local v27           #hr:Lcom/android/server/am/HistoryRecord;
    .end local v28           #i:I
    .end local v29           #sr:Lcom/android/server/am/ServiceRecord;
    :catch_2a0
    move-exception v5

    move-object/from16 v26, v5

    .line 5152
    .local v26, e:Landroid/os/RemoteException;
    invoke-virtual/range {v22 .. v22}, Lcom/android/server/am/ProcessRecord;->resetPackageList()V

    .line 5153
    const-string v5, "link fail"

    move-object/from16 v0, p0

    move-object/from16 v1, v22

    move-object v2, v5

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 5154
    const/4 v5, 0x0

    goto/16 :goto_69

    .line 5176
    .end local v26           #e:Landroid/os/RemoteException;
    .restart local v8       #providers:Ljava/util/List;
    .restart local v13       #testMode:I
    :cond_2b4
    const/4 v5, 0x1

    move v13, v5

    goto/16 :goto_13d

    .line 5188
    .restart local v14       #isRestrictedBackupMode:Z
    :cond_2b8
    const/4 v5, 0x0

    move v14, v5

    goto/16 :goto_187

    .line 5191
    :cond_2bc
    :try_start_2bc
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    goto/16 :goto_195

    .line 5197
    :cond_2c5
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0
    :try_end_2ca
    .catch Ljava/lang/Exception; {:try_start_2bc .. :try_end_2ca} :catch_2cd

    move-object v7, v5

    goto/16 :goto_1be

    .line 5204
    .end local v14           #isRestrictedBackupMode:Z
    :catch_2cd
    move-exception v5

    move-object/from16 v26, v5

    .line 5208
    .local v26, e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    const-string v7, "Exception thrown during bind!"

    move-object v0, v5

    move-object v1, v7

    move-object/from16 v2, v26

    invoke-static {v0, v1, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5210
    invoke-virtual/range {v22 .. v22}, Lcom/android/server/am/ProcessRecord;->resetPackageList()V

    .line 5211
    const-string v5, "bind fail"

    move-object/from16 v0, p0

    move-object/from16 v1, v22

    move-object v2, v5

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 5212
    const/4 v5, 0x0

    goto/16 :goto_69

    .line 5231
    .end local v26           #e:Ljava/lang/Exception;
    .restart local v14       #isRestrictedBackupMode:Z
    .restart local v23       #badApp:Z
    .restart local v25       #didSomething:Z
    .restart local v27       #hr:Lcom/android/server/am/HistoryRecord;
    :catch_2ec
    move-exception v26

    .line 5232
    .restart local v26       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Exception in new application when starting activity "

    .end local v8           #providers:Ljava/util/List;
    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object/from16 v0, v27

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v8, v0

    invoke-virtual {v8}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v8

    invoke-virtual {v8}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    move-object v0, v5

    move-object v1, v7

    move-object/from16 v2, v26

    invoke-static {v0, v1, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5234
    const/16 v23, 0x1

    .line 5235
    goto/16 :goto_251

    .line 5237
    .end local v26           #e:Ljava/lang/Exception;
    .restart local v8       #providers:Ljava/util/List;
    :cond_31a
    const/4 v5, 0x0

    const/4 v7, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v27

    move-object v2, v5

    move-object v3, v6

    move v4, v7

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V

    goto/16 :goto_251

    .line 5252
    .end local v8           #providers:Ljava/util/List;
    .restart local v28       #i:I
    .restart local v29       #sr:Lcom/android/server/am/ServiceRecord;
    :cond_328
    :try_start_328
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v28

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 5253
    add-int/lit8 v28, v28, -0x1

    .line 5254
    move-object/from16 v0, p0

    move-object/from16 v1, v29

    move-object/from16 v2, v22

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->realStartServiceLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/ProcessRecord;)V
    :try_end_33e
    .catch Ljava/lang/Exception; {:try_start_328 .. :try_end_33e} :catch_342

    .line 5255
    const/16 v25, 0x1

    goto/16 :goto_29d

    .line 5257
    :catch_342
    move-exception v5

    move-object/from16 v26, v5

    .line 5258
    .restart local v26       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    .end local v6           #processName:Ljava/lang/String;
    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Exception in new application when starting service "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    move-object v0, v5

    move-object v1, v6

    move-object/from16 v2, v26

    invoke-static {v0, v1, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5260
    const/16 v23, 0x1

    .line 5265
    .end local v26           #e:Ljava/lang/Exception;
    .end local v28           #i:I
    .end local v29           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_368
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v24, v0

    .line 5266
    .local v24, br:Lcom/android/server/am/BroadcastRecord;
    if-nez v23, :cond_38d

    if-eqz v24, :cond_38d

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v22

    if-ne v0, v1, :cond_38d

    .line 5268
    const/4 v5, 0x0

    :try_start_37d
    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 5269
    move-object/from16 v0, p0

    move-object/from16 v1, v24

    move-object/from16 v2, v22

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->processCurBroadcastLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/ProcessRecord;)V
    :try_end_38b
    .catch Ljava/lang/Exception; {:try_start_37d .. :try_end_38b} :catch_3f5

    .line 5270
    const/16 v25, 0x1

    .line 5283
    :cond_38d
    :goto_38d
    if-nez v23, :cond_3e7

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    if-eqz v5, :cond_3e7

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/BackupRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v6, v0

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    if-ne v5, v6, :cond_3e7

    .line 5284
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "New app is backup target, launching agent for "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, v22

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 5285
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/BackupRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 5287
    :try_start_3d2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/BackupRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object v6, v0

    iget v6, v6, Lcom/android/server/am/BackupRecord;->backupMode:I

    move-object/from16 v0, p1

    move-object v1, v5

    move v2, v6

    invoke-interface {v0, v1, v2}, Landroid/app/IApplicationThread;->scheduleCreateBackupAgent(Landroid/content/pm/ApplicationInfo;I)V
    :try_end_3e7
    .catch Ljava/lang/Exception; {:try_start_3d2 .. :try_end_3e7} :catch_450

    .line 5294
    :cond_3e7
    :goto_3e7
    if-eqz v23, :cond_45e

    .line 5297
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v22

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 5298
    const/4 v5, 0x0

    goto/16 :goto_69

    .line 5271
    :catch_3f5
    move-exception v5

    move-object/from16 v26, v5

    .line 5272
    .restart local v26       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Exception in new application when starting receiver "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    move-object v7, v0

    invoke-virtual {v7}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    move-object v0, v5

    move-object v1, v6

    move-object/from16 v2, v26

    invoke-static {v0, v1, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5274
    const/16 v23, 0x1

    .line 5275
    move-object/from16 v0, p0

    move-object/from16 v1, v24

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 5276
    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object/from16 v16, v0

    move-object/from16 v0, v24

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    move/from16 v17, v0

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    move-object/from16 v18, v0

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    move-object/from16 v19, v0

    move-object/from16 v0, v24

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move/from16 v20, v0

    const/16 v21, 0x1

    move-object/from16 v15, p0

    invoke-direct/range {v15 .. v21}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 5278
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    goto/16 :goto_38d

    .line 5288
    .end local v26           #e:Ljava/lang/Exception;
    :catch_450
    move-exception v5

    move-object/from16 v26, v5

    .line 5289
    .restart local v26       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    const-string v6, "Exception scheduling backup agent creation: "

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5290
    invoke-virtual/range {v26 .. v26}, Ljava/lang/Exception;->printStackTrace()V

    goto :goto_3e7

    .line 5301
    .end local v26           #e:Ljava/lang/Exception;
    :cond_45e
    if-nez v25, :cond_463

    .line 5302
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 5305
    :cond_463
    const/4 v5, 0x1

    goto/16 :goto_69
.end method

.method private final bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V
    .registers 15
    .parameter "r"
    .parameter "force"

    .prologue
    .line 10246
    if-nez p2, :cond_7

    iget-boolean v8, p1, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    if-eqz v8, :cond_7

    .line 10351
    :cond_6
    :goto_6
    return-void

    .line 10249
    :cond_7
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->size()I

    move-result v8

    if-lez v8, :cond_90

    .line 10250
    if-nez p2, :cond_2e

    .line 10253
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v8

    invoke-interface {v8}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v6

    .line 10254
    .local v6, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_1b
    invoke-interface {v6}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_2e

    .line 10255
    invoke-interface {v6}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ConnectionRecord;

    .line 10256
    .local v2, cr:Lcom/android/server/am/ConnectionRecord;
    iget v8, v2, Lcom/android/server/am/ConnectionRecord;->flags:I

    and-int/lit8 v8, v8, 0x1

    if-eqz v8, :cond_1b

    goto :goto_6

    .line 10264
    .end local v2           #cr:Lcom/android/server/am/ConnectionRecord;
    .end local v6           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_2e
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v8

    invoke-interface {v8}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v6

    .line 10265
    .restart local v6       #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :goto_38
    invoke-interface {v6}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_90

    .line 10266
    invoke-interface {v6}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ConnectionRecord;

    .line 10269
    .local v1, c:Lcom/android/server/am/ConnectionRecord;
    :try_start_44
    iget-object v8, v1, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    iget-object v9, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    const/4 v10, 0x0

    invoke-interface {v8, v9, v10}, Landroid/app/IServiceConnection;->connected(Landroid/content/ComponentName;Landroid/os/IBinder;)V
    :try_end_4c
    .catch Ljava/lang/Exception; {:try_start_44 .. :try_end_4c} :catch_4d

    goto :goto_38

    .line 10270
    :catch_4d
    move-exception v8

    move-object v3, v8

    .line 10271
    .local v3, e:Ljava/lang/Exception;
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Failure disconnecting service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " to connection "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v1, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    invoke-interface {v10}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " (in "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v10, v10, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v10, v10, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ")"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9, v3}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_38

    .line 10279
    .end local v1           #c:Lcom/android/server/am/ConnectionRecord;
    .end local v3           #e:Ljava/lang/Exception;
    .end local v6           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_90
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->size()I

    move-result v8

    if-lez v8, :cond_100

    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v8, :cond_100

    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v8, :cond_100

    .line 10280
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v8}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v8

    invoke-interface {v8}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v7

    .line 10281
    .local v7, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    :cond_ac
    :goto_ac
    invoke-interface {v7}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_100

    .line 10282
    invoke-interface {v7}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/IntentBindRecord;

    .line 10285
    .local v5, ibr:Lcom/android/server/am/IntentBindRecord;
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v8, :cond_ac

    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v8, :cond_ac

    iget-boolean v8, v5, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    if-eqz v8, :cond_ac

    .line 10287
    :try_start_c6
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 10288
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v8}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 10289
    const/4 v8, 0x0

    iput-boolean v8, v5, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    .line 10290
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v9, v5, Lcom/android/server/am/IntentBindRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v9}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v9

    invoke-interface {v8, p1, v9}, Landroid/app/IApplicationThread;->scheduleUnbindService(Landroid/os/IBinder;Landroid/content/Intent;)V
    :try_end_de
    .catch Ljava/lang/Exception; {:try_start_c6 .. :try_end_de} :catch_df

    goto :goto_ac

    .line 10292
    :catch_df
    move-exception v8

    move-object v3, v8

    .line 10293
    .restart local v3       #e:Ljava/lang/Exception;
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Exception when unbinding service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9, v3}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 10295
    const/4 v8, 0x1

    invoke-virtual {p0, p1, v8}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto :goto_ac

    .line 10303
    .end local v3           #e:Ljava/lang/Exception;
    .end local v5           #ibr:Lcom/android/server/am/IntentBindRecord;
    .end local v7           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    :cond_100
    const/16 v8, 0x754f

    const/4 v9, 0x3

    new-array v9, v9, [Ljava/lang/Object;

    const/4 v10, 0x0

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v11

    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v11

    aput-object v11, v9, v10

    const/4 v10, 0x1

    iget-object v11, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    aput-object v11, v9, v10

    const/4 v10, 0x2

    iget-object v11, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v11, :cond_158

    iget-object v11, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v11, v11, Lcom/android/server/am/ProcessRecord;->pid:I

    :goto_11e
    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v11

    aput-object v11, v9, v10

    invoke-static {v8, v9}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 10307
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    iget-object v9, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v8, v9}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 10308
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    iget-object v9, p1, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v8, v9}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 10310
    const/4 v8, 0x0

    iput v8, p1, Lcom/android/server/am/ServiceRecord;->totalRestartCount:I

    .line 10311
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->unscheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)Z

    .line 10314
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 10315
    .local v0, N:I
    const/4 v4, 0x0

    .local v4, i:I
    :goto_142
    if-ge v4, v0, :cond_15a

    .line 10316
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v8, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v8

    if-ne v8, p1, :cond_155

    .line 10317
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v8, v4}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 10320
    add-int/lit8 v4, v4, -0x1

    .line 10321
    add-int/lit8 v0, v0, -0x1

    .line 10315
    :cond_155
    add-int/lit8 v4, v4, 0x1

    goto :goto_142

    .line 10303
    .end local v0           #N:I
    .end local v4           #i:I
    :cond_158
    const/4 v11, -0x1

    goto :goto_11e

    .line 10325
    .restart local v0       #N:I
    .restart local v4       #i:I
    :cond_15a
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v8, :cond_6

    .line 10326
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v8}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v8

    monitor-enter v8

    .line 10327
    :try_start_165
    iget-object v9, p1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v9}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->stopLaunchedLocked()V

    .line 10328
    monitor-exit v8
    :try_end_16b
    .catchall {:try_start_165 .. :try_end_16b} :catchall_1d0

    .line 10329
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v8, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 10330
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v8, :cond_6

    .line 10331
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v9, 0x0

    invoke-virtual {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->updateServiceForegroundLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 10333
    :try_start_17e
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Stopping service: "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 10334
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 10335
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v8, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 10336
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v8}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 10337
    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v8, v8, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v8, p1}, Landroid/app/IApplicationThread;->scheduleStopService(Landroid/os/IBinder;)V
    :try_end_1ac
    .catch Ljava/lang/Exception; {:try_start_17e .. :try_end_1ac} :catch_1ae

    goto/16 :goto_6

    .line 10338
    :catch_1ae
    move-exception v8

    move-object v3, v8

    .line 10339
    .restart local v3       #e:Ljava/lang/Exception;
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Exception when stopping service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9, v3}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 10341
    const/4 v8, 0x1

    invoke-virtual {p0, p1, v8}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto/16 :goto_6

    .line 10328
    .end local v3           #e:Ljava/lang/Exception;
    :catchall_1d0
    move-exception v9

    :try_start_1d1
    monitor-exit v8
    :try_end_1d2
    .catchall {:try_start_1d1 .. :try_end_1d2} :catchall_1d0

    throw v9
.end method

.method private final bringUpServiceLocked(Lcom/android/server/am/ServiceRecord;IZ)Z
    .registers 13
    .parameter "r"
    .parameter "intentFlags"
    .parameter "whileRestarting"

    .prologue
    .line 10193
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_a

    .line 10194
    const/4 v0, 0x0

    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->sendServiceArgsLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 10195
    const/4 v0, 0x1

    .line 10238
    :goto_9
    return v0

    .line 10198
    :cond_a
    if-nez p3, :cond_16

    iget-wide v2, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    const-wide/16 v4, 0x0

    cmp-long v0, v2, v4

    if-lez v0, :cond_16

    .line 10200
    const/4 v0, 0x1

    goto :goto_9

    .line 10208
    :cond_16
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 10210
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->processName:Ljava/lang/String;

    .line 10211
    .local v1, appName:Ljava/lang/String;
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v1, v0}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v7

    .line 10212
    .local v7, app:Lcom/android/server/am/ProcessRecord;
    if-eqz v7, :cond_4b

    iget-object v0, v7, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_4b

    .line 10214
    :try_start_2b
    invoke-direct {p0, p1, v7}, Lcom/android/server/am/ActivityManagerService;->realStartServiceLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/ProcessRecord;)V
    :try_end_2e
    .catch Landroid/os/RemoteException; {:try_start_2b .. :try_end_2e} :catch_30

    .line 10215
    const/4 v0, 0x1

    goto :goto_9

    .line 10216
    :catch_30
    move-exception v8

    .line 10217
    .local v8, e:Landroid/os/RemoteException;
    const-string v0, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Exception when starting service "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v0, v2, v8}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 10224
    .end local v8           #e:Landroid/os/RemoteException;
    :cond_4b
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_ae

    .line 10227
    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    const/4 v3, 0x1

    const-string v5, "service"

    iget-object v6, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    move-object v0, p0

    move v4, p2

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    if-nez v0, :cond_a9

    .line 10229
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    .end local v1           #appName:Ljava/lang/String;
    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unable to launch app "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, "/"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " for service "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v2}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ": process is bad"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10233
    const/4 v0, 0x1

    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 10234
    const/4 v0, 0x0

    goto/16 :goto_9

    .line 10236
    .restart local v1       #appName:Ljava/lang/String;
    :cond_a9
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 10238
    :cond_ae
    const/4 v0, 0x1

    goto/16 :goto_9
.end method

.method private final broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I
    .registers 63
    .parameter "callerApp"
    .parameter "callerPackage"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "resultTo"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "map"
    .parameter "requiredPermission"
    .parameter "ordered"
    .parameter "sticky"
    .parameter "callingPid"
    .parameter "callingUid"

    .prologue
    .line 11194
    new-instance v6, Landroid/content/Intent;

    move-object v0, v6

    move-object/from16 v1, p3

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    .line 11199
    .end local p3
    .local v6, intent:Landroid/content/Intent;
    if-eqz p5, :cond_2a

    if-nez p10, :cond_2a

    .line 11200
    const-string v7, "ActivityManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Broadcast "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, " not ordered but result callback requested!"

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v7, v8}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11206
    :cond_2a
    const-string v7, "android.intent.action.UID_REMOVED"

    invoke-virtual {v6}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v48

    .line 11208
    .local v48, uidRemoved:Z
    const-string v7, "android.intent.action.PACKAGE_REMOVED"

    invoke-virtual {v6}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-nez v7, :cond_4e

    const-string v7, "android.intent.action.PACKAGE_CHANGED"

    invoke-virtual {v6}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-nez v7, :cond_4e

    if-eqz v48, :cond_86

    .line 11211
    :cond_4e
    const-string v7, "android.permission.BROADCAST_PACKAGE_REMOVED"

    const/4 v8, -0x1

    move-object/from16 v0, p0

    move-object v1, v7

    move/from16 v2, p12

    move/from16 v3, p13

    move v4, v8

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v7

    if-nez v7, :cond_141

    .line 11215
    if-eqz v48, :cond_10c

    .line 11216
    invoke-virtual {v6}, Landroid/content/Intent;->getExtras()Landroid/os/Bundle;

    move-result-object v37

    .line 11217
    .local v37, intentExtras:Landroid/os/Bundle;
    if-eqz v37, :cond_104

    const-string v7, "android.intent.extra.UID"

    move-object/from16 v0, v37

    move-object v1, v7

    invoke-virtual {v0, v1}, Landroid/os/Bundle;->getInt(Ljava/lang/String;)I

    move-result v7

    move/from16 v47, v7

    .line 11219
    .local v47, uid:I
    :goto_72
    if-ltz v47, :cond_86

    .line 11220
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object v7, v0

    invoke-virtual {v7}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v31

    .line 11221
    .local v31, bs:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v31

    .line 11222
    :try_start_7e
    move-object/from16 v0, v31

    move/from16 v1, v47

    invoke-virtual {v0, v1}, Lcom/android/internal/os/BatteryStatsImpl;->removeUidStatsLocked(I)V

    .line 11223
    monitor-exit v31
    :try_end_86
    .catchall {:try_start_7e .. :try_end_86} :catchall_109

    .line 11255
    .end local v31           #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v37           #intentExtras:Landroid/os/Bundle;
    .end local v47           #uid:I
    :cond_86
    :goto_86
    const-string v7, "android.intent.action.TIMEZONE_CHANGED"

    invoke-virtual {v6}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_9c

    .line 11256
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v7, v0

    const/16 v8, 0xd

    invoke-virtual {v7, v8}, Landroid/os/Handler;->sendEmptyMessage(I)Z

    .line 11263
    :cond_9c
    const/16 v7, 0x3e8

    move/from16 v0, p13

    move v1, v7

    if-eq v0, v1, :cond_b3

    const/16 v7, 0x3e9

    move/from16 v0, p13

    move v1, v7

    if-eq v0, v1, :cond_b3

    const/16 v7, 0x7d0

    move/from16 v0, p13

    move v1, v7

    if-eq v0, v1, :cond_b3

    if-nez p13, :cond_1a2

    .line 11283
    :cond_b3
    if-eqz p11, :cond_2a5

    .line 11284
    const-string v7, "android.permission.BROADCAST_STICKY"

    move-object/from16 v0, p0

    move-object v1, v7

    move/from16 v2, p12

    move/from16 v3, p13

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkPermission(Ljava/lang/String;II)I

    move-result v7

    if-eqz v7, :cond_20b

    .line 11287
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Permission Denial: broadcastIntent() requesting a sticky broadcast from pid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move/from16 v1, p12

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ", uid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move/from16 v1, p13

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " requires "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, "android.permission.BROADCAST_STICKY"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v41

    .line 11290
    .local v41, msg:Ljava/lang/String;
    const-string v7, "ActivityManager"

    move-object v0, v7

    move-object/from16 v1, v41

    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11291
    new-instance v7, Ljava/lang/SecurityException;

    move-object v0, v7

    move-object/from16 v1, v41

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v7

    .line 11217
    .end local v41           #msg:Ljava/lang/String;
    .restart local v37       #intentExtras:Landroid/os/Bundle;
    :cond_104
    const/4 v7, -0x1

    move/from16 v47, v7

    goto/16 :goto_72

    .line 11223
    .restart local v31       #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .restart local v47       #uid:I
    :catchall_109
    move-exception v7

    :try_start_10a
    monitor-exit v31
    :try_end_10b
    .catchall {:try_start_10a .. :try_end_10b} :catchall_109

    throw v7

    .line 11226
    .end local v31           #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v37           #intentExtras:Landroid/os/Bundle;
    .end local v47           #uid:I
    :cond_10c
    invoke-virtual {v6}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v34

    .line 11228
    .local v34, data:Landroid/net/Uri;
    if-eqz v34, :cond_86

    invoke-virtual/range {v34 .. v34}, Landroid/net/Uri;->getSchemeSpecificPart()Ljava/lang/String;

    move-result-object v46

    .local v46, ssp:Ljava/lang/String;
    if-eqz v46, :cond_86

    .line 11229
    const-string v7, "android.intent.extra.DONT_KILL_APP"

    const/4 v8, 0x0

    invoke-virtual {v6, v7, v8}, Landroid/content/Intent;->getBooleanExtra(Ljava/lang/String;Z)Z

    move-result v7

    if-nez v7, :cond_86

    .line 11230
    const-string v7, "android.intent.extra.UID"

    const/4 v8, -0x1

    invoke-virtual {v6, v7, v8}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I

    move-result v7

    const/4 v8, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v46

    move v2, v7

    move v3, v8

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->uninstallPackageLocked(Ljava/lang/String;IZ)V

    .line 11232
    invoke-static {}, Lcom/android/server/AttributeCache;->instance()Lcom/android/server/AttributeCache;

    move-result-object v29

    .line 11233
    .local v29, ac:Lcom/android/server/AttributeCache;
    if-eqz v29, :cond_86

    .line 11234
    move-object/from16 v0, v29

    move-object/from16 v1, v46

    invoke-virtual {v0, v1}, Lcom/android/server/AttributeCache;->removePackage(Ljava/lang/String;)V

    goto/16 :goto_86

    .line 11240
    .end local v29           #ac:Lcom/android/server/AttributeCache;
    .end local v34           #data:Landroid/net/Uri;
    .end local v46           #ssp:Ljava/lang/String;
    :cond_141
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Permission Denial: "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v6}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " broadcast from "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " (pid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move/from16 v1, p12

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ", uid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move/from16 v1, p13

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ")"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " requires "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, "android.permission.BROADCAST_PACKAGE_REMOVED"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v41

    .line 11245
    .restart local v41       #msg:Ljava/lang/String;
    const-string v7, "ActivityManager"

    move-object v0, v7

    move-object/from16 v1, v41

    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11246
    new-instance v7, Ljava/lang/SecurityException;

    move-object v0, v7

    move-object/from16 v1, v41

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v7

    .line 11266
    .end local v41           #msg:Ljava/lang/String;
    :cond_1a2
    if-eqz p1, :cond_1ab

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    move v7, v0

    if-nez v7, :cond_b3

    .line 11268
    :cond_1ab
    :try_start_1ab
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v7

    invoke-virtual {v6}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v8

    invoke-interface {v7, v8}, Landroid/content/pm/IPackageManager;->isProtectedBroadcast(Ljava/lang/String;)Z

    move-result v7

    if-eqz v7, :cond_b3

    .line 11270
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Permission Denial: not allowed to send broadcast "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v6}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " from pid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move/from16 v1, p12

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ", uid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move/from16 v1, p13

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v41

    .line 11273
    .restart local v41       #msg:Ljava/lang/String;
    const-string v7, "ActivityManager"

    move-object v0, v7

    move-object/from16 v1, v41

    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11274
    new-instance v7, Ljava/lang/SecurityException;

    move-object v0, v7

    move-object/from16 v1, v41

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v7
    :try_end_1fb
    .catch Landroid/os/RemoteException; {:try_start_1ab .. :try_end_1fb} :catch_1fb

    .line 11276
    .end local v41           #msg:Ljava/lang/String;
    :catch_1fb
    move-exception v7

    move-object/from16 v35, v7

    .line 11277
    .local v35, e:Landroid/os/RemoteException;
    const-string v7, "ActivityManager"

    const-string v8, "Remote exception"

    move-object v0, v7

    move-object v1, v8

    move-object/from16 v2, v35

    invoke-static {v0, v1, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 11278
    const/4 v7, 0x0

    .line 11448
    .end local v35           #e:Landroid/os/RemoteException;
    :goto_20a
    return v7

    .line 11293
    :cond_20b
    if-eqz p9, :cond_234

    .line 11294
    const-string v7, "ActivityManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Can\'t broadcast sticky intent "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, " and enforce permission "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    move-object v0, v8

    move-object/from16 v1, p9

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v7, v8}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11296
    const/4 v7, -0x1

    goto :goto_20a

    .line 11298
    :cond_234
    invoke-virtual {v6}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v7

    if-eqz v7, :cond_242

    .line 11299
    new-instance v7, Ljava/lang/SecurityException;

    const-string v8, "Sticky broadcasts can\'t target a specific component"

    invoke-direct {v7, v8}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v7

    .line 11302
    :cond_242
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    move-object v7, v0

    invoke-virtual {v6}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v40

    check-cast v40, Ljava/util/ArrayList;

    .line 11303
    .local v40, list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    if-nez v40, :cond_268

    .line 11304
    new-instance v40, Ljava/util/ArrayList;

    .end local v40           #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    invoke-direct/range {v40 .. v40}, Ljava/util/ArrayList;-><init>()V

    .line 11305
    .restart local v40       #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    move-object v7, v0

    invoke-virtual {v6}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v8

    move-object v0, v7

    move-object v1, v8

    move-object/from16 v2, v40

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 11307
    :cond_268
    invoke-virtual/range {v40 .. v40}, Ljava/util/ArrayList;->size()I

    move-result v26

    .line 11309
    .local v26, N:I
    const/16 v36, 0x0

    .local v36, i:I
    :goto_26e
    move/from16 v0, v36

    move/from16 v1, v26

    if-ge v0, v1, :cond_294

    .line 11310
    move-object/from16 v0, v40

    move/from16 v1, v36

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p3

    check-cast p3, Landroid/content/Intent;

    move-object v0, v6

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v7

    if-eqz v7, :cond_364

    .line 11312
    new-instance v7, Landroid/content/Intent;

    invoke-direct {v7, v6}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    move-object/from16 v0, v40

    move/from16 v1, v36

    move-object v2, v7

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->set(ILjava/lang/Object;)Ljava/lang/Object;

    .line 11316
    :cond_294
    move/from16 v0, v36

    move/from16 v1, v26

    if-lt v0, v1, :cond_2a5

    .line 11317
    new-instance v7, Landroid/content/Intent;

    invoke-direct {v7, v6}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    move-object/from16 v0, v40

    move-object v1, v7

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11322
    .end local v26           #N:I
    .end local v36           #i:I
    .end local v40           #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    :cond_2a5
    const/16 v20, 0x0

    .line 11323
    .local v20, receivers:Ljava/util/List;
    const/4 v12, 0x0

    .line 11325
    .local v12, registeredReceivers:Ljava/util/List;,"Ljava/util/List<Lcom/android/server/am/BroadcastFilter;>;"
    :try_start_2a8
    invoke-virtual {v6}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v7

    if-eqz v7, :cond_368

    .line 11327
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v7

    invoke-virtual {v6}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v8

    const/16 v9, 0x400

    invoke-interface {v7, v8, v9}, Landroid/content/pm/IPackageManager;->getReceiverInfo(Landroid/content/ComponentName;I)Landroid/content/pm/ActivityInfo;

    move-result-object v30

    .line 11329
    .local v30, ai:Landroid/content/pm/ActivityInfo;
    if-eqz v30, :cond_2d3

    .line 11330
    new-instance v42, Ljava/util/ArrayList;

    invoke-direct/range {v42 .. v42}, Ljava/util/ArrayList;-><init>()V
    :try_end_2c3
    .catch Landroid/os/RemoteException; {:try_start_2a8 .. :try_end_2c3} :catch_462

    .line 11331
    .end local v20           #receivers:Ljava/util/List;
    .local v42, receivers:Ljava/util/List;
    :try_start_2c3
    new-instance v43, Landroid/content/pm/ResolveInfo;

    invoke-direct/range {v43 .. v43}, Landroid/content/pm/ResolveInfo;-><init>()V

    .line 11332
    .local v43, ri:Landroid/content/pm/ResolveInfo;
    move-object/from16 v0, v30

    move-object/from16 v1, v43

    iput-object v0, v1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 11333
    invoke-interface/range {v42 .. v43}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_2d1
    .catch Landroid/os/RemoteException; {:try_start_2c3 .. :try_end_2d1} :catch_465

    move-object/from16 v20, v42

    .line 11349
    .end local v30           #ai:Landroid/content/pm/ActivityInfo;
    .end local v42           #receivers:Ljava/util/List;
    .end local v43           #ri:Landroid/content/pm/ResolveInfo;
    .restart local v20       #receivers:Ljava/util/List;
    :cond_2d3
    :goto_2d3
    if-eqz v12, :cond_391

    invoke-interface {v12}, Ljava/util/List;->size()I

    move-result v7

    move/from16 v27, v7

    .line 11350
    .local v27, NR:I
    :goto_2db
    if-nez p10, :cond_306

    if-lez v27, :cond_306

    .line 11354
    new-instance v5, Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v7, p1

    move-object/from16 v8, p2

    move/from16 v9, p12

    move/from16 v10, p13

    move-object/from16 v11, p9

    move-object/from16 v13, p5

    move/from16 v14, p6

    move-object/from16 v15, p7

    move-object/from16 v16, p8

    move/from16 v17, p10

    invoke-direct/range {v5 .. v17}, Lcom/android/server/am/BroadcastRecord;-><init>(Landroid/content/Intent;Lcom/android/server/am/ProcessRecord;Ljava/lang/String;IILjava/lang/String;Ljava/util/List;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Z)V

    .line 11361
    .local v5, r:Lcom/android/server/am/BroadcastRecord;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v7, v0

    invoke-virtual {v7, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11362
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 11363
    const/4 v12, 0x0

    .line 11364
    const/16 v27, 0x0

    .line 11368
    .end local v5           #r:Lcom/android/server/am/BroadcastRecord;
    :cond_306
    const/16 v38, 0x0

    .line 11369
    .local v38, ir:I
    if-eqz v20, :cond_412

    .line 11376
    const/16 v44, 0x0

    .line 11377
    .local v44, skip:Z
    const-string v7, "android.intent.action.PACKAGE_ADDED"

    invoke-virtual {v6}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_396

    .line 11378
    const/16 v44, 0x1

    .line 11384
    :cond_31a
    :goto_31a
    if-eqz v44, :cond_3b6

    invoke-virtual {v6}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v7

    if-eqz v7, :cond_3b6

    invoke-virtual {v6}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v7

    invoke-virtual {v7}, Landroid/net/Uri;->getSchemeSpecificPart()Ljava/lang/String;

    move-result-object v7

    move-object/from16 v45, v7

    .line 11387
    .local v45, skipPackage:Ljava/lang/String;
    :goto_32c
    if-eqz v45, :cond_3bb

    if-eqz v20, :cond_3bb

    .line 11388
    invoke-interface/range {v20 .. v20}, Ljava/util/List;->size()I

    move-result v28

    .line 11389
    .local v28, NT:I
    const/16 v39, 0x0

    .local v39, it:I
    :goto_336
    move/from16 v0, v39

    move/from16 v1, v28

    if-ge v0, v1, :cond_3bb

    .line 11390
    move-object/from16 v0, v20

    move/from16 v1, v39

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v33

    check-cast v33, Landroid/content/pm/ResolveInfo;

    .line 11391
    .local v33, curt:Landroid/content/pm/ResolveInfo;
    move-object/from16 v0, v33

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move-object v0, v7

    move-object/from16 v1, v45

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_361

    .line 11392
    move-object/from16 v0, v20

    move/from16 v1, v39

    invoke-interface {v0, v1}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 11393
    add-int/lit8 v39, v39, -0x1

    .line 11394
    add-int/lit8 v28, v28, -0x1

    .line 11389
    :cond_361
    add-int/lit8 v39, v39, 0x1

    goto :goto_336

    .line 11309
    .end local v12           #registeredReceivers:Ljava/util/List;,"Ljava/util/List<Lcom/android/server/am/BroadcastFilter;>;"
    .end local v20           #receivers:Ljava/util/List;
    .end local v27           #NR:I
    .end local v28           #NT:I
    .end local v33           #curt:Landroid/content/pm/ResolveInfo;
    .end local v38           #ir:I
    .end local v39           #it:I
    .end local v44           #skip:Z
    .end local v45           #skipPackage:Ljava/lang/String;
    .restart local v26       #N:I
    .restart local v36       #i:I
    .restart local v40       #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    :cond_364
    add-int/lit8 v36, v36, 0x1

    goto/16 :goto_26e

    .line 11337
    .end local v26           #N:I
    .end local v36           #i:I
    .end local v40           #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    .restart local v12       #registeredReceivers:Ljava/util/List;,"Ljava/util/List<Lcom/android/server/am/BroadcastFilter;>;"
    .restart local v20       #receivers:Ljava/util/List;
    :cond_368
    :try_start_368
    invoke-virtual {v6}, Landroid/content/Intent;->getFlags()I

    move-result v7

    const/high16 v8, 0x4000

    and-int/2addr v7, v8

    if-nez v7, :cond_380

    .line 11339
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v7

    const/16 v8, 0x400

    move-object v0, v7

    move-object v1, v6

    move-object/from16 v2, p4

    move v3, v8

    invoke-interface {v0, v1, v2, v3}, Landroid/content/pm/IPackageManager;->queryIntentReceivers(Landroid/content/Intent;Ljava/lang/String;I)Ljava/util/List;

    move-result-object v20

    .line 11343
    :cond_380
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    move-object v7, v0

    const/4 v8, 0x0

    move-object v0, v7

    move-object v1, v6

    move-object/from16 v2, p4

    move v3, v8

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/IntentResolver;->queryIntent(Landroid/content/Intent;Ljava/lang/String;Z)Ljava/util/List;
    :try_end_38e
    .catch Landroid/os/RemoteException; {:try_start_368 .. :try_end_38e} :catch_462

    move-result-object v12

    goto/16 :goto_2d3

    .line 11349
    :cond_391
    const/4 v7, 0x0

    move/from16 v27, v7

    goto/16 :goto_2db

    .line 11379
    .restart local v27       #NR:I
    .restart local v38       #ir:I
    .restart local v44       #skip:Z
    :cond_396
    const-string v7, "android.intent.action.PACKAGE_RESTARTED"

    invoke-virtual {v6}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_3a6

    .line 11380
    const/16 v44, 0x1

    goto/16 :goto_31a

    .line 11381
    :cond_3a6
    const-string v7, "android.intent.action.PACKAGE_DATA_CLEARED"

    invoke-virtual {v6}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_31a

    .line 11382
    const/16 v44, 0x1

    goto/16 :goto_31a

    .line 11384
    :cond_3b6
    const/4 v7, 0x0

    move-object/from16 v45, v7

    goto/16 :goto_32c

    .line 11399
    .restart local v45       #skipPackage:Ljava/lang/String;
    :cond_3bb
    if-eqz v20, :cond_409

    invoke-interface/range {v20 .. v20}, Ljava/util/List;->size()I

    move-result v7

    move/from16 v28, v7

    .line 11400
    .restart local v28       #NT:I
    :goto_3c3
    const/16 v39, 0x0

    .line 11401
    .restart local v39       #it:I
    const/16 v33, 0x0

    .line 11402
    .restart local v33       #curt:Landroid/content/pm/ResolveInfo;
    const/16 v32, 0x0

    .line 11403
    .local v32, curr:Lcom/android/server/am/BroadcastFilter;
    :goto_3c9
    move/from16 v0, v39

    move/from16 v1, v28

    if-ge v0, v1, :cond_412

    move/from16 v0, v38

    move/from16 v1, v27

    if-ge v0, v1, :cond_412

    .line 11404
    if-nez v33, :cond_3e1

    .line 11405
    move-object/from16 v0, v20

    move/from16 v1, v39

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v33

    .end local v33           #curt:Landroid/content/pm/ResolveInfo;
    check-cast v33, Landroid/content/pm/ResolveInfo;

    .line 11407
    .restart local v33       #curt:Landroid/content/pm/ResolveInfo;
    :cond_3e1
    if-nez v32, :cond_3ec

    .line 11408
    move-object v0, v12

    move/from16 v1, v38

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v32

    .end local v32           #curr:Lcom/android/server/am/BroadcastFilter;
    check-cast v32, Lcom/android/server/am/BroadcastFilter;

    .line 11410
    .restart local v32       #curr:Lcom/android/server/am/BroadcastFilter;
    :cond_3ec
    invoke-virtual/range {v32 .. v32}, Lcom/android/server/am/BroadcastFilter;->getPriority()I

    move-result v7

    move-object/from16 v0, v33

    iget v0, v0, Landroid/content/pm/ResolveInfo;->priority:I

    move v8, v0

    if-lt v7, v8, :cond_40d

    .line 11412
    move-object/from16 v0, v20

    move/from16 v1, v39

    move-object/from16 v2, v32

    invoke-interface {v0, v1, v2}, Ljava/util/List;->add(ILjava/lang/Object;)V

    .line 11413
    add-int/lit8 v38, v38, 0x1

    .line 11414
    const/16 v32, 0x0

    .line 11415
    add-int/lit8 v39, v39, 0x1

    .line 11416
    add-int/lit8 v28, v28, 0x1

    goto :goto_3c9

    .line 11399
    .end local v28           #NT:I
    .end local v32           #curr:Lcom/android/server/am/BroadcastFilter;
    .end local v33           #curt:Landroid/content/pm/ResolveInfo;
    .end local v39           #it:I
    :cond_409
    const/4 v7, 0x0

    move/from16 v28, v7

    goto :goto_3c3

    .line 11419
    .restart local v28       #NT:I
    .restart local v32       #curr:Lcom/android/server/am/BroadcastFilter;
    .restart local v33       #curt:Landroid/content/pm/ResolveInfo;
    .restart local v39       #it:I
    :cond_40d
    add-int/lit8 v39, v39, 0x1

    .line 11420
    const/16 v33, 0x0

    goto :goto_3c9

    .line 11424
    .end local v28           #NT:I
    .end local v32           #curr:Lcom/android/server/am/BroadcastFilter;
    .end local v33           #curt:Landroid/content/pm/ResolveInfo;
    .end local v39           #it:I
    .end local v44           #skip:Z
    .end local v45           #skipPackage:Ljava/lang/String;
    :cond_412
    :goto_412
    move/from16 v0, v38

    move/from16 v1, v27

    if-ge v0, v1, :cond_42f

    .line 11425
    if-nez v20, :cond_41f

    .line 11426
    new-instance v20, Ljava/util/ArrayList;

    .end local v20           #receivers:Ljava/util/List;
    invoke-direct/range {v20 .. v20}, Ljava/util/ArrayList;-><init>()V

    .line 11428
    .restart local v20       #receivers:Ljava/util/List;
    :cond_41f
    move-object v0, v12

    move/from16 v1, v38

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v7

    move-object/from16 v0, v20

    move-object v1, v7

    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 11429
    add-int/lit8 v38, v38, 0x1

    goto :goto_412

    .line 11432
    :cond_42f
    if-eqz v20, :cond_437

    invoke-interface/range {v20 .. v20}, Ljava/util/List;->size()I

    move-result v7

    if-gtz v7, :cond_439

    :cond_437
    if-eqz p5, :cond_45f

    .line 11434
    :cond_439
    new-instance v5, Lcom/android/server/am/BroadcastRecord;

    move-object v13, v5

    move-object v14, v6

    move-object/from16 v15, p1

    move-object/from16 v16, p2

    move/from16 v17, p12

    move/from16 v18, p13

    move-object/from16 v19, p9

    move-object/from16 v21, p5

    move/from16 v22, p6

    move-object/from16 v23, p7

    move-object/from16 v24, p8

    move/from16 v25, p10

    invoke-direct/range {v13 .. v25}, Lcom/android/server/am/BroadcastRecord;-><init>(Landroid/content/Intent;Lcom/android/server/am/ProcessRecord;Ljava/lang/String;IILjava/lang/String;Ljava/util/List;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Z)V

    .line 11444
    .restart local v5       #r:Lcom/android/server/am/BroadcastRecord;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v7, v0

    invoke-virtual {v7, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11445
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 11448
    .end local v5           #r:Lcom/android/server/am/BroadcastRecord;
    :cond_45f
    const/4 v7, 0x0

    goto/16 :goto_20a

    .line 11345
    .end local v27           #NR:I
    .end local v38           #ir:I
    :catch_462
    move-exception v7

    goto/16 :goto_2d3

    .end local v20           #receivers:Ljava/util/List;
    .restart local v30       #ai:Landroid/content/pm/ActivityInfo;
    .restart local v42       #receivers:Ljava/util/List;
    :catch_465
    move-exception v7

    move-object/from16 v20, v42

    .end local v42           #receivers:Ljava/util/List;
    .restart local v20       #receivers:Ljava/util/List;
    goto/16 :goto_2d3
.end method

.method private final broadcastTimeout()V
    .registers 21

    .prologue
    const-wide/16 v9, 0x2710

    const/4 v8, 0x1

    const-string v5, "ActivityManager"

    .line 11642
    monitor-enter p0

    .line 11643
    :try_start_6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-nez v5, :cond_13

    .line 11644
    monitor-exit p0

    .line 11699
    :goto_12
    return-void

    .line 11646
    :cond_13
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v16

    .line 11647
    .local v16, now:J
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v18

    check-cast v18, Lcom/android/server/am/BroadcastRecord;

    .line 11648
    .local v18, r:Lcom/android/server/am/BroadcastRecord;
    move-object/from16 v0, v18

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->startTime:J

    move-wide v5, v0

    add-long/2addr v5, v9

    cmp-long v5, v5, v16

    if-lez v5, :cond_4b

    .line 11652
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x8

    invoke-virtual {v5, v6}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v15

    .line 11653
    .local v15, msg:Landroid/os/Message;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    move-object/from16 v0, v18

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->startTime:J

    move-wide v6, v0

    add-long/2addr v6, v9

    invoke-virtual {v5, v15, v6, v7}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z

    .line 11654
    monitor-exit p0

    goto :goto_12

    .line 11698
    .end local v15           #msg:Landroid/os/Message;
    .end local v16           #now:J
    .end local v18           #r:Lcom/android/server/am/BroadcastRecord;
    :catchall_48
    move-exception v5

    monitor-exit p0
    :try_end_4a
    .catchall {:try_start_6 .. :try_end_4a} :catchall_48

    throw v5

    .line 11657
    .restart local v16       #now:J
    .restart local v18       #r:Lcom/android/server/am/BroadcastRecord;
    :cond_4b
    :try_start_4b
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Timeout of broadcast "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, v18

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " - receiver="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11658
    move-wide/from16 v0, v16

    move-object/from16 v2, v18

    iput-wide v0, v2, Lcom/android/server/am/BroadcastRecord;->startTime:J

    .line 11659
    move-object/from16 v0, v18

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->anrCount:I

    move v5, v0

    add-int/lit8 v5, v5, 0x1

    move v0, v5

    move-object/from16 v1, v18

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->anrCount:I

    .line 11662
    move-object/from16 v0, v18

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move v5, v0

    if-gtz v5, :cond_98

    .line 11663
    const-string v5, "ActivityManager"

    const-string v6, "Timeout on receiver with nextReceiver <= 0"

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11664
    monitor-exit p0

    goto/16 :goto_12

    .line 11667
    :cond_98
    const/4 v12, 0x0

    .line 11669
    .local v12, app:Lcom/android/server/am/ProcessRecord;
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    move-object/from16 v0, v18

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move v6, v0

    sub-int/2addr v6, v8

    invoke-interface {v5, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v14

    .line 11670
    .local v14, curReceiver:Ljava/lang/Object;
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Receiver during timeout: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11671
    move-object/from16 v0, p0

    move-object/from16 v1, v18

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 11672
    instance-of v5, v14, Lcom/android/server/am/BroadcastFilter;

    if-eqz v5, :cond_15a

    .line 11673
    move-object v0, v14

    check-cast v0, Lcom/android/server/am/BroadcastFilter;

    move-object v13, v0

    .line 11674
    .local v13, bf:Lcom/android/server/am/BroadcastFilter;
    iget-object v5, v13, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v5, v5, Lcom/android/server/am/ReceiverList;->pid:I

    if-eqz v5, :cond_f9

    iget-object v5, v13, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v5, v5, Lcom/android/server/am/ReceiverList;->pid:I

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move v6, v0

    if-eq v5, v6, :cond_f9

    .line 11676
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    monitor-enter v5
    :try_end_e6
    .catchall {:try_start_4b .. :try_end_e6} :catchall_48

    .line 11677
    :try_start_e6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v6, v0

    iget-object v7, v13, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v7, v7, Lcom/android/server/am/ReceiverList;->pid:I

    invoke-virtual {v6, v7}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v19

    move-object/from16 v0, v19

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    move-object v12, v0

    .line 11679
    monitor-exit v5
    :try_end_f9
    .catchall {:try_start_e6 .. :try_end_f9} :catchall_157

    .line 11685
    .end local v13           #bf:Lcom/android/server/am/BroadcastFilter;
    :cond_f9
    :goto_f9
    if-eqz v12, :cond_122

    .line 11686
    const/4 v5, 0x0

    const/4 v6, 0x0

    :try_start_fd
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Broadcast of "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v8, v0

    invoke-virtual {v8}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    move-object/from16 v0, p0

    move-object v1, v12

    move-object v2, v5

    move-object v3, v6

    move-object v4, v7

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->appNotRespondingLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;)V

    .line 11690
    :cond_122
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v18

    if-ne v0, v1, :cond_132

    .line 11691
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 11695
    :cond_132
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object v6, v0

    move-object/from16 v0, v18

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    move v7, v0

    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    move-object v8, v0

    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    move-object v9, v0

    move-object/from16 v0, v18

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move v10, v0

    const/4 v11, 0x1

    move-object/from16 v5, p0

    invoke-direct/range {v5 .. v11}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 11697
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 11698
    monitor-exit p0
    :try_end_155
    .catchall {:try_start_fd .. :try_end_155} :catchall_48

    goto/16 :goto_12

    .line 11679
    .restart local v13       #bf:Lcom/android/server/am/BroadcastFilter;
    :catchall_157
    move-exception v6

    :try_start_158
    monitor-exit v5
    :try_end_159
    .catchall {:try_start_158 .. :try_end_159} :catchall_157

    :try_start_159
    throw v6

    .line 11682
    .end local v13           #bf:Lcom/android/server/am/BroadcastFilter;
    :cond_15a
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object v12, v0
    :try_end_15f
    .catchall {:try_start_159 .. :try_end_15f} :catchall_48

    goto :goto_f9
.end method

.method private final bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V
    .registers 8
    .parameter "r"

    .prologue
    .line 9992
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    .line 9993
    .local v1, now:J
    iget v3, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    if-nez v3, :cond_31

    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_31

    .line 9994
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v3}, Ljava/util/HashSet;->size()I

    move-result v3

    if-nez v3, :cond_2a

    .line 9995
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0xc

    invoke-virtual {v3, v4}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 9996
    .local v0, msg:Landroid/os/Message;
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iput-object v3, v0, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 9997
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v4, 0x4e20

    add-long/2addr v4, v1

    invoke-virtual {v3, v0, v4, v5}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z

    .line 9999
    .end local v0           #msg:Landroid/os/Message;
    :cond_2a
    iget-object v3, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v3, p1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 10001
    :cond_31
    iget v3, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    add-int/lit8 v3, v3, 0x1

    iput v3, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    .line 10002
    iput-wide v1, p1, Lcom/android/server/am/ServiceRecord;->executingStart:J

    .line 10003
    return-void
.end method

.method private final canGcNow()Z
    .registers 2

    .prologue
    .line 12768
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    if-nez v0, :cond_20

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    if-nez v0, :cond_20

    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    if-nez v0, :cond_1e

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v0, :cond_20

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->idle:Z

    if-eqz v0, :cond_20

    :cond_1e
    const/4 v0, 0x1

    :goto_1f
    return v0

    :cond_20
    const/4 v0, 0x0

    goto :goto_1f
.end method

.method private final checkContentProviderPermissionLocked(Landroid/content/pm/ProviderInfo;Lcom/android/server/am/ProcessRecord;I)Ljava/lang/String;
    .registers 15
    .parameter "cpi"
    .parameter "r"
    .parameter "mode"

    .prologue
    const/high16 v10, 0x1000

    const/4 v9, 0x0

    const/4 v8, -0x1

    .line 7401
    if-eqz p2, :cond_23

    iget v6, p2, Lcom/android/server/am/ProcessRecord;->pid:I

    move v0, v6

    .line 7402
    .local v0, callingPid:I
    :goto_9
    if-eqz p2, :cond_29

    iget-object v6, p2, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    move v1, v6

    .line 7403
    .local v1, callingUid:I
    :goto_10
    iget-object v6, p1, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    iget-boolean v7, p1, Landroid/content/pm/ProviderInfo;->exported:Z

    if-eqz v7, :cond_2f

    move v7, v8

    :goto_17
    invoke-virtual {p0, v6, v0, v1, v7}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v6

    if-nez v6, :cond_1f

    if-eq p3, v10, :cond_21

    :cond_1f
    if-ne p3, v8, :cond_34

    :cond_21
    move-object v6, v9

    .line 7440
    :goto_22
    return-object v6

    .line 7401
    .end local v0           #callingPid:I
    .end local v1           #callingUid:I
    :cond_23
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    move v0, v6

    goto :goto_9

    .line 7402
    .restart local v0       #callingPid:I
    :cond_29
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    move v1, v6

    goto :goto_10

    .line 7403
    .restart local v1       #callingUid:I
    :cond_2f
    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_17

    .line 7409
    :cond_34
    iget-object v6, p1, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    iget-boolean v7, p1, Landroid/content/pm/ProviderInfo;->exported:Z

    if-eqz v7, :cond_43

    move v7, v8

    :goto_3b
    invoke-virtual {p0, v6, v0, v1, v7}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v6

    if-nez v6, :cond_48

    move-object v6, v9

    .line 7412
    goto :goto_22

    .line 7409
    :cond_43
    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_3b

    .line 7415
    :cond_48
    iget-object v5, p1, Landroid/content/pm/ProviderInfo;->pathPermissions:[Landroid/content/pm/PathPermission;

    .line 7416
    .local v5, pps:[Landroid/content/pm/PathPermission;
    if-eqz v5, :cond_83

    .line 7417
    array-length v2, v5

    .line 7418
    .local v2, i:I
    :cond_4d
    if-lez v2, :cond_83

    .line 7419
    add-int/lit8 v2, v2, -0x1

    .line 7420
    aget-object v4, v5, v2

    .line 7421
    .local v4, pp:Landroid/content/pm/PathPermission;
    invoke-virtual {v4}, Landroid/content/pm/PathPermission;->getReadPermission()Ljava/lang/String;

    move-result-object v6

    iget-boolean v7, p1, Landroid/content/pm/ProviderInfo;->exported:Z

    if-eqz v7, :cond_68

    move v7, v8

    :goto_5c
    invoke-virtual {p0, v6, v0, v1, v7}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v6

    if-nez v6, :cond_64

    if-eq p3, v10, :cond_66

    :cond_64
    if-ne p3, v8, :cond_6d

    :cond_66
    move-object v6, v9

    .line 7425
    goto :goto_22

    .line 7421
    :cond_68
    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_5c

    .line 7427
    :cond_6d
    invoke-virtual {v4}, Landroid/content/pm/PathPermission;->getWritePermission()Ljava/lang/String;

    move-result-object v6

    iget-boolean v7, p1, Landroid/content/pm/ProviderInfo;->exported:Z

    if-eqz v7, :cond_7e

    move v7, v8

    :goto_76
    invoke-virtual {p0, v6, v0, v1, v7}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v6

    if-nez v6, :cond_4d

    move-object v6, v9

    .line 7430
    goto :goto_22

    .line 7427
    :cond_7e
    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_76

    .line 7435
    .end local v2           #i:I
    .end local v4           #pp:Landroid/content/pm/PathPermission;
    :cond_83
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Permission Denial: opening provider "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " from "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    if-eqz p2, :cond_d9

    move-object v7, p2

    :goto_9d
    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " (pid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ", uid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ") requires "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " or "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 7439
    .local v3, msg:Ljava/lang/String;
    const-string v6, "ActivityManager"

    invoke-static {v6, v3}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    move-object v6, v3

    .line 7440
    goto/16 :goto_22

    .line 7435
    .end local v3           #msg:Ljava/lang/String;
    :cond_d9
    const-string v7, "(null)"

    goto :goto_9d
.end method

.method private final checkHoldingPermissionsLocked(Landroid/content/pm/IPackageManager;Landroid/content/pm/ProviderInfo;II)Z
    .registers 8
    .parameter "pm"
    .parameter "pi"
    .parameter "uid"
    .parameter "modeFlags"

    .prologue
    const/4 v2, 0x0

    .line 6057
    and-int/lit8 v1, p4, 0x1

    if-eqz v1, :cond_13

    .line 6058
    :try_start_5
    iget-object v1, p2, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    if-eqz v1, :cond_13

    iget-object v1, p2, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    invoke-interface {p1, v1, p3}, Landroid/content/pm/IPackageManager;->checkUidPermission(Ljava/lang/String;I)I

    move-result v1

    if-eqz v1, :cond_13

    move v1, v2

    .line 6073
    :goto_12
    return v1

    .line 6064
    :cond_13
    and-int/lit8 v1, p4, 0x2

    if-eqz v1, :cond_25

    .line 6065
    iget-object v1, p2, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    if-eqz v1, :cond_25

    iget-object v1, p2, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    invoke-interface {p1, v1, p3}, Landroid/content/pm/IPackageManager;->checkUidPermission(Ljava/lang/String;I)I
    :try_end_20
    .catch Landroid/os/RemoteException; {:try_start_5 .. :try_end_20} :catch_27

    move-result v1

    if-eqz v1, :cond_25

    move v1, v2

    .line 6068
    goto :goto_12

    .line 6071
    :cond_25
    const/4 v1, 0x1

    goto :goto_12

    .line 6072
    :catch_27
    move-exception v1

    move-object v0, v1

    .local v0, e:Landroid/os/RemoteException;
    move v1, v2

    .line 6073
    goto :goto_12
.end method

.method private checkScreenIdle()V
    .registers 6

    .prologue
    const/4 v4, 0x1

    .line 4064
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    sub-int v2, v3, v4

    .line 4068
    .local v2, top:I
    if-lez v2, :cond_2b

    .line 4070
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    sub-int v4, v2, v4

    invoke-virtual {v3, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 4071
    .local v1, p:Lcom/android/server/am/HistoryRecord;
    iget-object v3, v1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    const-string v4, "android.intent.category.HOME"

    invoke-virtual {v3, v4}, Landroid/content/Intent;->hasCategory(Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_2b

    .line 4072
    new-instance v0, Landroid/content/Intent;

    const-string v3, "android.intent.action.stk.idle_screen"

    invoke-direct {v0, v3}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 4073
    .local v0, StkIntent:Landroid/content/Intent;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v3, v0}, Landroid/content/Context;->sendBroadcast(Landroid/content/Intent;)V

    .line 4076
    .end local v0           #StkIntent:Landroid/content/Intent;
    .end local v1           #p:Lcom/android/server/am/HistoryRecord;
    :cond_2b
    return-void
.end method

.method private final checkUriPermissionLocked(Landroid/net/Uri;II)Z
    .registers 9
    .parameter "uri"
    .parameter "uid"
    .parameter "modeFlags"

    .prologue
    const/4 v4, 0x1

    const/4 v3, 0x0

    .line 6080
    if-eqz p2, :cond_a

    invoke-static {}, Landroid/os/Process;->supportsProcesses()Z

    move-result v2

    if-nez v2, :cond_c

    :cond_a
    move v2, v4

    .line 6087
    :goto_b
    return v2

    .line 6083
    :cond_c
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v2, p2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Ljava/util/HashMap;

    .line 6084
    .local v1, perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    if-nez v1, :cond_18

    move v2, v3

    goto :goto_b

    .line 6085
    :cond_18
    invoke-virtual {v1, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/UriPermission;

    .line 6086
    .local v0, perm:Lcom/android/server/am/UriPermission;
    if-nez v0, :cond_22

    move v2, v3

    goto :goto_b

    .line 6087
    :cond_22
    iget v2, v0, Lcom/android/server/am/UriPermission;->modeFlags:I

    and-int/2addr v2, p3

    if-ne v2, p3, :cond_29

    move v2, v4

    goto :goto_b

    :cond_29
    move v2, v3

    goto :goto_b
.end method

.method private final cleanUpActivityLocked(Lcom/android/server/am/HistoryRecord;Z)V
    .registers 9
    .parameter "r"
    .parameter "cleanServices"

    .prologue
    const/4 v5, 0x0

    const/4 v4, 0x0

    .line 4198
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v3, p1, :cond_8

    .line 4199
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 4201
    :cond_8
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v3, p1, :cond_e

    .line 4202
    iput-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    .line 4205
    :cond_e
    iput-boolean v4, p1, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    .line 4206
    iput-boolean v4, p1, Lcom/android/server/am/HistoryRecord;->frozenBeforeDestroy:Z

    .line 4211
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    invoke-virtual {v3, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4212
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-virtual {v3, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4215
    iget-boolean v3, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_44

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    if-eqz v3, :cond_44

    .line 4216
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    invoke-virtual {v3}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .local v1, i$:Ljava/util/Iterator;
    :cond_2a
    :goto_2a
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_42

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/lang/ref/WeakReference;

    .line 4217
    .local v0, apr:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    invoke-virtual {v0}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/PendingIntentRecord;

    .line 4218
    .local v2, rec:Lcom/android/server/am/PendingIntentRecord;
    if-eqz v2, :cond_2a

    .line 4219
    invoke-virtual {p0, v2, v4}, Lcom/android/server/am/ActivityManagerService;->cancelIntentSenderLocked(Lcom/android/server/am/PendingIntentRecord;Z)V

    goto :goto_2a

    .line 4222
    .end local v0           #apr:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    .end local v2           #rec:Lcom/android/server/am/PendingIntentRecord;
    :cond_42
    iput-object v5, p1, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    .line 4225
    .end local v1           #i$:Ljava/util/Iterator;
    :cond_44
    if-eqz p2, :cond_49

    .line 4226
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->cleanUpActivityServicesLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4229
    :cond_49
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    if-lez v3, :cond_56

    .line 4233
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v3, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4237
    :cond_56
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0x9

    invoke-virtual {v3, v4, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 4238
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0xa

    invoke-virtual {v3, v4, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 4239
    return-void
.end method

.method private final cleanUpActivityServicesLocked(Lcom/android/server/am/HistoryRecord;)V
    .registers 6
    .parameter "r"

    .prologue
    const/4 v3, 0x0

    .line 4180
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    if-eqz v2, :cond_1d

    .line 4181
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .line 4182
    .local v1, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :goto_b
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_1b

    .line 4183
    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ConnectionRecord;

    .line 4184
    .local v0, c:Lcom/android/server/am/ConnectionRecord;
    invoke-direct {p0, v0, v3, p1}, Lcom/android/server/am/ActivityManagerService;->removeConnectionLocked(Lcom/android/server/am/ConnectionRecord;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;)V

    goto :goto_b

    .line 4186
    .end local v0           #c:Lcom/android/server/am/ConnectionRecord;
    :cond_1b
    iput-object v3, p1, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    .line 4188
    .end local v1           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_1d
    return-void
.end method

.method private final cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V
    .registers 16
    .parameter "app"
    .parameter "restarting"
    .parameter "index"

    .prologue
    const/4 v11, 0x0

    const/4 v10, 0x0

    .line 9627
    if-ltz p3, :cond_9

    .line 9628
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, p3}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 9632
    :cond_9
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->crashDialog:Landroid/app/Dialog;

    if-eqz v7, :cond_14

    .line 9633
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->crashDialog:Landroid/app/Dialog;

    invoke-virtual {v7}, Landroid/app/Dialog;->dismiss()V

    .line 9634
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->crashDialog:Landroid/app/Dialog;

    .line 9636
    :cond_14
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    if-eqz v7, :cond_1f

    .line 9637
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    invoke-virtual {v7}, Landroid/app/Dialog;->dismiss()V

    .line 9638
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    .line 9640
    :cond_1f
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    if-eqz v7, :cond_2a

    .line 9641
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    invoke-virtual {v7}, Landroid/app/Dialog;->dismiss()V

    .line 9642
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    .line 9645
    :cond_2a
    iput-boolean v11, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    .line 9646
    iput-boolean v11, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    .line 9648
    invoke-virtual {p1}, Lcom/android/server/am/ProcessRecord;->resetPackageList()V

    .line 9649
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    .line 9650
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 9651
    iput-boolean v11, p1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 9653
    const/4 v7, 0x1

    invoke-direct {p0, p1, v7}, Lcom/android/server/am/ActivityManagerService;->killServicesLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 9655
    const/4 v6, 0x0

    .line 9657
    .local v6, restart:Z
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 9660
    .local v0, NL:I
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->isEmpty()Z

    move-result v7

    if-nez v7, :cond_8a

    .line 9661
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v7

    invoke-interface {v7}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v4

    .line 9662
    .local v4, it:Ljava/util/Iterator;
    :cond_54
    :goto_54
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_85

    .line 9663
    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 9664
    .local v2, cpr:Lcom/android/server/am/ContentProviderRecord;
    iput-object v10, v2, Lcom/android/server/am/ContentProviderRecord;->provider:Landroid/content/IContentProvider;

    .line 9665
    iput-object v10, v2, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 9669
    const/4 v3, 0x0

    .line 9670
    .local v3, i:I
    iget-boolean v7, p1, Lcom/android/server/am/ProcessRecord;->bad:Z

    if-nez v7, :cond_83

    .line 9671
    :goto_69
    if-ge v3, v0, :cond_74

    .line 9672
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v7, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    if-ne v7, v2, :cond_80

    .line 9673
    const/4 v6, 0x1

    .line 9681
    :cond_74
    :goto_74
    if-lt v3, v0, :cond_54

    .line 9682
    invoke-direct {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->removeDyingProviderLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/ContentProviderRecord;)V

    .line 9683
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_54

    .line 9671
    :cond_80
    add-int/lit8 v3, v3, 0x1

    goto :goto_69

    .line 9678
    :cond_83
    move v3, v0

    goto :goto_74

    .line 9686
    .end local v2           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v3           #i:I
    :cond_85
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->clear()V

    .line 9693
    .end local v4           #it:Ljava/util/Iterator;
    :cond_8a
    const/4 v3, 0x0

    .restart local v3       #i:I
    :goto_8b
    if-ge v3, v0, :cond_ab

    .line 9694
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v7, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 9696
    .restart local v2       #cpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v7, v2, Lcom/android/server/am/ContentProviderRecord;->launchingApp:Lcom/android/server/am/ProcessRecord;

    if-ne v7, p1, :cond_9e

    .line 9697
    iget-boolean v7, p1, Lcom/android/server/am/ProcessRecord;->bad:Z

    if-nez v7, :cond_a1

    .line 9698
    const/4 v6, 0x1

    .line 9693
    :cond_9e
    :goto_9e
    add-int/lit8 v3, v3, 0x1

    goto :goto_8b

    .line 9700
    :cond_a1
    invoke-direct {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->removeDyingProviderLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/ContentProviderRecord;)V

    .line 9701
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v0

    goto :goto_9e

    .line 9707
    .end local v2           #cpr:Lcom/android/server/am/ContentProviderRecord;
    :cond_ab
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->isEmpty()Z

    move-result v7

    if-nez v7, :cond_d0

    .line 9708
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v4

    .line 9709
    .restart local v4       #it:Ljava/util/Iterator;
    :goto_b9
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_cb

    .line 9710
    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 9711
    .restart local v2       #cpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v7, v2, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    invoke-virtual {v7, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    goto :goto_b9

    .line 9713
    .end local v2           #cpr:Lcom/android/server/am/ContentProviderRecord;
    :cond_cb
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->clear()V

    .line 9734
    .end local v4           #it:Ljava/util/Iterator;
    :cond_d0
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->skipCurrentReceiverLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 9737
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->size()I

    move-result v7

    if-lez v7, :cond_f6

    .line 9738
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v5

    .line 9739
    .local v5, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ReceiverList;>;"
    :goto_e1
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_f1

    .line 9740
    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ReceiverList;

    invoke-virtual {p0, v7}, Lcom/android/server/am/ActivityManagerService;->removeReceiverLocked(Lcom/android/server/am/ReceiverList;)V

    goto :goto_e1

    .line 9742
    :cond_f1
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->clear()V

    .line 9746
    .end local v5           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ReceiverList;>;"
    :cond_f6
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    if-eqz v7, :cond_137

    iget v7, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    iget-object v8, v8, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v8, v8, Lcom/android/server/am/ProcessRecord;->pid:I

    if-ne v7, v8, :cond_137

    .line 9747
    const-string v7, "ActivityManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "App "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    iget-object v9, v9, Lcom/android/server/am/BackupRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, " died during backup"

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v7, v8}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 9749
    :try_start_126
    const-string v7, "backup"

    invoke-static {v7}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v7

    invoke-static {v7}, Landroid/backup/IBackupManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/backup/IBackupManager;

    move-result-object v1

    .line 9751
    .local v1, bm:Landroid/backup/IBackupManager;
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-interface {v1, v7}, Landroid/backup/IBackupManager;->agentDisconnected(Ljava/lang/String;)V
    :try_end_137
    .catch Landroid/os/RemoteException; {:try_start_126 .. :try_end_137} :catch_1a5

    .line 9759
    .end local v1           #bm:Landroid/backup/IBackupManager;
    :cond_137
    :goto_137
    if-eqz p2, :cond_13a

    .line 9798
    :cond_139
    :goto_139
    return-void

    .line 9763
    :cond_13a
    iget-boolean v7, p1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v7, :cond_169

    .line 9766
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v9, v9, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v7, v8, v9}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 9779
    :cond_149
    :goto_149
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    invoke-virtual {v7, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 9781
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    if-ne p1, v7, :cond_154

    .line 9782
    iput-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    .line 9785
    :cond_154
    if-eqz v6, :cond_182

    .line 9788
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v9, v9, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v7, v8, v9, p1}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 9789
    const-string v7, "restart"

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-direct {p0, p1, v7, v8}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_139

    .line 9767
    :cond_169
    iget-boolean v7, p1, Lcom/android/server/am/ProcessRecord;->removed:Z

    if-nez v7, :cond_149

    .line 9771
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    .line 9772
    iput-object v10, p1, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 9773
    iput-boolean v11, p1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 9774
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, p1}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v7

    if-gez v7, :cond_149

    .line 9775
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 9776
    const/4 v6, 0x1

    goto :goto_149

    .line 9790
    :cond_182
    iget v7, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v7, :cond_139

    iget v7, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    iget v8, p0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v7, v8, :cond_139

    .line 9792
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v7

    .line 9793
    :try_start_18f
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    iget v9, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v8, v9}, Landroid/util/SparseArray;->remove(I)V

    .line 9794
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v9, 0x14

    invoke-virtual {v8, v9, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 9795
    monitor-exit v7
    :try_end_19e
    .catchall {:try_start_18f .. :try_end_19e} :catchall_1a2

    .line 9796
    invoke-virtual {p1, v11}, Lcom/android/server/am/ProcessRecord;->setPid(I)V

    goto :goto_139

    .line 9795
    :catchall_1a2
    move-exception v8

    :try_start_1a3
    monitor-exit v7
    :try_end_1a4
    .catchall {:try_start_1a3 .. :try_end_1a4} :catchall_1a2

    throw v8

    .line 9752
    :catch_1a5
    move-exception v7

    goto :goto_137
.end method

.method private final completePauseLocked()V
    .registers 14

    .prologue
    const-wide/16 v11, 0x0

    .line 2135
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2138
    .local v4, prev:Lcom/android/server/am/HistoryRecord;
    if-eqz v4, :cond_12

    .line 2139
    iget-boolean v6, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v6, :cond_6a

    .line 2141
    const/4 v6, 0x2

    invoke-direct {p0, v4, v6}, Lcom/android/server/am/ActivityManagerService;->finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;I)Lcom/android/server/am/HistoryRecord;

    move-result-object v4

    .line 2174
    :cond_f
    :goto_f
    const/4 v6, 0x0

    iput-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2177
    :cond_12
    iget-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    if-nez v6, :cond_a3

    iget-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    if-nez v6, :cond_a3

    .line 2178
    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 2188
    :cond_1d
    :goto_1d
    if-eqz v4, :cond_22

    .line 2189
    invoke-virtual {v4}, Lcom/android/server/am/HistoryRecord;->resumeKeyDispatchingLocked()V

    .line 2192
    :cond_22
    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v6, :cond_67

    iget-wide v6, v4, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    cmp-long v6, v6, v11

    if-lez v6, :cond_67

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->isOnBattery()Z

    move-result v6

    if-eqz v6, :cond_67

    .line 2193
    const-wide/16 v1, 0x0

    .line 2194
    .local v1, diff:J
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    monitor-enter v6

    .line 2195
    :try_start_39
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    iget-object v8, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v8, v8, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v7, v8}, Lcom/android/server/ProcessStats;->getCpuTimeForPid(I)J

    move-result-wide v7

    iget-wide v9, v4, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    sub-long v1, v7, v9

    .line 2196
    monitor-exit v6
    :try_end_48
    .catchall {:try_start_39 .. :try_end_48} :catchall_b9

    .line 2197
    cmp-long v6, v1, v11

    if-lez v6, :cond_67

    .line 2198
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v0

    .line 2199
    .local v0, bsi:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v0

    .line 2200
    :try_start_53
    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v7, v4, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v6, v7}, Lcom/android/internal/os/BatteryStatsImpl;->getProcessStatsLocked(ILjava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-result-object v5

    .line 2203
    .local v5, ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    if-eqz v5, :cond_66

    .line 2204
    invoke-virtual {v5, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->addForegroundTimeLocked(J)V

    .line 2206
    :cond_66
    monitor-exit v0
    :try_end_67
    .catchall {:try_start_53 .. :try_end_67} :catchall_bc

    .line 2209
    .end local v0           #bsi:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v1           #diff:J
    .end local v5           #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    :cond_67
    iput-wide v11, v4, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    .line 2210
    return-void

    .line 2142
    :cond_6a
    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v6, :cond_a0

    .line 2144
    iget-boolean v6, v4, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    if-eqz v6, :cond_7a

    .line 2145
    const/4 v6, 0x0

    iput-boolean v6, v4, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    .line 2146
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 2150
    :cond_7a
    iget-boolean v6, v4, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    if-eqz v6, :cond_83

    .line 2157
    const/4 v6, 0x1

    invoke-direct {p0, v4, v6}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    goto :goto_f

    .line 2159
    :cond_83
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 2160
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    const/4 v7, 0x3

    if-le v6, v7, :cond_f

    .line 2165
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v3

    .line 2166
    .local v3, msg:Landroid/os/Message;
    const/16 v6, 0xb

    iput v6, v3, Landroid/os/Message;->what:I

    .line 2167
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v6, v3}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    goto/16 :goto_f

    .line 2172
    .end local v3           #msg:Landroid/os/Message;
    :cond_a0
    const/4 v4, 0x0

    goto/16 :goto_f

    .line 2180
    :cond_a3
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v6}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v6

    if-eqz v6, :cond_b0

    .line 2181
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v6}, Landroid/os/PowerManager$WakeLock;->release()V

    .line 2183
    :cond_b0
    iget-boolean v6, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    if-eqz v6, :cond_1d

    .line 2184
    invoke-virtual {p0}, Ljava/lang/Object;->notifyAll()V

    goto/16 :goto_1d

    .line 2196
    .restart local v1       #diff:J
    :catchall_b9
    move-exception v7

    :try_start_ba
    monitor-exit v6
    :try_end_bb
    .catchall {:try_start_ba .. :try_end_bb} :catchall_b9

    throw v7

    .line 2206
    .restart local v0       #bsi:Lcom/android/internal/os/BatteryStatsImpl;
    :catchall_bc
    move-exception v6

    :try_start_bd
    monitor-exit v0
    :try_end_be
    .catchall {:try_start_bd .. :try_end_be} :catchall_bc

    throw v6
.end method

.method private final completeResumeLocked(Lcom/android/server/am/HistoryRecord;)V
    .registers 10
    .parameter "next"

    .prologue
    const-wide/16 v6, 0x7530

    const/4 v5, 0x0

    const/4 v4, 0x0

    const-string v3, "ActivityManager"

    .line 2218
    iput-boolean v5, p1, Lcom/android/server/am/HistoryRecord;->idle:Z

    .line 2219
    iput-object v4, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 2220
    iput-object v4, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    .line 2223
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v2, 0xa

    invoke-virtual {v1, v2}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 2224
    .local v0, msg:Landroid/os/Message;
    iput-object p1, v0, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 2231
    iget-boolean v1, p0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    if-eqz v1, :cond_5a

    if-eqz p1, :cond_5a

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    const-string v2, "com.orange.zhai"

    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_5a

    .line 2232
    const-string v1, "ActivityManager"

    const-string v1, "IDLE_TIMEOUT is increased for Orange Home!"

    invoke-static {v3, v1}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 2233
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v1, v0, v6, v7}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 2258
    :goto_32
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->reportResumedActivity(Lcom/android/server/am/HistoryRecord;)V

    .line 2260
    iput-object v4, p1, Lcom/android/server/am/HistoryRecord;->thumbnail:Landroid/graphics/Bitmap;

    .line 2261
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->setFocusedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 2262
    invoke-virtual {p1}, Lcom/android/server/am/HistoryRecord;->resumeKeyDispatchingLocked()V

    .line 2263
    invoke-direct {p0, v4, v5}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V

    .line 2264
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v1}, Lcom/android/server/WindowManagerService;->executeAppTransition()V

    .line 2269
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_82

    .line 2270
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    monitor-enter v1

    .line 2271
    :try_start_4c
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v3, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v2, v3}, Lcom/android/server/ProcessStats;->getCpuTimeForPid(I)J

    move-result-wide v2

    iput-wide v2, p1, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    .line 2272
    monitor-exit v1
    :try_end_59
    .catchall {:try_start_4c .. :try_end_59} :catchall_7f

    .line 2276
    :goto_59
    return-void

    .line 2236
    :cond_5a
    iget-boolean v1, p0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    if-eqz v1, :cond_77

    if-eqz p1, :cond_77

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    const-string v2, "com.lge.homecube"

    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_77

    .line 2237
    const-string v1, "ActivityManager"

    const-string v1, "IDLE_TIMEOUT is increased for LG Home!"

    invoke-static {v3, v1}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 2238
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v1, v0, v6, v7}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    goto :goto_32

    .line 2244
    :cond_77
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v2, 0x2710

    invoke-virtual {v1, v0, v2, v3}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    goto :goto_32

    .line 2272
    :catchall_7f
    move-exception v2

    :try_start_80
    monitor-exit v1
    :try_end_81
    .catchall {:try_start_80 .. :try_end_81} :catchall_7f

    throw v2

    .line 2274
    :cond_82
    const-wide/16 v1, 0x0

    iput-wide v1, p1, Lcom/android/server/am/HistoryRecord;->cpuTimeAtResume:J

    goto :goto_59
.end method

.method private final computeOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;)I
    .registers 27
    .parameter "app"
    .parameter "hiddenAdj"
    .parameter "TOP_APP"

    .prologue
    .line 12503
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    move/from16 v19, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->adjSeq:I

    move/from16 v20, v0

    move/from16 v0, v19

    move/from16 v1, v20

    if-ne v0, v1, :cond_19

    .line 12505
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->curAdj:I

    move/from16 v19, v0

    .line 12742
    :goto_18
    return v19

    .line 12508
    :cond_19
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object/from16 v19, v0

    if-nez v19, :cond_36

    .line 12509
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    move/from16 v19, v0

    move/from16 v0, v19

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjSeq:I

    .line 12510
    sget v19, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    move/from16 v0, v19

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    goto :goto_18

    .line 12513
    :cond_36
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v19, v0

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v20, v0

    move/from16 v0, v19

    move/from16 v1, v20

    if-gt v0, v1, :cond_7d

    .line 12516
    const-string v19, "fixed"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 12517
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    move/from16 v19, v0

    move/from16 v0, v19

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjSeq:I

    .line 12518
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v19, v0

    move/from16 v0, v19

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    .line 12519
    const/16 v19, 0x0

    move/from16 v0, v19

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    .line 12520
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v19, v0

    move/from16 v0, v19

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    goto :goto_18

    .line 12523
    :cond_7d
    const/16 v19, 0x0

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    .line 12524
    const/16 v19, 0x0

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    .line 12530
    move-object/from16 v0, p1

    move-object/from16 v1, p3

    if-ne v0, v1, :cond_29d

    .line 12532
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v6, v0

    .line 12533
    .local v6, adj:I
    const-string v19, "top-activity"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 12589
    :cond_a0
    :goto_a0
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    move/from16 v19, v0

    move/from16 v0, v19

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->adjSeq:I

    .line 12590
    move v0, v6

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    .line 12591
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v19, v0

    move v0, v6

    move/from16 v1, v19

    if-gt v0, v1, :cond_3b9

    move/from16 v19, v6

    :goto_be
    move/from16 v0, v19

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 12593
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object/from16 v19, v0

    if-eqz v19, :cond_112

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v19, v0

    move-object/from16 v0, p1

    move-object/from16 v1, v19

    if-ne v0, v1, :cond_112

    .line 12595
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_ADJ:I

    move/from16 v19, v0

    move v0, v6

    move/from16 v1, v19

    if-le v0, v1, :cond_112

    .line 12596
    const-string v19, "ActivityManager"

    new-instance v20, Ljava/lang/StringBuilder;

    invoke-direct/range {v20 .. v20}, Ljava/lang/StringBuilder;-><init>()V

    const-string v21, "oom BACKUP_APP_ADJ for "

    invoke-virtual/range {v20 .. v21}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v20

    move-object/from16 v0, v20

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v20

    invoke-virtual/range {v20 .. v20}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v20

    invoke-static/range {v19 .. v20}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 12597
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->BACKUP_APP_ADJ:I

    move v6, v0

    .line 12598
    const-string v19, "backup"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 12602
    :cond_112
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Ljava/util/HashSet;->size()I

    move-result v19

    if-eqz v19, :cond_3d2

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v19, v0

    move v0, v6

    move/from16 v1, v19

    if-le v0, v1, :cond_3d2

    .line 12608
    move v0, v6

    move/from16 v1, p2

    if-le v0, v1, :cond_138

    .line 12609
    move/from16 v6, p2

    .line 12610
    const-string v19, "bg-services"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 12612
    :cond_138
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v16

    .line 12615
    .local v16, now:J
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v12

    .line 12616
    .local v12, jt:Ljava/util/Iterator;
    :cond_146
    invoke-interface {v12}, Ljava/util/Iterator;->hasNext()Z

    move-result v19

    if-eqz v19, :cond_3d2

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v19, v0

    move v0, v6

    move/from16 v1, v19

    if-le v0, v1, :cond_3d2

    .line 12617
    invoke-interface {v12}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v18

    check-cast v18, Lcom/android/server/am/ServiceRecord;

    .line 12618
    .local v18, s:Lcom/android/server/am/ServiceRecord;
    move-object/from16 v0, v18

    iget-boolean v0, v0, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    move/from16 v19, v0

    if-eqz v19, :cond_18c

    .line 12619
    move-object/from16 v0, v18

    iget-wide v0, v0, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    move-wide/from16 v19, v0

    const-wide/32 v21, 0x1b7740

    add-long v19, v19, v21

    cmp-long v19, v16, v19

    if-gez v19, :cond_18c

    .line 12623
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    move/from16 v19, v0

    move v0, v6

    move/from16 v1, v19

    if-le v0, v1, :cond_18c

    .line 12624
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    move v6, v0

    .line 12625
    const-string v19, "started-services"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 12629
    :cond_18c
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Ljava/util/HashMap;->size()I

    move-result v19

    if-lez v19, :cond_146

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v19, v0

    move v0, v6

    move/from16 v1, v19

    if-le v0, v1, :cond_146

    .line 12630
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v19

    invoke-interface/range {v19 .. v19}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v13

    .line 12632
    .local v13, kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_1b1
    :goto_1b1
    invoke-interface {v13}, Ljava/util/Iterator;->hasNext()Z

    move-result v19

    if-eqz v19, :cond_146

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v19, v0

    move v0, v6

    move/from16 v1, v19

    if-le v0, v1, :cond_146

    .line 12635
    invoke-interface {v13}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/am/ConnectionRecord;

    .line 12636
    .local v10, cr:Lcom/android/server/am/ConnectionRecord;
    move-object v0, v10

    iget-object v0, v0, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    if-eq v0, v1, :cond_1b1

    .line 12640
    move-object v0, v10

    iget v0, v0, Lcom/android/server/am/ConnectionRecord;->flags:I

    move/from16 v19, v0

    and-int/lit8 v19, v19, 0x1

    if-eqz v19, :cond_24e

    .line 12641
    move-object v0, v10

    iget-object v0, v0, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    move-object v7, v0

    .line 12642
    .local v7, client:Lcom/android/server/am/ProcessRecord;
    move/from16 v15, p2

    .line 12643
    .local v15, myHiddenAdj:I
    move-object v0, v7

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v19, v0

    move v0, v15

    move/from16 v1, v19

    if-le v0, v1, :cond_20b

    .line 12644
    move-object v0, v7

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v19, v0

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move/from16 v20, v0

    move/from16 v0, v19

    move/from16 v1, v20

    if-le v0, v1, :cond_3c1

    .line 12645
    iget v15, v7, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    .line 12650
    :cond_20b
    :goto_20b
    move-object/from16 v0, p0

    move-object v1, v7

    move v2, v15

    move-object/from16 v3, p3

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->computeOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;)I

    move-result v8

    .line 12652
    .local v8, clientAdj:I
    if-le v6, v8, :cond_24e

    .line 12653
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move/from16 v19, v0

    move v0, v8

    move/from16 v1, v19

    if-le v0, v1, :cond_3c8

    move v6, v8

    .line 12655
    :goto_223
    const-string v19, "service"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 12656
    move-object v0, v10

    iget-object v0, v0, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    .line 12657
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->serviceInfo:Landroid/content/pm/ServiceInfo;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    .line 12660
    .end local v7           #client:Lcom/android/server/am/ProcessRecord;
    .end local v8           #clientAdj:I
    .end local v15           #myHiddenAdj:I
    :cond_24e
    iget-object v5, v10, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    .line 12664
    .local v5, a:Lcom/android/server/am/HistoryRecord;
    if-eqz v5, :cond_1b1

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v19, v0

    move v0, v6

    move/from16 v1, v19

    if-le v0, v1, :cond_1b1

    move-object v0, v5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v19, v0

    sget-object v20, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v0, v19

    move-object/from16 v1, v20

    if-eq v0, v1, :cond_277

    move-object v0, v5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v19, v0

    sget-object v20, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v0, v19

    move-object/from16 v1, v20

    if-ne v0, v1, :cond_1b1

    .line 12667
    :cond_277
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v6, v0

    .line 12668
    const-string v19, "service"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 12669
    move-object v0, v5

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    .line 12670
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->serviceInfo:Landroid/content/pm/ServiceInfo;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    goto/16 :goto_1b1

    .line 12534
    .end local v5           #a:Lcom/android/server/am/HistoryRecord;
    .end local v6           #adj:I
    .end local v10           #cr:Lcom/android/server/am/ConnectionRecord;
    .end local v12           #jt:Ljava/util/Iterator;
    .end local v13           #kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    .end local v16           #now:J
    .end local v18           #s:Lcom/android/server/am/ServiceRecord;
    :cond_29d
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object/from16 v19, v0

    if-eqz v19, :cond_2b4

    .line 12536
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v6, v0

    .line 12537
    .restart local v6       #adj:I
    const-string v19, "instrumentation"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_a0

    .line 12538
    .end local v6           #adj:I
    :cond_2b4
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    move/from16 v19, v0

    if-lez v19, :cond_2cb

    .line 12540
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v6, v0

    .line 12541
    .restart local v6       #adj:I
    const-string v19, "persistent"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_a0

    .line 12542
    .end local v6           #adj:I
    :cond_2cb
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v19, v0

    if-nez v19, :cond_2ed

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v19, v0

    if-eqz v19, :cond_2fc

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    if-ne v0, v1, :cond_2fc

    .line 12546
    :cond_2ed
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v6, v0

    .line 12547
    .restart local v6       #adj:I
    const-string v19, "broadcast"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_a0

    .line 12548
    .end local v6           #adj:I
    :cond_2fc
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Ljava/util/HashSet;->size()I

    move-result v19

    if-lez v19, :cond_317

    .line 12551
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v6, v0

    .line 12552
    .restart local v6       #adj:I
    const-string v19, "exec-service"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_a0

    .line 12553
    .end local v6           #adj:I
    :cond_317
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    move/from16 v19, v0

    if-eqz v19, :cond_32e

    .line 12555
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move v6, v0

    .line 12556
    .restart local v6       #adj:I
    const-string v19, "foreground-service"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_a0

    .line 12557
    .end local v6           #adj:I
    :cond_32e
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    move-object/from16 v19, v0

    if-eqz v19, :cond_351

    .line 12559
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move v6, v0

    .line 12560
    .restart local v6       #adj:I
    const-string v19, "force-foreground"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 12561
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    goto/16 :goto_a0

    .line 12562
    .end local v6           #adj:I
    :cond_351
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v19, v0

    move-object/from16 v0, p1

    move-object/from16 v1, v19

    if-ne v0, v1, :cond_36c

    .line 12565
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->HOME_APP_ADJ:I

    move v6, v0

    .line 12566
    .restart local v6       #adj:I
    const-string v19, "home"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_a0

    .line 12567
    .end local v6           #adj:I
    :cond_36c
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Ljava/util/ArrayList;->size()I

    move-result v4

    .local v4, N:I
    if-eqz v4, :cond_3ad

    .line 12569
    move/from16 v6, p2

    .line 12570
    .restart local v6       #adj:I
    const-string v19, "bg-activities"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 12571
    const/4 v11, 0x0

    .local v11, j:I
    :goto_383
    if-ge v11, v4, :cond_a0

    .line 12572
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move v1, v11

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    move-object v0, v5

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->visible:Z

    move/from16 v19, v0

    if-eqz v19, :cond_3aa

    .line 12574
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move v6, v0

    .line 12575
    const-string v19, "visible"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_a0

    .line 12571
    :cond_3aa
    add-int/lit8 v11, v11, 0x1

    goto :goto_383

    .line 12581
    .end local v6           #adj:I
    .end local v11           #j:I
    :cond_3ad
    sget v6, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    .line 12582
    .restart local v6       #adj:I
    const-string v19, "empty"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    goto/16 :goto_a0

    .line 12591
    .end local v4           #N:I
    :cond_3b9
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v19, v0

    goto/16 :goto_be

    .line 12647
    .restart local v7       #client:Lcom/android/server/am/ProcessRecord;
    .restart local v10       #cr:Lcom/android/server/am/ConnectionRecord;
    .restart local v12       #jt:Ljava/util/Iterator;
    .restart local v13       #kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    .restart local v15       #myHiddenAdj:I
    .restart local v16       #now:J
    .restart local v18       #s:Lcom/android/server/am/ServiceRecord;
    :cond_3c1
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move v15, v0

    goto/16 :goto_20b

    .line 12653
    .restart local v8       #clientAdj:I
    :cond_3c8
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move/from16 v19, v0

    move/from16 v6, v19

    goto/16 :goto_223

    .line 12677
    .end local v7           #client:Lcom/android/server/am/ProcessRecord;
    .end local v8           #clientAdj:I
    .end local v10           #cr:Lcom/android/server/am/ConnectionRecord;
    .end local v12           #jt:Ljava/util/Iterator;
    .end local v13           #kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    .end local v15           #myHiddenAdj:I
    .end local v16           #now:J
    .end local v18           #s:Lcom/android/server/am/ServiceRecord;
    :cond_3d2
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Ljava/util/HashMap;->size()I

    move-result v19

    if-eqz v19, :cond_4e6

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v19, v0

    move v0, v6

    move/from16 v1, v19

    if-le v0, v1, :cond_4e6

    .line 12682
    sget v19, Lcom/android/server/am/ActivityManagerService;->CONTENT_PROVIDER_ADJ:I

    move v0, v6

    move/from16 v1, v19

    if-le v0, v1, :cond_3fa

    .line 12683
    sget v6, Lcom/android/server/am/ActivityManagerService;->CONTENT_PROVIDER_ADJ:I

    .line 12684
    const-string v19, "pub-providers"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 12686
    :cond_3fa
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v19

    invoke-interface/range {v19 .. v19}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v12

    .line 12687
    .restart local v12       #jt:Ljava/util/Iterator;
    :cond_408
    :goto_408
    invoke-interface {v12}, Ljava/util/Iterator;->hasNext()Z

    move-result v19

    if-eqz v19, :cond_4e6

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v19, v0

    move v0, v6

    move/from16 v1, v19

    if-le v0, v1, :cond_4e6

    .line 12688
    invoke-interface {v12}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/ContentProviderRecord;

    .line 12689
    .local v9, cpr:Lcom/android/server/am/ContentProviderRecord;
    move-object v0, v9

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Ljava/util/HashSet;->size()I

    move-result v19

    if-eqz v19, :cond_4b4

    .line 12690
    move-object v0, v9

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v14

    .line 12691
    .local v14, kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ProcessRecord;>;"
    :cond_433
    :goto_433
    invoke-interface {v14}, Ljava/util/Iterator;->hasNext()Z

    move-result v19

    if-eqz v19, :cond_4b4

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v19, v0

    move v0, v6

    move/from16 v1, v19

    if-le v0, v1, :cond_4b4

    .line 12692
    invoke-interface {v14}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ProcessRecord;

    .line 12693
    .restart local v7       #client:Lcom/android/server/am/ProcessRecord;
    move-object v0, v7

    move-object/from16 v1, p1

    if-eq v0, v1, :cond_433

    .line 12697
    move/from16 v15, p2

    .line 12698
    .restart local v15       #myHiddenAdj:I
    move-object v0, v7

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v19, v0

    move v0, v15

    move/from16 v1, v19

    if-le v0, v1, :cond_46e

    .line 12699
    move-object v0, v7

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    move/from16 v19, v0

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v20, v0

    move/from16 v0, v19

    move/from16 v1, v20

    if-le v0, v1, :cond_4a5

    .line 12700
    iget v15, v7, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    .line 12705
    :cond_46e
    :goto_46e
    move-object/from16 v0, p0

    move-object v1, v7

    move v2, v15

    move-object/from16 v3, p3

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->computeOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;)I

    move-result v8

    .line 12707
    .restart local v8       #clientAdj:I
    if-le v6, v8, :cond_433

    .line 12708
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v19, v0

    move v0, v8

    move/from16 v1, v19

    if-le v0, v1, :cond_4ab

    move v6, v8

    .line 12710
    :goto_486
    const-string v19, "provider"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 12711
    move-object v0, v7

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    .line 12712
    move-object v0, v9

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    goto :goto_433

    .line 12702
    .end local v8           #clientAdj:I
    :cond_4a5
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v15, v0

    goto :goto_46e

    .line 12708
    .restart local v8       #clientAdj:I
    :cond_4ab
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v19, v0

    move/from16 v6, v19

    goto :goto_486

    .line 12719
    .end local v7           #client:Lcom/android/server/am/ProcessRecord;
    .end local v8           #clientAdj:I
    .end local v14           #kt:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ProcessRecord;>;"
    .end local v15           #myHiddenAdj:I
    :cond_4b4
    move-object v0, v9

    iget v0, v0, Lcom/android/server/am/ContentProviderRecord;->externals:I

    move/from16 v19, v0

    if-eqz v19, :cond_408

    .line 12720
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move/from16 v19, v0

    move v0, v6

    move/from16 v1, v19

    if-le v0, v1, :cond_408

    .line 12721
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    move v6, v0

    .line 12722
    const-string v19, "provider"

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    .line 12723
    move-object v0, v9

    iget-object v0, v0, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    goto/16 :goto_408

    .line 12729
    .end local v9           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v12           #jt:Ljava/util/Iterator;
    :cond_4e6
    move v0, v6

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    .line 12733
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move/from16 v19, v0

    move v0, v6

    move/from16 v1, v19

    if-le v0, v1, :cond_4fb

    .line 12734
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    move v6, v0

    .line 12737
    :cond_4fb
    move v0, v6

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 12738
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    move/from16 v19, v0

    move v0, v6

    move/from16 v1, v19

    if-le v0, v1, :cond_517

    const/16 v19, 0x1

    :goto_50d
    move/from16 v0, v19

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    move/from16 v19, v6

    .line 12742
    goto/16 :goto_18

    .line 12738
    :cond_517
    const/16 v19, 0x0

    goto :goto_50d
.end method

.method private final decPersistentCountLocked(Lcom/android/server/am/ProcessRecord;)V
    .registers 4
    .parameter "app"

    .prologue
    .line 4734
    iget v0, p1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    const/4 v1, 0x1

    sub-int/2addr v0, v1

    iput v0, p1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    .line 4735
    iget v0, p1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    if-lez v0, :cond_b

    .line 4747
    :cond_a
    :goto_a
    return-void

    .line 4739
    :cond_b
    iget-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v0, :cond_a

    .line 4746
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    goto :goto_a
.end method

.method private final deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V
    .registers 9
    .parameter "r"
    .parameter "intent"

    .prologue
    .line 3037
    const/4 v2, 0x0

    .line 3038
    .local v2, sent:Z
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v4, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v3, v4, :cond_26

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_26

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v3, :cond_26

    .line 3041
    :try_start_11
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    .line 3042
    .local v0, ar:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    new-instance v3, Landroid/content/Intent;

    invoke-direct {v3, p2}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    invoke-virtual {v0, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 3043
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v3, v0, p1}, Landroid/app/IApplicationThread;->scheduleNewIntent(Ljava/util/List;Landroid/os/IBinder;)V
    :try_end_25
    .catch Ljava/lang/Exception; {:try_start_11 .. :try_end_25} :catch_31

    .line 3044
    const/4 v2, 0x1

    .line 3049
    .end local v0           #ar:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    :cond_26
    :goto_26
    if-nez v2, :cond_30

    .line 3050
    new-instance v3, Landroid/content/Intent;

    invoke-direct {v3, p2}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    invoke-virtual {p1, v3}, Lcom/android/server/am/HistoryRecord;->addNewIntentLocked(Landroid/content/Intent;)V

    .line 3052
    :cond_30
    return-void

    .line 3045
    :catch_31
    move-exception v3

    move-object v1, v3

    .line 3046
    .local v1, e:Ljava/lang/Exception;
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Exception thrown sending new intent to "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_26
.end method

.method private final deliverToRegisteredReceiver(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V
    .registers 16
    .parameter "r"
    .parameter "filter"
    .parameter "ordered"

    .prologue
    const/4 v4, -0x1

    const/4 v10, 0x0

    const-string v5, " (pid="

    const-string v11, "ActivityManager"

    const-string v3, ")"

    .line 11748
    const/4 v9, 0x0

    .line 11749
    .local v9, skip:Z
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->requiredPermission:Ljava/lang/String;

    if-eqz v0, :cond_78

    .line 11750
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->requiredPermission:Ljava/lang/String;

    iget v1, p1, Lcom/android/server/am/BroadcastRecord;->callingPid:I

    iget v2, p1, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    invoke-virtual {p0, v0, v1, v2, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v8

    .line 11752
    .local v8, perm:I
    if-eqz v8, :cond_78

    .line 11753
    const-string v0, "ActivityManager"

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Permission Denial: broadcasting "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    iget-object v1, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v1}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, " from "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    iget-object v1, p1, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, " (pid="

    invoke-virtual {v0, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    iget v1, p1, Lcom/android/server/am/BroadcastRecord;->callingPid:I

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, ", uid="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    iget v1, p1, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, ")"

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, " requires "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    iget-object v1, p2, Lcom/android/server/am/BroadcastFilter;->requiredPermission:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, " due to registered receiver "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v11, v0}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11759
    const/4 v9, 0x1

    .line 11762
    .end local v8           #perm:I
    :cond_78
    iget-object v0, p1, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    if-eqz v0, :cond_105

    .line 11763
    iget-object v0, p1, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    iget-object v1, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v1, v1, Lcom/android/server/am/ReceiverList;->pid:I

    iget-object v2, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v2, v2, Lcom/android/server/am/ReceiverList;->uid:I

    invoke-virtual {p0, v0, v1, v2, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v8

    .line 11765
    .restart local v8       #perm:I
    if-eqz v8, :cond_105

    .line 11766
    const-string v0, "ActivityManager"

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Permission Denial: receiving "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    iget-object v1, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v1}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, " to "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    iget-object v1, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v1, v1, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, " (pid="

    invoke-virtual {v0, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    iget-object v1, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v1, v1, Lcom/android/server/am/ReceiverList;->pid:I

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, ", uid="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    iget-object v1, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget v1, v1, Lcom/android/server/am/ReceiverList;->uid:I

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, ")"

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, " requires "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    iget-object v1, p1, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, " due to sender "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    iget-object v1, p1, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, " (uid "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    iget v1, p1, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, ")"

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v11, v0}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11774
    const/4 v9, 0x1

    .line 11778
    .end local v8           #perm:I
    :cond_105
    if-nez v9, :cond_150

    .line 11782
    if-eqz p3, :cond_131

    .line 11783
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->receiver:Landroid/content/IIntentReceiver;

    invoke-interface {v0}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 11784
    iput-object p2, p1, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    .line 11785
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iput-object p1, v0, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 11786
    const/4 v0, 0x2

    iput v0, p1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 11787
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_131

    .line 11793
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iput-object v0, p1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 11794
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iput-object p1, v0, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 11795
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 11804
    :cond_131
    :try_start_131
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v1, v1, Lcom/android/server/am/ReceiverList;->receiver:Landroid/content/IIntentReceiver;

    new-instance v2, Landroid/content/Intent;

    iget-object v3, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-direct {v2, v3}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    iget v3, p1, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v4, p1, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v6, p1, Lcom/android/server/am/BroadcastRecord;->ordered:Z

    invoke-static/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->performReceive(Lcom/android/server/am/ProcessRecord;Landroid/content/IIntentReceiver;Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;Z)V

    .line 11807
    if-eqz p3, :cond_150

    .line 11808
    const/4 v0, 0x3

    iput v0, p1, Lcom/android/server/am/BroadcastRecord;->state:I
    :try_end_150
    .catch Landroid/os/RemoteException; {:try_start_131 .. :try_end_150} :catch_151

    .line 11822
    :cond_150
    :goto_150
    return-void

    .line 11810
    :catch_151
    move-exception v0

    move-object v7, v0

    .line 11811
    .local v7, e:Landroid/os/RemoteException;
    const-string v0, "ActivityManager"

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "Failure sending broadcast "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    iget-object v1, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v11, v0, v7}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 11812
    if-eqz p3, :cond_150

    .line 11813
    iput-object v10, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 11814
    iput-object v10, p1, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    .line 11815
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iput-object v10, v0, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 11816
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_150

    .line 11817
    iget-object v0, p2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iget-object v0, v0, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iput-object v10, v0, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    goto :goto_150
.end method

.method private final destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z
    .registers 13
    .parameter "r"
    .parameter "removeFromApp"

    .prologue
    const/4 v9, 0x0

    .line 4266
    const/16 v5, 0x7542

    const/4 v6, 0x3

    new-array v6, v6, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v7

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    aput-object v7, v6, v9

    const/4 v7, 0x1

    iget-object v8, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v8, v8, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    aput-object v8, v6, v7

    const/4 v7, 0x2

    iget-object v8, p1, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v8, v6, v7

    invoke-static {v5, v6}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 4270
    const/4 v3, 0x0

    .line 4272
    .local v3, removedFromHistory:Z
    invoke-direct {p0, p1, v9}, Lcom/android/server/am/ActivityManagerService;->cleanUpActivityLocked(Lcom/android/server/am/HistoryRecord;Z)V

    .line 4274
    iget-object v5, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v5, :cond_ad

    .line 4275
    if-eqz p2, :cond_47

    .line 4276
    iget-object v5, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v5, p1}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v1

    .line 4277
    .local v1, idx:I
    if-ltz v1, :cond_3e

    .line 4278
    iget-object v5, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 4280
    :cond_3e
    iget-boolean v5, p1, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-eqz v5, :cond_47

    .line 4281
    iget-object v5, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v5}, Lcom/android/server/am/ActivityManagerService;->decPersistentCountLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 4285
    .end local v1           #idx:I
    :cond_47
    const/4 v4, 0x0

    .line 4289
    .local v4, skipDestroy:Z
    :try_start_48
    iget-object v5, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-boolean v6, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    iget v7, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-interface {v5, p1, v6, v7}, Landroid/app/IApplicationThread;->scheduleDestroyActivity(Landroid/os/IBinder;ZI)V
    :try_end_53
    .catch Ljava/lang/Exception; {:try_start_48 .. :try_end_53} :catch_9c

    .line 4303
    :cond_53
    :goto_53
    const/4 v5, 0x0

    iput-object v5, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 4304
    iput-boolean v9, p1, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    .line 4306
    iget-boolean v5, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v5, :cond_a8

    if-nez v4, :cond_a8

    .line 4307
    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v5, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4308
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v6, 0x11

    invoke-virtual {v5, v6}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v2

    .line 4309
    .local v2, msg:Landroid/os/Message;
    iput-object p1, v2, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 4310
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v6, 0x2710

    invoke-virtual {v5, v2, v6, v7}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 4324
    .end local v2           #msg:Landroid/os/Message;
    .end local v4           #skipDestroy:Z
    :goto_73
    iput v9, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    .line 4326
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v5, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_9b

    .line 4327
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Activity "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " being finished, but not in LRU list"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4330
    :cond_9b
    return v3

    .line 4291
    .restart local v4       #skipDestroy:Z
    :catch_9c
    move-exception v5

    move-object v0, v5

    .line 4296
    .local v0, e:Ljava/lang/Exception;
    iget-boolean v5, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v5, :cond_53

    .line 4297
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->removeActivityFromHistoryLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4298
    const/4 v3, 0x1

    .line 4299
    const/4 v4, 0x1

    goto :goto_53

    .line 4312
    .end local v0           #e:Ljava/lang/Exception;
    :cond_a8
    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v5, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    goto :goto_73

    .line 4316
    .end local v4           #skipDestroy:Z
    :cond_ad
    iget-boolean v5, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v5, :cond_b6

    .line 4317
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->removeActivityFromHistoryLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4318
    const/4 v3, 0x1

    goto :goto_73

    .line 4320
    :cond_b6
    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v5, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    goto :goto_73
.end method

.method private final doPendingActivityLaunchesLocked(Z)V
    .registers 13
    .parameter "doResume"

    .prologue
    const/4 v10, 0x1

    .line 3218
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v7

    .line 3219
    .local v7, N:I
    if-gtz v7, :cond_a

    .line 3229
    :goto_9
    return-void

    .line 3222
    :cond_a
    const/4 v8, 0x0

    .local v8, i:I
    :goto_b
    if-ge v8, v7, :cond_30

    .line 3223
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    invoke-virtual {v0, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;

    .line 3224
    .local v9, pal:Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;
    iget-object v1, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->r:Lcom/android/server/am/HistoryRecord;

    iget-object v2, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->sourceRecord:Lcom/android/server/am/HistoryRecord;

    iget-object v3, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->grantedUriPermissions:[Landroid/net/Uri;

    iget v4, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->grantedMode:I

    iget-boolean v5, v9, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->onlyIfNeeded:Z

    if-eqz p1, :cond_2d

    sub-int v0, v7, v10

    if-ne v8, v0, :cond_2d

    move v6, v10

    :goto_26
    move-object v0, p0

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->startActivityUncheckedLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;[Landroid/net/Uri;IZZ)I

    .line 3222
    add-int/lit8 v8, v8, 0x1

    goto :goto_b

    .line 3224
    :cond_2d
    const/4 v0, 0x0

    move v6, v0

    goto :goto_26

    .line 3228
    .end local v9           #pal:Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;
    :cond_30
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->clear()V

    goto :goto_9
.end method

.method private static final dumpApplicationMemoryUsage(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;[Ljava/lang/String;)V
    .registers 15
    .parameter "fd"
    .parameter "pw"
    .parameter "list"
    .parameter "prefix"
    .parameter "args"

    .prologue
    .line 9428
    const-string v8, "--checkin"

    invoke-static {p4, v8}, Lcom/android/server/am/ActivityManagerService;->scanArgs([Ljava/lang/String;Ljava/lang/String;)Z

    move-result v2

    .line 9429
    .local v2, isCheckinRequest:Z
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v6

    .line 9430
    .local v6, uptime:J
    invoke-static {}, Landroid/os/SystemClock;->elapsedRealtime()J

    move-result-wide v4

    .line 9432
    .local v4, realtime:J
    if-eqz v2, :cond_7b

    .line 9434
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v8, v6, v7}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, ","

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v4, v5}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9435
    invoke-virtual {p1}, Ljava/io/PrintWriter;->flush()V

    .line 9440
    :goto_2d
    invoke-interface {p2}, Ljava/util/List;->size()I

    move-result v8

    const/4 v9, 0x1

    sub-int v1, v8, v9

    .local v1, i:I
    :goto_34
    if-ltz v1, :cond_ae

    .line 9441
    invoke-interface {p2, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 9442
    .local v3, r:Lcom/android/server/am/ProcessRecord;
    iget-object v8, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v8, :cond_78

    .line 9443
    if-nez v2, :cond_6f

    .line 9444
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "\n** MEMINFO in pid "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    iget v9, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, " ["

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    iget-object v9, v3, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, "] **"

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9445
    invoke-virtual {p1}, Ljava/io/PrintWriter;->flush()V

    .line 9448
    :cond_6f
    :try_start_6f
    iget-object v8, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v8}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v8

    invoke-interface {v8, p0, p4}, Landroid/os/IBinder;->dump(Ljava/io/FileDescriptor;[Ljava/lang/String;)V
    :try_end_78
    .catch Landroid/os/RemoteException; {:try_start_6f .. :try_end_78} :catch_a1

    .line 9440
    :cond_78
    :goto_78
    add-int/lit8 v1, v1, -0x1

    goto :goto_34

    .line 9437
    .end local v1           #i:I
    .end local v3           #r:Lcom/android/server/am/ProcessRecord;
    :cond_7b
    const-string v8, "Applications Memory Usage (kB):"

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9438
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Uptime: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v6, v7}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, " Realtime: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v4, v5}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto :goto_2d

    .line 9449
    .restart local v1       #i:I
    .restart local v3       #r:Lcom/android/server/am/ProcessRecord;
    :catch_a1
    move-exception v8

    move-object v0, v8

    .line 9450
    .local v0, e:Landroid/os/RemoteException;
    if-nez v2, :cond_78

    .line 9451
    const-string v8, "Got RemoteException!"

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9452
    invoke-virtual {p1}, Ljava/io/PrintWriter;->flush()V

    goto :goto_78

    .line 9457
    .end local v0           #e:Landroid/os/RemoteException;
    .end local v3           #r:Lcom/android/server/am/ProcessRecord;
    :cond_ae
    return-void
.end method

.method private static final dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V
    .registers 13
    .parameter "pw"
    .parameter "list"
    .parameter "prefix"
    .parameter "label"
    .parameter "complete"

    .prologue
    const/4 v6, 0x1

    const-string v7, "  "

    .line 9374
    const/4 v2, 0x0

    .line 9375
    .local v2, lastTask:Lcom/android/server/am/TaskRecord;
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v4

    sub-int v1, v4, v6

    .local v1, i:I
    :goto_a
    if-ltz v1, :cond_86

    .line 9376
    invoke-interface {p1, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 9377
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    if-nez p4, :cond_18

    iget-boolean v4, v3, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    if-nez v4, :cond_7c

    :cond_18
    move v0, v6

    .line 9378
    .local v0, full:Z
    :goto_19
    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v2, v4, :cond_44

    .line 9379
    iget-object v2, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 9380
    invoke-virtual {p0, p2}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9381
    if-eqz v0, :cond_7f

    const-string v4, "* "

    :goto_26
    invoke-virtual {p0, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9382
    invoke-virtual {p0, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9383
    if-eqz v0, :cond_44

    .line 9384
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "  "

    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v2, p0, v4}, Lcom/android/server/am/TaskRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9387
    :cond_44
    invoke-virtual {p0, p2}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    if-eqz v0, :cond_83

    const-string v4, "  * "

    :goto_4b
    invoke-virtual {p0, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p0, p3}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9388
    const-string v4, " #"

    invoke-virtual {p0, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p0, v1}, Ljava/io/PrintWriter;->print(I)V

    const-string v4, ": "

    invoke-virtual {p0, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9389
    invoke-virtual {p0, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9390
    if-eqz v0, :cond_79

    .line 9391
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "      "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v3, p0, v4}, Lcom/android/server/am/HistoryRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9375
    :cond_79
    add-int/lit8 v1, v1, -0x1

    goto :goto_a

    .line 9377
    .end local v0           #full:Z
    :cond_7c
    const/4 v4, 0x0

    move v0, v4

    goto :goto_19

    .line 9381
    .restart local v0       #full:Z
    :cond_7f
    const-string v4, "  "

    move-object v4, v7

    goto :goto_26

    .line 9387
    :cond_83
    const-string v4, "    "

    goto :goto_4b

    .line 9394
    .end local v0           #full:Z
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_86
    return-void
.end method

.method private static final dumpProcessList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I
    .registers 13
    .parameter "pw"
    .parameter "list"
    .parameter "prefix"
    .parameter "normalLabel"
    .parameter "persistentLabel"
    .parameter "inclOomAdj"

    .prologue
    .line 9399
    const/4 v1, 0x0

    .line 9400
    .local v1, numPers:I
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v0

    const/4 v2, 0x1

    sub-int/2addr v0, v2

    .local v0, i:I
    :goto_7
    if-ltz v0, :cond_b0

    .line 9401
    invoke-interface {p1, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 9406
    .local v2, r:Lcom/android/server/am/ProcessRecord;
    if-eqz p5, :cond_88

    .line 9407
    const-string v3, "%s%s #%2d: adj=%4d/%d %s (%s)"

    const/4 v4, 0x7

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    aput-object p2, v4, v5

    const/4 v5, 0x1

    iget-boolean v6, v2, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v6, :cond_86

    move-object v6, p4

    :goto_1f
    aput-object v6, v4, v5

    const/4 v5, 0x2

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    aput-object v6, v4, v5

    const/4 v5, 0x3

    iget v6, v2, Lcom/android/server/am/ProcessRecord;->setAdj:I

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    aput-object v6, v4, v5

    const/4 v5, 0x4

    iget v6, v2, Lcom/android/server/am/ProcessRecord;->setSchedGroup:I

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    aput-object v6, v4, v5

    const/4 v5, 0x5

    invoke-virtual {v2}, Lcom/android/server/am/ProcessRecord;->toString()Ljava/lang/String;

    move-result-object v6

    aput-object v6, v4, v5

    const/4 v5, 0x6

    iget-object v6, v2, Lcom/android/server/am/ProcessRecord;->adjType:Ljava/lang/String;

    aput-object v6, v4, v5

    invoke-static {v3, v4}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p0, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9410
    iget-object v3, v2, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    if-nez v3, :cond_55

    iget-object v3, v2, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    if-eqz v3, :cond_7d

    .line 9411
    :cond_55
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v3, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "          "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, v2, Lcom/android/server/am/ProcessRecord;->adjTarget:Ljava/lang/Object;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " used by "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, v2, Lcom/android/server/am/ProcessRecord;->adjSource:Ljava/lang/Object;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p0, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9419
    :cond_7d
    :goto_7d
    iget-boolean v2, v2, Lcom/android/server/am/ProcessRecord;->persistent:Z

    .end local v2           #r:Lcom/android/server/am/ProcessRecord;
    if-eqz v2, :cond_83

    .line 9420
    add-int/lit8 v1, v1, 0x1

    .line 9400
    :cond_83
    add-int/lit8 v0, v0, -0x1

    goto :goto_7

    .restart local v2       #r:Lcom/android/server/am/ProcessRecord;
    :cond_86
    move-object v6, p3

    .line 9407
    goto :goto_1f

    .line 9415
    :cond_88
    const-string v3, "%s%s #%2d: %s"

    const/4 v4, 0x4

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    aput-object p2, v4, v5

    const/4 v5, 0x1

    iget-boolean v6, v2, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v6, :cond_ae

    move-object v6, p4

    :goto_96
    aput-object v6, v4, v5

    const/4 v5, 0x2

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    aput-object v6, v4, v5

    const/4 v5, 0x3

    invoke-virtual {v2}, Lcom/android/server/am/ProcessRecord;->toString()Ljava/lang/String;

    move-result-object v6

    aput-object v6, v4, v5

    invoke-static {v3, v4}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p0, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto :goto_7d

    :cond_ae
    move-object v6, p3

    goto :goto_96

    .line 9423
    .end local v2           #r:Lcom/android/server/am/ProcessRecord;
    :cond_b0
    return v1
.end method

.method private dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;Lcom/android/server/am/ServiceRecord;[Ljava/lang/String;)V
    .registers 8
    .parameter "fd"
    .parameter "pw"
    .parameter "r"
    .parameter "args"

    .prologue
    .line 9097
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "  Service "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p3, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v2}, Landroid/content/ComponentName;->flattenToString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {p2, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9098
    iget-object v1, p3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_35

    iget-object v1, p3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v1, :cond_35

    .line 9102
    :try_start_26
    invoke-virtual {p2}, Ljava/io/PrintWriter;->flush()V

    .line 9103
    iget-object v1, p3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v1, p1, p3, p4}, Landroid/app/IApplicationThread;->dumpService(Ljava/io/FileDescriptor;Landroid/os/IBinder;[Ljava/lang/String;)V

    .line 9104
    const-string v1, "\n"

    invoke-virtual {p2, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V
    :try_end_35
    .catch Landroid/os/RemoteException; {:try_start_26 .. :try_end_35} :catch_36

    .line 9109
    :cond_35
    :goto_35
    return-void

    .line 9105
    :catch_36
    move-exception v1

    move-object v0, v1

    .line 9106
    .local v0, e:Landroid/os/RemoteException;
    const-string v1, "got a RemoteException while dumping the service"

    invoke-virtual {p2, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto :goto_35
.end method

.method private final ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V
    .registers 5
    .parameter "starting"
    .parameter "configChanges"

    .prologue
    const/4 v1, 0x0

    .line 2426
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 2427
    .local v0, r:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_a

    .line 2428
    invoke-direct {p0, v0, p1, v1, p2}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V

    .line 2430
    :cond_a
    return-void
.end method

.method private final ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V
    .registers 16
    .parameter "top"
    .parameter "starting"
    .parameter "onlyThisProcess"
    .parameter "configChanges"

    .prologue
    const/4 v9, 0x1

    const/4 v8, 0x0

    const-string v10, "ActivityManager"

    .line 2290
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v1

    .line 2291
    .local v1, count:I
    sub-int v4, v1, v9

    .line 2292
    .local v4, i:I
    :goto_c
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v6

    if-eq v6, p1, :cond_17

    .line 2293
    add-int/lit8 v4, v4, -0x1

    goto :goto_c

    .line 2296
    :cond_17
    const/4 v0, 0x0

    .line 2297
    .local v0, behindFullscreen:Z
    :goto_18
    if-ltz v4, :cond_6e

    .line 2298
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 2302
    .local v5, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v6, :cond_29

    .line 2297
    :cond_26
    add-int/lit8 v4, v4, -0x1

    goto :goto_18

    .line 2306
    :cond_29
    if-eqz p3, :cond_33

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    invoke-virtual {p3, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_ab

    :cond_33
    move v2, v9

    .line 2311
    .local v2, doThisProcess:Z
    :goto_34
    if-eq v5, p2, :cond_3b

    if-eqz v2, :cond_3b

    .line 2312
    invoke-direct {p0, v5, v8}, Lcom/android/server/am/ActivityManagerService;->ensureActivityConfigurationLocked(Lcom/android/server/am/HistoryRecord;I)Z

    .line 2315
    :cond_3b
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v6, :cond_45

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v6, :cond_ad

    .line 2316
    :cond_45
    if-eqz p3, :cond_4f

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    invoke-virtual {p3, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_64

    .line 2323
    :cond_4f
    if-eq v5, p2, :cond_56

    .line 2324
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v5, v6, p4}, Lcom/android/server/am/HistoryRecord;->startFreezingScreenLocked(Lcom/android/server/am/ProcessRecord;I)V

    .line 2326
    :cond_56
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-nez v6, :cond_5f

    .line 2329
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v6, v5, v9}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2331
    :cond_5f
    if-eq v5, p2, :cond_64

    .line 2332
    invoke-direct {p0, v5, v8, v8}, Lcom/android/server/am/ActivityManagerService;->startSpecificActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V

    .line 2366
    :cond_64
    :goto_64
    iget v6, v5, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    or-int/2addr p4, v6

    .line 2368
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    if-eqz v6, :cond_26

    .line 2372
    const/4 v0, 0x1

    .line 2373
    add-int/lit8 v4, v4, -0x1

    .line 2380
    .end local v2           #doThisProcess:Z
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_6e
    :goto_6e
    if-ltz v4, :cond_11d

    .line 2381
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 2386
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v6, :cond_a8

    .line 2387
    if-eqz v0, :cond_117

    .line 2388
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-eqz v6, :cond_a8

    .line 2391
    iput-boolean v8, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    .line 2393
    :try_start_84
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v7, 0x0

    invoke-virtual {v6, v5, v7}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2394
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v6, v7, :cond_96

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v6, v7, :cond_a8

    :cond_96
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v6, :cond_a8

    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v6, :cond_a8

    .line 2399
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    const/4 v7, 0x0

    invoke-interface {v6, v5, v7}, Landroid/app/IApplicationThread;->scheduleWindowVisibility(Landroid/os/IBinder;Z)V
    :try_end_a8
    .catch Ljava/lang/Exception; {:try_start_84 .. :try_end_a8} :catch_f6

    .line 2417
    :cond_a8
    :goto_a8
    add-int/lit8 v4, v4, -0x1

    goto :goto_6e

    :cond_ab
    move v2, v8

    .line 2306
    goto :goto_34

    .line 2336
    .restart local v2       #doThisProcess:Z
    :cond_ad
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-eqz v6, :cond_b5

    .line 2341
    invoke-virtual {v5, v8}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V

    goto :goto_64

    .line 2343
    :cond_b5
    if-nez p3, :cond_64

    .line 2346
    iput-boolean v9, v5, Lcom/android/server/am/HistoryRecord;->visible:Z

    .line 2347
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v6, v7, :cond_64

    if-eq v5, p2, :cond_64

    .line 2353
    :try_start_c1
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v7, 0x1

    invoke-virtual {v6, v5, v7}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2354
    iget-object v6, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v6, v6, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    const/4 v7, 0x1

    invoke-interface {v6, v5, v7}, Landroid/app/IApplicationThread;->scheduleWindowVisibility(Landroid/os/IBinder;Z)V

    .line 2355
    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V
    :try_end_d3
    .catch Ljava/lang/Exception; {:try_start_c1 .. :try_end_d3} :catch_d4

    goto :goto_64

    .line 2356
    :catch_d4
    move-exception v6

    move-object v3, v6

    .line 2359
    .local v3, e:Ljava/lang/Exception;
    const-string v6, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Exception thrown making visibile: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, v5, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v7}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v10, v6, v3}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_64

    .line 2401
    .end local v2           #doThisProcess:Z
    .end local v3           #e:Ljava/lang/Exception;
    :catch_f6
    move-exception v6

    move-object v3, v6

    .line 2404
    .restart local v3       #e:Ljava/lang/Exception;
    const-string v6, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Exception thrown making hidden: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, v5, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v7}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v10, v6, v3}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_a8

    .line 2411
    .end local v3           #e:Ljava/lang/Exception;
    :cond_117
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    if-eqz v6, :cond_a8

    .line 2414
    const/4 v0, 0x1

    goto :goto_a8

    .line 2419
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_11d
    return-void
.end method

.method private final ensureActivityConfigurationLocked(Lcom/android/server/am/HistoryRecord;I)Z
    .registers 10
    .parameter "r"
    .parameter "globalChanges"

    .prologue
    const/4 v6, 0x0

    const/4 v5, 0x1

    .line 12392
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    .line 12393
    .local v1, newConfig:Landroid/content/res/Configuration;
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->configuration:Landroid/content/res/Configuration;

    if-ne v3, v1, :cond_a

    move v3, v5

    .line 12478
    :goto_9
    return v3

    .line 12399
    :cond_a
    iget-boolean v3, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_13

    .line 12402
    invoke-virtual {p1, v6}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V

    move v3, v5

    .line 12403
    goto :goto_9

    .line 12408
    :cond_13
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->configuration:Landroid/content/res/Configuration;

    .line 12409
    .local v2, oldConfig:Landroid/content/res/Configuration;
    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->configuration:Landroid/content/res/Configuration;

    .line 12413
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_21

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v3, :cond_26

    .line 12416
    :cond_21
    invoke-virtual {p1, v6}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V

    move v3, v5

    .line 12417
    goto :goto_9

    .line 12422
    :cond_26
    iget-boolean v3, p1, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-nez v3, :cond_70

    .line 12425
    invoke-virtual {v2, v1}, Landroid/content/res/Configuration;->diff(Landroid/content/res/Configuration;)I

    move-result v0

    .line 12431
    .local v0, changes:I
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget v3, v3, Landroid/content/pm/ActivityInfo;->configChanges:I

    xor-int/lit8 v3, v3, -0x1

    and-int/2addr v3, v0

    if-eqz v3, :cond_70

    .line 12433
    iget v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    or-int/2addr v3, v0

    iput v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    .line 12434
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {p1, v3, p2}, Lcom/android/server/am/HistoryRecord;->startFreezingScreenLocked(Lcom/android/server/am/ProcessRecord;I)V

    .line 12435
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_4b

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v3, :cond_50

    .line 12437
    :cond_4b
    invoke-direct {p0, p1, v5}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    :goto_4e
    move v3, v6

    .line 12460
    goto :goto_9

    .line 12438
    :cond_50
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v4, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v3, v4, :cond_5a

    .line 12442
    iput-boolean v5, p1, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    move v3, v5

    .line 12443
    goto :goto_9

    .line 12444
    :cond_5a
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v4, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v3, v4, :cond_68

    .line 12450
    iget v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-direct {p0, p1, v3, v5}, Lcom/android/server/am/ActivityManagerService;->relaunchActivityLocked(Lcom/android/server/am/HistoryRecord;IZ)Z

    .line 12451
    iput v6, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    goto :goto_4e

    .line 12454
    :cond_68
    iget v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-direct {p0, p1, v3, v6}, Lcom/android/server/am/ActivityManagerService;->relaunchActivityLocked(Lcom/android/server/am/HistoryRecord;IZ)Z

    .line 12455
    iput v6, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    goto :goto_4e

    .line 12469
    .end local v0           #changes:I
    :cond_70
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_81

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v3, :cond_81

    .line 12471
    :try_start_7a
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v3, p1}, Landroid/app/IApplicationThread;->scheduleActivityConfigurationChanged(Landroid/os/IBinder;)V
    :try_end_81
    .catch Landroid/os/RemoteException; {:try_start_7a .. :try_end_81} :catch_86

    .line 12476
    :cond_81
    :goto_81
    invoke-virtual {p1, v6}, Lcom/android/server/am/HistoryRecord;->stopFreezingScreenLocked(Z)V

    move v3, v5

    .line 12478
    goto :goto_9

    .line 12472
    :catch_86
    move-exception v3

    goto :goto_81
.end method

.method private ensurePackageDexOpt(Ljava/lang/String;)V
    .registers 4
    .parameter "packageName"

    .prologue
    .line 1712
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v0

    .line 1714
    .local v0, pm:Landroid/content/pm/IPackageManager;
    :try_start_4
    invoke-interface {v0, p1}, Landroid/content/pm/IPackageManager;->performDexOpt(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_d

    .line 1715
    const/4 v1, 0x1

    iput-boolean v1, p0, Lcom/android/server/am/ActivityManagerService;->mDidDexOpt:Z
    :try_end_d
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_d} :catch_e

    .line 1719
    :cond_d
    :goto_d
    return-void

    .line 1717
    :catch_e
    move-exception v1

    goto :goto_d
.end method

.method private final findActivityInHistoryLocked(Lcom/android/server/am/HistoryRecord;I)I
    .registers 7
    .parameter "r"
    .parameter "task"

    .prologue
    .line 3003
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v1

    .line 3004
    .local v1, i:I
    :cond_6
    if-lez v1, :cond_18

    .line 3005
    add-int/lit8 v1, v1, -0x1

    .line 3006
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    .line 3007
    .local v0, candidate:Lcom/android/server/am/HistoryRecord;
    iget-object v2, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v2, v2, Lcom/android/server/am/TaskRecord;->taskId:I

    if-eq v2, p2, :cond_1a

    .line 3015
    .end local v0           #candidate:Lcom/android/server/am/HistoryRecord;
    :cond_18
    const/4 v2, -0x1

    :goto_19
    return v2

    .line 3010
    .restart local v0       #candidate:Lcom/android/server/am/HistoryRecord;
    :cond_1a
    iget-object v2, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v2, v3}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_6

    move v2, v1

    .line 3011
    goto :goto_19
.end method

.method private findActivityLocked(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)Lcom/android/server/am/HistoryRecord;
    .registers 9
    .parameter "intent"
    .parameter "info"

    .prologue
    .line 7245
    invoke-virtual {p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v1

    .line 7246
    .local v1, cls:Landroid/content/ComponentName;
    iget-object v4, p2, Landroid/content/pm/ActivityInfo;->targetActivity:Ljava/lang/String;

    if-eqz v4, :cond_11

    .line 7247
    new-instance v1, Landroid/content/ComponentName;

    .end local v1           #cls:Landroid/content/ComponentName;
    iget-object v4, p2, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v5, p2, Landroid/content/pm/ActivityInfo;->targetActivity:Ljava/lang/String;

    invoke-direct {v1, v4, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 7250
    .restart local v1       #cls:Landroid/content/ComponentName;
    :cond_11
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7251
    .local v0, N:I
    const/4 v4, 0x1

    sub-int v2, v0, v4

    .local v2, i:I
    :goto_1a
    if-ltz v2, :cond_39

    .line 7252
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 7253
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v4, v3, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v4, :cond_36

    .line 7254
    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v4}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v4

    invoke-virtual {v4, v1}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_36

    move-object v4, v3

    .line 7263
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :goto_35
    return-object v4

    .line 7251
    .restart local v3       #r:Lcom/android/server/am/HistoryRecord;
    :cond_36
    add-int/lit8 v2, v2, -0x1

    goto :goto_1a

    .line 7263
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_39
    const/4 v4, 0x0

    goto :goto_35
.end method

.method private final findAffinityTaskTopLocked(ILjava/lang/String;)I
    .registers 11
    .parameter "startIndex"
    .parameter "affinity"

    .prologue
    const/4 v7, 0x1

    .line 6628
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, p1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    iget-object v4, v5, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 6629
    .local v4, startTask:Lcom/android/server/am/TaskRecord;
    move-object v2, v4

    .line 6632
    .local v2, jt:Lcom/android/server/am/TaskRecord;
    sub-int v1, p1, v7

    .local v1, j:I
    :goto_e
    if-ltz v1, :cond_2b

    .line 6633
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 6634
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    iget-object v5, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v5, v2, :cond_28

    .line 6635
    iget-object v2, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 6636
    iget-object v5, v2, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {p2, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_28

    move v5, v1

    .line 6660
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    .end local p0
    :goto_27
    return v5

    .line 6632
    .restart local v3       #r:Lcom/android/server/am/HistoryRecord;
    .restart local p0
    :cond_28
    add-int/lit8 v1, v1, -0x1

    goto :goto_e

    .line 6643
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_2b
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 6644
    .local v0, N:I
    move-object v2, v4

    .line 6645
    add-int/lit8 v1, p1, 0x1

    :goto_34
    if-ge v1, v0, :cond_51

    .line 6646
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 6647
    .restart local v3       #r:Lcom/android/server/am/HistoryRecord;
    iget-object v5, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v5, v2, :cond_4e

    .line 6648
    iget-object v5, v2, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {p2, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_4c

    move v5, v1

    .line 6649
    goto :goto_27

    .line 6651
    :cond_4c
    iget-object v2, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 6645
    :cond_4e
    add-int/lit8 v1, v1, 0x1

    goto :goto_34

    .line 6656
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_51
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    sub-int v6, v0, v7

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p0

    .end local p0
    check-cast p0, Lcom/android/server/am/HistoryRecord;

    iget-object v5, p0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {p2, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_68

    .line 6657
    sub-int v5, v0, v7

    goto :goto_27

    .line 6660
    :cond_68
    const/4 v5, -0x1

    goto :goto_27
.end method

.method private findServiceLocked(Landroid/content/Intent;Ljava/lang/String;)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    .registers 15
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    const/4 v11, 0x0

    .line 9864
    const/4 v5, 0x0

    .line 9865
    .local v5, r:Lcom/android/server/am/ServiceRecord;
    invoke-virtual {p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v8

    if-eqz v8, :cond_14

    .line 9866
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v9

    invoke-virtual {v8, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 9868
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :cond_14
    if-nez v5, :cond_23

    .line 9869
    new-instance v3, Landroid/content/Intent$FilterComparison;

    invoke-direct {v3, p1}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V

    .line 9870
    .local v3, filter:Landroid/content/Intent$FilterComparison;
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    invoke-virtual {v8, v3}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 9873
    .end local v3           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :cond_23
    if-nez v5, :cond_4e

    .line 9875
    :try_start_25
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v8

    const/4 v9, 0x0

    invoke-interface {v8, p1, p2, v9}, Landroid/content/pm/IPackageManager;->resolveService(Landroid/content/Intent;Ljava/lang/String;I)Landroid/content/pm/ResolveInfo;

    move-result-object v6

    .line 9878
    .local v6, rInfo:Landroid/content/pm/ResolveInfo;
    if-eqz v6, :cond_37

    iget-object v8, v6, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    move-object v7, v8

    .line 9880
    .local v7, sInfo:Landroid/content/pm/ServiceInfo;
    :goto_33
    if-nez v7, :cond_39

    move-object v8, v11

    .line 9905
    .end local v6           #rInfo:Landroid/content/pm/ResolveInfo;
    .end local v7           #sInfo:Landroid/content/pm/ServiceInfo;
    :goto_36
    return-object v8

    .restart local v6       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_37
    move-object v7, v11

    .line 9878
    goto :goto_33

    .line 9884
    .restart local v7       #sInfo:Landroid/content/pm/ServiceInfo;
    :cond_39
    new-instance v4, Landroid/content/ComponentName;

    iget-object v8, v7, Landroid/content/pm/ServiceInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v9, v7, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v8, v9}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 9886
    .local v4, name:Landroid/content/ComponentName;
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v8, v4}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v8

    move-object v0, v8

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object v5, v0
    :try_end_4e
    .catch Landroid/os/RemoteException; {:try_start_25 .. :try_end_4e} :catch_b4

    .line 9891
    .end local v4           #name:Landroid/content/ComponentName;
    .end local v6           #rInfo:Landroid/content/pm/ResolveInfo;
    .end local v7           #sInfo:Landroid/content/pm/ServiceInfo;
    :cond_4e
    :goto_4e
    if-eqz v5, :cond_b2

    .line 9892
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v1

    .line 9893
    .local v1, callingPid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    .line 9894
    .local v2, callingUid:I
    iget-object v8, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    iget-boolean v9, v5, Lcom/android/server/am/ServiceRecord;->exported:Z

    if-eqz v9, :cond_a7

    const/4 v9, -0x1

    :goto_5f
    invoke-virtual {p0, v8, v1, v2, v9}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v8

    if-eqz v8, :cond_ac

    .line 9897
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Permission Denial: Accessing service "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v5, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " from pid="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ", uid="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " requires "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-object v10, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9901
    new-instance v8, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    iget-object v9, v5, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    invoke-direct {v8, p0, v11, v9}, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ServiceRecord;Ljava/lang/String;)V

    goto :goto_36

    .line 9894
    :cond_a7
    iget-object v9, v5, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget v9, v9, Landroid/content/pm/ApplicationInfo;->uid:I

    goto :goto_5f

    .line 9903
    :cond_ac
    new-instance v8, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    invoke-direct {v8, p0, v5, v11}, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ServiceRecord;Ljava/lang/String;)V

    goto :goto_36

    .end local v1           #callingPid:I
    .end local v2           #callingUid:I
    :cond_b2
    move-object v8, v11

    .line 9905
    goto :goto_36

    .line 9887
    :catch_b4
    move-exception v8

    goto :goto_4e
.end method

.method private final findServiceLocked(Landroid/content/ComponentName;Landroid/os/IBinder;)Lcom/android/server/am/ServiceRecord;
    .registers 5
    .parameter "name"
    .parameter "token"

    .prologue
    .line 9848
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v1, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    .line 9849
    .local v0, r:Lcom/android/server/am/ServiceRecord;
    if-ne v0, p2, :cond_c

    move-object v1, v0

    :goto_b
    return-object v1

    :cond_c
    const/4 v1, 0x0

    goto :goto_b
.end method

.method private findTaskLocked(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)Lcom/android/server/am/HistoryRecord;
    .registers 10
    .parameter "intent"
    .parameter "info"

    .prologue
    .line 7199
    invoke-virtual {p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v1

    .line 7200
    .local v1, cls:Landroid/content/ComponentName;
    iget-object v5, p2, Landroid/content/pm/ActivityInfo;->targetActivity:Ljava/lang/String;

    if-eqz v5, :cond_11

    .line 7201
    new-instance v1, Landroid/content/ComponentName;

    .end local v1           #cls:Landroid/content/ComponentName;
    iget-object v5, p2, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    iget-object v6, p2, Landroid/content/pm/ActivityInfo;->targetActivity:Ljava/lang/String;

    invoke-direct {v1, v5, v6}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 7204
    .restart local v1       #cls:Landroid/content/ComponentName;
    :cond_11
    const/4 v2, 0x0

    .line 7206
    .local v2, cp:Lcom/android/server/am/TaskRecord;
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7207
    .local v0, N:I
    const/4 v5, 0x1

    sub-int v3, v0, v5

    .local v3, i:I
    :goto_1b
    if-ltz v3, :cond_77

    .line 7208
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 7209
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v5, :cond_74

    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v5, v2, :cond_74

    iget v5, v4, Lcom/android/server/am/HistoryRecord;->launchMode:I

    const/4 v6, 0x3

    if-eq v5, v6, :cond_74

    .line 7211
    iget-object v2, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7215
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    if-eqz v5, :cond_48

    .line 7216
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    iget-object v6, p2, Landroid/content/pm/ActivityInfo;->taskAffinity:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_74

    move-object v5, v4

    .line 7236
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :goto_47
    return-object v5

    .line 7220
    .restart local v4       #r:Lcom/android/server/am/HistoryRecord;
    :cond_48
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-eqz v5, :cond_5e

    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    invoke-virtual {v5, v1}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_5e

    move-object v5, v4

    .line 7225
    goto :goto_47

    .line 7226
    :cond_5e
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinityIntent:Landroid/content/Intent;

    if-eqz v5, :cond_74

    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinityIntent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    invoke-virtual {v5, v1}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_74

    move-object v5, v4

    .line 7231
    goto :goto_47

    .line 7207
    :cond_74
    add-int/lit8 v3, v3, -0x1

    goto :goto_1b

    .line 7236
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :cond_77
    const/4 v5, 0x0

    goto :goto_47
.end method

.method private final finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z
    .registers 14
    .parameter "r"
    .parameter "index"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "reason"

    .prologue
    .line 3917
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v1, :cond_1e

    .line 3918
    const-string v1, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Duplicate finish request for "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 3919
    const/4 v1, 0x0

    .line 3998
    .end local p2
    :goto_1d
    return v1

    .line 3922
    .restart local p2
    :cond_1e
    const/4 v1, 0x1

    iput-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    .line 3923
    const/16 v1, 0x7531

    const/4 v2, 0x4

    new-array v2, v2, [Ljava/lang/Object;

    const/4 v3, 0x0

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v4

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v2, v3

    const/4 v3, 0x1

    iget-object v4, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v4, v4, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v2, v3

    const/4 v3, 0x2

    iget-object v4, p1, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v4, v2, v3

    const/4 v3, 0x3

    aput-object p5, v2, v3

    invoke-static {v1, v2}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 3926
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v2, v1, Lcom/android/server/am/TaskRecord;->numActivities:I

    const/4 v3, 0x1

    sub-int/2addr v2, v3

    iput v2, v1, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 3927
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    if-eqz v1, :cond_70

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    const/4 v2, 0x1

    sub-int/2addr v1, v2

    if-ge p2, v1, :cond_70

    .line 3928
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    add-int/lit8 v2, p2, 0x1

    invoke-virtual {v1, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/HistoryRecord;

    .line 3929
    .local v7, next:Lcom/android/server/am/HistoryRecord;
    iget-object v1, v7, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-ne v1, v2, :cond_70

    .line 3930
    const/4 v1, 0x1

    iput-boolean v1, v7, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    .line 3934
    .end local v7           #next:Lcom/android/server/am/HistoryRecord;
    :cond_70
    invoke-virtual {p1}, Lcom/android/server/am/HistoryRecord;->pauseKeyDispatchingLocked()V

    .line 3935
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v1, p1, :cond_7f

    .line 3936
    const/4 v1, 0x0

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v1

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->setFocusedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 3940
    :cond_7f
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 3941
    .local v0, resultTo:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_a3

    .line 3945
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v1, v1, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    if-lez v1, :cond_96

    .line 3946
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v1, v1, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    invoke-direct {p0, v1, v2, p4, p1}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionFromIntentLocked(ILjava/lang/String;Landroid/content/Intent;Lcom/android/server/am/HistoryRecord;)V

    .line 3949
    :cond_96
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    iget v3, p1, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move-object v1, p1

    move v4, p3

    move-object v5, p4

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/HistoryRecord;->addResultLocked(Lcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 3951
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 3958
    :cond_a3
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 3959
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    .line 3960
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    .line 3961
    const/4 v1, 0x0

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    .line 3963
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-lez v1, :cond_bc

    .line 3967
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 3970
    :cond_bc
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v1, p1, :cond_f5

    .line 3971
    if-lez p2, :cond_d3

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    const/4 v2, 0x1

    sub-int v2, p2, v2

    invoke-virtual {v1, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    .end local p2
    check-cast p2, Lcom/android/server/am/HistoryRecord;

    iget-object v1, p2, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v1, v2, :cond_f0

    :cond_d3
    const/4 v1, 0x1

    move v6, v1

    .line 3975
    .local v6, endTask:Z
    :goto_d5
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    if-eqz v6, :cond_f3

    const/16 v2, 0x9

    :goto_db
    invoke-virtual {v1, v2}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 3980
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v2, 0x0

    invoke-virtual {v1, p1, v2}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 3982
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-nez v1, :cond_ed

    .line 3985
    const/4 v1, 0x0

    const/4 v2, 0x0

    invoke-direct {p0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->startPausingLocked(ZZ)V

    .line 3998
    .end local v6           #endTask:Z
    :cond_ed
    const/4 v1, 0x0

    goto/16 :goto_1d

    .line 3971
    :cond_f0
    const/4 v1, 0x0

    move v6, v1

    goto :goto_d5

    .line 3975
    .restart local v6       #endTask:Z
    :cond_f3
    const/4 v2, 0x7

    goto :goto_db

    .line 3988
    .end local v6           #endTask:Z
    .restart local p2
    :cond_f5
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v1, v2, :cond_ed

    .line 3992
    const/4 v1, 0x1

    invoke-direct {p0, p1, p2, v1}, Lcom/android/server/am/ActivityManagerService;->finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;II)Lcom/android/server/am/HistoryRecord;

    move-result-object v1

    if-nez v1, :cond_105

    const/4 v1, 0x1

    goto/16 :goto_1d

    :cond_105
    const/4 v1, 0x0

    goto/16 :goto_1d
.end method

.method private final finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;I)Lcom/android/server/am/HistoryRecord;
    .registers 5
    .parameter "r"
    .parameter "mode"

    .prologue
    .line 4007
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 4008
    .local v0, index:I
    if-gez v0, :cond_8

    .line 4009
    const/4 v1, 0x0

    .line 4012
    :goto_7
    return-object v1

    :cond_8
    invoke-direct {p0, p1, v0, p2}, Lcom/android/server/am/ActivityManagerService;->finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;II)Lcom/android/server/am/HistoryRecord;

    move-result-object v1

    goto :goto_7
.end method

.method private final finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;II)Lcom/android/server/am/HistoryRecord;
    .registers 8
    .parameter "r"
    .parameter "index"
    .parameter "mode"

    .prologue
    const/4 v3, 0x0

    .line 4020
    const/4 v2, 0x2

    if-ne p3, v2, :cond_34

    iget-boolean v2, p1, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    if-eqz v2, :cond_34

    .line 4021
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_2b

    .line 4022
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4023
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x3

    if-le v2, v3, :cond_2b

    .line 4027
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v0

    .line 4028
    .local v0, msg:Landroid/os/Message;
    const/16 v2, 0xb

    iput v2, v0, Landroid/os/Message;->what:I

    .line 4029
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v2, v0}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 4032
    .end local v0           #msg:Landroid/os/Message;
    :cond_2b
    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v2, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4033
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    move-object v2, p1

    .line 4059
    :goto_33
    return-object v2

    .line 4038
    :cond_34
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4039
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4040
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v2, p1, :cond_44

    .line 4041
    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 4043
    :cond_44
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4044
    .local v1, prevState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->FINISHING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v2, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4046
    if-eqz p3, :cond_54

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v1, v2, :cond_54

    sget-object v2, Lcom/android/server/am/ActivityManagerService$ActivityState;->INITIALIZING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v1, v2, :cond_5f

    .line 4051
    :cond_54
    const/4 v2, 0x1

    invoke-direct {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    move-result v2

    if-eqz v2, :cond_5d

    move-object v2, v3

    goto :goto_33

    :cond_5d
    move-object v2, p1

    goto :goto_33

    .line 4056
    :cond_5f
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4057
    invoke-direct {p0, v3}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    move-object v2, p1

    .line 4059
    goto :goto_33
.end method

.method private final finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z
    .registers 14
    .parameter "receiver"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "resultExtras"
    .parameter "resultAbort"
    .parameter "explicit"

    .prologue
    const/4 v6, 0x1

    const/4 v4, 0x0

    const/4 v3, 0x0

    const-string v5, "ActivityManager"

    .line 11537
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    if-nez v2, :cond_18

    .line 11538
    if-eqz p6, :cond_16

    .line 11539
    const-string v2, "ActivityManager"

    const-string v2, "finishReceiver called but no pending broadcasts"

    invoke-static {v5, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    :cond_16
    move v2, v4

    .line 11583
    :goto_17
    return v2

    .line 11543
    :cond_18
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v2, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/BroadcastRecord;

    .line 11544
    .local v0, r:Lcom/android/server/am/BroadcastRecord;
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    if-nez v2, :cond_2f

    .line 11545
    if-eqz p6, :cond_2d

    .line 11546
    const-string v2, "ActivityManager"

    const-string v2, "finishReceiver called but none active"

    invoke-static {v5, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    :cond_2d
    move v2, v4

    .line 11548
    goto :goto_17

    .line 11550
    :cond_2f
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    if-eq v2, p1, :cond_3c

    .line 11551
    const-string v2, "ActivityManager"

    const-string v2, "finishReceiver called but active receiver is different"

    invoke-static {v5, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    move v2, v4

    .line 11552
    goto :goto_17

    .line 11554
    :cond_3c
    iget v1, v0, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 11555
    .local v1, state:I
    iput v4, v0, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 11556
    if-nez v1, :cond_4b

    .line 11557
    if-eqz p6, :cond_4b

    .line 11558
    const-string v2, "ActivityManager"

    const-string v2, "finishReceiver called but state is IDLE"

    invoke-static {v5, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11561
    :cond_4b
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 11562
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2, v3}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 11563
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    if-eqz v2, :cond_5a

    .line 11564
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    iput-object v3, v2, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 11566
    :cond_5a
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    if-eqz v2, :cond_64

    .line 11567
    iget-object v2, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    iget-object v2, v2, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;

    iput-object v3, v2, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 11569
    :cond_64
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    .line 11570
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 11571
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    .line 11572
    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curReceiver:Landroid/content/pm/ActivityInfo;

    .line 11573
    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 11575
    iput p2, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    .line 11576
    iput-object p3, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    .line 11577
    iput-object p4, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    .line 11578
    iput-boolean p5, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    .line 11583
    if-eq v1, v6, :cond_7b

    const/4 v2, 0x3

    if-ne v1, v2, :cond_7d

    :cond_7b
    move v2, v6

    goto :goto_17

    :cond_7d
    move v2, v4

    goto :goto_17
.end method

.method private final finishTaskMove(I)V
    .registers 3
    .parameter "task"

    .prologue
    .line 7038
    const/4 v0, 0x0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 7039
    return-void
.end method

.method private final generateApplicationProvidersLocked(Lcom/android/server/am/ProcessRecord;)Ljava/util/List;
    .registers 11
    .parameter "app"

    .prologue
    .line 7373
    const/4 v4, 0x0

    .line 7375
    .local v4, providers:Ljava/util/List;
    :try_start_1
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    const/16 v8, 0xc00

    invoke-interface {v5, v6, v7, v8}, Landroid/content/pm/IPackageManager;->queryContentProviders(Ljava/lang/String;II)Ljava/util/List;
    :try_end_10
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_10} :catch_53

    move-result-object v4

    .line 7380
    :goto_11
    if-eqz v4, :cond_52

    .line 7381
    invoke-interface {v4}, Ljava/util/List;->size()I

    move-result v0

    .line 7382
    .local v0, N:I
    const/4 v3, 0x0

    .local v3, i:I
    :goto_18
    if-ge v3, v0, :cond_52

    .line 7383
    invoke-interface {v4, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/content/pm/ProviderInfo;

    .line 7385
    .local v1, cpi:Landroid/content/pm/ProviderInfo;
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v6, v1, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 7387
    .local v2, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-nez v2, :cond_3a

    .line 7388
    new-instance v2, Lcom/android/server/am/ContentProviderRecord;

    .end local v2           #cpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v5, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    invoke-direct {v2, v1, v5}, Lcom/android/server/am/ContentProviderRecord;-><init>(Landroid/content/pm/ProviderInfo;Landroid/content/pm/ApplicationInfo;)V

    .line 7389
    .restart local v2       #cpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v6, v1, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7391
    :cond_3a
    iget-object v5, p1, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    iget-object v6, v1, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7392
    iget-object v5, v1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {p1, v5}, Lcom/android/server/am/ProcessRecord;->addPackage(Ljava/lang/String;)Z

    .line 7393
    iget-object v5, v1, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-direct {p0, v5}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 7382
    add-int/lit8 v3, v3, 0x1

    goto :goto_18

    .line 7396
    .end local v0           #N:I
    .end local v1           #cpi:Landroid/content/pm/ProviderInfo;
    .end local v2           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v3           #i:I
    :cond_52
    return-object v4

    .line 7378
    :catch_53
    move-exception v5

    goto :goto_11
.end method

.method private generateProcessError(Lcom/android/server/am/ProcessRecord;ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;[B)Landroid/app/ActivityManager$ProcessErrorStateInfo;
    .registers 9
    .parameter "app"
    .parameter "condition"
    .parameter "tag"
    .parameter "shortMsg"
    .parameter "longMsg"
    .parameter "crashData"

    .prologue
    .line 8447
    new-instance v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;

    invoke-direct {v0}, Landroid/app/ActivityManager$ProcessErrorStateInfo;-><init>()V

    .line 8449
    .local v0, report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    iput p2, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->condition:I

    .line 8450
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iput-object v1, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->processName:Ljava/lang/String;

    .line 8451
    iget v1, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    iput v1, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->pid:I

    .line 8452
    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    iput v1, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->uid:I

    .line 8453
    iput-object p3, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->tag:Ljava/lang/String;

    .line 8454
    iput-object p4, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->shortMsg:Ljava/lang/String;

    .line 8455
    iput-object p5, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->longMsg:Ljava/lang/String;

    .line 8456
    iput-object p6, v0, Landroid/app/ActivityManager$ProcessErrorStateInfo;->crashData:[B

    .line 8458
    return-object v0
.end method

.method private getCallingRecordLocked(Landroid/os/IBinder;)Lcom/android/server/am/HistoryRecord;
    .registers 5
    .parameter "token"

    .prologue
    .line 5637
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 5638
    .local v0, index:I
    if-ltz v0, :cond_13

    .line 5639
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 5640
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    if-eqz v1, :cond_13

    .line 5641
    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 5644
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_12
    return-object v2

    :cond_13
    const/4 v2, 0x0

    goto :goto_12
.end method

.method private getCommonServicesLocked()Ljava/util/HashMap;
    .registers 6
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Landroid/os/IBinder;",
            ">;"
        }
    .end annotation

    .prologue
    const-string v4, "window"

    const-string v3, "package"

    const-string v2, "alarm"

    .line 1614
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    if-nez v0, :cond_38

    .line 1615
    new-instance v0, Ljava/util/HashMap;

    invoke-direct {v0}, Ljava/util/HashMap;-><init>()V

    iput-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    .line 1618
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    const-string v1, "package"

    const-string v1, "package"

    invoke-static {v3}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v1

    invoke-virtual {v0, v3, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 1619
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    const-string v1, "window"

    const-string v1, "window"

    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v1

    invoke-virtual {v0, v4, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 1620
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    const-string v1, "alarm"

    const-string v1, "alarm"

    invoke-static {v2}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v1

    invoke-virtual {v0, v2, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 1623
    :cond_38
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppBindArgs:Ljava/util/HashMap;

    return-object v0
.end method

.method private getContentProviderExternal(Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;
    .registers 3
    .parameter "name"

    .prologue
    .line 7641
    const/4 v0, 0x0

    invoke-direct {p0, v0, p1}, Lcom/android/server/am/ActivityManagerService;->getContentProviderImpl(Landroid/app/IApplicationThread;Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;

    move-result-object v0

    return-object v0
.end method

.method private final getContentProviderImpl(Landroid/app/IApplicationThread;Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;
    .registers 25
    .parameter "caller"
    .parameter "name"

    .prologue
    .line 7446
    const/4 v13, 0x0

    .line 7448
    .local v13, cpi:Landroid/content/pm/ProviderInfo;
    monitor-enter p0

    .line 7449
    const/16 v21, 0x0

    .line 7450
    .local v21, r:Lcom/android/server/am/ProcessRecord;
    if-eqz p1, :cond_46

    .line 7451
    :try_start_6
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v21

    .line 7452
    if-nez v21, :cond_46

    .line 7453
    new-instance v4, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unable to find app for caller "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " (pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ") when getting content provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 7604
    :catchall_43
    move-exception v4

    monitor-exit p0
    :try_end_45
    .catchall {:try_start_6 .. :try_end_45} :catchall_43

    throw v4

    .line 7461
    :cond_46
    :try_start_46
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Lcom/android/server/am/ContentProviderRecord;

    .line 7462
    .local v14, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v14, :cond_124

    .line 7463
    iget-object v13, v14, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    .line 7464
    const/4 v4, -0x1

    move-object/from16 v0, p0

    move-object v1, v13

    move-object/from16 v2, v21

    move v3, v4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkContentProviderPermissionLocked(Landroid/content/pm/ProviderInfo;Lcom/android/server/am/ProcessRecord;I)Ljava/lang/String;

    move-result-object v4

    if-eqz v4, :cond_75

    .line 7465
    new-instance v4, Landroid/app/IActivityManager$ContentProviderHolder;

    iget-object v5, v13, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    if-eqz v5, :cond_72

    iget-object v5, v13, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    :goto_6d
    invoke-direct {v4, v13, v5}, Landroid/app/IActivityManager$ContentProviderHolder;-><init>(Landroid/content/pm/ProviderInfo;Ljava/lang/String;)V

    monitor-exit p0

    .line 7625
    :goto_71
    return-object v4

    .line 7465
    :cond_72
    iget-object v5, v13, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    goto :goto_6d

    .line 7470
    :cond_75
    if-eqz v21, :cond_8d

    move-object v0, v14

    move-object/from16 v1, v21

    invoke-virtual {v0, v1}, Lcom/android/server/am/ContentProviderRecord;->canRunHere(Lcom/android/server/am/ProcessRecord;)Z

    move-result v4

    if-eqz v4, :cond_8d

    .line 7475
    iget-object v4, v14, Lcom/android/server/am/ContentProviderRecord;->provider:Landroid/content/IContentProvider;

    if-eqz v4, :cond_8a

    .line 7478
    new-instance v15, Lcom/android/server/am/ContentProviderRecord;

    invoke-direct {v15, v14}, Lcom/android/server/am/ContentProviderRecord;-><init>(Lcom/android/server/am/ContentProviderRecord;)V

    .end local v14           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .local v15, cpr:Lcom/android/server/am/ContentProviderRecord;
    move-object v14, v15

    .line 7480
    .end local v15           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .restart local v14       #cpr:Lcom/android/server/am/ContentProviderRecord;
    :cond_8a
    monitor-exit p0

    move-object v4, v14

    goto :goto_71

    .line 7483
    :cond_8d
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v18

    .line 7487
    .local v18, origId:J
    if-eqz v21, :cond_11d

    .line 7488
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashSet;

    move-object v4, v0

    invoke-virtual {v4, v14}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 7489
    iget-object v4, v14, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    move-object v0, v4

    move-object/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 7494
    :goto_a3
    iget-object v4, v14, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v4, :cond_af

    .line 7495
    iget-object v4, v14, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v0, p0

    move-object v1, v4

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 7498
    :cond_af
    invoke-static/range {v18 .. v19}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7604
    .end local v18           #origId:J
    :goto_b2
    monitor-exit p0
    :try_end_b3
    .catchall {:try_start_46 .. :try_end_b3} :catchall_43

    .line 7607
    monitor-enter v14

    .line 7608
    :goto_b4
    :try_start_b4
    iget-object v4, v14, Lcom/android/server/am/ContentProviderRecord;->provider:Landroid/content/IContentProvider;

    if-nez v4, :cond_283

    .line 7609
    iget-object v4, v14, Lcom/android/server/am/ContentProviderRecord;->launchingApp:Lcom/android/server/am/ProcessRecord;

    if-nez v4, :cond_27b

    .line 7610
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unable to launch app "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v13, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "/"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v13, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " for provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ": launching app became null"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 7614
    const/16 v4, 0x7554

    const/4 v5, 0x3

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    iget-object v7, v13, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    aput-object v7, v5, v6

    const/4 v6, 0x1

    iget-object v7, v13, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x2

    aput-object p2, v5, v6

    invoke-static {v4, v5}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 7617
    const/4 v4, 0x0

    monitor-exit v14

    goto/16 :goto_71

    .line 7624
    :catchall_11a
    move-exception v4

    monitor-exit v14
    :try_end_11c
    .catchall {:try_start_b4 .. :try_end_11c} :catchall_11a

    throw v4

    .line 7491
    .restart local v18       #origId:J
    :cond_11d
    :try_start_11d
    iget v4, v14, Lcom/android/server/am/ContentProviderRecord;->externals:I

    add-int/lit8 v4, v4, 0x1

    iput v4, v14, Lcom/android/server/am/ContentProviderRecord;->externals:I
    :try_end_123
    .catchall {:try_start_11d .. :try_end_123} :catchall_43

    goto :goto_a3

    .line 7502
    .end local v18           #origId:J
    :cond_124
    :try_start_124
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    const/16 v5, 0xc00

    move-object v0, v4

    move-object/from16 v1, p2

    move v2, v5

    invoke-interface {v0, v1, v2}, Landroid/content/pm/IPackageManager;->resolveContentProvider(Ljava/lang/String;I)Landroid/content/pm/ProviderInfo;
    :try_end_131
    .catchall {:try_start_124 .. :try_end_131} :catchall_43
    .catch Landroid/os/RemoteException; {:try_start_124 .. :try_end_131} :catch_28a

    move-result-object v13

    .line 7507
    :goto_132
    if-nez v13, :cond_138

    .line 7508
    const/4 v4, 0x0

    :try_start_135
    monitor-exit p0

    goto/16 :goto_71

    .line 7511
    :cond_138
    const/4 v4, -0x1

    move-object/from16 v0, p0

    move-object v1, v13

    move-object/from16 v2, v21

    move v3, v4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkContentProviderPermissionLocked(Landroid/content/pm/ProviderInfo;Lcom/android/server/am/ProcessRecord;I)Ljava/lang/String;

    move-result-object v4

    if-eqz v4, :cond_156

    .line 7512
    new-instance v4, Landroid/app/IActivityManager$ContentProviderHolder;

    iget-object v5, v13, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    if-eqz v5, :cond_153

    iget-object v5, v13, Landroid/content/pm/ProviderInfo;->readPermission:Ljava/lang/String;

    :goto_14d
    invoke-direct {v4, v13, v5}, Landroid/app/IActivityManager$ContentProviderHolder;-><init>(Landroid/content/pm/ProviderInfo;Ljava/lang/String;)V

    monitor-exit p0

    goto/16 :goto_71

    :cond_153
    iget-object v5, v13, Landroid/content/pm/ProviderInfo;->writePermission:Ljava/lang/String;

    goto :goto_14d

    .line 7517
    :cond_156
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    move-object v4, v0

    iget-object v5, v13, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v14

    .end local v14           #cpr:Lcom/android/server/am/ContentProviderRecord;
    check-cast v14, Lcom/android/server/am/ContentProviderRecord;
    :try_end_163
    .catchall {:try_start_135 .. :try_end_163} :catchall_43

    .line 7518
    .restart local v14       #cpr:Lcom/android/server/am/ContentProviderRecord;
    if-nez v14, :cond_198

    const/4 v4, 0x1

    move/from16 v16, v4

    .line 7519
    .local v16, firstClass:Z
    :goto_168
    if-eqz v16, :cond_1a2

    .line 7521
    :try_start_16a
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    iget-object v5, v13, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    const/16 v6, 0x400

    invoke-interface {v4, v5, v6}, Landroid/content/pm/IPackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v12

    .line 7526
    .local v12, ai:Landroid/content/pm/ApplicationInfo;
    if-nez v12, :cond_19c

    .line 7527
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "No package info for content provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v13, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_194
    .catchall {:try_start_16a .. :try_end_194} :catchall_43
    .catch Landroid/os/RemoteException; {:try_start_16a .. :try_end_194} :catch_287

    .line 7529
    const/4 v4, 0x0

    :try_start_195
    monitor-exit p0
    :try_end_196
    .catchall {:try_start_195 .. :try_end_196} :catchall_43

    goto/16 :goto_71

    .line 7518
    .end local v12           #ai:Landroid/content/pm/ApplicationInfo;
    .end local v16           #firstClass:Z
    :cond_198
    const/4 v4, 0x0

    move/from16 v16, v4

    goto :goto_168

    .line 7531
    .restart local v12       #ai:Landroid/content/pm/ApplicationInfo;
    .restart local v16       #firstClass:Z
    :cond_19c
    :try_start_19c
    new-instance v15, Lcom/android/server/am/ContentProviderRecord;

    invoke-direct {v15, v13, v12}, Lcom/android/server/am/ContentProviderRecord;-><init>(Landroid/content/pm/ProviderInfo;Landroid/content/pm/ApplicationInfo;)V
    :try_end_1a1
    .catchall {:try_start_19c .. :try_end_1a1} :catchall_43
    .catch Landroid/os/RemoteException; {:try_start_19c .. :try_end_1a1} :catch_287

    .end local v14           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .restart local v15       #cpr:Lcom/android/server/am/ContentProviderRecord;
    move-object v14, v15

    .line 7537
    .end local v12           #ai:Landroid/content/pm/ApplicationInfo;
    .end local v15           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .restart local v14       #cpr:Lcom/android/server/am/ContentProviderRecord;
    :cond_1a2
    :goto_1a2
    if-eqz v21, :cond_1b1

    :try_start_1a4
    move-object v0, v14

    move-object/from16 v1, v21

    invoke-virtual {v0, v1}, Lcom/android/server/am/ContentProviderRecord;->canRunHere(Lcom/android/server/am/ProcessRecord;)Z

    move-result v4

    if-eqz v4, :cond_1b1

    .line 7542
    monitor-exit p0

    move-object v4, v14

    goto/16 :goto_71

    .line 7554
    :cond_1b1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v11

    .line 7556
    .local v11, N:I
    const/16 v17, 0x0

    .local v17, i:I
    :goto_1bc
    move/from16 v0, v17

    move v1, v11

    if-ge v0, v1, :cond_1cf

    .line 7557
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move/from16 v1, v17

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    if-ne v4, v14, :cond_234

    .line 7572
    :cond_1cf
    move/from16 v0, v17

    move v1, v11

    if-lt v0, v1, :cond_247

    .line 7573
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v18

    .line 7574
    .restart local v18       #origId:J
    iget-object v5, v13, Landroid/content/pm/ProviderInfo;->processName:Ljava/lang/String;

    iget-object v6, v14, Lcom/android/server/am/ContentProviderRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    const/4 v7, 0x0

    const/4 v8, 0x0

    const-string v9, "content provider"

    new-instance v10, Landroid/content/ComponentName;

    iget-object v4, v13, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v4, v4, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v11, v13, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    .end local v11           #N:I
    invoke-direct {v10, v4, v11}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    move-object/from16 v4, p0

    invoke-direct/range {v4 .. v10}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;)Lcom/android/server/am/ProcessRecord;

    move-result-object v20

    .line 7578
    .local v20, proc:Lcom/android/server/am/ProcessRecord;
    if-nez v20, :cond_237

    .line 7579
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unable to launch app "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v13, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "/"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v13, Landroid/content/pm/ProviderInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " for provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ": process is bad"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 7583
    const/4 v4, 0x0

    monitor-exit p0

    goto/16 :goto_71

    .line 7556
    .end local v18           #origId:J
    .end local v20           #proc:Lcom/android/server/am/ProcessRecord;
    .restart local v11       #N:I
    :cond_234
    add-int/lit8 v17, v17, 0x1

    goto :goto_1bc

    .line 7585
    .end local v11           #N:I
    .restart local v18       #origId:J
    .restart local v20       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_237
    move-object/from16 v0, v20

    move-object v1, v14

    iput-object v0, v1, Lcom/android/server/am/ContentProviderRecord;->launchingApp:Lcom/android/server/am/ProcessRecord;

    .line 7586
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4, v14}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 7587
    invoke-static/range {v18 .. v19}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7592
    .end local v18           #origId:J
    .end local v20           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_247
    if-eqz v16, :cond_253

    .line 7593
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    move-object v4, v0

    iget-object v5, v13, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v4, v5, v14}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7595
    :cond_253
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p2

    move-object v2, v14

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7597
    if-eqz v21, :cond_273

    .line 7598
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashSet;

    move-object v4, v0

    invoke-virtual {v4, v14}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 7599
    iget-object v4, v14, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    move-object v0, v4

    move-object/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    goto/16 :goto_b2

    .line 7601
    :cond_273
    iget v4, v14, Lcom/android/server/am/ContentProviderRecord;->externals:I

    add-int/lit8 v4, v4, 0x1

    iput v4, v14, Lcom/android/server/am/ContentProviderRecord;->externals:I
    :try_end_279
    .catchall {:try_start_1a4 .. :try_end_279} :catchall_43

    goto/16 :goto_b2

    .line 7620
    .end local v16           #firstClass:Z
    .end local v17           #i:I
    :cond_27b
    :try_start_27b
    invoke-virtual {v14}, Ljava/lang/Object;->wait()V
    :try_end_27e
    .catchall {:try_start_27b .. :try_end_27e} :catchall_11a
    .catch Ljava/lang/InterruptedException; {:try_start_27b .. :try_end_27e} :catch_280

    goto/16 :goto_b4

    .line 7621
    :catch_280
    move-exception v4

    goto/16 :goto_b4

    .line 7624
    :cond_283
    :try_start_283
    monitor-exit v14
    :try_end_284
    .catchall {:try_start_283 .. :try_end_284} :catchall_11a

    move-object v4, v14

    .line 7625
    goto/16 :goto_71

    .line 7532
    .restart local v16       #firstClass:Z
    :catch_287
    move-exception v4

    goto/16 :goto_1a2

    .line 7505
    .end local v16           #firstClass:Z
    :catch_28a
    move-exception v4

    goto/16 :goto_132
.end method

.method private getErrorReportReceiver(Lcom/android/server/am/ProcessRecord;)Landroid/content/ComponentName;
    .registers 9
    .parameter "app"

    .prologue
    const/4 v6, 0x0

    .line 8398
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v3

    .line 8402
    .local v3, pm:Landroid/content/pm/IPackageManager;
    :try_start_5
    iget-object v4, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v4, v4, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-interface {v3, v4}, Landroid/content/pm/IPackageManager;->getInstallerPackageName(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    .line 8403
    .local v1, installerPackageName:Ljava/lang/String;
    if-nez v1, :cond_11

    move-object v4, v6

    .line 8419
    .end local v1           #installerPackageName:Ljava/lang/String;
    :goto_10
    return-object v4

    .line 8408
    .restart local v1       #installerPackageName:Ljava/lang/String;
    :cond_11
    new-instance v2, Landroid/content/Intent;

    const-string v4, "android.intent.action.APP_ERROR"

    invoke-direct {v2, v4}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 8409
    .local v2, intent:Landroid/content/Intent;
    invoke-virtual {v2, v1}, Landroid/content/Intent;->setPackage(Ljava/lang/String;)Landroid/content/Intent;

    .line 8410
    const/4 v4, 0x0

    const/4 v5, 0x0

    invoke-interface {v3, v2, v4, v5}, Landroid/content/pm/IPackageManager;->resolveIntent(Landroid/content/Intent;Ljava/lang/String;I)Landroid/content/pm/ResolveInfo;

    move-result-object v0

    .line 8411
    .local v0, info:Landroid/content/pm/ResolveInfo;
    if-eqz v0, :cond_27

    iget-object v4, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    if-nez v4, :cond_29

    :cond_27
    move-object v4, v6

    .line 8412
    goto :goto_10

    .line 8415
    :cond_29
    new-instance v4, Landroid/content/ComponentName;

    iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v1, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_32
    .catch Landroid/os/RemoteException; {:try_start_5 .. :try_end_32} :catch_33

    goto :goto_10

    .line 8416
    .end local v0           #info:Landroid/content/pm/ResolveInfo;
    .end local v1           #installerPackageName:Ljava/lang/String;
    .end local v2           #intent:Landroid/content/Intent;
    :catch_33
    move-exception v4

    move-object v4, v6

    .line 8419
    goto :goto_10
.end method

.method private final getLRURecordIndexForAppLocked(Landroid/app/IApplicationThread;)I
    .registers 7
    .parameter "thread"

    .prologue
    .line 4451
    invoke-interface {p1}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v3

    .line 4454
    .local v3, threadBinder:Landroid/os/IBinder;
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 4456
    .local v0, count:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_b
    if-ge v1, v0, :cond_26

    .line 4457
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 4458
    .local v2, rec:Lcom/android/server/am/ProcessRecord;
    iget-object v4, v2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v4, :cond_23

    iget-object v4, v2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v4}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v4

    if-ne v4, v3, :cond_23

    move v4, v1

    .line 4462
    .end local v2           #rec:Lcom/android/server/am/ProcessRecord;
    :goto_22
    return v4

    .line 4456
    .restart local v2       #rec:Lcom/android/server/am/ProcessRecord;
    :cond_23
    add-int/lit8 v1, v1, 0x1

    goto :goto_b

    .line 4462
    .end local v2           #rec:Lcom/android/server/am/ProcessRecord;
    :cond_26
    const/4 v4, -0x1

    goto :goto_22
.end method

.method private final getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;
    .registers 6
    .parameter "processName"
    .parameter "uid"

    .prologue
    .line 1699
    const/16 v2, 0x3e8

    if-ne p2, v2, :cond_1d

    .line 1703
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v2}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v2

    invoke-virtual {v2, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/util/SparseArray;

    .line 1705
    .local v1, procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    if-eqz v1, :cond_1b

    const/4 v2, 0x0

    invoke-virtual {v1, v2}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object p0

    .end local p0
    check-cast p0, Lcom/android/server/am/ProcessRecord;

    move-object v2, p0

    .line 1708
    .end local v1           #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    :goto_1a
    return-object v2

    .line 1705
    .restart local v1       #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .restart local p0
    :cond_1b
    const/4 v2, 0x0

    goto :goto_1a

    .line 1707
    .end local v1           #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    :cond_1d
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v2, p1, p2}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    .local v0, proc:Lcom/android/server/am/ProcessRecord;
    move-object v2, v0

    .line 1708
    goto :goto_1a
.end method

.method private final getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;
    .registers 4
    .parameter "thread"

    .prologue
    const/4 v1, 0x0

    .line 4467
    if-nez p1, :cond_4

    .line 4472
    .end local p0
    :cond_3
    :goto_3
    return-object v1

    .line 4471
    .restart local p0
    :cond_4
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getLRURecordIndexForAppLocked(Landroid/app/IApplicationThread;)I

    move-result v0

    .line 4472
    .local v0, appIndex:I
    if-ltz v0, :cond_3

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p0

    .end local p0
    check-cast p0, Lcom/android/server/am/ProcessRecord;

    move-object v1, p0

    goto :goto_3
.end method

.method private final getStickies(Ljava/lang/String;Landroid/content/IntentFilter;Ljava/util/List;)Ljava/util/List;
    .registers 12
    .parameter "action"
    .parameter "filter"
    .parameter "cur"

    .prologue
    .line 11029
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v6}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v5

    .line 11030
    .local v5, resolver:Landroid/content/ContentResolver;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    invoke-virtual {v6, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Ljava/util/ArrayList;

    .line 11031
    .local v4, list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    if-nez v4, :cond_12

    move-object v1, p3

    .line 11044
    .end local p3
    .local v1, cur:Ljava/util/List;
    :goto_11
    return-object v1

    .line 11034
    .end local v1           #cur:Ljava/util/List;
    .restart local p3
    :cond_12
    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 11035
    .local v0, N:I
    const/4 v2, 0x0

    .local v2, i:I
    :goto_17
    if-ge v2, v0, :cond_35

    .line 11036
    invoke-virtual {v4, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/Intent;

    .line 11037
    .local v3, intent:Landroid/content/Intent;
    const/4 v6, 0x1

    const-string v7, "ActivityManager"

    invoke-virtual {p2, v5, v3, v6, v7}, Landroid/content/IntentFilter;->match(Landroid/content/ContentResolver;Landroid/content/Intent;ZLjava/lang/String;)I

    move-result v6

    if-ltz v6, :cond_32

    .line 11038
    if-nez p3, :cond_2f

    .line 11039
    new-instance p3, Ljava/util/ArrayList;

    .end local p3
    invoke-direct {p3}, Ljava/util/ArrayList;-><init>()V

    .line 11041
    .restart local p3
    :cond_2f
    invoke-interface {p3, v3}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 11035
    :cond_32
    add-int/lit8 v2, v2, 0x1

    goto :goto_17

    .end local v3           #intent:Landroid/content/Intent;
    :cond_35
    move-object v1, p3

    .line 11044
    .end local p3
    .restart local v1       #cur:Ljava/util/List;
    goto :goto_11
.end method

.method private grantUriPermissionFromIntentLocked(ILjava/lang/String;Landroid/content/Intent;Lcom/android/server/am/HistoryRecord;)V
    .registers 11
    .parameter "callingUid"
    .parameter "targetPkg"
    .parameter "intent"
    .parameter "activity"

    .prologue
    .line 6237
    if-nez p3, :cond_3

    .line 6246
    :cond_2
    :goto_2
    return-void

    .line 6240
    :cond_3
    invoke-virtual {p3}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v3

    .line 6241
    .local v3, data:Landroid/net/Uri;
    if-eqz v3, :cond_2

    .line 6244
    invoke-virtual {p3}, Landroid/content/Intent;->getFlags()I

    move-result v4

    move-object v0, p0

    move v1, p1

    move-object v2, p2

    move-object v5, p4

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionLocked(ILjava/lang/String;Landroid/net/Uri;ILcom/android/server/am/HistoryRecord;)V

    goto :goto_2
.end method

.method private grantUriPermissionLocked(ILjava/lang/String;Landroid/net/Uri;ILcom/android/server/am/HistoryRecord;)V
    .registers 25
    .parameter "callingUid"
    .parameter "targetPkg"
    .parameter "uri"
    .parameter "modeFlags"
    .parameter "activity"

    .prologue
    .line 6112
    and-int/lit8 p4, p4, 0x3

    .line 6114
    if-nez p4, :cond_5

    .line 6233
    :cond_4
    :goto_4
    return-void

    .line 6118
    :cond_5
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v13

    .line 6121
    .local v13, pm:Landroid/content/pm/IPackageManager;
    const-string v16, "content"

    invoke-virtual/range {p3 .. p3}, Landroid/net/Uri;->getScheme()Ljava/lang/String;

    move-result-object v17

    invoke-virtual/range {v16 .. v17}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v16

    if-eqz v16, :cond_4

    .line 6125
    invoke-virtual/range {p3 .. p3}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v10

    .line 6126
    .local v10, name:Ljava/lang/String;
    const/4 v12, 0x0

    .line 6127
    .local v12, pi:Landroid/content/pm/ProviderInfo;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object v1, v10

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ContentProviderRecord;

    .line 6129
    .local v7, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v7, :cond_4b

    .line 6130
    iget-object v12, v7, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    .line 6138
    :goto_2d
    if-nez v12, :cond_56

    .line 6139
    const-string v16, "ActivityManager"

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "No content provider found for: "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object v1, v10

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-static/range {v16 .. v17}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_4

    .line 6133
    :cond_4b
    const/16 v16, 0x800

    :try_start_4d
    move-object v0, v13

    move-object v1, v10

    move/from16 v2, v16

    invoke-interface {v0, v1, v2}, Landroid/content/pm/IPackageManager;->resolveContentProvider(Ljava/lang/String;I)Landroid/content/pm/ProviderInfo;
    :try_end_54
    .catch Landroid/os/RemoteException; {:try_start_4d .. :try_end_54} :catch_236

    move-result-object v12

    goto :goto_2d

    .line 6145
    :cond_56
    :try_start_56
    move-object v0, v13

    move-object/from16 v1, p2

    invoke-interface {v0, v1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I
    :try_end_5c
    .catch Landroid/os/RemoteException; {:try_start_56 .. :try_end_5c} :catch_c1

    move-result v14

    .line 6146
    .local v14, targetUid:I
    if-ltz v14, :cond_4

    .line 6154
    move-object/from16 v0, p0

    move-object v1, v13

    move-object v2, v12

    move v3, v14

    move/from16 v4, p4

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkHoldingPermissionsLocked(Landroid/content/pm/IPackageManager;Landroid/content/pm/ProviderInfo;II)Z

    move-result v16

    if-nez v16, :cond_4

    .line 6161
    move-object/from16 v0, p0

    move-object/from16 v1, p3

    move v2, v14

    move/from16 v3, p4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkUriPermissionLocked(Landroid/net/Uri;II)Z

    move-result v16

    if-nez v16, :cond_4

    .line 6167
    move-object v0, v12

    iget-boolean v0, v0, Landroid/content/pm/ProviderInfo;->grantUriPermissions:Z

    move/from16 v16, v0

    if-nez v16, :cond_c4

    .line 6168
    new-instance v16, Ljava/lang/SecurityException;

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "Provider "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->packageName:Ljava/lang/String;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, "/"

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, " does not allow granting of Uri permissions (uri "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, ")"

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-direct/range {v16 .. v17}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v16

    .line 6149
    .end local v14           #targetUid:I
    :catch_c1
    move-exception v8

    .line 6150
    .local v8, ex:Landroid/os/RemoteException;
    goto/16 :goto_4

    .line 6173
    .end local v8           #ex:Landroid/os/RemoteException;
    .restart local v14       #targetUid:I
    :cond_c4
    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->uriPermissionPatterns:[Landroid/os/PatternMatcher;

    move-object/from16 v16, v0

    if-eqz v16, :cond_133

    .line 6174
    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->uriPermissionPatterns:[Landroid/os/PatternMatcher;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    array-length v0, v0

    move v5, v0

    .line 6175
    .local v5, N:I
    const/4 v6, 0x0

    .line 6176
    .local v6, allowed:Z
    const/4 v9, 0x0

    .local v9, i:I
    :goto_d6
    if-ge v9, v5, :cond_f3

    .line 6177
    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->uriPermissionPatterns:[Landroid/os/PatternMatcher;

    move-object/from16 v16, v0

    aget-object v16, v16, v9

    if-eqz v16, :cond_130

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->uriPermissionPatterns:[Landroid/os/PatternMatcher;

    move-object/from16 v16, v0

    aget-object v16, v16, v9

    invoke-virtual/range {p3 .. p3}, Landroid/net/Uri;->getPath()Ljava/lang/String;

    move-result-object v17

    invoke-virtual/range {v16 .. v17}, Landroid/os/PatternMatcher;->match(Ljava/lang/String;)Z

    move-result v16

    if-eqz v16, :cond_130

    .line 6179
    const/4 v6, 0x1

    .line 6183
    :cond_f3
    if-nez v6, :cond_133

    .line 6184
    new-instance v16, Ljava/lang/SecurityException;

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "Provider "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->packageName:Ljava/lang/String;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, "/"

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v12

    iget-object v0, v0, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, " does not allow granting of permission to path of Uri "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-direct/range {v16 .. v17}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v16

    .line 6176
    :cond_130
    add-int/lit8 v9, v9, 0x1

    goto :goto_d6

    .line 6193
    .end local v5           #N:I
    .end local v6           #allowed:Z
    .end local v9           #i:I
    :cond_133
    move-object/from16 v0, p0

    move-object v1, v13

    move-object v2, v12

    move/from16 v3, p1

    move/from16 v4, p4

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkHoldingPermissionsLocked(Landroid/content/pm/IPackageManager;Landroid/content/pm/ProviderInfo;II)Z

    move-result v16

    if-nez v16, :cond_17a

    .line 6194
    move-object/from16 v0, p0

    move-object/from16 v1, p3

    move/from16 v2, p1

    move/from16 v3, p4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkUriPermissionLocked(Landroid/net/Uri;II)Z

    move-result v16

    if-nez v16, :cond_17a

    .line 6195
    new-instance v16, Ljava/lang/SecurityException;

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "Uid "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, " does not have permission to uri "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-direct/range {v16 .. v17}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v16

    .line 6204
    :cond_17a
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move v1, v14

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Ljava/util/HashMap;

    .line 6206
    .local v15, targetUris:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    if-nez v15, :cond_19d

    .line 6207
    new-instance v15, Ljava/util/HashMap;

    .end local v15           #targetUris:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    invoke-direct {v15}, Ljava/util/HashMap;-><init>()V

    .line 6208
    .restart local v15       #targetUris:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move v1, v14

    move-object v2, v15

    invoke-virtual {v0, v1, v2}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 6211
    :cond_19d
    move-object v0, v15

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/am/UriPermission;

    .line 6212
    .local v11, perm:Lcom/android/server/am/UriPermission;
    if-nez v11, :cond_1b8

    .line 6213
    new-instance v11, Lcom/android/server/am/UriPermission;

    .end local v11           #perm:Lcom/android/server/am/UriPermission;
    move-object v0, v11

    move v1, v14

    move-object/from16 v2, p3

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/UriPermission;-><init>(ILandroid/net/Uri;)V

    .line 6214
    .restart local v11       #perm:Lcom/android/server/am/UriPermission;
    move-object v0, v15

    move-object/from16 v1, p3

    move-object v2, v11

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 6217
    :cond_1b8
    move-object v0, v11

    iget v0, v0, Lcom/android/server/am/UriPermission;->modeFlags:I

    move/from16 v16, v0

    or-int v16, v16, p4

    move/from16 v0, v16

    move-object v1, v11

    iput v0, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    .line 6218
    if-nez p5, :cond_1d4

    .line 6219
    move-object v0, v11

    iget v0, v0, Lcom/android/server/am/UriPermission;->globalModeFlags:I

    move/from16 v16, v0

    or-int v16, v16, p4

    move/from16 v0, v16

    move-object v1, v11

    iput v0, v1, Lcom/android/server/am/UriPermission;->globalModeFlags:I

    goto/16 :goto_4

    .line 6220
    :cond_1d4
    and-int/lit8 v16, p4, 0x1

    if-eqz v16, :cond_205

    .line 6221
    move-object v0, v11

    iget-object v0, v0, Lcom/android/server/am/UriPermission;->readActivities:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object/from16 v1, p5

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 6222
    move-object/from16 v0, p5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    move-object/from16 v16, v0

    if-nez v16, :cond_1f7

    .line 6223
    new-instance v16, Ljava/util/HashSet;

    invoke-direct/range {v16 .. v16}, Ljava/util/HashSet;-><init>()V

    move-object/from16 v0, v16

    move-object/from16 v1, p5

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    .line 6225
    :cond_1f7
    move-object/from16 v0, p5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object v1, v11

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    goto/16 :goto_4

    .line 6226
    :cond_205
    and-int/lit8 v16, p4, 0x2

    if-eqz v16, :cond_4

    .line 6227
    move-object v0, v11

    iget-object v0, v0, Lcom/android/server/am/UriPermission;->writeActivities:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object/from16 v1, p5

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 6228
    move-object/from16 v0, p5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    move-object/from16 v16, v0

    if-nez v16, :cond_228

    .line 6229
    new-instance v16, Ljava/util/HashSet;

    invoke-direct/range {v16 .. v16}, Ljava/util/HashSet;-><init>()V

    move-object/from16 v0, v16

    move-object/from16 v1, p5

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    .line 6231
    :cond_228
    move-object/from16 v0, p5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object v1, v11

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    goto/16 :goto_4

    .line 6135
    .end local v11           #perm:Lcom/android/server/am/UriPermission;
    .end local v14           #targetUid:I
    .end local v15           #targetUris:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    :catch_236
    move-exception v16

    goto/16 :goto_2d
.end method

.method private final handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V
    .registers 13
    .parameter "app"
    .parameter "restarting"

    .prologue
    const/4 v9, 0x0

    const/4 v8, 0x0

    .line 4359
    const/4 v5, -0x1

    invoke-direct {p0, p1, p2, v5}, Lcom/android/server/am/ActivityManagerService;->cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V

    .line 4360
    if-nez p2, :cond_d

    .line 4361
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v5, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4365
    :cond_d
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_19

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    iget-object v5, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v5, p1, :cond_19

    .line 4367
    iput-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 4369
    :cond_19
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_25

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    iget-object v5, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v5, p1, :cond_25

    .line 4370
    iput-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    .line 4374
    :cond_25
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-static {v5, p1}, Lcom/android/server/am/ActivityManagerService;->removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V

    .line 4375
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-static {v5, p1}, Lcom/android/server/am/ActivityManagerService;->removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V

    .line 4376
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-static {v5, p1}, Lcom/android/server/am/ActivityManagerService;->removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V

    .line 4377
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    invoke-static {v5, p1}, Lcom/android/server/am/ActivityManagerService;->removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V

    .line 4379
    const/4 v0, 0x1

    .line 4380
    .local v0, atTop:Z
    const/4 v1, 0x0

    .line 4383
    .local v1, hasVisibleActivities:Z
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v2

    .line 4386
    .local v2, i:I
    :goto_41
    if-lez v2, :cond_86

    .line 4387
    add-int/lit8 v2, v2, -0x1

    .line 4388
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 4391
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v5, p1, :cond_74

    .line 4392
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->haveState:Z

    if-nez v5, :cond_59

    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->stateNotNeeded:Z

    if-eqz v5, :cond_5d

    :cond_59
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v5, :cond_76

    .line 4396
    :cond_5d
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v2}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 4398
    iput-boolean v9, v4, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    .line 4399
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v5, v4}, Lcom/android/server/WindowManagerService;->removeAppToken(Landroid/os/IBinder;)V

    .line 4403
    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->removeActivityUriPermissionsLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4420
    :cond_6c
    :goto_6c
    const/4 v5, 0x1

    invoke-direct {p0, v4, v5}, Lcom/android/server/am/ActivityManagerService;->cleanUpActivityLocked(Lcom/android/server/am/HistoryRecord;Z)V

    .line 4421
    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v5, v4, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4423
    :cond_74
    const/4 v0, 0x0

    .line 4424
    goto :goto_41

    .line 4410
    :cond_76
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-eqz v5, :cond_7b

    .line 4411
    const/4 v1, 0x1

    .line 4413
    :cond_7b
    iput-object v8, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 4414
    iput-boolean v9, v4, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    .line 4415
    iget-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->haveState:Z

    if-nez v5, :cond_6c

    .line 4416
    iput-object v8, v4, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    goto :goto_6c

    .line 4426
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :cond_86
    iget-object v5, p1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->clear()V

    .line 4428
    iget-object v5, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    if-eqz v5, :cond_c4

    .line 4429
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Crash of app "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " running instrumentation "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4431
    new-instance v3, Landroid/os/Bundle;

    invoke-direct {v3}, Landroid/os/Bundle;-><init>()V

    .line 4432
    .local v3, info:Landroid/os/Bundle;
    const-string v5, "shortMsg"

    const-string v6, "Process crashed."

    invoke-virtual {v3, v5, v6}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 4433
    invoke-virtual {p0, p1, v9, v3}, Lcom/android/server/am/ActivityManagerService;->finishInstrumentationLocked(Lcom/android/server/am/ProcessRecord;ILandroid/os/Bundle;)V

    .line 4436
    .end local v3           #info:Landroid/os/Bundle;
    :cond_c4
    if-nez p2, :cond_d1

    .line 4437
    invoke-direct {p0, v8}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    move-result v5

    if-nez v5, :cond_d1

    .line 4443
    if-eqz v1, :cond_d1

    .line 4444
    invoke-direct {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V

    .line 4448
    :cond_d1
    return-void
.end method

.method private final indexOfTokenLocked(Landroid/os/IBinder;)I
    .registers 9
    .parameter "token"

    .prologue
    .line 9477
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v1

    .line 9480
    .local v1, count:I
    const/4 v5, 0x0

    .line 9481
    .local v5, r:Lcom/android/server/am/HistoryRecord;
    const/4 v3, -0x1

    .line 9482
    .local v3, index:I
    const/4 v6, 0x1

    sub-int v2, v1, v6

    .local v2, i:I
    :goto_b
    if-ltz v2, :cond_1a

    .line 9483
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    .line 9484
    .local v4, o:Ljava/lang/Object;
    if-ne v4, p1, :cond_1b

    .line 9485
    move-object v0, v4

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    .line 9486
    move v3, v2

    .line 9491
    .end local v4           #o:Ljava/lang/Object;
    :cond_1a
    return v3

    .line 9482
    .restart local v4       #o:Ljava/lang/Object;
    :cond_1b
    add-int/lit8 v2, v2, -0x1

    goto :goto_b
.end method

.method public static final installSystemProviders()V
    .registers 5

    .prologue
    .line 7752
    sget-object v2, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v2, v2, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    const-string v3, "system"

    const/16 v4, 0x3e8

    invoke-virtual {v2, v3, v4}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    .line 7753
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    sget-object v2, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    invoke-direct {v2, v0}, Lcom/android/server/am/ActivityManagerService;->generateApplicationProvidersLocked(Lcom/android/server/am/ProcessRecord;)Ljava/util/List;

    move-result-object v1

    .line 7754
    .local v1, providers:Ljava/util/List;
    sget-object v2, Lcom/android/server/am/ActivityManagerService;->mSystemThread:Landroid/app/ActivityThread;

    invoke-virtual {v2, v1}, Landroid/app/ActivityThread;->installSystemProviders(Ljava/util/List;)V

    .line 7755
    return-void
.end method

.method private isNextTransitionForward()Z
    .registers 3

    .prologue
    .line 1722
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v1}, Lcom/android/server/WindowManagerService;->getPendingAppTransition()I

    move-result v0

    .line 1723
    .local v0, transit:I
    const/4 v1, 0x6

    if-eq v0, v1, :cond_11

    const/16 v1, 0x8

    if-eq v0, v1, :cond_11

    const/16 v1, 0xa

    if-ne v0, v1, :cond_13

    :cond_11
    const/4 v1, 0x1

    :goto_12
    return v1

    :cond_13
    const/4 v1, 0x0

    goto :goto_12
.end method

.method private final killServicesLocked(Lcom/android/server/am/ProcessRecord;Z)V
    .registers 14
    .parameter "app"
    .parameter "allowRestart"

    .prologue
    .line 9526
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->size()I

    move-result v7

    if-lez v7, :cond_1f

    .line 9527
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v4

    .line 9528
    .local v4, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :goto_e
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_1f

    .line 9529
    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ConnectionRecord;

    .line 9530
    .local v5, r:Lcom/android/server/am/ConnectionRecord;
    const/4 v7, 0x0

    invoke-direct {p0, v5, p1, v7}, Lcom/android/server/am/ActivityManagerService;->removeConnectionLocked(Lcom/android/server/am/ConnectionRecord;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;)V

    goto :goto_e

    .line 9533
    .end local v4           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    .end local v5           #r:Lcom/android/server/am/ConnectionRecord;
    :cond_1f
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->clear()V

    .line 9535
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->size()I

    move-result v7

    if-eqz v7, :cond_e4

    .line 9538
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .line 9539
    .local v3, it:Ljava/util/Iterator;
    :goto_32
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_dd

    .line 9540
    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/am/ServiceRecord;

    .line 9541
    .local v6, sr:Lcom/android/server/am/ServiceRecord;
    iget-object v7, v6, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v7}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v7

    monitor-enter v7

    .line 9542
    :try_start_45
    iget-object v8, v6, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v8}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->stopLaunchedLocked()V

    .line 9543
    monitor-exit v7
    :try_end_4b
    .catchall {:try_start_45 .. :try_end_4b} :catchall_7f

    .line 9544
    const/4 v7, 0x0

    iput-object v7, v6, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 9545
    const/4 v7, 0x0

    iput v7, v6, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    .line 9546
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v7, v6}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 9547
    iget-object v7, v6, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->size()I

    move-result v7

    if-lez v7, :cond_82

    .line 9548
    iget-object v7, v6, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v7

    invoke-interface {v7}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .line 9550
    .local v1, bindings:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    :goto_68
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_82

    .line 9551
    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/IntentBindRecord;

    .line 9554
    .local v0, b:Lcom/android/server/am/IntentBindRecord;
    const/4 v7, 0x0

    iput-object v7, v0, Lcom/android/server/am/IntentBindRecord;->binder:Landroid/os/IBinder;

    .line 9555
    const/4 v7, 0x0

    iput-boolean v7, v0, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    iput-boolean v7, v0, Lcom/android/server/am/IntentBindRecord;->received:Z

    iput-boolean v7, v0, Lcom/android/server/am/IntentBindRecord;->requested:Z

    goto :goto_68

    .line 9543
    .end local v0           #b:Lcom/android/server/am/IntentBindRecord;
    .end local v1           #bindings:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    :catchall_7f
    move-exception v8

    :try_start_80
    monitor-exit v7
    :try_end_81
    .catchall {:try_start_80 .. :try_end_81} :catchall_7f

    throw v8

    .line 9559
    :cond_82
    iget v7, v6, Lcom/android/server/am/ServiceRecord;->crashCount:I

    const/4 v8, 0x2

    if-lt v7, v8, :cond_d0

    .line 9560
    const-string v7, "ActivityManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Service crashed "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    iget v9, v6, Lcom/android/server/am/ServiceRecord;->crashCount:I

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, " times, stopping: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v7, v8}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9562
    const/16 v7, 0x7552

    const/4 v8, 0x3

    new-array v8, v8, [Ljava/lang/Object;

    const/4 v9, 0x0

    iget v10, v6, Lcom/android/server/am/ServiceRecord;->crashCount:I

    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v10

    aput-object v10, v8, v9

    const/4 v9, 0x1

    iget-object v10, v6, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    aput-object v10, v8, v9

    const/4 v9, 0x2

    iget v10, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v10

    aput-object v10, v8, v9

    invoke-static {v7, v8}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 9564
    const/4 v7, 0x1

    invoke-direct {p0, v6, v7}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto/16 :goto_32

    .line 9565
    :cond_d0
    if-nez p2, :cond_d8

    .line 9566
    const/4 v7, 0x1

    invoke-direct {p0, v6, v7}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto/16 :goto_32

    .line 9568
    :cond_d8
    invoke-direct {p0, v6}, Lcom/android/server/am/ActivityManagerService;->scheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)V

    goto/16 :goto_32

    .line 9572
    .end local v6           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_dd
    if-nez p2, :cond_e4

    .line 9573
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->clear()V

    .line 9578
    .end local v3           #it:Ljava/util/Iterator;
    :cond_e4
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v2

    .line 9579
    .local v2, i:I
    :cond_ea
    :goto_ea
    if-lez v2, :cond_100

    .line 9580
    add-int/lit8 v2, v2, -0x1

    .line 9581
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v7, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/am/ServiceRecord;

    .line 9582
    .restart local v6       #sr:Lcom/android/server/am/ServiceRecord;
    iget-object v7, v6, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v7, p1, :cond_ea

    .line 9583
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v7, v2}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    goto :goto_ea

    .line 9587
    .end local v6           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_100
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v7}, Ljava/util/HashSet;->clear()V

    .line 9588
    return-void
.end method

.method private final logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V
    .registers 13
    .parameter "r"

    .prologue
    const/4 v10, 0x4

    const/4 v9, 0x3

    const/4 v8, 0x2

    const/4 v7, 0x0

    const/4 v6, 0x1

    .line 11614
    iget v3, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    if-lez v3, :cond_72

    .line 11615
    iget-object v3, p1, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    iget v4, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    sub-int/2addr v4, v6

    invoke-interface {v3, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    .line 11616
    .local v2, curReceiver:Ljava/lang/Object;
    instance-of v3, v2, Lcom/android/server/am/BroadcastFilter;

    if-eqz v3, :cond_47

    .line 11617
    move-object v0, v2

    check-cast v0, Lcom/android/server/am/BroadcastFilter;

    move-object v1, v0

    .line 11618
    .local v1, bf:Lcom/android/server/am/BroadcastFilter;
    const/16 v3, 0x7548

    new-array v4, v10, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v7

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v5

    aput-object v5, v4, v6

    iget v5, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    sub-int/2addr v5, v6

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v8

    invoke-static {v1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v9

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 11639
    .end local v1           #bf:Lcom/android/server/am/BroadcastFilter;
    .end local v2           #curReceiver:Ljava/lang/Object;
    :goto_46
    return-void

    .line 11624
    .restart local v2       #curReceiver:Ljava/lang/Object;
    :cond_47
    const/16 v3, 0x7549

    new-array v4, v10, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v7

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v5

    aput-object v5, v4, v6

    iget v5, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    sub-int/2addr v5, v6

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v8

    check-cast v2, Landroid/content/pm/ResolveInfo;

    .end local v2           #curReceiver:Ljava/lang/Object;
    invoke-virtual {v2}, Landroid/content/pm/ResolveInfo;->toString()Ljava/lang/String;

    move-result-object v5

    aput-object v5, v4, v9

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    goto :goto_46

    .line 11631
    :cond_72
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Discarding broadcast before first receiver is invoked: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11633
    const/16 v3, 0x7549

    new-array v4, v10, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v7

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v5

    aput-object v5, v4, v6

    iget v5, p1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v4, v8

    const-string v5, "NONE"

    aput-object v5, v4, v9

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    goto :goto_46
.end method

.method private final logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V
    .registers 7
    .parameter "tag"
    .parameter "r"
    .parameter "task"

    .prologue
    .line 3056
    const/4 v0, 0x7

    new-array v0, v0, [Ljava/lang/Object;

    const/4 v1, 0x0

    invoke-static {p2}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v2

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x1

    iget v2, p3, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x2

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v2, v0, v1

    const/4 v1, 0x3

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x4

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getType()Ljava/lang/String;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x5

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getDataString()Ljava/lang/String;

    move-result-object v2

    aput-object v2, v0, v1

    const/4 v1, 0x6

    iget-object v2, p2, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getFlags()I

    move-result v2

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    aput-object v2, v0, v1

    invoke-static {p1, v0}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 3061
    return-void
.end method

.method public static final main(I)Landroid/content/Context;
    .registers 9
    .parameter "factoryTest"

    .prologue
    const/4 v6, 0x1

    const/4 v7, 0x0

    .line 1241
    new-instance v4, Lcom/android/server/am/ActivityManagerService$AThread;

    invoke-direct {v4}, Lcom/android/server/am/ActivityManagerService$AThread;-><init>()V

    .line 1242
    .local v4, thr:Lcom/android/server/am/ActivityManagerService$AThread;
    invoke-virtual {v4}, Lcom/android/server/am/ActivityManagerService$AThread;->start()V

    .line 1244
    monitor-enter v4

    .line 1245
    :goto_b
    :try_start_b
    iget-object v5, v4, Lcom/android/server/am/ActivityManagerService$AThread;->mService:Lcom/android/server/am/ActivityManagerService;
    :try_end_d
    .catchall {:try_start_b .. :try_end_d} :catchall_5c

    if-nez v5, :cond_15

    .line 1247
    :try_start_f
    invoke-virtual {v4}, Ljava/lang/Object;->wait()V
    :try_end_12
    .catchall {:try_start_f .. :try_end_12} :catchall_5c
    .catch Ljava/lang/InterruptedException; {:try_start_f .. :try_end_12} :catch_13

    goto :goto_b

    .line 1248
    :catch_13
    move-exception v5

    goto :goto_b

    .line 1251
    :cond_15
    :try_start_15
    monitor-exit v4
    :try_end_16
    .catchall {:try_start_15 .. :try_end_16} :catchall_5c

    .line 1253
    iget-object v2, v4, Lcom/android/server/am/ActivityManagerService$AThread;->mService:Lcom/android/server/am/ActivityManagerService;

    .line 1254
    .local v2, m:Lcom/android/server/am/ActivityManagerService;
    sput-object v2, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    .line 1255
    invoke-static {}, Landroid/app/ActivityThread;->systemMain()Landroid/app/ActivityThread;

    move-result-object v0

    .line 1256
    .local v0, at:Landroid/app/ActivityThread;
    sput-object v0, Lcom/android/server/am/ActivityManagerService;->mSystemThread:Landroid/app/ActivityThread;

    .line 1257
    invoke-virtual {v0}, Landroid/app/ActivityThread;->getSystemContext()Landroid/app/ApplicationContext;

    move-result-object v1

    .line 1258
    .local v1, context:Landroid/content/Context;
    iput-object v1, v2, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    .line 1259
    iput p0, v2, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    .line 1260
    const-string v5, "power"

    invoke-virtual {v1, v5}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/os/PowerManager;

    .line 1262
    .local v3, pm:Landroid/os/PowerManager;
    const-string v5, "ActivityManager-Sleep"

    invoke-virtual {v3, v6, v5}, Landroid/os/PowerManager;->newWakeLock(ILjava/lang/String;)Landroid/os/PowerManager$WakeLock;

    move-result-object v5

    iput-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    .line 1263
    const-string v5, "ActivityManager-Launch"

    invoke-virtual {v3, v6, v5}, Landroid/os/PowerManager;->newWakeLock(ILjava/lang/String;)Landroid/os/PowerManager$WakeLock;

    move-result-object v5

    iput-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    .line 1264
    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Landroid/os/PowerManager$WakeLock;->setReferenceCounted(Z)V

    .line 1266
    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v5, v1}, Lcom/android/server/am/BatteryStatsService;->publish(Landroid/content/Context;)V

    .line 1267
    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    invoke-virtual {v5, v1}, Lcom/android/server/am/UsageStatsService;->publish(Landroid/content/Context;)V

    .line 1269
    monitor-enter v4

    .line 1270
    const/4 v5, 0x1

    :try_start_52
    iput-boolean v5, v4, Lcom/android/server/am/ActivityManagerService$AThread;->mReady:Z

    .line 1271
    invoke-virtual {v4}, Ljava/lang/Object;->notifyAll()V

    .line 1272
    monitor-exit v4
    :try_end_58
    .catchall {:try_start_52 .. :try_end_58} :catchall_5f

    .line 1274
    invoke-virtual {v2, v7, v7, v7, v7}, Lcom/android/server/am/ActivityManagerService;->startRunning(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V

    .line 1276
    return-object v1

    .line 1251
    .end local v0           #at:Landroid/app/ActivityThread;
    .end local v1           #context:Landroid/content/Context;
    .end local v2           #m:Lcom/android/server/am/ActivityManagerService;
    .end local v3           #pm:Landroid/os/PowerManager;
    :catchall_5c
    move-exception v5

    :try_start_5d
    monitor-exit v4
    :try_end_5e
    .catchall {:try_start_5d .. :try_end_5e} :catchall_5c

    throw v5

    .line 1272
    .restart local v0       #at:Landroid/app/ActivityThread;
    .restart local v1       #context:Landroid/content/Context;
    .restart local v2       #m:Lcom/android/server/am/ActivityManagerService;
    .restart local v3       #pm:Landroid/os/PowerManager;
    :catchall_5f
    move-exception v5

    :try_start_60
    monitor-exit v4
    :try_end_61
    .catchall {:try_start_60 .. :try_end_61} :catchall_5f

    throw v5
.end method

.method private final moveActivityToFrontLocked(I)Lcom/android/server/am/HistoryRecord;
    .registers 8
    .parameter "where"

    .prologue
    const/4 v5, 0x1

    .line 3023
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v3, p1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    .line 3024
    .local v0, newTop:Lcom/android/server/am/HistoryRecord;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v2

    .line 3025
    .local v2, top:I
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    sub-int v4, v2, v5

    invoke-virtual {v3, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 3026
    .local v1, oldTop:Lcom/android/server/am/HistoryRecord;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v3, v2, v0}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 3027
    const/4 v3, 0x0

    iput-boolean v3, v1, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    .line 3028
    iput-boolean v5, v0, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    .line 3029
    return-object v0
.end method

.method private final moveTaskBackwardsLocked(I)V
    .registers 4
    .parameter "task"

    .prologue
    .line 7168
    const-string v0, "ActivityManager"

    const-string v1, "moveTaskBackwards not yet implemented!"

    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 7169
    return-void
.end method

.method private final moveTaskToBackLocked(I)Z
    .registers 15
    .parameter "task"

    .prologue
    const/4 v12, 0x0

    const/4 v11, 0x0

    .line 7091
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "moveTaskToBack: "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 7093
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->checkScreenIdle()V

    .line 7098
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    if-eqz v8, :cond_3f

    .line 7099
    invoke-direct {p0, v11, p1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Landroid/os/IBinder;I)Lcom/android/server/am/HistoryRecord;

    move-result-object v5

    .line 7100
    .local v5, next:Lcom/android/server/am/HistoryRecord;
    if-nez v5, :cond_2b

    .line 7101
    invoke-direct {p0, v11, v12}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Landroid/os/IBinder;I)Lcom/android/server/am/HistoryRecord;

    move-result-object v5

    .line 7103
    :cond_2b
    if-eqz v5, :cond_3f

    .line 7105
    const/4 v3, 0x1

    .line 7107
    .local v3, moveOK:Z
    :try_start_2e
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    iget-object v9, v5, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    invoke-interface {v8, v9}, Landroid/app/IActivityController;->activityResuming(Ljava/lang/String;)Z
    :try_end_35
    .catch Landroid/os/RemoteException; {:try_start_2e .. :try_end_35} :catch_3a

    move-result v3

    .line 7111
    :goto_36
    if-nez v3, :cond_3f

    move v8, v12

    .line 7149
    .end local v3           #moveOK:Z
    .end local v5           #next:Lcom/android/server/am/HistoryRecord;
    :goto_39
    return v8

    .line 7108
    .restart local v3       #moveOK:Z
    .restart local v5       #next:Lcom/android/server/am/HistoryRecord;
    :catch_3a
    move-exception v8

    move-object v2, v8

    .line 7109
    .local v2, e:Landroid/os/RemoteException;
    iput-object v11, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    goto :goto_36

    .line 7117
    .end local v2           #e:Landroid/os/RemoteException;
    .end local v3           #moveOK:Z
    .end local v5           #next:Lcom/android/server/am/HistoryRecord;
    :cond_3f
    new-instance v4, Ljava/util/ArrayList;

    invoke-direct {v4}, Ljava/util/ArrayList;-><init>()V

    .line 7121
    .local v4, moved:Ljava/util/ArrayList;
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/16 v9, 0xb

    invoke-virtual {v8, v9}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 7123
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7124
    .local v0, N:I
    const/4 v1, 0x0

    .line 7125
    .local v1, bottom:I
    const/4 v6, 0x0

    .line 7129
    .local v6, pos:I
    :goto_53
    if-ge v6, v0, :cond_75

    .line 7130
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v8, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/HistoryRecord;

    .line 7133
    .local v7, r:Lcom/android/server/am/HistoryRecord;
    iget-object v8, v7, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v8, v8, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v8, p1, :cond_72

    .line 7135
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v8, v6}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 7136
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v8, v1, v7}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 7137
    invoke-virtual {v4, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 7138
    add-int/lit8 v1, v1, 0x1

    .line 7140
    :cond_72
    add-int/lit8 v6, v6, 0x1

    .line 7141
    goto :goto_53

    .line 7143
    .end local v7           #r:Lcom/android/server/am/HistoryRecord;
    :cond_75
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v8, v4}, Lcom/android/server/WindowManagerService;->moveAppTokensToBottom(Ljava/util/List;)V

    .line 7148
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->finishTaskMove(I)V

    .line 7149
    const/4 v8, 0x1

    goto :goto_39
.end method

.method private final moveTaskToFrontLocked(Lcom/android/server/am/TaskRecord;)V
    .registers 11
    .parameter "tr"

    .prologue
    const/4 v8, 0x1

    .line 6988
    iget v4, p1, Lcom/android/server/am/TaskRecord;->taskId:I

    .line 6989
    .local v4, task:I
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    sub-int v5, v6, v8

    .line 6991
    .local v5, top:I
    if-ltz v5, :cond_1b

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/am/HistoryRecord;

    iget-object v6, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v6, v4, :cond_1c

    .line 7035
    :cond_1b
    :goto_1b
    return-void

    .line 6998
    :cond_1c
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/16 v7, 0xa

    invoke-virtual {v6, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 7000
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    .line 7004
    .local v1, moved:Ljava/util/ArrayList;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    sub-int v5, v6, v8

    .line 7005
    move v2, v5

    .line 7009
    .local v2, pos:I
    :goto_31
    if-ltz v2, :cond_5d

    .line 7010
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 7013
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    const/4 v0, 0x1

    .line 7014
    .local v0, first:Z
    iget-object v6, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v6, v4, :cond_5a

    .line 7016
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 7017
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v5, v3}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 7018
    const/4 v6, 0x0

    invoke-virtual {v1, v6, v3}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 7019
    add-int/lit8 v5, v5, -0x1

    .line 7020
    if-eqz v0, :cond_5a

    .line 7021
    iget-object v6, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    invoke-direct {p0, v6}, Lcom/android/server/am/ActivityManagerService;->addRecentTask(Lcom/android/server/am/TaskRecord;)V

    .line 7022
    const/4 v0, 0x0

    .line 7025
    :cond_5a
    add-int/lit8 v2, v2, -0x1

    .line 7026
    goto :goto_31

    .line 7028
    .end local v0           #first:Z
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_5d
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v6, v1}, Lcom/android/server/WindowManagerService;->moveAppTokensToTop(Ljava/util/List;)V

    .line 7033
    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->finishTaskMove(I)V

    .line 7034
    const/16 v6, 0x7532

    invoke-static {v6, v4}, Landroid/util/EventLog;->writeEvent(II)I

    goto :goto_1b
.end method

.method private onBootComplete()Z
    .registers 14

    .prologue
    const/16 v10, 0xa

    const/4 v12, 0x0

    const-string v11, "ActivityManager"

    .line 5876
    new-instance v4, Ljava/io/File;

    const-string v8, "/data/nv"

    const-string v9, "frst_flag"

    invoke-direct {v4, v8, v9}, Ljava/io/File;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 5877
    .local v4, file:Ljava/io/File;
    new-array v0, v10, [C

    .line 5880
    .local v0, buffer:[C
    :try_start_10
    new-instance v1, Ljava/io/FileReader;

    invoke-direct {v1, v4}, Ljava/io/FileReader;-><init>(Ljava/io/File;)V
    :try_end_15
    .catch Ljava/io/FileNotFoundException; {:try_start_10 .. :try_end_15} :catch_8b

    .line 5883
    .local v1, command:Ljava/io/FileReader;
    const/4 v8, 0x0

    const/16 v9, 0xa

    :try_start_18
    invoke-virtual {v1, v0, v8, v9}, Ljava/io/FileReader;->read([CII)I

    move-result v7

    .line 5884
    .local v7, len:I
    new-instance v8, Ljava/lang/String;

    const/4 v9, 0x0

    invoke-direct {v8, v0, v9, v7}, Ljava/lang/String;-><init>([CII)V

    invoke-virtual {v8}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v5

    .line 5885
    .local v5, frstFlag:Ljava/lang/String;
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "frstFlag : "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 5886
    const-string v8, "requested"

    invoke-virtual {v5, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_54

    .line 5889
    new-instance v6, Landroid/content/Intent;

    const-string v8, "android.intent.action.REQUEST_FACTORY_RESET"

    invoke-direct {v6, v8}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 5890
    .local v6, intent:Landroid/content/Intent;
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v8, v6}, Landroid/content/Context;->sendBroadcast(Landroid/content/Intent;)V

    .line 5891
    const/4 v8, 0x1

    .line 5952
    .end local v1           #command:Ljava/io/FileReader;
    .end local v5           #frstFlag:Ljava/lang/String;
    .end local v6           #intent:Landroid/content/Intent;
    .end local v7           #len:I
    :goto_53
    return v8

    .line 5894
    .restart local v1       #command:Ljava/io/FileReader;
    .restart local v5       #frstFlag:Ljava/lang/String;
    .restart local v7       #len:I
    :cond_54
    new-instance v6, Landroid/content/Intent;

    const-string v8, "android.intent.action.COMPLETE_FACTORY_RESET"

    invoke-direct {v6, v8}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 5895
    .restart local v6       #intent:Landroid/content/Intent;
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v8, v6}, Landroid/content/Context;->sendBroadcast(Landroid/content/Intent;)V
    :try_end_60
    .catch Ljava/lang/Exception; {:try_start_18 .. :try_end_60} :catch_6c
    .catch Ljava/io/FileNotFoundException; {:try_start_18 .. :try_end_60} :catch_8b

    .line 5946
    .end local v1           #command:Ljava/io/FileReader;
    .end local v5           #frstFlag:Ljava/lang/String;
    .end local v6           #intent:Landroid/content/Intent;
    .end local v7           #len:I
    :goto_60
    const-string v8, "ActivityManager"

    const-string v8, "MarkBootComplete"

    invoke-static {v11, v8}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 5947
    invoke-static {}, Lcom/lge/system/LGESystemNative;->MarkBootComplete()I

    move v8, v12

    .line 5952
    goto :goto_53

    .line 5898
    .restart local v1       #command:Ljava/io/FileReader;
    :catch_6c
    move-exception v8

    move-object v3, v8

    .line 5900
    .local v3, e1:Ljava/lang/Exception;
    :try_start_6e
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "frst_flag read failed : "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v3}, Ljava/lang/Exception;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_8a
    .catch Ljava/io/FileNotFoundException; {:try_start_6e .. :try_end_8a} :catch_8b

    goto :goto_60

    .line 5904
    .end local v1           #command:Ljava/io/FileReader;
    .end local v3           #e1:Ljava/lang/Exception;
    :catch_8b
    move-exception v8

    move-object v2, v8

    .line 5906
    .local v2, e:Ljava/io/FileNotFoundException;
    const-string v8, "ActivityManager"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Couldn\'t find or open /data/nv/first_flag "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v11, v8}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_60
.end method

.method private final performClearTaskLocked(ILcom/android/server/am/HistoryRecord;Z)Lcom/android/server/am/HistoryRecord;
    .registers 15
    .parameter "taskId"
    .parameter "newR"
    .parameter "doClear"

    .prologue
    .line 2938
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v2

    .line 2941
    .local v2, i:I
    :cond_6
    if-lez v2, :cond_1a

    .line 2942
    add-int/lit8 v2, v2, -0x1

    .line 2943
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 2944
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v0, v0, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v0, p1, :cond_6

    .line 2945
    add-int/lit8 v2, v2, 0x1

    .line 2951
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1a
    if-lez v2, :cond_81

    .line 2952
    add-int/lit8 v2, v2, -0x1

    .line 2953
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 2954
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v0, :cond_1a

    .line 2957
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v0, v0, Lcom/android/server/am/TaskRecord;->taskId:I

    if-eq v0, p1, :cond_32

    .line 2958
    const/4 v0, 0x0

    .line 2995
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_31
    return-object v0

    .line 2960
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_32
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    iget-object v3, p2, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v0, v3}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_1a

    .line 2962
    move-object v10, v1

    .line 2963
    .local v10, ret:Lcom/android/server/am/HistoryRecord;
    if-eqz p3, :cond_65

    .line 2964
    :cond_3f
    :goto_3f
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    const/4 v3, 0x1

    sub-int/2addr v0, v3

    if-ge v2, v0, :cond_65

    .line 2965
    add-int/lit8 v2, v2, 0x1

    .line 2966
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 2967
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v0, :cond_3f

    .line 2970
    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "clear"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_3f

    .line 2972
    add-int/lit8 v2, v2, -0x1

    goto :goto_3f

    .line 2980
    :cond_65
    iget v0, v10, Lcom/android/server/am/HistoryRecord;->launchMode:I

    if-nez v0, :cond_7f

    .line 2981
    iget-boolean v0, v10, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v0, :cond_7f

    .line 2982
    invoke-direct {p0, v10}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v9

    .line 2983
    .local v9, index:I
    if-ltz v9, :cond_7d

    .line 2984
    const/4 v5, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "clear"

    move-object v3, p0

    move-object v4, v10

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 2987
    :cond_7d
    const/4 v0, 0x0

    goto :goto_31

    .end local v9           #index:I
    :cond_7f
    move-object v0, v10

    .line 2991
    goto :goto_31

    .line 2995
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    .end local v10           #ret:Lcom/android/server/am/HistoryRecord;
    :cond_81
    const/4 v0, 0x0

    goto :goto_31
.end method

.method static performReceive(Lcom/android/server/am/ProcessRecord;Landroid/content/IIntentReceiver;Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;Z)V
    .registers 14
    .parameter "app"
    .parameter "receiver"
    .parameter "intent"
    .parameter "resultCode"
    .parameter "data"
    .parameter "extras"
    .parameter "ordered"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 11736
    if-eqz p0, :cond_12

    iget-object v0, p0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_12

    .line 11739
    iget-object v0, p0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v1, p1

    move-object v2, p2

    move v3, p3

    move-object v4, p4

    move-object v5, p5

    move v6, p6

    invoke-interface/range {v0 .. v6}, Landroid/app/IApplicationThread;->scheduleRegisteredReceiver(Landroid/content/IIntentReceiver;Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;Z)V

    .line 11744
    :goto_11
    return-void

    .line 11742
    :cond_12
    invoke-interface/range {p1 .. p6}, Landroid/content/IIntentReceiver;->performReceive(Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;Z)V

    goto :goto_11
.end method

.method public static prepareTraceFile(Z)Z
    .registers 11
    .parameter "removeExisting"

    .prologue
    const/4 v7, -0x1

    const-string v9, "ActivityManager"

    .line 4694
    const-string v5, "dalvik.vm.stack-trace-file"

    const/4 v6, 0x0

    invoke-static {v5, v6}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v4

    .line 4695
    .local v4, tracesPath:Ljava/lang/String;
    const/4 v3, 0x0

    .line 4696
    .local v3, fileReady:Z
    invoke-static {v4}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v5

    if-nez v5, :cond_44

    .line 4697
    new-instance v2, Ljava/io/File;

    invoke-direct {v2, v4}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 4698
    .local v2, f:Ljava/io/File;
    invoke-virtual {v2}, Ljava/io/File;->exists()Z

    move-result v5

    if-nez v5, :cond_4d

    .line 4700
    invoke-virtual {v2}, Ljava/io/File;->getParentFile()Ljava/io/File;

    move-result-object v0

    .line 4701
    .local v0, dir:Ljava/io/File;
    invoke-virtual {v0}, Ljava/io/File;->exists()Z

    move-result v5

    if-nez v5, :cond_45

    .line 4702
    invoke-virtual {v0}, Ljava/io/File;->mkdirs()Z

    move-result v3

    .line 4703
    invoke-virtual {v0}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v5

    const/16 v6, 0x1f9

    invoke-static {v5, v6, v7, v7}, Landroid/os/FileUtils;->setPermissions(Ljava/lang/String;III)I

    .line 4715
    .end local v0           #dir:Ljava/io/File;
    :cond_33
    :goto_33
    if-eqz p0, :cond_44

    .line 4717
    :try_start_35
    invoke-virtual {v2}, Ljava/io/File;->createNewFile()Z

    .line 4718
    invoke-virtual {v2}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v5

    const/16 v6, 0x1fe

    const/4 v7, -0x1

    const/4 v8, -0x1

    invoke-static {v5, v6, v7, v8}, Landroid/os/FileUtils;->setPermissions(Ljava/lang/String;III)I
    :try_end_43
    .catch Ljava/io/IOException; {:try_start_35 .. :try_end_43} :catch_6c

    .line 4721
    const/4 v3, 0x1

    .line 4728
    .end local v2           #f:Ljava/io/File;
    :cond_44
    :goto_44
    return v3

    .line 4705
    .restart local v0       #dir:Ljava/io/File;
    .restart local v2       #f:Ljava/io/File;
    :cond_45
    invoke-virtual {v0}, Ljava/io/File;->isDirectory()Z

    move-result v5

    if-eqz v5, :cond_33

    .line 4706
    const/4 v3, 0x1

    goto :goto_33

    .line 4708
    .end local v0           #dir:Ljava/io/File;
    :cond_4d
    if-eqz p0, :cond_33

    .line 4711
    const-string v5, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Removing old ANR trace file from "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v9, v5}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4712
    invoke-virtual {v2}, Ljava/io/File;->delete()Z

    move-result v3

    goto :goto_33

    .line 4722
    :catch_6c
    move-exception v5

    move-object v1, v5

    .line 4723
    .local v1, e:Ljava/io/IOException;
    const-string v5, "ActivityManager"

    const-string v5, "Unable to make ANR traces file"

    invoke-static {v9, v5, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_44
.end method

.method private final processCurBroadcastLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/ProcessRecord;)V
    .registers 12
    .parameter "r"
    .parameter "app"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    const/4 v8, 0x0

    .line 11703
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v0, :cond_b

    .line 11704
    new-instance v0, Landroid/os/RemoteException;

    invoke-direct {v0}, Landroid/os/RemoteException;-><init>()V

    throw v0

    .line 11706
    :cond_b
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 11707
    iput-object p2, p1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 11708
    iput-object p1, p2, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 11709
    const/4 v0, 0x1

    invoke-direct {p0, p2, v0}, Lcom/android/server/am/ActivityManagerService;->updateLRUListLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 11712
    iget-object v0, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    iget-object v1, p1, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    invoke-virtual {v0, v1}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 11714
    const/4 v7, 0x0

    .line 11719
    .local v7, started:Z
    :try_start_23
    iget-object v0, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v0}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    invoke-virtual {v0}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 11720
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    new-instance v1, Landroid/content/Intent;

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    invoke-direct {v1, v2}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    iget-object v2, p1, Lcom/android/server/am/BroadcastRecord;->curReceiver:Landroid/content/pm/ActivityInfo;

    iget v3, p1, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v4, p1, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v5, p1, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v6, p1, Lcom/android/server/am/BroadcastRecord;->ordered:Z

    invoke-interface/range {v0 .. v6}, Landroid/app/IApplicationThread;->scheduleReceiver(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;ILjava/lang/String;Landroid/os/Bundle;Z)V
    :try_end_46
    .catchall {:try_start_23 .. :try_end_46} :catchall_50

    .line 11722
    const/4 v7, 0x1

    .line 11724
    if-nez v7, :cond_4f

    .line 11725
    iput-object v8, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 11726
    iput-object v8, p1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 11727
    iput-object v8, p2, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 11731
    :cond_4f
    return-void

    .line 11724
    :catchall_50
    move-exception v0

    if-nez v7, :cond_59

    .line 11725
    iput-object v8, p1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 11726
    iput-object v8, p1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    .line 11727
    iput-object v8, p2, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 11724
    :cond_59
    throw v0
.end method

.method private final processNextBroadcast(Z)V
    .registers 35
    .parameter "fromMsg"

    .prologue
    .line 11825
    monitor-enter p0

    .line 11832
    :try_start_1
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStats()V

    .line 11834
    if-eqz p1, :cond_c

    .line 11835
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    .line 11839
    :cond_c
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_4f

    .line 11840
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v29

    check-cast v29, Lcom/android/server/am/BroadcastRecord;

    .line 11841
    .local v29, r:Lcom/android/server/am/BroadcastRecord;
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    invoke-interface {v5}, Ljava/util/List;->size()I

    move-result v14

    .line 11844
    .local v14, N:I
    const/16 v19, 0x0

    .local v19, i:I
    :goto_2e
    move/from16 v0, v19

    move v1, v14

    if-ge v0, v1, :cond_c

    .line 11845
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v19

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v32

    .line 11849
    .local v32, target:Ljava/lang/Object;
    check-cast v32, Lcom/android/server/am/BroadcastFilter;

    .end local v32           #target:Ljava/lang/Object;
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v29

    move-object/from16 v2, v32

    move v3, v5

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->deliverToRegisteredReceiver(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V

    .line 11844
    add-int/lit8 v19, v19, 0x1

    goto :goto_2e

    .line 11860
    .end local v14           #N:I
    .end local v19           #i:I
    .end local v29           #r:Lcom/android/server/am/BroadcastRecord;
    :cond_4f
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v5, v0

    if-eqz v5, :cond_cc

    .line 11861
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "processNextBroadcast: waiting for "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v7, v0

    iget-object v7, v7, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 11865
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    monitor-enter v5
    :try_end_7b
    .catchall {:try_start_1 .. :try_end_7b} :catchall_9e

    .line 11866
    :try_start_7b
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v6, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v7, v0

    iget-object v7, v7, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    iget v7, v7, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v6, v7}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v6

    if-nez v6, :cond_97

    const/4 v6, 0x1

    move/from16 v21, v6

    .line 11867
    .local v21, isDead:Z
    :goto_92
    monitor-exit v5
    :try_end_93
    .catchall {:try_start_7b .. :try_end_93} :catchall_9b

    .line 11868
    if-nez v21, :cond_a1

    .line 11870
    :try_start_95
    monitor-exit p0
    :try_end_96
    .catchall {:try_start_95 .. :try_end_96} :catchall_9e

    .line 12091
    .end local v21           #isDead:Z
    :goto_96
    return-void

    .line 11866
    :cond_97
    const/4 v6, 0x0

    move/from16 v21, v6

    goto :goto_92

    .line 11867
    :catchall_9b
    move-exception v6

    :try_start_9c
    monitor-exit v5
    :try_end_9d
    .catchall {:try_start_9c .. :try_end_9d} :catchall_9b

    :try_start_9d
    throw v6

    .line 12090
    :catchall_9e
    move-exception v5

    monitor-exit p0
    :try_end_a0
    .catchall {:try_start_9d .. :try_end_a0} :catchall_9e

    throw v5

    .line 11872
    .restart local v21       #isDead:Z
    :cond_a1
    :try_start_a1
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "pending app "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    move-object v7, v0

    iget-object v7, v7, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " died before responding to broadcast"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11874
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 11878
    .end local v21           #isDead:Z
    :cond_cc
    const/16 v22, 0x0

    .line 11881
    .local v22, looped:Z
    :cond_ce
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-nez v5, :cond_e3

    .line 11883
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    .line 11884
    if-eqz v22, :cond_e1

    .line 11888
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 11890
    :cond_e1
    monitor-exit p0

    goto :goto_96

    .line 11892
    :cond_e3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v29

    check-cast v29, Lcom/android/server/am/BroadcastRecord;

    .line 11893
    .restart local v29       #r:Lcom/android/server/am/BroadcastRecord;
    const/16 v18, 0x0

    .line 11898
    .local v18, forceReceive:Z
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    if-eqz v5, :cond_1ac

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    invoke-interface {v5}, Ljava/util/List;->size()I

    move-result v5

    move/from16 v27, v5

    .line 11899
    .local v27, numReceivers:I
    :goto_103
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v25

    .line 11900
    .local v25, now:J
    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J

    move-wide v7, v0

    const-wide/16 v9, 0x0

    cmp-long v5, v7, v9

    if-lez v5, :cond_1a2

    .line 11901
    if-lez v27, :cond_1a2

    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J

    move-wide v7, v0

    move/from16 v0, v27

    mul-int/lit16 v0, v0, 0x4e20

    move v5, v0

    int-to-long v9, v5

    add-long/2addr v7, v9

    cmp-long v5, v25, v7

    if-lez v5, :cond_1a2

    .line 11903
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Hung broadcast discarded after timeout failure: now="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-wide/from16 v1, v25

    invoke-virtual {v0, v1, v2}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " dispatchTime="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J

    move-wide v7, v0

    invoke-virtual {v6, v7, v8}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " startTime="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->startTime:J

    move-wide v7, v0

    invoke-virtual {v6, v7, v8}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " intent="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " numReceivers="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move/from16 v1, v27

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " nextReceiver="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " state="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->state:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11911
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->broadcastTimeout()V

    .line 11912
    const/16 v18, 0x1

    .line 11913
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 11917
    :cond_1a2
    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->state:I

    move v5, v0

    if-eqz v5, :cond_1b1

    .line 11921
    monitor-exit p0

    goto/16 :goto_96

    .line 11898
    .end local v25           #now:J
    .end local v27           #numReceivers:I
    :cond_1ac
    const/4 v5, 0x0

    move/from16 v27, v5

    goto/16 :goto_103

    .line 11924
    .restart local v25       #now:J
    .restart local v27       #numReceivers:I
    :cond_1b1
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    if-eqz v5, :cond_1cb

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move v5, v0

    move v0, v5

    move/from16 v1, v27

    if-ge v0, v1, :cond_1cb

    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move v5, v0

    if-nez v5, :cond_1cb

    if-eqz v18, :cond_210

    .line 11928
    :cond_1cb
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;

    move-object v5, v0
    :try_end_1d0
    .catchall {:try_start_a1 .. :try_end_1d0} :catchall_9e

    if-eqz v5, :cond_1f9

    .line 11935
    :try_start_1d2
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->callerApp:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;

    move-object v6, v0

    new-instance v7, Landroid/content/Intent;

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v8, v0

    invoke-direct {v7, v8}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    move v8, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    move-object v9, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    move-object v10, v0

    const/4 v11, 0x0

    invoke-static/range {v5 .. v11}, Lcom/android/server/am/ActivityManagerService;->performReceive(Lcom/android/server/am/ProcessRecord;Landroid/content/IIntentReceiver;Landroid/content/Intent;ILjava/lang/String;Landroid/os/Bundle;Z)V
    :try_end_1f9
    .catchall {:try_start_1d2 .. :try_end_1f9} :catchall_9e
    .catch Landroid/os/RemoteException; {:try_start_1d2 .. :try_end_1f9} :catch_295

    .line 11944
    :cond_1f9
    :goto_1f9
    :try_start_1f9
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x8

    invoke-virtual {v5, v6}, Landroid/os/Handler;->removeMessages(I)V

    .line 11950
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 11951
    const/16 v29, 0x0

    .line 11952
    const/16 v22, 0x1

    .line 11955
    :cond_210
    if-eqz v29, :cond_ce

    .line 11958
    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    move/from16 v30, v0

    add-int/lit8 v5, v30, 0x1

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I

    .line 11962
    .local v30, recIdx:I
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v7

    move-wide v0, v7

    move-object/from16 v2, v29

    iput-wide v0, v2, Lcom/android/server/am/BroadcastRecord;->startTime:J

    .line 11963
    if-nez v30, :cond_253

    .line 11964
    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->startTime:J

    move-wide v7, v0

    move-wide v0, v7

    move-object/from16 v2, v29

    iput-wide v0, v2, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J

    .line 11971
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x8

    invoke-virtual {v5, v6}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v23

    .line 11972
    .local v23, msg:Landroid/os/Message;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    move-object/from16 v0, v29

    iget-wide v0, v0, Lcom/android/server/am/BroadcastRecord;->startTime:J

    move-wide v7, v0

    const-wide/16 v9, 0x2710

    add-long/2addr v7, v9

    move-object v0, v5

    move-object/from16 v1, v23

    move-wide v2, v7

    invoke-virtual {v0, v1, v2, v3}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z

    .line 11975
    .end local v23           #msg:Landroid/os/Message;
    :cond_253
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v30

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v24

    .line 11976
    .local v24, nextReceiver:Ljava/lang/Object;
    move-object/from16 v0, v24

    instance-of v0, v0, Lcom/android/server/am/BroadcastFilter;

    move v5, v0

    if-eqz v5, :cond_2bb

    .line 11979
    move-object/from16 v0, v24

    check-cast v0, Lcom/android/server/am/BroadcastFilter;

    move-object/from16 v17, v0

    .line 11983
    .local v17, filter:Lcom/android/server/am/BroadcastFilter;
    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->ordered:Z

    move v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v29

    move-object/from16 v2, v17

    move v3, v5

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->deliverToRegisteredReceiver(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V

    .line 11984
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object v5, v0

    if-eqz v5, :cond_289

    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->ordered:Z

    move v5, v0

    if-nez v5, :cond_292

    .line 11987
    :cond_289
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 11988
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 11990
    :cond_292
    monitor-exit p0

    goto/16 :goto_96

    .line 11938
    .end local v17           #filter:Lcom/android/server/am/BroadcastFilter;
    .end local v24           #nextReceiver:Ljava/lang/Object;
    .end local v30           #recIdx:I
    :catch_295
    move-exception v5

    move-object/from16 v16, v5

    .line 11939
    .local v16, e:Landroid/os/RemoteException;
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Failure sending broadcast result of "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    move-object v0, v5

    move-object v1, v6

    move-object/from16 v2, v16

    invoke-static {v0, v1, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_1f9

    .line 11996
    .end local v16           #e:Landroid/os/RemoteException;
    .restart local v24       #nextReceiver:Ljava/lang/Object;
    .restart local v30       #recIdx:I
    :cond_2bb
    move-object/from16 v0, v24

    check-cast v0, Landroid/content/pm/ResolveInfo;

    move-object/from16 v20, v0

    .line 11999
    .local v20, info:Landroid/content/pm/ResolveInfo;
    const/16 v31, 0x0

    .line 12000
    .local v31, skip:Z
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I

    move v6, v0

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    move v7, v0

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget-boolean v8, v8, Landroid/content/pm/ActivityInfo;->exported:Z

    if-eqz v8, :cond_42c

    const/4 v8, -0x1

    :goto_2de
    move-object/from16 v0, p0

    move-object v1, v5

    move v2, v6

    move v3, v7

    move v4, v8

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v28

    .line 12004
    .local v28, perm:I
    if-eqz v28, :cond_373

    .line 12005
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Permission Denial: broadcasting "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v7}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " from "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " (pid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ", uid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ")"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " requires "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " due to receiver "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "/"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12012
    const/16 v31, 0x1

    .line 12014
    :cond_373
    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    move v5, v0

    const/16 v6, 0x3e8

    if-eq v5, v6, :cond_400

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    move-object v5, v0
    :try_end_381
    .catchall {:try_start_1f9 .. :try_end_381} :catchall_9e

    if-eqz v5, :cond_400

    .line 12017
    :try_start_383
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    move-object v6, v0

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-interface {v5, v6, v7}, Landroid/content/pm/IPackageManager;->checkPermission(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_398
    .catchall {:try_start_383 .. :try_end_398} :catchall_9e
    .catch Landroid/os/RemoteException; {:try_start_383 .. :try_end_398} :catch_437

    move-result v28

    .line 12023
    :goto_399
    if-eqz v28, :cond_400

    .line 12024
    :try_start_39b
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Permission Denial: receiving "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " to "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " requires "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " due to sender "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " (uid "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I

    move v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ")"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12030
    const/16 v31, 0x1

    .line 12033
    :cond_400
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    if-eqz v5, :cond_412

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    iget-boolean v5, v5, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-eqz v5, :cond_412

    .line 12035
    const/16 v31, 0x1

    .line 12038
    :cond_412
    if-eqz v31, :cond_43e

    .line 12039
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    .line 12040
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;

    .line 12041
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 12042
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 12043
    monitor-exit p0

    goto/16 :goto_96

    .line 12000
    .end local v28           #perm:I
    :cond_42c
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v8, v8, Landroid/content/pm/ApplicationInfo;->uid:I

    goto/16 :goto_2de

    .line 12020
    .restart local v28       #perm:I
    :catch_437
    move-exception v5

    move-object/from16 v16, v5

    .line 12021
    .restart local v16       #e:Landroid/os/RemoteException;
    const/16 v28, -0x1

    goto/16 :goto_399

    .line 12046
    .end local v16           #e:Landroid/os/RemoteException;
    :cond_43e
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 12047
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v6, v5, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;

    .line 12048
    .local v6, targetProcess:Ljava/lang/String;
    new-instance v5, Landroid/content/ComponentName;

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget-object v8, v8, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v5, v7, v8}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    .line 12051
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->curReceiver:Landroid/content/pm/ActivityInfo;

    .line 12054
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move-object/from16 v0, p0

    move-object v1, v6

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v15

    .line 12056
    .local v15, app:Lcom/android/server/am/ProcessRecord;
    if-eqz v15, :cond_4b3

    iget-object v5, v15, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;
    :try_end_484
    .catchall {:try_start_39b .. :try_end_484} :catchall_9e

    if-eqz v5, :cond_4b3

    .line 12058
    :try_start_486
    move-object/from16 v0, p0

    move-object/from16 v1, v29

    move-object v2, v15

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->processCurBroadcastLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/ProcessRecord;)V
    :try_end_48e
    .catchall {:try_start_486 .. :try_end_48e} :catchall_9e
    .catch Landroid/os/RemoteException; {:try_start_486 .. :try_end_48e} :catch_491

    .line 12059
    :try_start_48e
    monitor-exit p0

    goto/16 :goto_96

    .line 12060
    :catch_491
    move-exception v16

    .line 12061
    .restart local v16       #e:Landroid/os/RemoteException;
    const-string v5, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Exception when sending broadcast to "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    move-object v8, v0

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    move-object v0, v5

    move-object v1, v7

    move-object/from16 v2, v16

    invoke-static {v0, v1, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 12071
    .end local v16           #e:Landroid/os/RemoteException;
    :cond_4b3
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v7, v5, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    const/4 v8, 0x1

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/Intent;->getFlags()I

    move-result v5

    or-int/lit8 v9, v5, 0x4

    const-string v10, "broadcast"

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;

    move-object v11, v0

    move-object/from16 v5, p0

    invoke-direct/range {v5 .. v11}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;)Lcom/android/server/am/ProcessRecord;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    if-nez v5, :cond_555

    .line 12077
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    .end local v6           #targetProcess:Ljava/lang/String;
    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Unable to launch app "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v7, v7, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "/"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    iget-object v7, v7, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " for broadcast "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;

    move-object v7, v0

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ": process is bad"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12081
    move-object/from16 v0, p0

    move-object/from16 v1, v29

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 12082
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    move-object v8, v0

    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    move v9, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    move-object v10, v0

    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    move-object v11, v0

    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move v12, v0

    const/4 v13, 0x1

    move-object/from16 v7, p0

    invoke-direct/range {v7 .. v13}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 12084
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 12085
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, v29

    iput v0, v1, Lcom/android/server/am/BroadcastRecord;->state:I

    .line 12086
    monitor-exit p0

    goto/16 :goto_96

    .line 12089
    .restart local v6       #targetProcess:Ljava/lang/String;
    :cond_555
    move-object/from16 v0, v29

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 12090
    monitor-exit p0
    :try_end_55c
    .catchall {:try_start_48e .. :try_end_55c} :catchall_9e

    goto/16 :goto_96
.end method

.method private final processStartTimedOutLocked(Lcom/android/server/am/ProcessRecord;)V
    .registers 10
    .parameter "app"

    .prologue
    const-string v7, "ActivityManager"

    .line 5068
    iget v3, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 5069
    .local v3, pid:I
    const/4 v1, 0x0

    .line 5070
    .local v1, gone:Z
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v4

    .line 5071
    :try_start_8
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v5, v3}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 5072
    .local v2, knownApp:Lcom/android/server/am/ProcessRecord;
    if-eqz v2, :cond_1c

    iget-object v5, v2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v5, :cond_1c

    .line 5073
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v5, v3}, Landroid/util/SparseArray;->remove(I)V

    .line 5074
    const/4 v1, 0x1

    .line 5076
    :cond_1c
    monitor-exit v4
    :try_end_1d
    .catchall {:try_start_8 .. :try_end_1d} :catchall_89

    .line 5078
    if-eqz v1, :cond_8c

    .line 5079
    const-string v4, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Process "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " failed to attach"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v7, v4}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5080
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v5, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v4, v5, v6}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 5081
    invoke-static {v3}, Landroid/os/Process;->killProcess(I)V

    .line 5082
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    if-eqz v4, :cond_64

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    iget-object v4, v4, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    iget v4, v4, Lcom/android/server/am/ProcessRecord;->pid:I

    if-ne v4, v3, :cond_64

    .line 5083
    const-string v4, "ActivityManager"

    const-string v4, "Unattached app died before broadcast acknowledged, skipping"

    invoke-static {v7, v4}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5084
    const/4 v4, 0x0

    iput-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 5085
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 5087
    :cond_64
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    if-eqz v4, :cond_88

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    iget-object v4, v4, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v4, v4, Lcom/android/server/am/ProcessRecord;->pid:I

    if-ne v4, v3, :cond_88

    .line 5088
    const-string v4, "ActivityManager"

    const-string v4, "Unattached app died before backup, skipping"

    invoke-static {v7, v4}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5090
    :try_start_77
    const-string v4, "backup"

    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v4

    invoke-static {v4}, Landroid/backup/IBackupManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/backup/IBackupManager;

    move-result-object v0

    .line 5092
    .local v0, bm:Landroid/backup/IBackupManager;
    iget-object v4, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v4, v4, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-interface {v0, v4}, Landroid/backup/IBackupManager;->agentDisconnected(Ljava/lang/String;)V
    :try_end_88
    .catch Landroid/os/RemoteException; {:try_start_77 .. :try_end_88} :catch_a5

    .line 5100
    .end local v0           #bm:Landroid/backup/IBackupManager;
    :cond_88
    :goto_88
    return-void

    .line 5076
    .end local v2           #knownApp:Lcom/android/server/am/ProcessRecord;
    :catchall_89
    move-exception v5

    :try_start_8a
    monitor-exit v4
    :try_end_8b
    .catchall {:try_start_8a .. :try_end_8b} :catchall_89

    throw v5

    .line 5098
    .restart local v2       #knownApp:Lcom/android/server/am/ProcessRecord;
    :cond_8c
    const-string v4, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Spurious process start timeout - pid not known for "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v7, v4}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_88

    .line 5093
    :catch_a5
    move-exception v4

    goto :goto_88
.end method

.method private final realStartActivityLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/ProcessRecord;ZZ)Z
    .registers 18
    .parameter "r"
    .parameter "app"
    .parameter "andResume"
    .parameter "checkConfig"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 1732
    const/4 v0, 0x0

    invoke-virtual {p1, p2, v0}, Lcom/android/server/am/HistoryRecord;->startFreezingScreenLocked(Lcom/android/server/am/ProcessRecord;I)V

    .line 1733
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v1, 0x1

    invoke-virtual {v0, p1, v1}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 1741
    if-eqz p4, :cond_1e

    .line 1742
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    invoke-virtual {p1, p2}, Lcom/android/server/am/HistoryRecord;->mayFreezeScreenLocked(Lcom/android/server/am/ProcessRecord;)Z

    move-result v2

    if-eqz v2, :cond_79

    move-object v2, p1

    :goto_17
    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->updateOrientationFromAppTokens(Landroid/content/res/Configuration;Landroid/os/IBinder;)Landroid/content/res/Configuration;

    move-result-object v10

    .line 1745
    .local v10, config:Landroid/content/res/Configuration;
    invoke-virtual {p0, v10, p1}, Lcom/android/server/am/ActivityManagerService;->updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z

    .line 1748
    .end local v10           #config:Landroid/content/res/Configuration;
    :cond_1e
    iput-object p2, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 1752
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v12

    .line 1753
    .local v12, idx:I
    if-gez v12, :cond_2d

    .line 1754
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 1756
    :cond_2d
    const/4 v0, 0x1

    invoke-direct {p0, p2, v0}, Lcom/android/server/am/ActivityManagerService;->updateLRUListLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 1759
    :try_start_31
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v0, :cond_7b

    .line 1760
    new-instance v0, Landroid/os/RemoteException;

    invoke-direct {v0}, Landroid/os/RemoteException;-><init>()V

    throw v0
    :try_end_3b
    .catch Landroid/os/RemoteException; {:try_start_31 .. :try_end_3b} :catch_3b

    .line 1785
    :catch_3b
    move-exception v0

    move-object v11, v0

    .line 1786
    .local v11, e:Landroid/os/RemoteException;
    iget-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->launchFailed:Z

    if-eqz v0, :cond_124

    .line 1789
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Second failure launching "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    invoke-virtual {v2}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ", giving up"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1, v11}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 1792
    iget v0, p2, Lcom/android/server/am/ProcessRecord;->pid:I

    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-direct {p0, p2, v0, v1}, Lcom/android/server/am/ActivityManagerService;->appDiedLocked(Lcom/android/server/am/ProcessRecord;ILandroid/app/IApplicationThread;)V

    .line 1793
    const/4 v0, 0x0

    const/4 v1, 0x0

    const-string v2, "2nd-crash"

    invoke-direct {p0, p1, v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z

    .line 1795
    const/4 v0, 0x0

    .line 1836
    .end local v11           #e:Landroid/os/RemoteException;
    :goto_78
    return v0

    .line 1742
    .end local v12           #idx:I
    :cond_79
    const/4 v2, 0x0

    goto :goto_17

    .line 1762
    .restart local v12       #idx:I
    :cond_7b
    const/4 v6, 0x0

    .line 1763
    .local v6, results:Ljava/util/List;,"Ljava/util/List<Landroid/app/ResultInfo;>;"
    const/4 v7, 0x0

    .line 1764
    .local v7, newIntents:Ljava/util/List;,"Ljava/util/List<Landroid/content/Intent;>;"
    if-eqz p3, :cond_83

    .line 1765
    :try_start_7f
    iget-object v6, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 1766
    iget-object v7, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    .line 1772
    :cond_83
    if-eqz p3, :cond_a8

    .line 1773
    const/16 v0, 0x7536

    const/4 v1, 0x3

    new-array v1, v1, [Ljava/lang/Object;

    const/4 v2, 0x0

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    const/4 v2, 0x1

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v3, v3, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    const/4 v2, 0x2

    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v3, v1, v2

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 1777
    :cond_a8
    iget-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->isHomeActivity:Z

    if-eqz v0, :cond_ae

    .line 1778
    iput-object p2, p0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    .line 1780
    :cond_ae
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v0}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v0

    invoke-virtual {v0}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 1781
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    new-instance v1, Landroid/content/Intent;

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-direct {v1, v2}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v3

    iget-object v4, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v5, p1, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    if-nez p3, :cond_121

    const/4 v2, 0x1

    move v8, v2

    :goto_d0
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->isNextTransitionForward()Z

    move-result v9

    move-object v2, p1

    invoke-interface/range {v0 .. v9}, Landroid/app/IApplicationThread;->scheduleLaunchActivity(Landroid/content/Intent;Landroid/os/IBinder;ILandroid/content/pm/ActivityInfo;Landroid/os/Bundle;Ljava/util/List;Ljava/util/List;ZZ)V
    :try_end_d8
    .catch Landroid/os/RemoteException; {:try_start_7f .. :try_end_d8} :catch_3b

    .line 1804
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->launchFailed:Z

    .line 1805
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->updateLRUListLocked(Lcom/android/server/am/HistoryRecord;)Z

    move-result v0

    if-eqz v0, :cond_ff

    .line 1806
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Activity "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " being launched, but already in LRU list"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 1810
    :cond_ff
    if-eqz p3, :cond_12a

    .line 1813
    sget-object v0, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v0, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 1814
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    .line 1815
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->haveState:Z

    .line 1816
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 1817
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 1818
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    invoke-virtual {v0}, Lcom/android/server/am/TaskRecord;->touchActiveTime()V

    .line 1819
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->completeResumeLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 1820
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->pauseIfSleepingLocked()V

    .line 1834
    :goto_11b
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->startSetupActivityLocked()V

    .line 1836
    const/4 v0, 0x1

    goto/16 :goto_78

    .line 1781
    :cond_121
    const/4 v2, 0x0

    move v8, v2

    goto :goto_d0

    .line 1800
    .end local v6           #results:Ljava/util/List;,"Ljava/util/List<Landroid/app/ResultInfo;>;"
    .end local v7           #newIntents:Ljava/util/List;,"Ljava/util/List<Landroid/content/Intent;>;"
    .restart local v11       #e:Landroid/os/RemoteException;
    :cond_124
    iget-object v0, p2, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 1801
    throw v11

    .line 1826
    .end local v11           #e:Landroid/os/RemoteException;
    .restart local v6       #results:Ljava/util/List;,"Ljava/util/List<Landroid/app/ResultInfo;>;"
    .restart local v7       #newIntents:Ljava/util/List;,"Ljava/util/List<Landroid/content/Intent;>;"
    :cond_12a
    sget-object v0, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v0, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 1827
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->stopped:Z

    goto :goto_11b
.end method

.method private final realStartServiceLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/ProcessRecord;)V
    .registers 9
    .parameter "r"
    .parameter "app"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    const/4 v5, 0x1

    .line 10076
    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v1, :cond_b

    .line 10077
    new-instance v1, Landroid/os/RemoteException;

    invoke-direct {v1}, Landroid/os/RemoteException;-><init>()V

    throw v1

    .line 10080
    :cond_b
    iput-object p2, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 10081
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    iput-wide v1, p1, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    iput-wide v1, p1, Lcom/android/server/am/ServiceRecord;->restartTime:J

    .line 10083
    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v1, p1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 10084
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 10085
    invoke-direct {p0, p2, v5}, Lcom/android/server/am/ActivityManagerService;->updateLRUListLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 10087
    const/4 v0, 0x0

    .line 10091
    .local v0, created:Z
    const/16 v1, 0x754e

    const/4 v2, 0x4

    :try_start_24
    new-array v2, v2, [Ljava/lang/Object;

    const/4 v3, 0x0

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v4

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v2, v3

    const/4 v3, 0x1

    iget-object v4, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    aput-object v4, v2, v3

    const/4 v3, 0x2

    iget-object v4, p1, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v4}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v4

    invoke-virtual {v4}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v4

    aput-object v4, v2, v3

    const/4 v3, 0x3

    iget-object v4, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v4, v4, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v2, v3

    invoke-static {v1, v2}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 10094
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v1}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v1

    monitor-enter v1
    :try_end_58
    .catchall {:try_start_24 .. :try_end_58} :catchall_81

    .line 10095
    :try_start_58
    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->startLaunchedLocked()V

    .line 10096
    monitor-exit v1
    :try_end_5e
    .catchall {:try_start_58 .. :try_end_5e} :catchall_7e

    .line 10097
    :try_start_5e
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->serviceInfo:Landroid/content/pm/ServiceInfo;

    iget-object v1, v1, Landroid/content/pm/ServiceInfo;->packageName:Ljava/lang/String;

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->ensurePackageDexOpt(Ljava/lang/String;)V

    .line 10098
    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->serviceInfo:Landroid/content/pm/ServiceInfo;

    invoke-interface {v1, p1, v2}, Landroid/app/IApplicationThread;->scheduleCreateService(Landroid/os/IBinder;Landroid/content/pm/ServiceInfo;)V
    :try_end_6c
    .catchall {:try_start_5e .. :try_end_6c} :catchall_81

    .line 10099
    const/4 v0, 0x1

    .line 10101
    if-nez v0, :cond_77

    .line 10102
    iget-object v1, p2, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v1, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 10103
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->scheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 10107
    :cond_77
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingsLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 10108
    invoke-direct {p0, p1, v5}, Lcom/android/server/am/ActivityManagerService;->sendServiceArgsLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 10109
    return-void

    .line 10096
    :catchall_7e
    move-exception v2

    :try_start_7f
    monitor-exit v1
    :try_end_80
    .catchall {:try_start_7f .. :try_end_80} :catchall_7e

    :try_start_80
    throw v2
    :try_end_81
    .catchall {:try_start_80 .. :try_end_81} :catchall_81

    .line 10101
    :catchall_81
    move-exception v1

    if-nez v0, :cond_8c

    .line 10102
    iget-object v2, p2, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v2, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 10103
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->scheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 10101
    :cond_8c
    throw v1
.end method

.method private final relaunchActivityLocked(Lcom/android/server/am/HistoryRecord;IZ)Z
    .registers 14
    .parameter "r"
    .parameter "changes"
    .parameter "andResume"

    .prologue
    const/4 v9, 0x0

    const/4 v8, 0x1

    const/4 v7, 0x0

    .line 12345
    const/4 v2, 0x0

    .line 12346
    .local v2, results:Ljava/util/List;,"Ljava/util/List<Landroid/app/ResultInfo;>;"
    const/4 v3, 0x0

    .line 12347
    .local v3, newIntents:Ljava/util/List;,"Ljava/util/List<Landroid/content/Intent;>;"
    if-eqz p3, :cond_b

    .line 12348
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 12349
    iget-object v3, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    .line 12354
    :cond_b
    if-eqz p3, :cond_47

    const/16 v0, 0x7543

    :goto_f
    const/4 v1, 0x3

    new-array v1, v1, [Ljava/lang/Object;

    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v4

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v1, v7

    iget-object v4, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v4, v4, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v1, v8

    const/4 v4, 0x2

    iget-object v5, p1, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v5, v1, v4

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 12358
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {p1, v0, v7}, Lcom/android/server/am/HistoryRecord;->startFreezingScreenLocked(Lcom/android/server/am/ProcessRecord;I)V

    .line 12362
    :try_start_33
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez p3, :cond_4a

    move v5, v8

    :goto_3a
    move-object v1, p1

    move v4, p2

    invoke-interface/range {v0 .. v5}, Landroid/app/IApplicationThread;->scheduleRelaunchActivity(Landroid/os/IBinder;Ljava/util/List;Ljava/util/List;IZ)V
    :try_end_3f
    .catch Landroid/os/RemoteException; {:try_start_33 .. :try_end_3f} :catch_4c

    .line 12371
    if-eqz p3, :cond_45

    .line 12372
    iput-object v9, p1, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 12373
    iput-object v9, p1, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    :cond_45
    move v0, v8

    .line 12376
    :goto_46
    return v0

    .line 12354
    :cond_47
    const/16 v0, 0x7544

    goto :goto_f

    :cond_4a
    move v5, v7

    .line 12362
    goto :goto_3a

    .line 12367
    :catch_4c
    move-exception v0

    move-object v6, v0

    .local v6, e:Landroid/os/RemoteException;
    move v0, v7

    .line 12368
    goto :goto_46
.end method

.method private final removeActivityFromHistoryLocked(Lcom/android/server/am/HistoryRecord;)V
    .registers 4
    .parameter "r"

    .prologue
    .line 4242
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v1, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v0, v1, :cond_1d

    .line 4243
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 4244
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    .line 4245
    sget-object v0, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v0, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 4246
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v0, p1}, Lcom/android/server/WindowManagerService;->removeAppToken(Landroid/os/IBinder;)V

    .line 4250
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->cleanUpActivityServicesLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4251
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->removeActivityUriPermissionsLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 4253
    :cond_1d
    return-void
.end method

.method private removeActivityUriPermissionsLocked(Lcom/android/server/am/HistoryRecord;)V
    .registers 5
    .parameter "activity"

    .prologue
    .line 6286
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    if-eqz v2, :cond_33

    .line 6287
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->readUriPermissions:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v0

    .local v0, i$:Ljava/util/Iterator;
    :cond_a
    :goto_a
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_33

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/UriPermission;

    .line 6288
    .local v1, perm:Lcom/android/server/am/UriPermission;
    iget-object v2, v1, Lcom/android/server/am/UriPermission;->readActivities:Ljava/util/HashSet;

    invoke-virtual {v2, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 6289
    iget-object v2, v1, Lcom/android/server/am/UriPermission;->readActivities:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->size()I

    move-result v2

    if-nez v2, :cond_a

    iget v2, v1, Lcom/android/server/am/UriPermission;->globalModeFlags:I

    and-int/lit8 v2, v2, 0x1

    if-nez v2, :cond_a

    .line 6291
    iget v2, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    and-int/lit8 v2, v2, -0x2

    iput v2, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    .line 6292
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->removeUriPermissionIfNeededLocked(Lcom/android/server/am/UriPermission;)V

    goto :goto_a

    .line 6296
    .end local v0           #i$:Ljava/util/Iterator;
    .end local v1           #perm:Lcom/android/server/am/UriPermission;
    :cond_33
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    if-eqz v2, :cond_66

    .line 6297
    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->writeUriPermissions:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v0

    .restart local v0       #i$:Ljava/util/Iterator;
    :cond_3d
    :goto_3d
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_66

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/UriPermission;

    .line 6298
    .restart local v1       #perm:Lcom/android/server/am/UriPermission;
    iget-object v2, v1, Lcom/android/server/am/UriPermission;->writeActivities:Ljava/util/HashSet;

    invoke-virtual {v2, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 6299
    iget-object v2, v1, Lcom/android/server/am/UriPermission;->writeActivities:Ljava/util/HashSet;

    invoke-virtual {v2}, Ljava/util/HashSet;->size()I

    move-result v2

    if-nez v2, :cond_3d

    iget v2, v1, Lcom/android/server/am/UriPermission;->globalModeFlags:I

    and-int/lit8 v2, v2, 0x2

    if-nez v2, :cond_3d

    .line 6301
    iget v2, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    and-int/lit8 v2, v2, -0x3

    iput v2, v1, Lcom/android/server/am/UriPermission;->modeFlags:I

    .line 6302
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->removeUriPermissionIfNeededLocked(Lcom/android/server/am/UriPermission;)V

    goto :goto_3d

    .line 6306
    .end local v0           #i$:Ljava/util/Iterator;
    .end local v1           #perm:Lcom/android/server/am/UriPermission;
    :cond_66
    return-void
.end method

.method private removeConnectionLocked(Lcom/android/server/am/ConnectionRecord;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;)V
    .registers 12
    .parameter "c"
    .parameter "skipApp"
    .parameter "skipAct"

    .prologue
    const/4 v7, 0x0

    .line 10663
    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    invoke-interface {v4}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v1

    .line 10664
    .local v1, binder:Landroid/os/IBinder;
    iget-object v0, p1, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    .line 10665
    .local v0, b:Lcom/android/server/am/AppBindRecord;
    iget-object v3, v0, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    .line 10666
    .local v3, s:Lcom/android/server/am/ServiceRecord;
    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v4, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 10667
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v4, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 10668
    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    if-eqz v4, :cond_2a

    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    if-eq v4, p3, :cond_2a

    .line 10669
    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    iget-object v4, v4, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    if-eqz v4, :cond_2a

    .line 10670
    iget-object v4, p1, Lcom/android/server/am/ConnectionRecord;->activity:Lcom/android/server/am/HistoryRecord;

    iget-object v4, v4, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v4, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 10673
    :cond_2a
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    if-eq v4, p2, :cond_35

    .line 10674
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v4, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 10676
    :cond_35
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    invoke-virtual {v4, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 10678
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->connections:Ljava/util/HashSet;

    invoke-virtual {v4}, Ljava/util/HashSet;->size()I

    move-result v4

    if-nez v4, :cond_4b

    .line 10679
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-object v4, v4, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    iget-object v5, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 10684
    :cond_4b
    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v4, :cond_86

    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v4, :cond_86

    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-object v4, v4, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    invoke-virtual {v4}, Ljava/util/HashMap;->size()I

    move-result v4

    if-nez v4, :cond_86

    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-boolean v4, v4, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    if-eqz v4, :cond_86

    .line 10687
    :try_start_65
    invoke-direct {p0, v3}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 10688
    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 10689
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    const/4 v5, 0x0

    iput-boolean v5, v4, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    .line 10692
    iget-object v4, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    const/4 v5, 0x0

    iput-boolean v5, v4, Lcom/android/server/am/IntentBindRecord;->doRebind:Z

    .line 10693
    iget-object v4, v3, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v5, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-object v5, v5, Lcom/android/server/am/IntentBindRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v5}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v5

    invoke-interface {v4, v3, v5}, Landroid/app/IApplicationThread;->scheduleUnbindService(Landroid/os/IBinder;Landroid/content/Intent;)V
    :try_end_86
    .catch Ljava/lang/Exception; {:try_start_65 .. :try_end_86} :catch_90

    .line 10700
    :cond_86
    :goto_86
    iget v4, p1, Lcom/android/server/am/ConnectionRecord;->flags:I

    and-int/lit8 v4, v4, 0x1

    if-eqz v4, :cond_8f

    .line 10701
    invoke-direct {p0, v3, v7}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 10703
    :cond_8f
    return-void

    .line 10694
    :catch_90
    move-exception v4

    move-object v2, v4

    .line 10695
    .local v2, e:Ljava/lang/Exception;
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Exception when unbinding service "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v3, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 10696
    const/4 v4, 0x1

    invoke-virtual {p0, v3, v4}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    goto :goto_86
.end method

.method private removeContentProviderExternal(Ljava/lang/String;)V
    .registers 7
    .parameter "name"

    .prologue
    .line 7679
    monitor-enter p0

    .line 7680
    :try_start_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v2, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ContentProviderRecord;

    .line 7681
    .local v0, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-nez v0, :cond_d

    .line 7684
    monitor-exit p0

    .line 7695
    :goto_c
    return-void

    .line 7688
    :cond_d
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v3, v0, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v3, v3, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ContentProviderRecord;

    .line 7689
    .local v1, localCpr:Lcom/android/server/am/ContentProviderRecord;
    iget v2, v1, Lcom/android/server/am/ContentProviderRecord;->externals:I

    const/4 v3, 0x1

    sub-int/2addr v2, v3

    iput v2, v1, Lcom/android/server/am/ContentProviderRecord;->externals:I

    .line 7690
    iget v2, v1, Lcom/android/server/am/ContentProviderRecord;->externals:I

    if-gez v2, :cond_3b

    .line 7691
    const-string v2, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Externals < 0 for content provider "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 7693
    :cond_3b
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 7694
    monitor-exit p0

    goto :goto_c

    .end local v0           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v1           #localCpr:Lcom/android/server/am/ContentProviderRecord;
    :catchall_40
    move-exception v2

    monitor-exit p0
    :try_end_42
    .catchall {:try_start_1 .. :try_end_42} :catchall_40

    throw v2
.end method

.method private final removeDyingProviderLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/ContentProviderRecord;)V
    .registers 10
    .parameter "proc"
    .parameter "cpr"

    .prologue
    .line 9592
    monitor-enter p2

    .line 9593
    const/4 v4, 0x0

    :try_start_2
    iput-object v4, p2, Lcom/android/server/am/ContentProviderRecord;->launchingApp:Lcom/android/server/am/ProcessRecord;

    .line 9594
    invoke-virtual {p2}, Ljava/lang/Object;->notifyAll()V

    .line 9595
    monitor-exit p2
    :try_end_8
    .catchall {:try_start_2 .. :try_end_8} :catchall_29

    .line 9597
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v5, p2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v5, v5, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 9598
    iget-object v4, p2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v4, v4, Landroid/content/pm/ProviderInfo;->authority:Ljava/lang/String;

    const-string v5, ";"

    invoke-virtual {v4, v5}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v3

    .line 9599
    .local v3, names:[Ljava/lang/String;
    const/4 v2, 0x0

    .local v2, j:I
    :goto_1c
    array-length v4, v3

    if-ge v2, v4, :cond_2c

    .line 9600
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    aget-object v5, v3, v2

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 9599
    add-int/lit8 v2, v2, 0x1

    goto :goto_1c

    .line 9595
    .end local v2           #j:I
    .end local v3           #names:[Ljava/lang/String;
    :catchall_29
    move-exception v4

    :try_start_2a
    monitor-exit p2
    :try_end_2b
    .catchall {:try_start_2a .. :try_end_2b} :catchall_29

    throw v4

    .line 9603
    .restart local v2       #j:I
    .restart local v3       #names:[Ljava/lang/String;
    :cond_2c
    iget-object v4, p2, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    invoke-virtual {v4}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .line 9604
    .local v1, cit:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ProcessRecord;>;"
    :cond_32
    :goto_32
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_96

    .line 9605
    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    .line 9606
    .local v0, capp:Lcom/android/server/am/ProcessRecord;
    iget-boolean v4, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v4, :cond_32

    iget-object v4, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v4, :cond_32

    iget v4, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    if-eqz v4, :cond_32

    iget v4, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    iget v5, p0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v4, v5, :cond_32

    .line 9609
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Killing app "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " (pid "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget v6, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ") because provider "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, p2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v6, v6, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " is in dying process "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 9613
    iget v4, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v4}, Landroid/os/Process;->killProcess(I)V

    goto :goto_32

    .line 9617
    .end local v0           #capp:Lcom/android/server/am/ProcessRecord;
    :cond_96
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v4, p2}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 9618
    return-void
.end method

.method private static removeHistoryRecordsForAppLocked(Ljava/util/ArrayList;Lcom/android/server/am/ProcessRecord;)V
    .registers 5
    .parameter "list"
    .parameter "app"

    .prologue
    .line 4336
    invoke-virtual {p0}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 4340
    .local v0, i:I
    :cond_4
    :goto_4
    if-lez v0, :cond_16

    .line 4341
    add-int/lit8 v0, v0, -0x1

    .line 4342
    invoke-virtual {p0, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 4345
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v2, p1, :cond_4

    .line 4347
    invoke-virtual {p0, v0}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    goto :goto_4

    .line 4350
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_16
    return-void
.end method

.method private final removeProcessLocked(Lcom/android/server/am/ProcessRecord;Z)Z
    .registers 10
    .parameter "app"
    .parameter "callerWillRestart"

    .prologue
    .line 5035
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    .line 5036
    .local v0, name:Ljava/lang/String;
    iget-object v4, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v3, v4, Landroid/content/pm/ApplicationInfo;->uid:I

    .line 5037
    .local v3, uid:I
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Force removing process "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " ("

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "/"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ")"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 5041
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v4, v0, v3}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 5042
    const/4 v1, 0x0

    .line 5043
    .local v1, needRestart:Z
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v4, :cond_77

    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    iget v5, p0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v4, v5, :cond_77

    .line 5044
    iget v2, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 5045
    .local v2, pid:I
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v4

    .line 5046
    :try_start_4d
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v5, v2}, Landroid/util/SparseArray;->remove(I)V

    .line 5047
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v6, 0x14

    invoke-virtual {v5, v6, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 5048
    monitor-exit v4
    :try_end_5a
    .catchall {:try_start_4d .. :try_end_5a} :catchall_72

    .line 5049
    const/4 v4, 0x1

    invoke-direct {p0, p1, v4}, Lcom/android/server/am/ActivityManagerService;->handleAppDiedLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 5050
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 5051
    invoke-static {v2}, Landroid/os/Process;->killProcess(I)V

    .line 5053
    iget-boolean v4, p1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v4, :cond_71

    .line 5054
    if-nez p2, :cond_75

    .line 5055
    iget-object v4, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {p0, v4}, Lcom/android/server/am/ActivityManagerService;->addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;

    .line 5064
    .end local v2           #pid:I
    :cond_71
    :goto_71
    return v1

    .line 5048
    .restart local v2       #pid:I
    :catchall_72
    move-exception v5

    :try_start_73
    monitor-exit v4
    :try_end_74
    .catchall {:try_start_73 .. :try_end_74} :catchall_72

    throw v5

    .line 5057
    :cond_75
    const/4 v1, 0x1

    goto :goto_71

    .line 5061
    .end local v2           #pid:I
    :cond_77
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_71
.end method

.method private removeUriPermissionIfNeededLocked(Lcom/android/server/am/UriPermission;)V
    .registers 5
    .parameter "perm"

    .prologue
    .line 6272
    iget v1, p1, Lcom/android/server/am/UriPermission;->modeFlags:I

    and-int/lit8 v1, v1, 0x3

    if-nez v1, :cond_24

    .line 6274
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    iget v2, p1, Lcom/android/server/am/UriPermission;->uid:I

    invoke-virtual {v1, v2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/util/HashMap;

    .line 6276
    .local v0, perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    if-eqz v0, :cond_24

    .line 6277
    iget-object v1, p1, Lcom/android/server/am/UriPermission;->uri:Landroid/net/Uri;

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 6278
    invoke-virtual {v0}, Ljava/util/HashMap;->size()I

    move-result v1

    if-nez v1, :cond_24

    .line 6279
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    iget v2, p1, Lcom/android/server/am/UriPermission;->uid:I

    invoke-virtual {v1, v2}, Landroid/util/SparseArray;->remove(I)V

    .line 6283
    .end local v0           #perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    :cond_24
    return-void
.end method

.method private reportResumedActivity(Lcom/android/server/am/HistoryRecord;)V
    .registers 6
    .parameter "r"

    .prologue
    .line 2533
    invoke-static {p1}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v1

    .line 2534
    .local v1, identHash:I
    const/4 v3, 0x1

    invoke-direct {p0, p1, v3}, Lcom/android/server/am/ActivityManagerService;->updateUsageStats(Lcom/android/server/am/HistoryRecord;Z)V

    .line 2536
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v3}, Landroid/os/RemoteCallbackList;->beginBroadcast()I

    move-result v0

    .line 2537
    .local v0, i:I
    :cond_e
    :goto_e
    if-lez v0, :cond_22

    .line 2538
    add-int/lit8 v0, v0, -0x1

    .line 2539
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v3, v0}, Landroid/os/RemoteCallbackList;->getBroadcastItem(I)Landroid/os/IInterface;

    move-result-object v2

    check-cast v2, Landroid/app/IActivityWatcher;

    .line 2540
    .local v2, w:Landroid/app/IActivityWatcher;
    if-eqz v2, :cond_e

    .line 2542
    :try_start_1c
    invoke-interface {v2, v1}, Landroid/app/IActivityWatcher;->activityResuming(I)V
    :try_end_1f
    .catch Landroid/os/RemoteException; {:try_start_1c .. :try_end_1f} :catch_20

    goto :goto_e

    .line 2543
    :catch_20
    move-exception v3

    goto :goto_e

    .line 2547
    .end local v2           #w:Landroid/app/IActivityWatcher;
    :cond_22
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v3}, Landroid/os/RemoteCallbackList;->finishBroadcast()V

    .line 2548
    return-void
.end method

.method private reportStartInstrumentationFailure(Landroid/app/IInstrumentationWatcher;Landroid/content/ComponentName;Ljava/lang/String;)V
    .registers 9
    .parameter "watcher"
    .parameter "cn"
    .parameter "report"

    .prologue
    const-string v4, "ActivityManager"

    .line 12166
    const-string v2, "ActivityManager"

    invoke-static {v4, p3}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12168
    if-eqz p1, :cond_1e

    .line 12169
    :try_start_9
    new-instance v1, Landroid/os/Bundle;

    invoke-direct {v1}, Landroid/os/Bundle;-><init>()V

    .line 12170
    .local v1, results:Landroid/os/Bundle;
    const-string v2, "id"

    const-string v3, "ActivityManagerService"

    invoke-virtual {v1, v2, v3}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 12171
    const-string v2, "Error"

    invoke-virtual {v1, v2, p3}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 12172
    const/4 v2, -0x1

    invoke-interface {p1, p2, v2, v1}, Landroid/app/IInstrumentationWatcher;->instrumentationStatus(Landroid/content/ComponentName;ILandroid/os/Bundle;)V
    :try_end_1e
    .catch Landroid/os/RemoteException; {:try_start_9 .. :try_end_1e} :catch_1f

    .line 12177
    .end local v1           #results:Landroid/os/Bundle;
    :cond_1e
    :goto_1e
    return-void

    .line 12174
    :catch_1f
    move-exception v2

    move-object v0, v2

    .line 12175
    .local v0, e:Landroid/os/RemoteException;
    const-string v2, "ActivityManager"

    invoke-static {v4, v0}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_1e
.end method

.method private final requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z
    .registers 15
    .parameter "token"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "reason"

    .prologue
    const/4 v9, 0x1

    const/4 v4, 0x0

    .line 3883
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v2

    .line 3884
    .local v2, index:I
    if-gez v2, :cond_a

    move v0, v4

    .line 3908
    :goto_9
    return v0

    .line 3887
    :cond_a
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 3890
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    const/4 v7, 0x1

    .line 3891
    .local v7, lastActivity:Z
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    sub-int v6, v0, v9

    .local v6, i:I
    :goto_1b
    if-ltz v6, :cond_2c

    .line 3892
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/am/HistoryRecord;

    .line 3893
    .local v8, p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v0, v8, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v0, :cond_3a

    if-eq v8, v1, :cond_3a

    .line 3894
    const/4 v7, 0x0

    .line 3901
    .end local v8           #p:Lcom/android/server/am/HistoryRecord;
    :cond_2c
    if-eqz v7, :cond_3d

    .line 3902
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    const-string v3, "android.intent.category.HOME"

    invoke-virtual {v0, v3}, Landroid/content/Intent;->hasCategory(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_3d

    move v0, v4

    .line 3903
    goto :goto_9

    .line 3891
    .restart local v8       #p:Lcom/android/server/am/HistoryRecord;
    :cond_3a
    add-int/lit8 v6, v6, -0x1

    goto :goto_1b

    .end local v8           #p:Lcom/android/server/am/HistoryRecord;
    :cond_3d
    move-object v0, p0

    move v3, p2

    move-object v4, p3

    move-object v5, p4

    .line 3907
    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move v0, v9

    .line 3908
    goto :goto_9
.end method

.method private final requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z
    .registers 9
    .parameter "r"
    .parameter "i"
    .parameter "rebind"

    .prologue
    const/4 v4, 0x1

    const/4 v3, 0x0

    .line 10042
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_c

    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v1, :cond_e

    :cond_c
    move v1, v3

    .line 10061
    :goto_d
    return v1

    .line 10046
    :cond_e
    iget-boolean v1, p2, Lcom/android/server/am/IntentBindRecord;->requested:Z

    if-eqz v1, :cond_14

    if-eqz p3, :cond_37

    :cond_14
    iget-object v1, p2, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->size()I

    move-result v1

    if-lez v1, :cond_37

    .line 10048
    :try_start_1c
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 10051
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v2, p2, Lcom/android/server/am/IntentBindRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v2}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v2

    invoke-interface {v1, p1, v2, p3}, Landroid/app/IApplicationThread;->scheduleBindService(Landroid/os/IBinder;Landroid/content/Intent;Z)V

    .line 10052
    if-nez p3, :cond_31

    .line 10053
    const/4 v1, 0x1

    iput-boolean v1, p2, Lcom/android/server/am/IntentBindRecord;->requested:Z

    .line 10055
    :cond_31
    const/4 v1, 0x1

    iput-boolean v1, p2, Lcom/android/server/am/IntentBindRecord;->hasBound:Z

    .line 10056
    const/4 v1, 0x0

    iput-boolean v1, p2, Lcom/android/server/am/IntentBindRecord;->doRebind:Z
    :try_end_37
    .catch Landroid/os/RemoteException; {:try_start_1c .. :try_end_37} :catch_39

    :cond_37
    move v1, v4

    .line 10061
    goto :goto_d

    .line 10057
    :catch_39
    move-exception v1

    move-object v0, v1

    .local v0, e:Landroid/os/RemoteException;
    move v1, v3

    .line 10058
    goto :goto_d
.end method

.method private final requestServiceBindingsLocked(Lcom/android/server/am/ServiceRecord;)V
    .registers 5
    .parameter "r"

    .prologue
    .line 10065
    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v2}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v0

    .line 10066
    .local v0, bindings:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/IntentBindRecord;>;"
    :cond_a
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_1d

    .line 10067
    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/IntentBindRecord;

    .line 10068
    .local v1, i:Lcom/android/server/am/IntentBindRecord;
    const/4 v2, 0x0

    invoke-direct {p0, p1, v1, v2}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z

    move-result v2

    if-nez v2, :cond_a

    .line 10072
    .end local v1           #i:Lcom/android/server/am/IntentBindRecord;
    :cond_1d
    return-void
.end method

.method private final resetTaskIfNeededLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;
    .registers 29
    .parameter "taskTop"
    .parameter "newActivity"

    .prologue
    .line 6669
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget v3, v3, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v3, v3, 0x4

    if-eqz v3, :cond_68

    const/4 v3, 0x1

    move/from16 v18, v3

    .line 6671
    .local v18, forceReset:Z
    :goto_e
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/am/TaskRecord;->getInactiveDuration()J

    move-result-wide v6

    const-wide/32 v8, 0x1b7740

    cmp-long v3, v6, v8

    if-lez v3, :cond_2b

    .line 6672
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget v3, v3, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v3, v3, 0x8

    if-nez v3, :cond_2b

    .line 6674
    const/16 v18, 0x1

    .line 6678
    :cond_2b
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object/from16 v24, v0

    .line 6683
    .local v24, task:Lcom/android/server/am/TaskRecord;
    const/16 v22, 0x0

    .line 6684
    .local v22, target:Lcom/android/server/am/HistoryRecord;
    const/16 v23, 0x0

    .line 6685
    .local v23, targetI:I
    const/16 v25, -0x1

    .line 6686
    .local v25, taskTopI:I
    const/16 v21, -0x1

    .line 6687
    .local v21, replyChainEnd:I
    const/16 v20, -0x1

    .line 6688
    .local v20, lastReparentPos:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v19, v3, v4

    .end local p2
    .local v19, i:I
    :goto_47
    const/4 v3, -0x1

    move/from16 v0, v19

    move v1, v3

    if-lt v0, v1, :cond_391

    .line 6689
    if-ltz v19, :cond_6c

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    check-cast p2, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v13, p2

    .line 6691
    .local v13, below:Lcom/android/server/am/HistoryRecord;
    :goto_5f
    if-eqz v13, :cond_6f

    iget-boolean v3, v13, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_6f

    .line 6688
    :goto_65
    add-int/lit8 v19, v19, -0x1

    goto :goto_47

    .line 6669
    .end local v13           #below:Lcom/android/server/am/HistoryRecord;
    .end local v18           #forceReset:Z
    .end local v19           #i:I
    .end local v20           #lastReparentPos:I
    .end local v21           #replyChainEnd:I
    .end local v22           #target:Lcom/android/server/am/HistoryRecord;
    .end local v23           #targetI:I
    .end local v24           #task:Lcom/android/server/am/TaskRecord;
    .end local v25           #taskTopI:I
    .restart local p2
    :cond_68
    const/4 v3, 0x0

    move/from16 v18, v3

    goto :goto_e

    .line 6689
    .end local p2
    .restart local v18       #forceReset:Z
    .restart local v19       #i:I
    .restart local v20       #lastReparentPos:I
    .restart local v21       #replyChainEnd:I
    .restart local v22       #target:Lcom/android/server/am/HistoryRecord;
    .restart local v23       #targetI:I
    .restart local v24       #task:Lcom/android/server/am/TaskRecord;
    .restart local v25       #taskTopI:I
    :cond_6c
    const/4 v3, 0x0

    move-object v13, v3

    goto :goto_5f

    .line 6694
    .restart local v13       #below:Lcom/android/server/am/HistoryRecord;
    :cond_6f
    if-nez v22, :cond_78

    .line 6695
    move-object/from16 v22, v13

    .line 6696
    move/from16 v23, v19

    .line 6700
    const/16 v21, -0x1

    .line 6701
    goto :goto_65

    .line 6704
    :cond_78
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    move-object v0, v3

    iget v0, v0, Landroid/content/pm/ActivityInfo;->flags:I

    move/from16 v17, v0

    .line 6706
    .local v17, flags:I
    and-int/lit8 v3, v17, 0x2

    if-eqz v3, :cond_ca

    const/4 v3, 0x1

    move/from16 v16, v3

    .line 6708
    .local v16, finishOnTaskLaunch:Z
    :goto_89
    and-int/lit8 v3, v17, 0x40

    if-eqz v3, :cond_ce

    const/4 v3, 0x1

    move v12, v3

    .line 6711
    .local v12, allowTaskReparenting:Z
    :goto_8f
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, v24

    if-ne v0, v1, :cond_278

    .line 6717
    if-gez v25, :cond_9d

    .line 6718
    move/from16 v25, v23

    .line 6720
    :cond_9d
    if-eqz v13, :cond_274

    iget-object v3, v13, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v0, v3

    move-object/from16 v1, v24

    if-ne v0, v1, :cond_274

    .line 6721
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Intent;->getFlags()I

    move-result v3

    const/high16 v4, 0x8

    and-int/2addr v3, v4

    if-eqz v3, :cond_d1

    const/4 v3, 0x1

    move v14, v3

    .line 6724
    .local v14, clearWhenTaskReset:Z
    :goto_b6
    if-nez v16, :cond_d4

    if-nez v14, :cond_d4

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v3, v0

    if-eqz v3, :cond_d4

    .line 6731
    if-gez v21, :cond_c5

    .line 6732
    move/from16 v21, v23

    .line 6943
    .end local v14           #clearWhenTaskReset:Z
    :cond_c5
    :goto_c5
    move-object/from16 v22, v13

    .line 6944
    move/from16 v23, v19

    goto :goto_65

    .line 6706
    .end local v12           #allowTaskReparenting:Z
    .end local v16           #finishOnTaskLaunch:Z
    :cond_ca
    const/4 v3, 0x0

    move/from16 v16, v3

    goto :goto_89

    .line 6708
    .restart local v16       #finishOnTaskLaunch:Z
    :cond_ce
    const/4 v3, 0x0

    move v12, v3

    goto :goto_8f

    .line 6721
    .restart local v12       #allowTaskReparenting:Z
    :cond_d1
    const/4 v3, 0x0

    move v14, v3

    goto :goto_b6

    .line 6734
    .restart local v14       #clearWhenTaskReset:Z
    :cond_d4
    if-nez v16, :cond_1f8

    if-nez v14, :cond_1f8

    if-eqz v12, :cond_1f8

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v3, v0

    if-eqz v3, :cond_1f8

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v3, v0

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_1f8

    .line 6743
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    const/4 v4, 0x0

    invoke-virtual {v3, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 6744
    .local v4, p:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v3, v0

    if-eqz v3, :cond_149

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v3, v0

    iget-object v5, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    invoke-virtual {v3, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_149

    .line 6749
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v0, v3

    move-object/from16 v1, v22

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 6763
    :goto_11a
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object/from16 v0, v24

    iget v0, v0, Lcom/android/server/am/TaskRecord;->taskId:I

    move v5, v0

    move-object v0, v3

    move-object/from16 v1, v22

    move v2, v5

    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->setAppGroupId(Landroid/os/IBinder;I)V

    .line 6764
    if-gez v21, :cond_12f

    .line 6765
    move/from16 v21, v23

    .line 6767
    :cond_12f
    const/4 v15, 0x0

    .line 6768
    .local v15, dstPos:I
    move/from16 v5, v23

    .local v5, srcPos:I
    :goto_132
    move v0, v5

    move/from16 v1, v21

    if-gt v0, v1, :cond_1da

    .line 6769
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 6770
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_192

    .line 6768
    :goto_146
    add-int/lit8 v5, v5, 0x1

    goto :goto_132

    .line 6753
    .end local v5           #srcPos:I
    .end local v15           #dstPos:I
    :cond_149
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v3, v0

    add-int/lit8 v3, v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 6754
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v3, v0

    if-gtz v3, :cond_162

    .line 6755
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 6757
    :cond_162
    new-instance v3, Lcom/android/server/am/TaskRecord;

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v5, v0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v6, v0

    const/4 v7, 0x0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget v8, v8, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v8, v8, 0x4

    if-eqz v8, :cond_190

    const/4 v8, 0x1

    :goto_17b
    invoke-direct {v3, v5, v6, v7, v8}, Lcom/android/server/am/TaskRecord;-><init>(ILandroid/content/pm/ActivityInfo;Landroid/content/Intent;Z)V

    move-object v0, v3

    move-object/from16 v1, v22

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 6759
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    iput-object v5, v3, Lcom/android/server/am/TaskRecord;->affinityIntent:Landroid/content/Intent;

    goto :goto_11a

    .line 6757
    :cond_190
    const/4 v8, 0x0

    goto :goto_17b

    .line 6775
    .restart local v5       #srcPos:I
    .restart local v15       #dstPos:I
    :cond_192
    move-object/from16 v0, v24

    iget v0, v0, Lcom/android/server/am/TaskRecord;->numActivities:I

    move v3, v0

    const/4 v6, 0x1

    sub-int/2addr v3, v6

    move v0, v3

    move-object/from16 v1, v24

    iput v0, v1, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 6776
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    iput-object v3, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 6777
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    iget v6, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    add-int/lit8 v6, v6, 0x1

    iput v6, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 6778
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 6779
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v15, v4}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 6780
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    invoke-virtual {v3, v15, v4}, Lcom/android/server/WindowManagerService;->moveAppToken(ILandroid/os/IBinder;)V

    .line 6781
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-virtual {v3, v4, v6}, Lcom/android/server/WindowManagerService;->setAppGroupId(Landroid/os/IBinder;I)V

    .line 6782
    add-int/lit8 v15, v15, 0x1

    .line 6786
    add-int/lit8 v19, v19, 0x1

    goto/16 :goto_146

    .line 6788
    :cond_1da
    move-object/from16 v0, p1

    move-object v1, v4

    if-ne v0, v1, :cond_1e1

    .line 6789
    move-object/from16 p1, v13

    .line 6791
    :cond_1e1
    move/from16 v0, v25

    move/from16 v1, v21

    if-ne v0, v1, :cond_1e9

    .line 6792
    const/16 v25, -0x1

    .line 6794
    :cond_1e9
    const/16 v21, -0x1

    .line 6795
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object/from16 v0, p0

    move-object v1, v3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->addRecentTask(Lcom/android/server/am/TaskRecord;)V

    goto/16 :goto_c5

    .line 6796
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v5           #srcPos:I
    .end local v15           #dstPos:I
    :cond_1f8
    if-nez v18, :cond_1fe

    if-nez v16, :cond_1fe

    if-eqz v14, :cond_270

    .line 6802
    :cond_1fe
    if-eqz v14, :cond_247

    .line 6806
    add-int/lit8 v21, v23, 0x1

    .line 6809
    :goto_202
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    move/from16 v0, v21

    move v1, v3

    if-ge v0, v1, :cond_22b

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    check-cast p2, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, v24

    if-ne v0, v1, :cond_22b

    .line 6810
    add-int/lit8 v21, v21, 0x1

    goto :goto_202

    .line 6812
    :cond_22b
    add-int/lit8 v21, v21, -0x1

    .line 6816
    :cond_22d
    :goto_22d
    const/4 v4, 0x0

    .line 6817
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    move/from16 v5, v23

    .restart local v5       #srcPos:I
    :goto_230
    move v0, v5

    move/from16 v1, v21

    if-gt v0, v1, :cond_25d

    .line 6818
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 6819
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_24c

    .line 6817
    :cond_244
    :goto_244
    add-int/lit8 v5, v5, 0x1

    goto :goto_230

    .line 6813
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v5           #srcPos:I
    :cond_247
    if-gez v21, :cond_22d

    .line 6814
    move/from16 v21, v23

    goto :goto_22d

    .line 6822
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    .restart local v5       #srcPos:I
    :cond_24c
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "reset"

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_244

    .line 6824
    add-int/lit8 v21, v21, -0x1

    .line 6825
    add-int/lit8 v5, v5, -0x1

    goto :goto_244

    .line 6828
    :cond_25d
    move-object/from16 v0, p1

    move-object v1, v4

    if-ne v0, v1, :cond_264

    .line 6829
    move-object/from16 p1, v13

    .line 6831
    :cond_264
    move/from16 v0, v25

    move/from16 v1, v21

    if-ne v0, v1, :cond_26c

    .line 6832
    const/16 v25, -0x1

    .line 6834
    :cond_26c
    const/16 v21, -0x1

    .line 6835
    goto/16 :goto_c5

    .line 6839
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v5           #srcPos:I
    :cond_270
    const/16 v21, -0x1

    goto/16 :goto_c5

    .line 6844
    .end local v14           #clearWhenTaskReset:Z
    :cond_274
    const/16 v21, -0x1

    goto/16 :goto_c5

    .line 6847
    :cond_278
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v3, v0

    if-eqz v3, :cond_285

    .line 6854
    if-gez v21, :cond_c5

    .line 6855
    move/from16 v21, v23

    goto/16 :goto_c5

    .line 6858
    :cond_285
    if-ltz v25, :cond_c5

    if-eqz v12, :cond_c5

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    move-object v3, v0

    if-eqz v3, :cond_c5

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/TaskRecord;->affinity:Ljava/lang/String;

    move-object v3, v0

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->taskAffinity:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_c5

    .line 6872
    if-nez v18, :cond_2a4

    if-eqz v16, :cond_2db

    .line 6873
    :cond_2a4
    if-gez v21, :cond_2a8

    .line 6874
    move/from16 v21, v23

    .line 6876
    :cond_2a8
    const/4 v4, 0x0

    .line 6877
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    move/from16 v5, v23

    .restart local v5       #srcPos:I
    :goto_2ab
    move v0, v5

    move/from16 v1, v21

    if-gt v0, v1, :cond_2d7

    .line 6878
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 6879
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_2c2

    .line 6877
    :cond_2bf
    :goto_2bf
    add-int/lit8 v5, v5, 0x1

    goto :goto_2ab

    .line 6882
    :cond_2c2
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "reset"

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_2bf

    .line 6884
    add-int/lit8 v25, v25, -0x1

    .line 6885
    add-int/lit8 v20, v20, -0x1

    .line 6886
    add-int/lit8 v21, v21, -0x1

    .line 6887
    add-int/lit8 v5, v5, -0x1

    goto :goto_2bf

    .line 6890
    :cond_2d7
    const/16 v21, -0x1

    .line 6891
    goto/16 :goto_c5

    .line 6892
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v5           #srcPos:I
    :cond_2db
    if-gez v21, :cond_2df

    .line 6893
    move/from16 v21, v23

    .line 6895
    :cond_2df
    move/from16 v5, v21

    .restart local v5       #srcPos:I
    :goto_2e1
    move v0, v5

    move/from16 v1, v23

    if-lt v0, v1, :cond_347

    .line 6896
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 6897
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_2f8

    .line 6895
    :goto_2f5
    add-int/lit8 v5, v5, -0x1

    goto :goto_2e1

    .line 6900
    :cond_2f8
    if-gez v20, :cond_344

    .line 6901
    move/from16 v20, v25

    .line 6902
    move-object/from16 p1, v4

    .line 6906
    :goto_2fe
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 6907
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    const/4 v7, 0x1

    sub-int/2addr v6, v7

    iput v6, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 6908
    move-object/from16 v0, v24

    move-object v1, v4

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 6909
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v20

    move-object v2, v4

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 6912
    move-object/from16 v0, v24

    iget v0, v0, Lcom/android/server/am/TaskRecord;->numActivities:I

    move v3, v0

    add-int/lit8 v3, v3, 0x1

    move v0, v3

    move-object/from16 v1, v24

    iput v0, v1, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 6913
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v20

    move-object v2, v4

    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->moveAppToken(ILandroid/os/IBinder;)V

    .line 6914
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    iget-object v6, v4, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-virtual {v3, v4, v6}, Lcom/android/server/WindowManagerService;->setAppGroupId(Landroid/os/IBinder;I)V

    goto :goto_2f5

    .line 6904
    :cond_344
    add-int/lit8 v20, v20, -0x1

    goto :goto_2fe

    .line 6919
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    :cond_347
    const/16 v21, -0x1

    .line 6925
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget v3, v3, Landroid/content/pm/ActivityInfo;->launchMode:I

    const/4 v4, 0x1

    if-ne v3, v4, :cond_c5

    .line 6926
    const/4 v3, 0x1

    sub-int v8, v20, v3

    .end local v5           #srcPos:I
    .local v8, j:I
    :goto_356
    if-ltz v8, :cond_c5

    .line 6927
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v8}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 6928
    .restart local v4       #p:Lcom/android/server/am/HistoryRecord;
    iget-boolean v3, v4, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v3, :cond_36a

    .line 6926
    :cond_367
    :goto_367
    add-int/lit8 v8, v8, -0x1

    goto :goto_356

    .line 6931
    :cond_36a
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v3}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v3

    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    invoke-virtual {v3, v5}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_367

    .line 6932
    const/4 v9, 0x0

    const/4 v10, 0x0

    const-string v11, "replace"

    move-object/from16 v6, p0

    move-object v7, v4

    invoke-direct/range {v6 .. v11}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_367

    .line 6934
    add-int/lit8 v25, v25, -0x1

    .line 6935
    add-int/lit8 v20, v20, -0x1

    goto :goto_367

    .line 6947
    .end local v4           #p:Lcom/android/server/am/HistoryRecord;
    .end local v8           #j:I
    .end local v12           #allowTaskReparenting:Z
    .end local v13           #below:Lcom/android/server/am/HistoryRecord;
    .end local v16           #finishOnTaskLaunch:Z
    .end local v17           #flags:I
    :cond_391
    return-object p1
.end method

.method private restartPackageLocked(Ljava/lang/String;I)V
    .registers 21
    .parameter "packageName"
    .parameter "uid"

    .prologue
    .line 4945
    const/4 v4, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, p2

    move v3, v4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->uninstallPackageLocked(Ljava/lang/String;IZ)V

    .line 4946
    new-instance v7, Landroid/content/Intent;

    const-string v4, "android.intent.action.PACKAGE_RESTARTED"

    const-string v5, "package"

    const/4 v6, 0x0

    move-object v0, v5

    move-object/from16 v1, p1

    move-object v2, v6

    invoke-static {v0, v1, v2}, Landroid/net/Uri;->fromParts(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v5

    invoke-direct {v7, v4, v5}, Landroid/content/Intent;-><init>(Ljava/lang/String;Landroid/net/Uri;)V

    .line 4948
    .local v7, intent:Landroid/content/Intent;
    const-string v4, "android.intent.extra.UID"

    move-object v0, v7

    move-object v1, v4

    move/from16 v2, p2

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;

    .line 4949
    const/4 v5, 0x0

    const/4 v6, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, 0x0

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move/from16 v16, v0

    const/16 v17, 0x3e8

    move-object/from16 v4, p0

    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 4952
    return-void
.end method

.method private final resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z
    .registers 24
    .parameter "prev"

    .prologue
    .line 2561
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v6

    .line 2565
    .local v6, next:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    move/from16 v21, v0

    .line 2566
    .local v21, userLeaving:Z
    const/4 v5, 0x0

    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    .line 2568
    if-nez v6, :cond_1b

    .line 2571
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->startHomeActivityLocked()Z

    move-result v5

    .line 2799
    .end local v6           #next:Lcom/android/server/am/HistoryRecord;
    :goto_1a
    return v5

    .line 2574
    .restart local v6       #next:Lcom/android/server/am/HistoryRecord;
    :cond_1b
    const/4 v5, 0x0

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->delayedResume:Z

    .line 2577
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-ne v5, v6, :cond_35

    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v5, v7, :cond_35

    .line 2580
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/WindowManagerService;->executeAppTransition()V

    .line 2581
    const/4 v5, 0x0

    goto :goto_1a

    .line 2586
    :cond_35
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    move v5, v0

    if-nez v5, :cond_43

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    move v5, v0

    if-eqz v5, :cond_5a

    :cond_43
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-ne v5, v6, :cond_5a

    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v7, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v5, v7, :cond_5a

    .line 2590
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/WindowManagerService;->executeAppTransition()V

    .line 2591
    const/4 v5, 0x0

    goto :goto_1a

    .line 2596
    :cond_5a
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 2597
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 2603
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_73

    .line 2605
    const/4 v5, 0x0

    goto :goto_1a

    .line 2610
    :cond_73
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_85

    .line 2612
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move/from16 v1, v21

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->startPausingLocked(ZZ)V

    .line 2613
    const/4 v5, 0x1

    goto :goto_1a

    .line 2616
    :cond_85
    if-eqz p1, :cond_aa

    move-object/from16 v0, p1

    move-object v1, v6

    if-eq v0, v1, :cond_aa

    .line 2617
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    move v5, v0

    if-nez v5, :cond_165

    if-eqz v6, :cond_165

    iget-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    if-nez v5, :cond_165

    .line 2618
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    .line 2619
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 2649
    :cond_aa
    :goto_aa
    if-eqz p1, :cond_196

    .line 2650
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move v5, v0

    if-eqz v5, :cond_17f

    .line 2653
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v7, v0

    iget-object v8, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-ne v7, v8, :cond_17b

    const/4 v7, 0x7

    :goto_c2
    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 2656
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Lcom/android/server/WindowManagerService;->setAppWillBeHidden(Landroid/os/IBinder;)V

    .line 2657
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x0

    move-object v0, v5

    move-object/from16 v1, p1

    move v2, v7

    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2675
    :cond_dd
    :goto_dd
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v5, :cond_295

    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v5, :cond_295

    .line 2679
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x1

    invoke-virtual {v5, v6, v7}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 2681
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object/from16 v18, v0

    .line 2682
    .local v18, lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    move-object v0, v6

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object/from16 v19, v0

    .line 2684
    .local v19, lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStats()V

    .line 2686
    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v5, v6, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 2687
    move-object v0, v6

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2688
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    invoke-virtual {v5}, Lcom/android/server/am/TaskRecord;->touchActiveTime()V

    .line 2689
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v7, 0x1

    move-object/from16 v0, p0

    move-object v1, v5

    move v2, v7

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->updateLRUListLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 2690
    move-object/from16 v0, p0

    move-object v1, v6

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->updateLRUListLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 2694
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v7, v0

    iget-object v8, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v6, v8}, Lcom/android/server/am/HistoryRecord;->mayFreezeScreenLocked(Lcom/android/server/am/ProcessRecord;)Z

    move-result v8

    if-eqz v8, :cond_1ad

    move-object v8, v6

    :goto_12f
    invoke-virtual {v5, v7, v8}, Lcom/android/server/WindowManagerService;->updateOrientationFromAppTokens(Landroid/content/res/Configuration;Landroid/os/IBinder;)Landroid/content/res/Configuration;

    move-result-object v16

    .line 2697
    .local v16, config:Landroid/content/res/Configuration;
    if-eqz v16, :cond_138

    .line 2698
    const/4 v5, 0x1

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->frozenBeforeDestroy:Z

    .line 2700
    :cond_138
    move-object/from16 v0, p0

    move-object/from16 v1, v16

    move-object v2, v6

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z

    move-result v5

    if-nez v5, :cond_1af

    .line 2706
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v20

    .line 2710
    .local v20, nextNext:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v20

    move-object v1, v6

    if-eq v0, v1, :cond_15a

    .line 2712
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x13

    invoke-virtual {v5, v6}, Landroid/os/Handler;->sendEmptyMessage(I)Z

    .line 2714
    .end local v6           #next:Lcom/android/server/am/HistoryRecord;
    :cond_15a
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/WindowManagerService;->executeAppTransition()V

    .line 2715
    const/4 v5, 0x1

    goto/16 :goto_1a

    .line 2631
    .end local v16           #config:Landroid/content/res/Configuration;
    .end local v18           #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .end local v19           #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    .end local v20           #nextNext:Lcom/android/server/am/HistoryRecord;
    .restart local v6       #next:Lcom/android/server/am/HistoryRecord;
    :cond_165
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move v5, v0

    if-eqz v5, :cond_aa

    .line 2632
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x0

    move-object v0, v5

    move-object/from16 v1, p1

    move v2, v7

    invoke-virtual {v0, v1, v2}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    goto/16 :goto_aa

    .line 2653
    :cond_17b
    const/16 v7, 0x9

    goto/16 :goto_c2

    .line 2661
    :cond_17f
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v7, v0

    iget-object v8, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-ne v7, v8, :cond_193

    const/4 v7, 0x6

    :goto_18e
    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto/16 :goto_dd

    :cond_193
    const/16 v7, 0x8

    goto :goto_18e

    .line 2669
    :cond_196
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    const/4 v7, 0x1

    if-le v5, v7, :cond_dd

    .line 2672
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    const/4 v7, 0x6

    invoke-virtual {v5, v7}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    goto/16 :goto_dd

    .line 2694
    .restart local v18       #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .restart local v19       #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    :cond_1ad
    const/4 v8, 0x0

    goto :goto_12f

    .line 2720
    .restart local v16       #config:Landroid/content/res/Configuration;
    :cond_1af
    :try_start_1af
    iget-object v15, v6, Lcom/android/server/am/HistoryRecord;->results:Ljava/util/ArrayList;

    .line 2721
    .local v15, a:Ljava/util/ArrayList;
    if-eqz v15, :cond_1c4

    .line 2722
    invoke-virtual {v15}, Ljava/util/ArrayList;->size()I

    move-result v14

    .line 2723
    .local v14, N:I
    iget-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v5, :cond_1c4

    if-lez v14, :cond_1c4

    .line 2727
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v5, v6, v15}, Landroid/app/IApplicationThread;->scheduleSendResult(Landroid/os/IBinder;Ljava/util/List;)V

    .line 2731
    .end local v14           #N:I
    :cond_1c4
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    if-eqz v5, :cond_1d1

    .line 2732
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-object v7, v6, Lcom/android/server/am/HistoryRecord;->newIntents:Ljava/util/ArrayList;

    invoke-interface {v5, v7, v6}, Landroid/app/IApplicationThread;->scheduleNewIntent(Ljava/util/List;Landroid/os/IBinder;)V

    .line 2735
    :cond_1d1
    const/16 v5, 0x7537

    const/4 v7, 0x3

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    invoke-static {v6}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v9

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    const/4 v8, 0x1

    iget-object v9, v6, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v9, v9, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v7, v8

    const/4 v8, 0x2

    iget-object v9, v6, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v9, v7, v8

    invoke-static {v5, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 2739
    iget-object v5, v6, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->isNextTransitionForward()Z

    move-result v7

    invoke-interface {v5, v6, v7}, Landroid/app/IApplicationThread;->scheduleResumeActivity(Landroid/os/IBinder;Z)V

    .line 2742
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->pauseIfSleepingLocked()V
    :try_end_202
    .catch Ljava/lang/Exception; {:try_start_1af .. :try_end_202} :catch_217

    .line 2767
    const/4 v5, 0x1

    :try_start_203
    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->visible:Z

    .line 2768
    move-object/from16 v0, p0

    move-object v1, v6

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->completeResumeLocked(Lcom/android/server/am/HistoryRecord;)V
    :try_end_20b
    .catch Ljava/lang/Exception; {:try_start_203 .. :try_end_20b} :catch_266

    .line 2779
    const/4 v5, 0x0

    iput-object v5, v6, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    .line 2780
    const/4 v5, 0x0

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->haveState:Z

    .line 2781
    const/4 v5, 0x0

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 2799
    .end local v15           #a:Ljava/util/ArrayList;
    .end local v16           #config:Landroid/content/res/Configuration;
    .end local v18           #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .end local v19           #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    :goto_214
    const/4 v5, 0x1

    goto/16 :goto_1a

    .line 2744
    .restart local v16       #config:Landroid/content/res/Configuration;
    .restart local v18       #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .restart local v19       #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    :catch_217
    move-exception v5

    move-object/from16 v17, v5

    .line 2746
    .local v17, e:Ljava/lang/Exception;
    move-object/from16 v0, v19

    move-object v1, v6

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 2747
    move-object/from16 v0, v18

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2748
    const-string v5, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Restarting because process died: "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v5, v7}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 2750
    iget-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->hasBeenLaunched:Z

    if-nez v5, :cond_251

    .line 2751
    const/4 v5, 0x1

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->hasBeenLaunched:Z

    .line 2760
    :goto_244
    const/4 v5, 0x1

    const/4 v7, 0x0

    move-object/from16 v0, p0

    move-object v1, v6

    move v2, v5

    move v3, v7

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startSpecificActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V

    .line 2761
    const/4 v5, 0x1

    goto/16 :goto_1a

    .line 2754
    :cond_251
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    iget-object v7, v6, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    iget v8, v6, Lcom/android/server/am/HistoryRecord;->theme:I

    iget-object v9, v6, Lcom/android/server/am/HistoryRecord;->nonLocalizedLabel:Ljava/lang/CharSequence;

    iget v10, v6, Lcom/android/server/am/HistoryRecord;->labelRes:I

    iget v11, v6, Lcom/android/server/am/HistoryRecord;->icon:I

    const/4 v12, 0x0

    const/4 v13, 0x1

    invoke-virtual/range {v5 .. v13}, Lcom/android/server/WindowManagerService;->setAppStartingWindow(Landroid/os/IBinder;Ljava/lang/String;ILjava/lang/CharSequence;IILandroid/os/IBinder;Z)V

    goto :goto_244

    .line 2769
    .end local v17           #e:Ljava/lang/Exception;
    .restart local v15       #a:Ljava/util/ArrayList;
    :catch_266
    move-exception v5

    move-object/from16 v17, v5

    .line 2772
    .restart local v17       #e:Ljava/lang/Exception;
    const-string v5, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Exception thrown during resume of "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    move-object v0, v5

    move-object v1, v7

    move-object/from16 v2, v17

    invoke-static {v0, v1, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2773
    const/4 v5, 0x0

    const/4 v7, 0x0

    const-string v8, "resume-exception"

    move-object/from16 v0, p0

    move-object v1, v6

    move v2, v5

    move-object v3, v7

    move-object v4, v8

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z

    .line 2775
    const/4 v5, 0x1

    goto/16 :goto_1a

    .line 2785
    .end local v15           #a:Ljava/util/ArrayList;
    .end local v16           #config:Landroid/content/res/Configuration;
    .end local v17           #e:Ljava/lang/Exception;
    .end local v18           #lastResumedActivity:Lcom/android/server/am/HistoryRecord;
    .end local v19           #lastState:Lcom/android/server/am/ActivityManagerService$ActivityState;
    :cond_295
    iget-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->hasBeenLaunched:Z

    if-nez v5, :cond_2a8

    .line 2786
    const/4 v5, 0x1

    iput-boolean v5, v6, Lcom/android/server/am/HistoryRecord;->hasBeenLaunched:Z

    .line 2796
    :goto_29c
    const/4 v5, 0x1

    const/4 v7, 0x1

    move-object/from16 v0, p0

    move-object v1, v6

    move v2, v5

    move v3, v7

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startSpecificActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V

    goto/16 :goto_214

    .line 2789
    :cond_2a8
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    iget-object v7, v6, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    iget v8, v6, Lcom/android/server/am/HistoryRecord;->theme:I

    iget-object v9, v6, Lcom/android/server/am/HistoryRecord;->nonLocalizedLabel:Ljava/lang/CharSequence;

    iget v10, v6, Lcom/android/server/am/HistoryRecord;->labelRes:I

    iget v11, v6, Lcom/android/server/am/HistoryRecord;->icon:I

    const/4 v12, 0x0

    const/4 v13, 0x1

    invoke-virtual/range {v5 .. v13}, Lcom/android/server/WindowManagerService;->setAppStartingWindow(Landroid/os/IBinder;Ljava/lang/String;ILjava/lang/CharSequence;IILandroid/os/IBinder;Z)V

    goto :goto_29c
.end method

.method private final resumedAppLocked()Lcom/android/server/am/HistoryRecord;
    .registers 3

    .prologue
    .line 12942
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 12943
    .local v0, resumedActivity:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_8

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-nez v1, :cond_15

    .line 12944
    :cond_8
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 12945
    if-eqz v0, :cond_10

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-nez v1, :cond_15

    .line 12946
    :cond_10
    const/4 v1, 0x0

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 12949
    :cond_15
    return-object v0
.end method

.method private retrieveServiceLocked(Landroid/content/Intent;Ljava/lang/String;II)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    .registers 26
    .parameter "service"
    .parameter "resolvedType"
    .parameter "callingPid"
    .parameter "callingUid"

    .prologue
    .line 9924
    const/4 v5, 0x0

    .line 9925
    .local v5, r:Lcom/android/server/am/ServiceRecord;
    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v18

    if-eqz v18, :cond_17

    .line 9926
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    move-object/from16 v18, v0

    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v19

    invoke-virtual/range {v18 .. v19}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 9928
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :cond_17
    new-instance v12, Landroid/content/Intent$FilterComparison;

    move-object v0, v12

    move-object/from16 v1, p1

    invoke-direct {v0, v1}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V

    .line 9929
    .local v12, filter:Landroid/content/Intent$FilterComparison;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    move-object/from16 v18, v0

    move-object/from16 v0, v18

    move-object v1, v12

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 9930
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    if-nez v5, :cond_1f4

    .line 9932
    :try_start_30
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v18

    const/16 v19, 0x400

    move-object/from16 v0, v18

    move-object/from16 v1, p1

    move-object/from16 v2, p2

    move/from16 v3, v19

    invoke-interface {v0, v1, v2, v3}, Landroid/content/pm/IPackageManager;->resolveService(Landroid/content/Intent;Ljava/lang/String;I)Landroid/content/pm/ResolveInfo;

    move-result-object v16

    .line 9935
    .local v16, rInfo:Landroid/content/pm/ResolveInfo;
    if-eqz v16, :cond_74

    move-object/from16 v0, v16

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->serviceInfo:Landroid/content/pm/ServiceInfo;

    move-object/from16 v18, v0

    move-object/from16 v9, v18

    .line 9937
    .local v9, sInfo:Landroid/content/pm/ServiceInfo;
    :goto_4c
    if-nez v9, :cond_79

    .line 9938
    const-string v18, "ActivityManager"

    new-instance v19, Ljava/lang/StringBuilder;

    invoke-direct/range {v19 .. v19}, Ljava/lang/StringBuilder;-><init>()V

    const-string v20, "Unable to start service "

    invoke-virtual/range {v19 .. v20}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v19

    move-object/from16 v0, v19

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v19

    const-string v20, ": not found"

    invoke-virtual/range {v19 .. v20}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v19

    invoke-virtual/range {v19 .. v19}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v19

    invoke-static/range {v18 .. v19}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9940
    const/16 v18, 0x0

    move-object v8, v12

    .line 9988
    .end local v9           #sInfo:Landroid/content/pm/ServiceInfo;
    .end local v12           #filter:Landroid/content/Intent$FilterComparison;
    .end local v16           #rInfo:Landroid/content/pm/ResolveInfo;
    .local v8, filter:Landroid/content/Intent$FilterComparison;
    :goto_73
    return-object v18

    .line 9935
    .end local v8           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v12       #filter:Landroid/content/Intent$FilterComparison;
    .restart local v16       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_74
    const/16 v18, 0x0

    move-object/from16 v9, v18

    goto :goto_4c

    .line 9943
    .restart local v9       #sInfo:Landroid/content/pm/ServiceInfo;
    :cond_79
    new-instance v7, Landroid/content/ComponentName;

    move-object v0, v9

    iget-object v0, v0, Landroid/content/pm/ServiceInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object/from16 v18, v0

    move-object/from16 v0, v18

    iget-object v0, v0, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object/from16 v18, v0

    move-object v0, v9

    iget-object v0, v0, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    move-object/from16 v19, v0

    move-object v0, v7

    move-object/from16 v1, v18

    move-object/from16 v2, v19

    invoke-direct {v0, v1, v2}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 9945
    .local v7, name:Landroid/content/ComponentName;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    move-object/from16 v18, v0

    move-object/from16 v0, v18

    move-object v1, v7

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Lcom/android/server/am/ServiceRecord;
    :try_end_a2
    .catch Landroid/os/RemoteException; {:try_start_30 .. :try_end_a2} :catch_1e4

    .line 9946
    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    .local v15, r:Lcom/android/server/am/ServiceRecord;
    if-nez v15, :cond_1f0

    .line 9947
    :try_start_a4
    new-instance v8, Landroid/content/Intent$FilterComparison;

    invoke-virtual/range {p1 .. p1}, Landroid/content/Intent;->cloneFilter()Landroid/content/Intent;

    move-result-object v18

    move-object v0, v8

    move-object/from16 v1, v18

    invoke-direct {v0, v1}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V
    :try_end_b0
    .catch Landroid/os/RemoteException; {:try_start_a4 .. :try_end_b0} :catch_1e8

    .line 9948
    .end local v12           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v8       #filter:Landroid/content/Intent$FilterComparison;
    :try_start_b0
    new-instance v10, Lcom/android/server/am/ActivityManagerService$ServiceRestarter;

    const/16 v18, 0x0

    move-object v0, v10

    move-object/from16 v1, p0

    move-object/from16 v2, v18

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService$ServiceRestarter;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ActivityManagerService$1;)V

    .line 9949
    .local v10, res:Lcom/android/server/am/ActivityManagerService$ServiceRestarter;
    const/4 v6, 0x0

    .line 9950
    .local v6, ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object/from16 v18, v0

    invoke-virtual/range {v18 .. v18}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v17

    .line 9951
    .local v17, stats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v17
    :try_end_c8
    .catch Landroid/os/RemoteException; {:try_start_b0 .. :try_end_c8} :catch_144

    .line 9952
    :try_start_c8
    move-object v0, v9

    iget-object v0, v0, Landroid/content/pm/ServiceInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object/from16 v18, v0

    move-object/from16 v0, v18

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    move/from16 v18, v0

    move-object v0, v9

    iget-object v0, v0, Landroid/content/pm/ServiceInfo;->packageName:Ljava/lang/String;

    move-object/from16 v19, v0

    move-object v0, v9

    iget-object v0, v0, Landroid/content/pm/ServiceInfo;->name:Ljava/lang/String;

    move-object/from16 v20, v0

    invoke-virtual/range {v17 .. v20}, Lcom/android/internal/os/BatteryStatsImpl;->getServiceStatsLocked(ILjava/lang/String;Ljava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    move-result-object v6

    .line 9955
    monitor-exit v17
    :try_end_e2
    .catchall {:try_start_c8 .. :try_end_e2} :catchall_141

    .line 9956
    :try_start_e2
    new-instance v5, Lcom/android/server/am/ServiceRecord;

    invoke-direct/range {v5 .. v10}, Lcom/android/server/am/ServiceRecord;-><init>(Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;Landroid/content/ComponentName;Landroid/content/Intent$FilterComparison;Landroid/content/pm/ServiceInfo;Ljava/lang/Runnable;)V
    :try_end_e7
    .catch Landroid/os/RemoteException; {:try_start_e2 .. :try_end_e7} :catch_144

    .line 9957
    .end local v15           #r:Lcom/android/server/am/ServiceRecord;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :try_start_e7
    invoke-virtual {v10, v5}, Lcom/android/server/am/ActivityManagerService$ServiceRestarter;->setService(Lcom/android/server/am/ServiceRecord;)V

    .line 9958
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    move-object/from16 v18, v0

    move-object/from16 v0, v18

    move-object v1, v7

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 9959
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServicesByIntent:Ljava/util/HashMap;

    move-object/from16 v18, v0

    move-object/from16 v0, v18

    move-object v1, v8

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 9962
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object/from16 v18, v0

    invoke-virtual/range {v18 .. v18}, Ljava/util/ArrayList;->size()I

    move-result v11

    .line 9963
    .local v11, N:I
    const/4 v13, 0x0

    .local v13, i:I
    :goto_10f
    if-ge v13, v11, :cond_146

    .line 9964
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object/from16 v18, v0

    move-object/from16 v0, v18

    move v1, v13

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Lcom/android/server/am/ServiceRecord;

    .line 9965
    .local v14, pr:Lcom/android/server/am/ServiceRecord;
    move-object v0, v14

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    move-object/from16 v18, v0

    move-object/from16 v0, v18

    move-object v1, v7

    invoke-virtual {v0, v1}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v18

    if-eqz v18, :cond_13e

    .line 9966
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    move-object/from16 v18, v0

    move-object/from16 v0, v18

    move v1, v13

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;
    :try_end_13a
    .catch Landroid/os/RemoteException; {:try_start_e7 .. :try_end_13a} :catch_1ed

    .line 9967
    add-int/lit8 v13, v13, -0x1

    .line 9968
    add-int/lit8 v11, v11, -0x1

    .line 9963
    :cond_13e
    add-int/lit8 v13, v13, 0x1

    goto :goto_10f

    .line 9955
    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    .end local v11           #N:I
    .end local v13           #i:I
    .end local v14           #pr:Lcom/android/server/am/ServiceRecord;
    .restart local v15       #r:Lcom/android/server/am/ServiceRecord;
    :catchall_141
    move-exception v18

    :try_start_142
    monitor-exit v17
    :try_end_143
    .catchall {:try_start_142 .. :try_end_143} :catchall_141

    :try_start_143
    throw v18
    :try_end_144
    .catch Landroid/os/RemoteException; {:try_start_143 .. :try_end_144} :catch_144

    .line 9972
    .end local v6           #ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    .end local v10           #res:Lcom/android/server/am/ActivityManagerService$ServiceRestarter;
    .end local v17           #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :catch_144
    move-exception v18

    move-object v5, v15

    .line 9976
    .end local v7           #name:Landroid/content/ComponentName;
    .end local v9           #sInfo:Landroid/content/pm/ServiceInfo;
    .end local v15           #r:Lcom/android/server/am/ServiceRecord;
    .end local v16           #rInfo:Landroid/content/pm/ResolveInfo;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    :cond_146
    :goto_146
    if-eqz v5, :cond_1e0

    .line 9977
    move-object v0, v5

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    move-object/from16 v18, v0

    move-object v0, v5

    iget-boolean v0, v0, Lcom/android/server/am/ServiceRecord;->exported:Z

    move/from16 v19, v0

    if-eqz v19, :cond_1c4

    const/16 v19, -0x1

    :goto_156
    move-object/from16 v0, p0

    move-object/from16 v1, v18

    move/from16 v2, p3

    move/from16 v3, p4

    move/from16 v4, v19

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v18

    if-eqz v18, :cond_1d0

    .line 9980
    const-string v18, "ActivityManager"

    new-instance v19, Ljava/lang/StringBuilder;

    invoke-direct/range {v19 .. v19}, Ljava/lang/StringBuilder;-><init>()V

    const-string v20, "Permission Denial: Accessing service "

    invoke-virtual/range {v19 .. v20}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v19

    move-object v0, v5

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    move-object/from16 v20, v0

    invoke-virtual/range {v19 .. v20}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v19

    const-string v20, " from pid="

    invoke-virtual/range {v19 .. v20}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v19

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v20

    invoke-virtual/range {v19 .. v20}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v19

    const-string v20, ", uid="

    invoke-virtual/range {v19 .. v20}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v19

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v20

    invoke-virtual/range {v19 .. v20}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v19

    const-string v20, " requires "

    invoke-virtual/range {v19 .. v20}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v19

    move-object v0, v5

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    move-object/from16 v20, v0

    invoke-virtual/range {v19 .. v20}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v19

    invoke-virtual/range {v19 .. v19}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v19

    invoke-static/range {v18 .. v19}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 9984
    new-instance v18, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    const/16 v19, 0x0

    move-object v0, v5

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->permission:Ljava/lang/String;

    move-object/from16 v20, v0

    move-object/from16 v0, v18

    move-object/from16 v1, p0

    move-object/from16 v2, v19

    move-object/from16 v3, v20

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ServiceRecord;Ljava/lang/String;)V

    goto/16 :goto_73

    .line 9977
    :cond_1c4
    move-object v0, v5

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    move/from16 v19, v0

    goto :goto_156

    .line 9986
    :cond_1d0
    new-instance v18, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    const/16 v19, 0x0

    move-object/from16 v0, v18

    move-object/from16 v1, p0

    move-object v2, v5

    move-object/from16 v3, v19

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ServiceRecord;Ljava/lang/String;)V

    goto/16 :goto_73

    .line 9988
    :cond_1e0
    const/16 v18, 0x0

    goto/16 :goto_73

    .line 9972
    .end local v8           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v12       #filter:Landroid/content/Intent$FilterComparison;
    :catch_1e4
    move-exception v18

    move-object v8, v12

    .end local v12           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v8       #filter:Landroid/content/Intent$FilterComparison;
    goto/16 :goto_146

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    .end local v8           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v7       #name:Landroid/content/ComponentName;
    .restart local v9       #sInfo:Landroid/content/pm/ServiceInfo;
    .restart local v12       #filter:Landroid/content/Intent$FilterComparison;
    .restart local v15       #r:Lcom/android/server/am/ServiceRecord;
    .restart local v16       #rInfo:Landroid/content/pm/ResolveInfo;
    :catch_1e8
    move-exception v18

    move-object v8, v12

    .end local v12           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v8       #filter:Landroid/content/Intent$FilterComparison;
    move-object v5, v15

    .end local v15           #r:Lcom/android/server/am/ServiceRecord;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    goto/16 :goto_146

    .restart local v6       #ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    .restart local v10       #res:Lcom/android/server/am/ActivityManagerService$ServiceRestarter;
    .restart local v17       #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :catch_1ed
    move-exception v18

    goto/16 :goto_146

    .end local v5           #r:Lcom/android/server/am/ServiceRecord;
    .end local v6           #ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    .end local v8           #filter:Landroid/content/Intent$FilterComparison;
    .end local v10           #res:Lcom/android/server/am/ActivityManagerService$ServiceRestarter;
    .end local v17           #stats:Lcom/android/internal/os/BatteryStatsImpl;
    .restart local v12       #filter:Landroid/content/Intent$FilterComparison;
    .restart local v15       #r:Lcom/android/server/am/ServiceRecord;
    :cond_1f0
    move-object v8, v12

    .end local v12           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v8       #filter:Landroid/content/Intent$FilterComparison;
    move-object v5, v15

    .end local v15           #r:Lcom/android/server/am/ServiceRecord;
    .restart local v5       #r:Lcom/android/server/am/ServiceRecord;
    goto/16 :goto_146

    .end local v7           #name:Landroid/content/ComponentName;
    .end local v8           #filter:Landroid/content/Intent$FilterComparison;
    .end local v9           #sInfo:Landroid/content/pm/ServiceInfo;
    .end local v16           #rInfo:Landroid/content/pm/ResolveInfo;
    .restart local v12       #filter:Landroid/content/Intent$FilterComparison;
    :cond_1f4
    move-object v8, v12

    .end local v12           #filter:Landroid/content/Intent$FilterComparison;
    .restart local v8       #filter:Landroid/content/Intent$FilterComparison;
    goto/16 :goto_146
.end method

.method private retrieveSettings()V
    .registers 9

    .prologue
    const/4 v7, 0x1

    const/4 v6, 0x0

    .line 8266
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v5}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v3

    .line 8267
    .local v3, resolver:Landroid/content/ContentResolver;
    const-string v5, "debug_app"

    invoke-static {v3, v5}, Landroid/provider/Settings$System;->getString(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    .line 8269
    .local v2, debugApp:Ljava/lang/String;
    const-string v5, "wait_for_debugger"

    invoke-static {v3, v5, v6}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v5

    if-eqz v5, :cond_3a

    move v4, v7

    .line 8271
    .local v4, waitForDebugger:Z
    :goto_17
    const-string v5, "always_finish_activities"

    invoke-static {v3, v5, v6}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v5

    if-eqz v5, :cond_3c

    move v0, v7

    .line 8274
    .local v0, alwaysFinishActivities:Z
    :goto_20
    new-instance v1, Landroid/content/res/Configuration;

    invoke-direct {v1}, Landroid/content/res/Configuration;-><init>()V

    .line 8275
    .local v1, configuration:Landroid/content/res/Configuration;
    invoke-static {v3, v1}, Landroid/provider/Settings$System;->getConfiguration(Landroid/content/ContentResolver;Landroid/content/res/Configuration;)V

    .line 8277
    monitor-enter p0

    .line 8278
    :try_start_29
    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    .line 8279
    iput-boolean v4, p0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    iput-boolean v4, p0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    .line 8280
    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    .line 8283
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    invoke-virtual {v5, v1}, Landroid/content/res/Configuration;->updateFrom(Landroid/content/res/Configuration;)I

    .line 8284
    monitor-exit p0

    .line 8285
    return-void

    .end local v0           #alwaysFinishActivities:Z
    .end local v1           #configuration:Landroid/content/res/Configuration;
    .end local v4           #waitForDebugger:Z
    :cond_3a
    move v4, v6

    .line 8269
    goto :goto_17

    .restart local v4       #waitForDebugger:Z
    :cond_3c
    move v0, v6

    .line 8271
    goto :goto_20

    .line 8284
    .restart local v0       #alwaysFinishActivities:Z
    .restart local v1       #configuration:Landroid/content/res/Configuration;
    :catchall_3e
    move-exception v5

    monitor-exit p0
    :try_end_40
    .catchall {:try_start_29 .. :try_end_40} :catchall_3e

    throw v5
.end method

.method private revokeUriPermissionLocked(ILandroid/net/Uri;I)V
    .registers 26
    .parameter "callingUid"
    .parameter "uri"
    .parameter "modeFlags"

    .prologue
    .line 6310
    and-int/lit8 p3, p3, 0x3

    .line 6312
    if-nez p3, :cond_5

    .line 6387
    .end local p1
    :cond_4
    :goto_4
    return-void

    .line 6316
    .restart local p1
    :cond_5
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v16

    .line 6318
    .local v16, pm:Landroid/content/pm/IPackageManager;
    invoke-virtual/range {p2 .. p2}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v8

    .line 6319
    .local v8, authority:Ljava/lang/String;
    const/4 v15, 0x0

    .line 6320
    .local v15, pi:Landroid/content/pm/ProviderInfo;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move-object v1, v8

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/ContentProviderRecord;

    .line 6322
    .local v9, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v9, :cond_3f

    .line 6323
    iget-object v15, v9, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    .line 6331
    :goto_21
    if-nez v15, :cond_4b

    .line 6332
    const-string v19, "ActivityManager"

    new-instance v20, Ljava/lang/StringBuilder;

    invoke-direct/range {v20 .. v20}, Ljava/lang/StringBuilder;-><init>()V

    const-string v21, "No content provider found for: "

    invoke-virtual/range {v20 .. v21}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v20

    move-object/from16 v0, v20

    move-object v1, v8

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v20

    invoke-virtual/range {v20 .. v20}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v20

    invoke-static/range {v19 .. v20}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_4

    .line 6326
    :cond_3f
    const/16 v19, 0x800

    :try_start_41
    move-object/from16 v0, v16

    move-object v1, v8

    move/from16 v2, v19

    invoke-interface {v0, v1, v2}, Landroid/content/pm/IPackageManager;->resolveContentProvider(Ljava/lang/String;I)Landroid/content/pm/ProviderInfo;
    :try_end_49
    .catch Landroid/os/RemoteException; {:try_start_41 .. :try_end_49} :catch_132

    move-result-object v15

    goto :goto_21

    .line 6337
    :cond_4b
    move-object/from16 v0, p0

    move-object/from16 v1, v16

    move-object v2, v15

    move/from16 v3, p1

    move/from16 v4, p3

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkHoldingPermissionsLocked(Landroid/content/pm/IPackageManager;Landroid/content/pm/ProviderInfo;II)Z

    move-result v19

    if-nez v19, :cond_85

    .line 6341
    new-instance v19, Ljava/lang/SecurityException;

    new-instance v20, Ljava/lang/StringBuilder;

    invoke-direct/range {v20 .. v20}, Ljava/lang/StringBuilder;-><init>()V

    const-string v21, "Uid "

    invoke-virtual/range {v20 .. v21}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v20

    move-object/from16 v0, v20

    move/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v20

    const-string v21, " does not have permission to uri "

    invoke-virtual/range {v20 .. v21}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v20

    move-object/from16 v0, v20

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v20

    invoke-virtual/range {v20 .. v20}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v20

    invoke-direct/range {v19 .. v20}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v19

    .line 6347
    :cond_85
    invoke-virtual/range {p2 .. p2}, Landroid/net/Uri;->getPathSegments()Ljava/util/List;

    move-result-object v7

    .line 6348
    .local v7, SEGMENTS:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v7, :cond_4

    .line 6349
    invoke-interface {v7}, Ljava/util/List;->size()I

    move-result v6

    .line 6350
    .local v6, NS:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Landroid/util/SparseArray;->size()I

    move-result v5

    .line 6351
    .local v5, N:I
    const/4 v10, 0x0

    .end local p1
    .local v10, i:I
    :goto_9a
    if-ge v10, v5, :cond_4

    .line 6352
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    move v1, v10

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Ljava/util/HashMap;

    .line 6354
    .local v14, perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    invoke-virtual {v14}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v19

    invoke-interface/range {v19 .. v19}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v11

    .line 6356
    .local v11, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/UriPermission;>;"
    :cond_b3
    :goto_b3
    invoke-interface {v11}, Ljava/util/Iterator;->hasNext()Z

    move-result v19

    if-eqz v19, :cond_10e

    .line 6357
    invoke-interface {v11}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/am/UriPermission;

    .line 6358
    .local v13, perm:Lcom/android/server/am/UriPermission;
    move-object v0, v13

    iget-object v0, v0, Lcom/android/server/am/UriPermission;->uri:Landroid/net/Uri;

    move-object/from16 v18, v0

    .line 6359
    .local v18, targetUri:Landroid/net/Uri;
    invoke-virtual/range {v18 .. v18}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v19

    move-object v0, v8

    move-object/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v19

    if-eqz v19, :cond_b3

    .line 6362
    invoke-virtual/range {v18 .. v18}, Landroid/net/Uri;->getPathSegments()Ljava/util/List;

    move-result-object v17

    .line 6363
    .local v17, targetSegments:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v17, :cond_b3

    .line 6366
    invoke-interface/range {v17 .. v17}, Ljava/util/List;->size()I

    move-result v19

    move/from16 v0, v19

    move v1, v6

    if-lt v0, v1, :cond_b3

    .line 6369
    const/4 v12, 0x0

    .local v12, j:I
    :goto_e1
    if-ge v12, v6, :cond_fd

    .line 6370
    invoke-interface {v7, v12}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Ljava/lang/String;

    move-object/from16 v0, v17

    move v1, v12

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v19

    move-object/from16 v0, p1

    move-object/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v19

    if-eqz v19, :cond_b3

    .line 6369
    add-int/lit8 v12, v12, 0x1

    goto :goto_e1

    .line 6374
    :cond_fd
    move-object v0, v13

    move/from16 v1, p3

    invoke-virtual {v0, v1}, Lcom/android/server/am/UriPermission;->clearModes(I)V

    .line 6375
    move-object v0, v13

    iget v0, v0, Lcom/android/server/am/UriPermission;->modeFlags:I

    move/from16 v19, v0

    if-nez v19, :cond_b3

    .line 6376
    invoke-interface {v11}, Ljava/util/Iterator;->remove()V

    goto :goto_b3

    .line 6379
    .end local v12           #j:I
    .end local v13           #perm:Lcom/android/server/am/UriPermission;
    .end local v17           #targetSegments:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    .end local v18           #targetUri:Landroid/net/Uri;
    :cond_10e
    invoke-virtual {v14}, Ljava/util/HashMap;->size()I

    move-result v19

    if-nez v19, :cond_12e

    .line 6380
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v19, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    move-object/from16 v20, v0

    move-object/from16 v0, v20

    move v1, v10

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v20

    invoke-virtual/range {v19 .. v20}, Landroid/util/SparseArray;->remove(I)V

    .line 6382
    add-int/lit8 v5, v5, -0x1

    .line 6383
    add-int/lit8 v10, v10, -0x1

    .line 6351
    :cond_12e
    add-int/lit8 v10, v10, 0x1

    goto/16 :goto_9a

    .line 6328
    .end local v5           #N:I
    .end local v6           #NS:I
    .end local v7           #SEGMENTS:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    .end local v10           #i:I
    .end local v11           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/UriPermission;>;"
    .end local v14           #perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    .restart local p1
    :catch_132
    move-exception v19

    goto/16 :goto_21
.end method

.method private saveLocaleLocked(Ljava/util/Locale;ZZ)V
    .registers 6
    .parameter "l"
    .parameter "isDiff"
    .parameter "isPersist"

    .prologue
    .line 12485
    if-eqz p2, :cond_14

    .line 12486
    const-string v0, "user.language"

    invoke-virtual {p1}, Ljava/util/Locale;->getLanguage()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 12487
    const-string v0, "user.region"

    invoke-virtual {p1}, Ljava/util/Locale;->getCountry()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 12490
    :cond_14
    if-eqz p3, :cond_31

    .line 12491
    const-string v0, "persist.sys.language"

    invoke-virtual {p1}, Ljava/util/Locale;->getLanguage()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 12492
    const-string v0, "persist.sys.country"

    invoke-virtual {p1}, Ljava/util/Locale;->getCountry()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 12493
    const-string v0, "persist.sys.localevar"

    invoke-virtual {p1}, Ljava/util/Locale;->getVariant()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/os/SystemProperties;->set(Ljava/lang/String;Ljava/lang/String;)V

    .line 12495
    :cond_31
    return-void
.end method

.method private static scanArgs([Ljava/lang/String;Ljava/lang/String;)Z
    .registers 7
    .parameter "args"
    .parameter "value"

    .prologue
    .line 9466
    if-eqz p0, :cond_14

    .line 9467
    move-object v1, p0

    .local v1, arr$:[Ljava/lang/String;
    array-length v3, v1

    .local v3, len$:I
    const/4 v2, 0x0

    .local v2, i$:I
    :goto_5
    if-ge v2, v3, :cond_14

    aget-object v0, v1, v2

    .line 9468
    .local v0, arg:Ljava/lang/String;
    invoke-virtual {p1, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_11

    .line 9469
    const/4 v4, 0x1

    .line 9473
    .end local v0           #arg:Ljava/lang/String;
    .end local v1           #arr$:[Ljava/lang/String;
    .end local v2           #i$:I
    .end local v3           #len$:I
    :goto_10
    return v4

    .line 9467
    .restart local v0       #arg:Ljava/lang/String;
    .restart local v1       #arr$:[Ljava/lang/String;
    .restart local v2       #i$:I
    .restart local v3       #len$:I
    :cond_11
    add-int/lit8 v2, v2, 0x1

    goto :goto_5

    .line 9473
    .end local v0           #arg:Ljava/lang/String;
    .end local v1           #arr$:[Ljava/lang/String;
    .end local v2           #i$:I
    .end local v3           #len$:I
    :cond_14
    const/4 v4, 0x0

    goto :goto_10
.end method

.method private final scheduleBroadcastsLocked()V
    .registers 3

    .prologue
    .line 11051
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    if-eqz v0, :cond_5

    .line 11056
    :goto_4
    return-void

    .line 11054
    :cond_5
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/4 v1, 0x7

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendEmptyMessage(I)Z

    .line 11055
    const/4 v0, 0x1

    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    goto :goto_4
.end method

.method private final scheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)V
    .registers 14
    .parameter "r"

    .prologue
    .line 10112
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v2

    .line 10114
    .local v2, now:J
    iget v6, p1, Lcom/android/server/am/ServiceRecord;->totalRestartCount:I

    add-int/lit8 v6, v6, 0x1

    iput v6, p1, Lcom/android/server/am/ServiceRecord;->totalRestartCount:I

    .line 10115
    iget-wide v6, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    const-wide/16 v8, 0x0

    cmp-long v6, v6, v8

    if-nez v6, :cond_d4

    .line 10116
    iget v6, p1, Lcom/android/server/am/ServiceRecord;->restartCount:I

    add-int/lit8 v6, v6, 0x1

    iput v6, p1, Lcom/android/server/am/ServiceRecord;->restartCount:I

    .line 10117
    const-wide/16 v6, 0x1388

    iput-wide v6, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    .line 10132
    :goto_1c
    iget-wide v6, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    add-long/2addr v6, v2

    iput-wide v6, p1, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    .line 10138
    :cond_21
    const/4 v5, 0x0

    .line 10139
    .local v5, repeat:Z
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    const/4 v7, 0x1

    sub-int v0, v6, v7

    .local v0, i:I
    :goto_2b
    if-ltz v0, :cond_5a

    .line 10140
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v6, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord;

    .line 10141
    .local v4, r2:Lcom/android/server/am/ServiceRecord;
    if-eq v4, p1, :cond_f0

    iget-wide v6, p1, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    iget-wide v8, v4, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    const-wide/16 v10, 0x2710

    sub-long/2addr v8, v10

    cmp-long v6, v6, v8

    if-ltz v6, :cond_f0

    iget-wide v6, p1, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    iget-wide v8, v4, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    const-wide/16 v10, 0x2710

    add-long/2addr v8, v10

    cmp-long v6, v6, v8

    if-gez v6, :cond_f0

    .line 10145
    iget-wide v6, v4, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    const-wide/16 v8, 0x2710

    add-long/2addr v6, v8

    iput-wide v6, p1, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    .line 10146
    iget-wide v6, p1, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    sub-long/2addr v6, v2

    iput-wide v6, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    .line 10147
    const/4 v5, 0x1

    .line 10151
    .end local v4           #r2:Lcom/android/server/am/ServiceRecord;
    :cond_5a
    if-nez v5, :cond_21

    .line 10153
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v6, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v6

    if-nez v6, :cond_69

    .line 10154
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v6, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 10157
    :cond_69
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    iget-object v7, p1, Lcom/android/server/am/ServiceRecord;->restarter:Ljava/lang/Runnable;

    invoke-virtual {v6, v7}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V

    .line 10158
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    iget-object v7, p1, Lcom/android/server/am/ServiceRecord;->restarter:Ljava/lang/Runnable;

    iget-wide v8, p1, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    invoke-virtual {v6, v7, v8, v9}, Landroid/os/Handler;->postAtTime(Ljava/lang/Runnable;J)Z

    .line 10159
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v6

    iget-wide v8, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    add-long/2addr v6, v8

    iput-wide v6, p1, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    .line 10160
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Scheduling restart of crashed service "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " in "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-wide v8, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    invoke-virtual {v7, v8, v9}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, "ms"

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10162
    const/16 v6, 0x7553

    const/4 v7, 0x2

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    iget-object v9, p1, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    aput-object v9, v7, v8

    const/4 v8, 0x1

    iget-wide v9, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    invoke-static {v9, v10}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v9

    aput-object v9, v7, v8

    invoke-static {v6, v7}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 10165
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v1

    .line 10166
    .local v1, msg:Landroid/os/Message;
    const/16 v6, 0x12

    iput v6, v1, Landroid/os/Message;->what:I

    .line 10167
    iput-object p1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 10168
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v6, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 10169
    return-void

    .line 10124
    .end local v0           #i:I
    .end local v1           #msg:Landroid/os/Message;
    .end local v5           #repeat:Z
    :cond_d4
    iget-wide v6, p1, Lcom/android/server/am/ServiceRecord;->restartTime:J

    const-wide/32 v8, 0xea60

    add-long/2addr v6, v8

    cmp-long v6, v2, v6

    if-lez v6, :cond_e7

    .line 10125
    const/4 v6, 0x1

    iput v6, p1, Lcom/android/server/am/ServiceRecord;->restartCount:I

    .line 10126
    const-wide/16 v6, 0x1388

    iput-wide v6, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    goto/16 :goto_1c

    .line 10128
    :cond_e7
    iget-wide v6, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    const-wide/16 v8, 0x4

    mul-long/2addr v6, v8

    iput-wide v6, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    goto/16 :goto_1c

    .line 10139
    .restart local v0       #i:I
    .restart local v4       #r2:Lcom/android/server/am/ServiceRecord;
    .restart local v5       #repeat:Z
    :cond_f0
    add-int/lit8 v0, v0, -0x1

    goto/16 :goto_2b
.end method

.method public static self()Lcom/android/server/am/ActivityManagerService;
    .registers 1

    .prologue
    .line 1280
    sget-object v0, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    return-object v0
.end method

.method private final sendServiceArgsLocked(Lcom/android/server/am/ServiceRecord;Z)V
    .registers 10
    .parameter "r"
    .parameter "oomAdjusted"

    .prologue
    .line 10007
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->startArgs:Ljava/util/List;

    invoke-interface {v5}, Ljava/util/List;->size()I

    move-result v1

    .line 10008
    .local v1, N:I
    if-nez v1, :cond_9

    .line 10038
    :cond_8
    :goto_8
    return-void

    .line 10012
    :cond_9
    iget v5, p1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    sub-int/2addr v5, v1

    add-int/lit8 v0, v5, 0x1

    .line 10013
    .local v0, BASEID:I
    const/4 v4, 0x0

    .line 10014
    .local v4, i:I
    :goto_f
    if-ge v4, v1, :cond_32

    .line 10016
    :try_start_11
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->startArgs:Ljava/util/List;

    invoke-interface {v5, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/Intent;

    .line 10019
    .local v2, args:Landroid/content/Intent;
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->bumpServiceExecutingLocked(Lcom/android/server/am/ServiceRecord;)V

    .line 10020
    if-nez p2, :cond_24

    .line 10021
    const/4 p2, 0x1

    .line 10022
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v5}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 10024
    :cond_24
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    add-int v6, v0, v4

    invoke-interface {v5, p1, v6, v2}, Landroid/app/IApplicationThread;->scheduleServiceArgs(Landroid/os/IBinder;ILandroid/content/Intent;)V
    :try_end_2d
    .catch Ljava/lang/Exception; {:try_start_11 .. :try_end_2d} :catch_30

    .line 10025
    add-int/lit8 v4, v4, 0x1

    goto :goto_f

    .line 10026
    .end local v2           #args:Landroid/content/Intent;
    :catch_30
    move-exception v5

    move-object v3, v5

    .line 10030
    :cond_32
    if-ne v4, v1, :cond_3a

    .line 10031
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->startArgs:Ljava/util/List;

    invoke-interface {v5}, Ljava/util/List;->clear()V

    goto :goto_8

    .line 10033
    :cond_3a
    :goto_3a
    if-lez v4, :cond_8

    .line 10034
    iget-object v5, p1, Lcom/android/server/am/ServiceRecord;->startArgs:Ljava/util/List;

    const/4 v6, 0x0

    invoke-interface {v5, v6}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 10035
    add-int/lit8 v4, v4, -0x1

    goto :goto_3a
.end method

.method private final setFocusedActivityLocked(Lcom/android/server/am/HistoryRecord;)V
    .registers 4
    .parameter "r"

    .prologue
    .line 1627
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    if-eq v0, p1, :cond_c

    .line 1628
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    .line 1629
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v1, 0x1

    invoke-virtual {v0, p1, v1}, Lcom/android/server/WindowManagerService;->setFocusedApp(Landroid/os/IBinder;Z)V

    .line 1631
    :cond_c
    return-void
.end method

.method public static setSystemProcess()V
    .registers 8

    .prologue
    .line 1201
    :try_start_0
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    .line 1203
    .local v3, m:Lcom/android/server/am/ActivityManagerService;
    const-string v4, "activity"

    invoke-static {v4, v3}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1204
    const-string v4, "meminfo"

    new-instance v5, Lcom/android/server/am/ActivityManagerService$MemBinder;

    invoke-direct {v5, v3}, Lcom/android/server/am/ActivityManagerService$MemBinder;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    invoke-static {v4, v5}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1206
    const-string v4, "cpuinfo"

    new-instance v5, Lcom/android/server/am/ActivityManagerService$CpuBinder;

    invoke-direct {v5, v3}, Lcom/android/server/am/ActivityManagerService$CpuBinder;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    invoke-static {v4, v5}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1208
    const-string v4, "activity.broadcasts"

    new-instance v5, Lcom/android/server/am/ActivityManagerService$BroadcastsBinder;

    invoke-direct {v5, v3}, Lcom/android/server/am/ActivityManagerService$BroadcastsBinder;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    invoke-static {v4, v5}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1209
    const-string v4, "activity.services"

    new-instance v5, Lcom/android/server/am/ActivityManagerService$ServicesBinder;

    invoke-direct {v5, v3}, Lcom/android/server/am/ActivityManagerService$ServicesBinder;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    invoke-static {v4, v5}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1210
    const-string v4, "activity.senders"

    new-instance v5, Lcom/android/server/am/ActivityManagerService$SendersBinder;

    invoke-direct {v5, v3}, Lcom/android/server/am/ActivityManagerService$SendersBinder;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    invoke-static {v4, v5}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1211
    const-string v4, "activity.providers"

    new-instance v5, Lcom/android/server/am/ActivityManagerService$ProvidersBinder;

    invoke-direct {v5, v3}, Lcom/android/server/am/ActivityManagerService$ProvidersBinder;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    invoke-static {v4, v5}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1212
    const-string v4, "permission"

    new-instance v5, Lcom/android/server/am/ActivityManagerService$PermissionController;

    invoke-direct {v5, v3}, Lcom/android/server/am/ActivityManagerService$PermissionController;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    invoke-static {v4, v5}, Landroid/os/ServiceManager;->addService(Ljava/lang/String;Landroid/os/IBinder;)V

    .line 1214
    sget-object v4, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v4, v4, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v4}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v4

    const-string v5, "android"

    const/16 v6, 0x400

    invoke-virtual {v4, v5, v6}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v2

    .line 1217
    .local v2, info:Landroid/content/pm/ApplicationInfo;
    sget-object v4, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    monitor-enter v4
    :try_end_60
    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_0 .. :try_end_60} :catch_a5

    .line 1218
    :try_start_60
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    sget-object v6, Lcom/android/server/am/ActivityManagerService;->mSystemThread:Landroid/app/ActivityThread;

    invoke-virtual {v6}, Landroid/app/ActivityThread;->getApplicationThread()Landroid/app/ActivityThread$ApplicationThread;

    move-result-object v6

    iget-object v7, v2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    invoke-virtual {v5, v6, v2, v7}, Lcom/android/server/am/ActivityManagerService;->newProcessRecordLocked(Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 1221
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    const/4 v5, 0x1

    iput-boolean v5, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    .line 1222
    invoke-static {}, Landroid/os/Process;->myPid()I

    move-result v5

    iput v5, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 1223
    const/16 v5, -0x10

    iput v5, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    .line 1224
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v5, v5, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v6, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget-object v7, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v5, v6, v7, v0}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 1225
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v5, v5, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v5
    :try_end_8d
    .catchall {:try_start_60 .. :try_end_8d} :catchall_a2

    .line 1226
    :try_start_8d
    sget-object v6, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v6, v6, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    iget v7, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v6, v7, v0}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 1227
    monitor-exit v5
    :try_end_97
    .catchall {:try_start_8d .. :try_end_97} :catchall_9f

    .line 1228
    :try_start_97
    sget-object v5, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    const/4 v6, 0x1

    invoke-direct {v5, v0, v6}, Lcom/android/server/am/ActivityManagerService;->updateLRUListLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 1229
    monitor-exit v4
    :try_end_9e
    .catchall {:try_start_97 .. :try_end_9e} :catchall_a2

    .line 1234
    return-void

    .line 1227
    :catchall_9f
    move-exception v6

    :try_start_a0
    monitor-exit v5
    :try_end_a1
    .catchall {:try_start_a0 .. :try_end_a1} :catchall_9f

    :try_start_a1
    throw v6

    .line 1229
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    :catchall_a2
    move-exception v5

    monitor-exit v4
    :try_end_a4
    .catchall {:try_start_a1 .. :try_end_a4} :catchall_a2

    :try_start_a4
    throw v5
    :try_end_a5
    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_a4 .. :try_end_a5} :catch_a5

    .line 1230
    .end local v2           #info:Landroid/content/pm/ApplicationInfo;
    .end local v3           #m:Lcom/android/server/am/ActivityManagerService;
    :catch_a5
    move-exception v4

    move-object v1, v4

    .line 1231
    .local v1, e:Landroid/content/pm/PackageManager$NameNotFoundException;
    new-instance v4, Ljava/lang/RuntimeException;

    const-string v5, "Unable to find android system package"

    invoke-direct {v4, v5, v1}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;Ljava/lang/Throwable;)V

    throw v4
.end method

.method private final startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I
    .registers 45
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "aInfo"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "callingPid"
    .parameter "callingUid"
    .parameter "onlyIfNeeded"
    .parameter "componentSpecified"

    .prologue
    .line 3070
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Starting activity: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 3072
    const/16 v29, 0x0

    .line 3073
    .local v29, sourceRecord:Lcom/android/server/am/HistoryRecord;
    const/4 v7, 0x0

    .line 3074
    .local v7, resultRecord:Lcom/android/server/am/HistoryRecord;
    if-eqz p7, :cond_43

    .line 3075
    move-object/from16 v0, p0

    move-object/from16 v1, p7

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v24

    .line 3078
    .local v24, index:I
    if-ltz v24, :cond_43

    .line 3079
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v24

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v29

    .end local v29           #sourceRecord:Lcom/android/server/am/HistoryRecord;
    check-cast v29, Lcom/android/server/am/HistoryRecord;

    .line 3080
    .restart local v29       #sourceRecord:Lcom/android/server/am/HistoryRecord;
    if-ltz p9, :cond_43

    move-object/from16 v0, v29

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move v5, v0

    if-nez v5, :cond_43

    .line 3081
    move-object/from16 v7, v29

    .line 3086
    .end local v24           #index:I
    :cond_43
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getFlags()I

    move-result v25

    .line 3088
    .local v25, launchFlags:I
    const/high16 v5, 0x200

    and-int v5, v5, v25

    if-eqz v5, :cond_76

    if-eqz v29, :cond_76

    .line 3092
    if-ltz p9, :cond_53

    .line 3093
    const/4 v5, -0x3

    .line 3213
    :goto_52
    return v5

    .line 3095
    :cond_53
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v7, v0

    .line 3096
    move-object/from16 v0, v29

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    move-object/from16 p8, v0

    .line 3097
    move-object/from16 v0, v29

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move/from16 p9, v0

    .line 3098
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, v29

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 3099
    if-eqz v7, :cond_76

    .line 3100
    move-object v0, v7

    move-object/from16 v1, v29

    move-object/from16 v2, p8

    move/from16 v3, p9

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/HistoryRecord;->removeResultsLocked(Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V

    .line 3105
    :cond_76
    const/16 v23, 0x0

    .line 3107
    .local v23, err:I
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v5

    if-nez v5, :cond_80

    .line 3110
    const/16 v23, -0x1

    .line 3113
    :cond_80
    if-nez v23, :cond_86

    if-nez p6, :cond_86

    .line 3116
    const/16 v23, -0x2

    .line 3119
    :cond_86
    const/16 v21, 0x0

    .line 3120
    .local v21, callerApp:Lcom/android/server/am/ProcessRecord;
    if-nez v23, :cond_a2

    if-eqz p1, :cond_a2

    .line 3121
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v21

    .line 3122
    if-eqz v21, :cond_b5

    .line 3123
    move-object/from16 v0, v21

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move/from16 p10, v0

    .line 3124
    move-object/from16 v0, v21

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    move-object v0, v5

    iget v0, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    move/from16 p11, v0

    .line 3133
    :cond_a2
    :goto_a2
    if-eqz v23, :cond_ee

    .line 3134
    if-eqz v7, :cond_b2

    .line 3135
    const/4 v6, -0x1

    const/4 v10, 0x0

    const/4 v11, 0x0

    move-object/from16 v5, p0

    move-object/from16 v8, p8

    move/from16 v9, p9

    invoke-virtual/range {v5 .. v11}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    :cond_b2
    move/from16 v5, v23

    .line 3139
    goto :goto_52

    .line 3126
    :cond_b5
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unable to find app for caller "

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v8, " (pid="

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move/from16 v1, p10

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v8, ") when starting: "

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 3129
    const/16 v23, -0x4

    goto :goto_a2

    .line 3142
    :cond_ee
    move-object/from16 v0, p6

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;

    move-object v5, v0

    move-object/from16 v0, p6

    iget-boolean v0, v0, Landroid/content/pm/ActivityInfo;->exported:Z

    move v6, v0

    if-eqz v6, :cond_17b

    const/4 v6, -0x1

    :goto_fb
    move-object/from16 v0, p0

    move-object v1, v5

    move/from16 v2, p10

    move/from16 v3, p11

    move v4, v6

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v28

    .line 3144
    .local v28, perm:I
    if-eqz v28, :cond_184

    .line 3145
    if-eqz v7, :cond_117

    .line 3146
    const/4 v6, -0x1

    const/4 v10, 0x0

    const/4 v11, 0x0

    move-object/from16 v5, p0

    move-object/from16 v8, p8

    move/from16 v9, p9

    invoke-virtual/range {v5 .. v11}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 3150
    :cond_117
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: starting "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " from "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " (pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p10

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, p11

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ")"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " requires "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p6

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v26

    .line 3154
    .local v26, msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    move-object v0, v5

    move-object/from16 v1, v26

    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 3155
    new-instance v5, Ljava/lang/SecurityException;

    move-object v0, v5

    move-object/from16 v1, v26

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 3142
    .end local v26           #msg:Ljava/lang/String;
    .end local v28           #perm:I
    :cond_17b
    move-object/from16 v0, p6

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v6, v0

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    goto/16 :goto_fb

    .line 3158
    .restart local v28       #perm:I
    :cond_184
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v5, v0

    if-eqz v5, :cond_1cb

    .line 3159
    const/16 v20, 0x0

    .line 3163
    .local v20, abort:Z
    :try_start_18d
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->cloneFilter()Landroid/content/Intent;

    move-result-object v30

    .line 3164
    .local v30, watchIntent:Landroid/content/Intent;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v5, v0

    move-object/from16 v0, p6

    iget-object v0, v0, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    move-object v6, v0

    iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object v0, v5

    move-object/from16 v1, v30

    move-object v2, v6

    invoke-interface {v0, v1, v2}, Landroid/app/IActivityController;->activityStarting(Landroid/content/Intent;Ljava/lang/String;)Z
    :try_end_1a4
    .catch Landroid/os/RemoteException; {:try_start_18d .. :try_end_1a4} :catch_1c1

    move-result v5

    if-nez v5, :cond_1bd

    const/4 v5, 0x1

    move/from16 v20, v5

    .line 3170
    .end local v30           #watchIntent:Landroid/content/Intent;
    :goto_1aa
    if-eqz v20, :cond_1cb

    .line 3171
    if-eqz v7, :cond_1ba

    .line 3172
    const/4 v6, -0x1

    const/4 v10, 0x0

    const/4 v11, 0x0

    move-object/from16 v5, p0

    move-object/from16 v8, p8

    move/from16 v9, p9

    invoke-virtual/range {v5 .. v11}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 3178
    :cond_1ba
    const/4 v5, 0x0

    goto/16 :goto_52

    .line 3164
    .restart local v30       #watchIntent:Landroid/content/Intent;
    :cond_1bd
    const/4 v5, 0x0

    move/from16 v20, v5

    goto :goto_1aa

    .line 3166
    .end local v30           #watchIntent:Landroid/content/Intent;
    :catch_1c1
    move-exception v5

    move-object/from16 v22, v5

    .line 3167
    .local v22, e:Landroid/os/RemoteException;
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    goto :goto_1aa

    .line 3182
    .end local v20           #abort:Z
    .end local v22           #e:Landroid/os/RemoteException;
    :cond_1cb
    new-instance v8, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v15, v0

    move-object/from16 v9, p0

    move-object/from16 v10, v21

    move/from16 v11, p11

    move-object/from16 v12, p2

    move-object/from16 v13, p3

    move-object/from16 v14, p6

    move-object/from16 v16, v7

    move-object/from16 v17, p8

    move/from16 v18, p9

    move/from16 v19, p13

    invoke-direct/range {v8 .. v19}, Lcom/android/server/am/HistoryRecord;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;ILandroid/content/Intent;Ljava/lang/String;Landroid/content/pm/ActivityInfo;Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;IZ)V

    .line 3186
    .local v8, r:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_200

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    move v0, v5

    move/from16 v1, p11

    if-eq v0, v1, :cond_243

    .line 3188
    :cond_200
    const-string v5, "Activity start"

    move-object/from16 v0, p0

    move/from16 v1, p10

    move/from16 v2, p11

    move-object v3, v5

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->checkAppSwitchAllowedLocked(IILjava/lang/String;)Z

    move-result v5

    if-nez v5, :cond_243

    .line 3189
    new-instance v27, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;

    move-object/from16 v0, v27

    move-object/from16 v1, p0

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    .line 3190
    .local v27, pal:Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;
    move-object v0, v8

    move-object/from16 v1, v27

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->r:Lcom/android/server/am/HistoryRecord;

    .line 3191
    move-object/from16 v0, v29

    move-object/from16 v1, v27

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->sourceRecord:Lcom/android/server/am/HistoryRecord;

    .line 3192
    move-object/from16 v0, p4

    move-object/from16 v1, v27

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->grantedUriPermissions:[Landroid/net/Uri;

    .line 3193
    move/from16 v0, p5

    move-object/from16 v1, v27

    iput v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->grantedMode:I

    .line 3194
    move/from16 v0, p12

    move-object/from16 v1, v27

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;->onlyIfNeeded:Z

    .line 3195
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingActivityLaunches:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v27

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 3196
    const/4 v5, 0x4

    goto/16 :goto_52

    .line 3200
    .end local v27           #pal:Lcom/android/server/am/ActivityManagerService$PendingActivityLaunch;
    :cond_243
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDidAppSwitch:Z

    move v5, v0

    if-eqz v5, :cond_26a

    .line 3206
    const-wide/16 v5, 0x0

    move-wide v0, v5

    move-object/from16 v2, p0

    iput-wide v0, v2, Lcom/android/server/am/ActivityManagerService;->mAppSwitchesAllowedTime:J

    .line 3211
    :goto_251
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->doPendingActivityLaunchesLocked(Z)V

    .line 3213
    const/4 v15, 0x1

    move-object/from16 v9, p0

    move-object v10, v8

    move-object/from16 v11, v29

    move-object/from16 v12, p4

    move/from16 v13, p5

    move/from16 v14, p12

    invoke-direct/range {v9 .. v15}, Lcom/android/server/am/ActivityManagerService;->startActivityUncheckedLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;[Landroid/net/Uri;IZZ)I

    move-result v5

    goto/16 :goto_52

    .line 3208
    :cond_26a
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mDidAppSwitch:Z

    goto :goto_251
.end method

.method private final startActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V
    .registers 25
    .parameter "r"
    .parameter "newTask"
    .parameter "doResume"

    .prologue
    .line 2804
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v14

    .line 2806
    .local v14, NH:I
    const/4 v4, -0x1

    .line 2808
    .local v4, addPos:I
    if-nez p2, :cond_84

    .line 2810
    const/16 v17, 0x0

    .line 2811
    .local v17, next:Lcom/android/server/am/HistoryRecord;
    const/16 v20, 0x1

    .line 2812
    .local v20, startIt:Z
    const/4 v3, 0x1

    sub-int v16, v14, v3

    .local v16, i:I
    :goto_13
    if-ltz v16, :cond_84

    .line 2813
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v18

    check-cast v18, Lcom/android/server/am/HistoryRecord;

    .line 2814
    .local v18, p:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v18

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move v3, v0

    if-eqz v3, :cond_2d

    .line 2812
    :goto_2a
    add-int/lit8 v16, v16, -0x1

    goto :goto_13

    .line 2817
    :cond_2d
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    if-ne v3, v5, :cond_78

    .line 2821
    add-int/lit8 v4, v16, 0x1

    .line 2822
    if-nez v20, :cond_84

    .line 2823
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move v1, v4

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 2824
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    .line 2825
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    iget v5, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    add-int/lit8 v5, v5, 0x1

    iput v5, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 2826
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v6, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget v7, v5, Landroid/content/pm/ActivityInfo;->screenOrientation:I

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    move v8, v0

    move-object/from16 v5, p1

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/WindowManagerService;->addAppToken(ILandroid/view/IApplicationToken;IIZ)V

    .line 2923
    .end local v16           #i:I
    .end local v17           #next:Lcom/android/server/am/HistoryRecord;
    .end local v18           #p:Lcom/android/server/am/HistoryRecord;
    .end local v20           #startIt:Z
    :cond_77
    :goto_77
    return-void

    .line 2835
    .restart local v16       #i:I
    .restart local v17       #next:Lcom/android/server/am/HistoryRecord;
    .restart local v18       #p:Lcom/android/server/am/HistoryRecord;
    .restart local v20       #startIt:Z
    :cond_78
    move-object/from16 v0, v18

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    move v3, v0

    if-eqz v3, :cond_81

    .line 2836
    const/16 v20, 0x0

    .line 2838
    :cond_81
    move-object/from16 v17, v18

    goto :goto_2a

    .line 2844
    .end local v16           #i:I
    .end local v17           #next:Lcom/android/server/am/HistoryRecord;
    .end local v18           #p:Lcom/android/server/am/HistoryRecord;
    .end local v20           #startIt:Z
    :cond_84
    if-gez v4, :cond_8f

    .line 2845
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v4

    .line 2851
    :cond_8f
    if-ge v4, v14, :cond_97

    .line 2852
    const/4 v3, 0x0

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    .line 2857
    :cond_97
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    move-object v0, v3

    move v1, v4

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 2858
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->inHistory:Z

    .line 2859
    move/from16 v0, p2

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    .line 2860
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    iget v5, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    add-int/lit8 v5, v5, 0x1

    iput v5, v3, Lcom/android/server/am/TaskRecord;->numActivities:I

    .line 2861
    if-lez v14, :cond_188

    .line 2865
    move/from16 v13, p2

    .line 2866
    .local v13, showStartingIcon:Z
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v19, v0

    .line 2867
    .local v19, proc:Lcom/android/server/am/ProcessRecord;
    if-nez v19, :cond_df

    .line 2868
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v6, v0

    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v3, v5, v6}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v19

    .end local v19           #proc:Lcom/android/server/am/ProcessRecord;
    check-cast v19, Lcom/android/server/am/ProcessRecord;

    .line 2870
    .restart local v19       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_df
    if-eqz v19, :cond_e8

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v3, v0

    if-nez v3, :cond_e9

    .line 2871
    :cond_e8
    const/4 v13, 0x1

    .line 2875
    :cond_e9
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    if-eqz p2, :cond_17c

    const/16 v5, 0x8

    :goto_f2
    invoke-virtual {v3, v5}, Lcom/android/server/WindowManagerService;->prepareAppTransition(I)V

    .line 2878
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v6, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget v7, v5, Landroid/content/pm/ActivityInfo;->screenOrientation:I

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    move v8, v0

    move-object/from16 v5, p1

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/WindowManagerService;->addAppToken(ILandroid/view/IApplicationToken;IIZ)V

    .line 2880
    const/4 v15, 0x1

    .line 2881
    .local v15, doShow:Z
    if-eqz p2, :cond_13b

    .line 2887
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Intent;->getFlags()I

    move-result v3

    const/high16 v5, 0x20

    and-int/2addr v3, v5

    if-eqz v3, :cond_13b

    .line 2889
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object/from16 v2, p1

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->resetTaskIfNeededLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    .line 2890
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object v1, v3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p1

    if-ne v0, v1, :cond_17f

    const/4 v3, 0x1

    move v15, v3

    .line 2893
    :cond_13b
    :goto_13b
    if-eqz v15, :cond_171

    .line 2898
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v12, v0

    .line 2899
    .local v12, prev:Lcom/android/server/am/HistoryRecord;
    if-eqz v12, :cond_14e

    .line 2902
    iget-object v3, v12, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    if-eq v3, v5, :cond_182

    const/4 v12, 0x0

    .line 2906
    :cond_14e
    :goto_14e
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v7, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->theme:I

    move v8, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->nonLocalizedLabel:Ljava/lang/CharSequence;

    move-object v9, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->labelRes:I

    move v10, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->icon:I

    move v11, v0

    move-object/from16 v6, p1

    invoke-virtual/range {v5 .. v13}, Lcom/android/server/WindowManagerService;->setAppStartingWindow(Landroid/os/IBinder;Ljava/lang/String;ILjava/lang/CharSequence;IILandroid/os/IBinder;Z)V

    .line 2920
    .end local v12           #prev:Lcom/android/server/am/HistoryRecord;
    .end local v13           #showStartingIcon:Z
    .end local v15           #doShow:Z
    .end local v19           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_171
    :goto_171
    if-eqz p3, :cond_77

    .line 2921
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object v1, v3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    goto/16 :goto_77

    .line 2875
    .restart local v13       #showStartingIcon:Z
    .restart local v19       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_17c
    const/4 v5, 0x6

    goto/16 :goto_f2

    .line 2890
    .restart local v15       #doShow:Z
    :cond_17f
    const/4 v3, 0x0

    move v15, v3

    goto :goto_13b

    .line 2904
    .restart local v12       #prev:Lcom/android/server/am/HistoryRecord;
    :cond_182
    iget-boolean v3, v12, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    if-eqz v3, :cond_14e

    const/4 v12, 0x0

    goto :goto_14e

    .line 2913
    .end local v12           #prev:Lcom/android/server/am/HistoryRecord;
    .end local v13           #showStartingIcon:Z
    .end local v15           #doShow:Z
    .end local v19           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_188
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v6, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget v7, v5, Landroid/content/pm/ActivityInfo;->screenOrientation:I

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->fullscreen:Z

    move v8, v0

    move-object/from16 v5, p1

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/WindowManagerService;->addAppToken(ILandroid/view/IApplicationToken;IIZ)V

    goto :goto_171
.end method

.method private final startActivityUncheckedLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;[Landroid/net/Uri;IZZ)I
    .registers 35
    .parameter "r"
    .parameter "sourceRecord"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "onlyIfNeeded"
    .parameter "doResume"

    .prologue
    .line 3234
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object/from16 v20, v0

    .line 3235
    .local v20, intent:Landroid/content/Intent;
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchedFromUid:I

    move v6, v0

    .line 3237
    .local v6, callingUid:I
    invoke-virtual/range {v20 .. v20}, Landroid/content/Intent;->getFlags()I

    move-result v21

    .line 3241
    .local v21, launchFlags:I
    const/high16 v5, 0x4

    and-int v5, v5, v21

    if-nez v5, :cond_6d

    const/4 v5, 0x1

    :goto_16
    move v0, v5

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mUserLeaving:Z

    .line 3248
    if-nez p6, :cond_23

    .line 3249
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->delayedResume:Z

    .line 3252
    :cond_23
    const/high16 v5, 0x100

    and-int v5, v5, v21

    if-eqz v5, :cond_6f

    move-object/from16 v23, p1

    .line 3259
    .local v23, notTop:Lcom/android/server/am/HistoryRecord;
    :goto_2b
    if-eqz p5, :cond_4b

    .line 3260
    move-object/from16 v17, p2

    .line 3261
    .local v17, checkedCaller:Lcom/android/server/am/HistoryRecord;
    if-nez v17, :cond_39

    .line 3262
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v17

    .line 3264
    :cond_39
    move-object/from16 v0, v17

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v7, v0

    invoke-virtual {v5, v7}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_4b

    .line 3266
    const/16 p5, 0x0

    .line 3270
    .end local v17           #checkedCaller:Lcom/android/server/am/HistoryRecord;
    :cond_4b
    if-eqz p3, :cond_73

    if-lez v6, :cond_73

    .line 3271
    const/16 v19, 0x0

    .local v19, i:I
    :goto_51
    move-object/from16 v0, p3

    array-length v0, v0

    move v5, v0

    move/from16 v0, v19

    move v1, v5

    if-ge v0, v1, :cond_73

    .line 3272
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v7, v0

    aget-object v8, p3, v19

    move-object/from16 v5, p0

    move/from16 v9, p4

    move-object/from16 v10, p1

    invoke-direct/range {v5 .. v10}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionLocked(ILjava/lang/String;Landroid/net/Uri;ILcom/android/server/am/HistoryRecord;)V

    .line 3271
    add-int/lit8 v19, v19, 0x1

    goto :goto_51

    .line 3241
    .end local v19           #i:I
    .end local v23           #notTop:Lcom/android/server/am/HistoryRecord;
    :cond_6d
    const/4 v5, 0x0

    goto :goto_16

    .line 3252
    :cond_6f
    const/4 v5, 0x0

    move-object/from16 v23, v5

    goto :goto_2b

    .line 3277
    .restart local v23       #notTop:Lcom/android/server/am/HistoryRecord;
    :cond_73
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v5, v0

    move-object/from16 v0, p0

    move v1, v6

    move-object v2, v5

    move-object/from16 v3, v20

    move-object/from16 v4, p1

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionFromIntentLocked(ILjava/lang/String;Landroid/content/Intent;Lcom/android/server/am/HistoryRecord;)V

    .line 3280
    if-nez p2, :cond_18c

    .line 3283
    const/high16 v5, 0x1000

    and-int v5, v5, v21

    if-nez v5, :cond_aa

    .line 3284
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    .end local v6           #callingUid:I
    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "startActivity called from non-Activity context; forcing Intent.FLAG_ACTIVITY_NEW_TASK for: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, v20

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 3286
    const/high16 v5, 0x1000

    or-int v21, v21, v5

    .line 3300
    :cond_aa
    :goto_aa
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_db

    const/high16 v5, 0x1000

    and-int v5, v5, v21

    if-eqz v5, :cond_db

    .line 3306
    const-string v5, "ActivityManager"

    const-string v6, "Activity is launching as a new task, so cancelling activity result."

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 3307
    const/4 v8, -0x1

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v9, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    move-object v10, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move v11, v0

    const/4 v12, 0x0

    const/4 v13, 0x0

    move-object/from16 v7, p0

    invoke-virtual/range {v7 .. v13}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 3310
    const/4 v5, 0x0

    move-object v0, v5

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 3313
    :cond_db
    const/4 v15, 0x0

    .line 3314
    .local v15, addingToTask:Z
    const/high16 v5, 0x1000

    and-int v5, v5, v21

    if-eqz v5, :cond_e8

    const/high16 v5, 0x800

    and-int v5, v5, v21

    if-eqz v5, :cond_f8

    :cond_e8
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x2

    if-eq v5, v6, :cond_f8

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-ne v5, v6, :cond_2d6

    .line 3321
    :cond_f8
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-nez v5, :cond_2d6

    .line 3326
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-eq v5, v6, :cond_1b0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v20

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->findTaskLocked(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)Lcom/android/server/am/HistoryRecord;

    move-result-object v5

    move-object/from16 v25, v5

    .line 3329
    .local v25, taskTop:Lcom/android/server/am/HistoryRecord;
    :goto_117
    if-eqz v25, :cond_2d6

    .line 3330
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-nez v5, :cond_133

    .line 3335
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v6, v0

    move-object v0, v5

    move-object/from16 v1, v20

    move-object v2, v6

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/TaskRecord;->setIntent(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)V

    .line 3343
    :cond_133
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v18

    .line 3344
    .local v18, curTop:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    if-eq v5, v6, :cond_16f

    .line 3345
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    const/high16 v6, 0x40

    invoke-virtual {v5, v6}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    .line 3346
    if-eqz p2, :cond_15f

    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    if-ne v5, v6, :cond_1c2

    :cond_15f
    const/4 v5, 0x1

    move/from16 v16, v5

    .line 3348
    .local v16, callerAtFront:Z
    :goto_162
    if-eqz v16, :cond_16f

    .line 3351
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->moveTaskToFrontLocked(Lcom/android/server/am/TaskRecord;)V

    .line 3356
    .end local v16           #callerAtFront:Z
    :cond_16f
    const/high16 v5, 0x20

    and-int v5, v5, v21

    if-eqz v5, :cond_17f

    .line 3357
    move-object/from16 v0, p0

    move-object/from16 v1, v25

    move-object/from16 v2, p1

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->resetTaskIfNeededLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v25

    .line 3359
    :cond_17f
    if-eqz p5, :cond_1c6

    .line 3364
    if-eqz p6, :cond_18a

    .line 3365
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3367
    :cond_18a
    const/4 v5, 0x1

    .line 3573
    .end local v18           #curTop:Lcom/android/server/am/HistoryRecord;
    .end local v25           #taskTop:Lcom/android/server/am/HistoryRecord;
    .end local p3
    :goto_18b
    return v5

    .line 3288
    .end local v15           #addingToTask:Z
    .restart local v6       #callingUid:I
    .restart local p3
    :cond_18c
    move-object/from16 v0, p2

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-ne v5, v6, :cond_19a

    .line 3292
    .end local v6           #callingUid:I
    const/high16 v5, 0x1000

    or-int v21, v21, v5

    goto/16 :goto_aa

    .line 3293
    :cond_19a
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-eq v5, v6, :cond_1aa

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x2

    if-ne v5, v6, :cond_aa

    .line 3297
    :cond_1aa
    const/high16 v5, 0x1000

    or-int v21, v21, v5

    goto/16 :goto_aa

    .line 3326
    .restart local v15       #addingToTask:Z
    :cond_1b0
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v20

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->findActivityLocked(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)Lcom/android/server/am/HistoryRecord;

    move-result-object v5

    move-object/from16 v25, v5

    goto/16 :goto_117

    .line 3346
    .restart local v18       #curTop:Lcom/android/server/am/HistoryRecord;
    .restart local v25       #taskTop:Lcom/android/server/am/HistoryRecord;
    :cond_1c2
    const/4 v5, 0x0

    move/from16 v16, v5

    goto :goto_162

    .line 3369
    :cond_1c6
    const/high16 v5, 0x400

    and-int v5, v5, v21

    if-nez v5, :cond_1dc

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x2

    if-eq v5, v6, :cond_1dc

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x3

    if-ne v5, v6, :cond_238

    .line 3376
    :cond_1dc
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    const/4 v6, 0x1

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->performClearTaskLocked(ILcom/android/server/am/HistoryRecord;Z)Lcom/android/server/am/HistoryRecord;

    move-result-object v26

    .line 3378
    .local v26, top:Lcom/android/server/am/HistoryRecord;
    if-eqz v26, :cond_234

    .line 3379
    move-object/from16 v0, v26

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    move v5, v0

    if-eqz v5, :cond_209

    .line 3384
    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    invoke-virtual {v5, v6, v7}, Lcom/android/server/am/TaskRecord;->setIntent(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)V

    .line 3386
    :cond_209
    const/16 v5, 0x7533

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3387
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    .line 3438
    .end local v26           #top:Lcom/android/server/am/HistoryRecord;
    :cond_226
    :goto_226
    if-nez v15, :cond_2d6

    .line 3442
    if-eqz p6, :cond_231

    .line 3443
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3445
    :cond_231
    const/4 v5, 0x2

    goto/16 :goto_18b

    .line 3393
    .restart local v26       #top:Lcom/android/server/am/HistoryRecord;
    :cond_234
    const/4 v15, 0x1

    .line 3397
    move-object/from16 p2, v25

    goto :goto_226

    .line 3399
    .end local v26           #top:Lcom/android/server/am/HistoryRecord;
    :cond_238
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v5, v0

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    iget-object v6, v6, Lcom/android/server/am/TaskRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v5, v6}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_2ae

    .line 3406
    const/high16 v5, 0x2000

    and-int v5, v5, v21

    if-eqz v5, :cond_297

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v6, v0

    invoke-virtual {v5, v6}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_297

    .line 3408
    const/16 v5, 0x7533

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3409
    move-object/from16 v0, v25

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->frontOfTask:Z

    move v5, v0

    if-eqz v5, :cond_289

    .line 3410
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    invoke-virtual {v5, v6, v7}, Lcom/android/server/am/TaskRecord;->setIntent(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)V

    .line 3412
    :cond_289
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v25

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    goto :goto_226

    .line 3413
    :cond_297
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    iget-object v6, v6, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5, v6}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v5

    if-nez v5, :cond_226

    .line 3417
    const/4 v15, 0x1

    .line 3418
    move-object/from16 p2, v25

    goto/16 :goto_226

    .line 3420
    :cond_2ae
    const/high16 v5, 0x20

    and-int v5, v5, v21

    if-nez v5, :cond_2b9

    .line 3426
    const/4 v15, 0x1

    .line 3427
    move-object/from16 p2, v25

    goto/16 :goto_226

    .line 3428
    :cond_2b9
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget-boolean v5, v5, Lcom/android/server/am/TaskRecord;->rootWasReset:Z

    if-nez v5, :cond_226

    .line 3436
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    invoke-virtual {v5, v6, v7}, Lcom/android/server/am/TaskRecord;->setIntent(Landroid/content/Intent;Landroid/content/pm/ActivityInfo;)V

    goto/16 :goto_226

    .line 3457
    .end local v18           #curTop:Lcom/android/server/am/HistoryRecord;
    .end local v25           #taskTop:Lcom/android/server/am/HistoryRecord;
    :cond_2d6
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v5, v0

    if-eqz v5, :cond_352

    .line 3461
    move-object/from16 v0, p0

    move-object/from16 v1, v23

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v26

    .line 3462
    .restart local v26       #top:Lcom/android/server/am/HistoryRecord;
    if-eqz v26, :cond_373

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-nez v5, :cond_373

    .line 3463
    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v5, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    move-object v6, v0

    invoke-virtual {v5, v6}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_373

    .line 3464
    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    if-eqz v5, :cond_373

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v5, :cond_373

    .line 3465
    const/high16 v5, 0x2000

    and-int v5, v5, v21

    if-nez v5, :cond_324

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x1

    if-eq v5, v6, :cond_324

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchMode:I

    move v5, v0

    const/4 v6, 0x2

    if-ne v5, v6, :cond_373

    .line 3468
    :cond_324
    const/16 v5, 0x7533

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, v26

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3471
    if-eqz p6, :cond_33d

    .line 3472
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3474
    :cond_33d
    if-eqz p5, :cond_342

    .line 3478
    const/4 v5, 0x1

    goto/16 :goto_18b

    .line 3480
    :cond_342
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    .line 3481
    const/4 v5, 0x3

    goto/16 :goto_18b

    .line 3488
    .end local v26           #top:Lcom/android/server/am/HistoryRecord;
    :cond_352
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-eqz v5, :cond_370

    .line 3489
    const/4 v8, -0x1

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v9, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    move-object v10, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move v11, v0

    const/4 v12, 0x0

    const/4 v13, 0x0

    move-object/from16 v7, p0

    invoke-virtual/range {v7 .. v13}, Lcom/android/server/am/ActivityManagerService;->sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    .line 3493
    :cond_370
    const/4 v5, -0x2

    goto/16 :goto_18b

    .line 3496
    .restart local v26       #top:Lcom/android/server/am/HistoryRecord;
    :cond_373
    const/16 v22, 0x0

    .line 3499
    .local v22, newTask:Z
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v5, v0

    if-nez v5, :cond_3fe

    if-nez v15, :cond_3fe

    const/high16 v5, 0x1000

    and-int v5, v5, v21

    if-eqz v5, :cond_3fe

    .line 3502
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v5, v0

    add-int/lit8 v5, v5, 0x1

    move v0, v5

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 3503
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v5, v0

    if-gtz v5, :cond_39d

    .line 3504
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, p0

    iput v0, v1, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    .line 3506
    :cond_39d
    new-instance v5, Lcom/android/server/am/TaskRecord;

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget v8, v8, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v8, v8, 0x4

    if-eqz v8, :cond_3fc

    const/4 v8, 0x1

    :goto_3b5
    move-object v0, v5

    move v1, v6

    move-object v2, v7

    move-object/from16 v3, v20

    move v4, v8

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/TaskRecord;-><init>(ILandroid/content/pm/ActivityInfo;Landroid/content/Intent;Z)V

    move-object v0, v5

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 3510
    const/16 v22, 0x1

    .line 3511
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->addRecentTask(Lcom/android/server/am/TaskRecord;)V

    .line 3568
    .end local p3
    :goto_3d0
    if-eqz v22, :cond_3de

    .line 3569
    const/16 v5, 0x7534

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    invoke-static {v5, v6}, Landroid/util/EventLog;->writeEvent(II)I

    .line 3571
    :cond_3de
    const/16 v5, 0x7535

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3572
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, v22

    move/from16 v3, p6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V

    .line 3573
    const/4 v5, 0x0

    goto/16 :goto_18b

    .line 3506
    .restart local p3
    :cond_3fc
    const/4 v8, 0x0

    goto :goto_3b5

    .line 3513
    :cond_3fe
    if-eqz p2, :cond_49c

    .line 3514
    if-nez v15, :cond_445

    const/high16 v5, 0x400

    and-int v5, v5, v21

    if-eqz v5, :cond_445

    .line 3519
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    const/4 v6, 0x1

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->performClearTaskLocked(ILcom/android/server/am/HistoryRecord;Z)Lcom/android/server/am/HistoryRecord;

    move-result-object v26

    .line 3521
    if-eqz v26, :cond_490

    .line 3522
    const/16 v5, 0x7533

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3523
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    .line 3526
    if-eqz p6, :cond_442

    .line 3527
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3529
    :cond_442
    const/4 v5, 0x3

    goto/16 :goto_18b

    .line 3531
    :cond_445
    if-nez v15, :cond_490

    const/high16 v5, 0x2

    and-int v5, v5, v21

    if-eqz v5, :cond_490

    .line 3536
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    iget v5, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->findActivityInHistoryLocked(Lcom/android/server/am/HistoryRecord;I)I

    move-result v27

    .line 3537
    .local v27, where:I
    if-ltz v27, :cond_490

    .line 3538
    move-object/from16 v0, p0

    move/from16 v1, v27

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->moveActivityToFrontLocked(I)Lcom/android/server/am/HistoryRecord;

    move-result-object v26

    .line 3539
    const/16 v5, 0x7533

    move-object/from16 v0, v26

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v6, v0

    move-object/from16 v0, p0

    move v1, v5

    move-object/from16 v2, p1

    move-object v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->logStartActivity(ILcom/android/server/am/HistoryRecord;Lcom/android/server/am/TaskRecord;)V

    .line 3540
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v26

    move-object v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->deliverNewIntentLocked(Lcom/android/server/am/HistoryRecord;Landroid/content/Intent;)V

    .line 3541
    if-eqz p6, :cond_48d

    .line 3542
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3544
    :cond_48d
    const/4 v5, 0x3

    goto/16 :goto_18b

    .line 3550
    .end local v27           #where:I
    :cond_490
    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    goto/16 :goto_3d0

    .line 3558
    :cond_49c
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v14

    .line 3559
    .local v14, N:I
    if-lez v14, :cond_4c5

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    const/4 v6, 0x1

    sub-int v6, v14, v6

    invoke-virtual {v5, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p3

    .end local p3
    check-cast p3, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v24, p3

    .line 3561
    .local v24, prev:Lcom/android/server/am/HistoryRecord;
    :goto_4b7
    if-eqz v24, :cond_4c9

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v5, v0

    :goto_4be
    move-object v0, v5

    move-object/from16 v1, p1

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    goto/16 :goto_3d0

    .line 3559
    .end local v24           #prev:Lcom/android/server/am/HistoryRecord;
    .restart local p3
    :cond_4c5
    const/4 v5, 0x0

    move-object/from16 v24, v5

    goto :goto_4b7

    .line 3561
    .end local p3
    .restart local v24       #prev:Lcom/android/server/am/HistoryRecord;
    :cond_4c9
    new-instance v5, Lcom/android/server/am/TaskRecord;

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v6, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v7, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v8, v0

    iget v8, v8, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit8 v8, v8, 0x4

    if-eqz v8, :cond_4eb

    const/4 v8, 0x1

    :goto_4e1
    move-object v0, v5

    move v1, v6

    move-object v2, v7

    move-object/from16 v3, v20

    move v4, v8

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/TaskRecord;-><init>(ILandroid/content/pm/ActivityInfo;Landroid/content/Intent;Z)V

    goto :goto_4be

    :cond_4eb
    const/4 v8, 0x0

    goto :goto_4e1
.end method

.method private startHomeActivityLocked()Z
    .registers 16

    .prologue
    .line 2441
    iget v0, p0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    const/4 v1, 0x1

    if-ne v0, v1, :cond_b

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    if-nez v0, :cond_b

    .line 2446
    const/4 v0, 0x0

    .line 2473
    :goto_a
    return v0

    .line 2448
    :cond_b
    new-instance v2, Landroid/content/Intent;

    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    if-eqz v1, :cond_72

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    invoke-static {v1}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v1

    :goto_19
    invoke-direct {v2, v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;Landroid/net/Uri;)V

    .line 2451
    .local v2, intent:Landroid/content/Intent;
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    invoke-virtual {v2, v0}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 2452
    iget v0, p0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    const/4 v1, 0x1

    if-eq v0, v1, :cond_2b

    .line 2453
    const-string v0, "android.intent.category.HOME"

    invoke-virtual {v2, v0}, Landroid/content/Intent;->addCategory(Ljava/lang/String;)Landroid/content/Intent;

    .line 2455
    :cond_2b
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v0

    const/16 v1, 0x400

    invoke-virtual {v2, v0, v1}, Landroid/content/Intent;->resolveActivityInfo(Landroid/content/pm/PackageManager;I)Landroid/content/pm/ActivityInfo;

    move-result-object v6

    .line 2458
    .local v6, aInfo:Landroid/content/pm/ActivityInfo;
    if-eqz v6, :cond_70

    .line 2459
    new-instance v0, Landroid/content/ComponentName;

    iget-object v1, v6, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v3, v6, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v0, v1, v3}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v2, v0}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 2463
    iget-object v0, v6, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;

    iget-object v1, v6, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v14

    .line 2465
    .local v14, app:Lcom/android/server/am/ProcessRecord;
    if-eqz v14, :cond_57

    iget-object v0, v14, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    if-nez v0, :cond_70

    .line 2466
    :cond_57
    invoke-virtual {v2}, Landroid/content/Intent;->getFlags()I

    move-result v0

    const/high16 v1, 0x1000

    or-int/2addr v0, v1

    invoke-virtual {v2, v0}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;

    .line 2467
    const/4 v1, 0x0

    const/4 v3, 0x0

    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    move-object v0, p0

    invoke-direct/range {v0 .. v13}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    .line 2473
    .end local v14           #app:Lcom/android/server/am/ProcessRecord;
    :cond_70
    const/4 v0, 0x1

    goto :goto_a

    .line 2448
    .end local v2           #intent:Landroid/content/Intent;
    .end local v6           #aInfo:Landroid/content/pm/ActivityInfo;
    :cond_72
    const/4 v1, 0x0

    goto :goto_19
.end method

.method private final startPausingLocked(ZZ)V
    .registers 13
    .parameter "userLeaving"
    .parameter "uiSleeping"

    .prologue
    const/16 v9, 0x10

    const/4 v7, 0x0

    const-string v8, "ActivityManager"

    .line 2055
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v3, :cond_28

    .line 2056
    new-instance v0, Ljava/lang/RuntimeException;

    invoke-direct {v0}, Ljava/lang/RuntimeException;-><init>()V

    .line 2057
    .local v0, e:Ljava/lang/RuntimeException;
    const-string v3, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Trying to pause when pause is already pending for "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v8, v3, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2060
    .end local v0           #e:Ljava/lang/RuntimeException;
    :cond_28
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2061
    .local v2, prev:Lcom/android/server/am/HistoryRecord;
    if-nez v2, :cond_3c

    .line 2062
    new-instance v0, Ljava/lang/RuntimeException;

    invoke-direct {v0}, Ljava/lang/RuntimeException;-><init>()V

    .line 2063
    .restart local v0       #e:Ljava/lang/RuntimeException;
    const-string v3, "ActivityManager"

    const-string v3, "Trying to pause when nothing is resumed"

    invoke-static {v8, v3, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2064
    invoke-direct {p0, v7}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 2132
    .end local v0           #e:Ljava/lang/RuntimeException;
    :goto_3b
    return-void

    .line 2068
    :cond_3c
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2069
    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2070
    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    .line 2071
    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v3, v2, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 2072
    iget-object v3, v2, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    invoke-virtual {v3}, Lcom/android/server/am/TaskRecord;->touchActiveTime()V

    .line 2074
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStats()V

    .line 2076
    iget-object v3, v2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_ca

    iget-object v3, v2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v3, :cond_ca

    .line 2079
    const/16 v3, 0x753d

    const/4 v4, 0x2

    :try_start_5b
    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    invoke-static {v2}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v6

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    aput-object v6, v4, v5

    const/4 v5, 0x1

    iget-object v6, v2, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v6, v4, v5

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 2082
    iget-object v3, v2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-boolean v4, v2, Lcom/android/server/am/HistoryRecord;->finishing:Z

    iget v5, v2, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-interface {v3, v2, v4, p1, v5}, Landroid/app/IApplicationThread;->schedulePauseActivity(Landroid/os/IBinder;ZZI)V

    .line 2084
    const/4 v3, 0x0

    invoke-direct {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->updateUsageStats(Lcom/android/server/am/HistoryRecord;Z)V
    :try_end_7f
    .catch Ljava/lang/Exception; {:try_start_5b .. :try_end_7f} :catch_bc

    .line 2098
    :goto_7f
    iget-boolean v3, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    if-nez v3, :cond_a1

    iget-boolean v3, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    if-nez v3, :cond_a1

    .line 2099
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v3}, Landroid/os/PowerManager$WakeLock;->acquire()V

    .line 2100
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v3, v9}, Landroid/os/Handler;->hasMessages(I)Z

    move-result v3

    if-nez v3, :cond_a1

    .line 2102
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v3, v9}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v1

    .line 2103
    .local v1, msg:Landroid/os/Message;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v4, 0x2710

    invoke-virtual {v3, v1, v4, v5}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 2108
    .end local v1           #msg:Landroid/os/Message;
    :cond_a1
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v3, :cond_cf

    .line 2113
    if-nez p2, :cond_aa

    .line 2114
    invoke-virtual {v2}, Lcom/android/server/am/HistoryRecord;->pauseKeyDispatchingLocked()V

    .line 2122
    :cond_aa
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0x9

    invoke-virtual {v3, v4}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v1

    .line 2123
    .restart local v1       #msg:Landroid/os/Message;
    iput-object v2, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 2124
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v4, 0x1f4

    invoke-virtual {v3, v1, v4, v5}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    goto :goto_3b

    .line 2085
    .end local v1           #msg:Landroid/os/Message;
    :catch_bc
    move-exception v3

    move-object v0, v3

    .line 2087
    .local v0, e:Ljava/lang/Exception;
    const-string v3, "ActivityManager"

    const-string v3, "Exception thrown during pause"

    invoke-static {v8, v3, v0}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2088
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2089
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    goto :goto_7f

    .line 2092
    .end local v0           #e:Ljava/lang/Exception;
    :cond_ca
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    .line 2093
    iput-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    goto :goto_7f

    .line 2130
    :cond_cf
    invoke-direct {p0, v7}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    goto/16 :goto_3b
.end method

.method private final startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;)Lcom/android/server/am/ProcessRecord;
    .registers 15
    .parameter "processName"
    .parameter "info"
    .parameter "knownToBeDead"
    .parameter "intentFlags"
    .parameter "hostingType"
    .parameter "hostingName"

    .prologue
    const/4 v7, 0x0

    const/4 v6, 0x0

    .line 1874
    iget v2, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 1885
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    if-eqz v0, :cond_16

    if-eqz p3, :cond_10

    iget-object v2, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v2, :cond_16

    :cond_10
    iget v2, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v2, :cond_16

    move-object v2, v0

    .line 1934
    :goto_15
    return-object v2

    .line 1890
    :cond_16
    if-eqz p6, :cond_2f

    invoke-virtual {p6}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v2

    move-object v1, v2

    .line 1893
    .local v1, hostingNameStr:Ljava/lang/String;
    :goto_1d
    and-int/lit8 v2, p4, 0x4

    if-eqz v2, :cond_31

    .line 1896
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v4}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v2

    if-eqz v2, :cond_68

    move-object v2, v6

    .line 1897
    goto :goto_15

    .end local v1           #hostingNameStr:Ljava/lang/String;
    :cond_2f
    move-object v1, v6

    .line 1890
    goto :goto_1d

    .line 1904
    .restart local v1       #hostingNameStr:Ljava/lang/String;
    :cond_31
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v4}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 1905
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v4}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v2

    if-eqz v2, :cond_68

    .line 1906
    const/16 v2, 0x7540

    const/4 v3, 0x2

    new-array v3, v3, [Ljava/lang/Object;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v3, v7

    const/4 v4, 0x1

    iget-object v5, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    aput-object v5, v3, v4

    invoke-static {v2, v3}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 1908
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v4, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v4}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 1909
    if-eqz v0, :cond_68

    .line 1910
    iput-boolean v7, v0, Lcom/android/server/am/ProcessRecord;->bad:Z

    .line 1915
    :cond_68
    if-nez v0, :cond_8e

    .line 1916
    invoke-virtual {p0, v6, p2, p1}, Lcom/android/server/am/ActivityManagerService;->newProcessRecordLocked(Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 1917
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget v3, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, p1, v3, v0}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 1925
    :goto_75
    iget-boolean v2, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    if-nez v2, :cond_94

    iget v2, p2, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v2, v2, 0x8

    if-nez v2, :cond_94

    .line 1927
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_8c

    .line 1928
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    :cond_8c
    move-object v2, v0

    .line 1930
    goto :goto_15

    .line 1920
    :cond_8e
    iget-object v2, p2, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v0, v2}, Lcom/android/server/am/ProcessRecord;->addPackage(Ljava/lang/String;)Z

    goto :goto_75

    .line 1933
    :cond_94
    invoke-direct {p0, v0, p5, v1}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 1934
    iget v2, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    if-eqz v2, :cond_9e

    move-object v2, v0

    goto/16 :goto_15

    :cond_9e
    move-object v2, v6

    goto/16 :goto_15
.end method

.method private final startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V
    .registers 21
    .parameter "app"
    .parameter "hostingType"
    .parameter "hostingNameStr"

    .prologue
    .line 1939
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    if-lez v4, :cond_3b

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move v5, v0

    if-eq v4, v5, :cond_3b

    .line 1940
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    monitor-enter v4

    .line 1941
    :try_start_19
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v6, v0

    invoke-virtual {v5, v6}, Landroid/util/SparseArray;->remove(I)V

    .line 1942
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x14

    move-object v0, v5

    move v1, v6

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 1943
    monitor-exit v4
    :try_end_35
    .catchall {:try_start_19 .. :try_end_35} :catchall_1bb

    .line 1944
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 1947
    :cond_3b
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 1949
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStats()V

    .line 1951
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    move-object v4, v0

    const/4 v5, 0x0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    move-object v6, v0

    const/4 v7, 0x1

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    move-object v8, v0

    array-length v8, v8

    const/4 v9, 0x1

    sub-int/2addr v8, v9

    invoke-static {v4, v5, v6, v7, v8}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V

    .line 1952
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    move-object v4, v0

    const/4 v5, 0x0

    const/4 v6, 0x0

    aput v6, v4, v5

    .line 1955
    :try_start_69
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v6, v4, Landroid/content/pm/ApplicationInfo;->uid:I
    :try_end_70
    .catch Ljava/lang/RuntimeException; {:try_start_69 .. :try_end_70} :catch_1c9

    .line 1956
    .local v6, uid:I
    const/4 v8, 0x0

    .line 1958
    .local v8, gids:[I
    :try_start_71
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v4

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5}, Landroid/content/pm/PackageManager;->getPackageGids(Ljava/lang/String;)[I
    :try_end_84
    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_71 .. :try_end_84} :catch_1be
    .catch Ljava/lang/RuntimeException; {:try_start_71 .. :try_end_84} :catch_1c9

    move-result-object v8

    .line 1963
    :goto_85
    :try_start_85
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v4, v0

    if-eqz v4, :cond_c4

    .line 1964
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v4, v0

    const/4 v5, 0x1

    if-ne v4, v5, :cond_b0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    move-object v4, v0

    if-eqz v4, :cond_b0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v4, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_b0

    .line 1967
    const/4 v6, 0x0

    .line 1969
    :cond_b0
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v4, v0

    const/4 v5, 0x2

    if-ne v4, v5, :cond_c4

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v4, v4, 0x10

    if-eqz v4, :cond_c4

    .line 1971
    const/4 v6, 0x0

    .line 1974
    :cond_c4
    const/4 v9, 0x0

    .line 1975
    .local v9, debugFlags:I
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v4, v4, 0x2

    if-eqz v4, :cond_d2

    .line 1976
    or-int/lit8 v9, v9, 0x1

    .line 1978
    :cond_d2
    const-string v4, "1"

    const-string v5, "debug.checkjni"

    invoke-static {v5}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_e2

    .line 1979
    or-int/lit8 v9, v9, 0x2

    .line 1981
    :cond_e2
    const-string v4, "1"

    const-string v5, "debug.assert"

    invoke-static {v5}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_f2

    .line 1982
    or-int/lit8 v9, v9, 0x4

    .line 1984
    :cond_f2
    const-string v4, "android.app.ActivityThread"

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSimpleProcessManagement:Z

    move v5, v0

    if-eqz v5, :cond_1ef

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    :goto_100
    const/4 v10, 0x0

    move v7, v6

    invoke-static/range {v4 .. v10}, Landroid/os/Process;->start(Ljava/lang/String;Ljava/lang/String;II[II[Ljava/lang/String;)I

    move-result v16

    .line 1987
    .local v16, pid:I
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->batteryStats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-object v4, v0

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v11

    .line 1988
    .local v11, bs:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v11
    :try_end_110
    .catch Ljava/lang/RuntimeException; {:try_start_85 .. :try_end_110} :catch_1c9

    .line 1989
    :try_start_110
    invoke-virtual {v11}, Lcom/android/internal/os/BatteryStatsImpl;->isOnBattery()Z

    move-result v4

    if-eqz v4, :cond_11e

    .line 1990
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->batteryStats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-object v4, v0

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->incStartsLocked()V

    .line 1992
    :cond_11e
    monitor-exit v11
    :try_end_11f
    .catchall {:try_start_110 .. :try_end_11f} :catchall_1f2

    .line 1994
    const/16 v4, 0x753e

    const/4 v5, 0x5

    :try_start_122
    new-array v5, v5, [Ljava/lang/Object;

    const/4 v7, 0x0

    invoke-static/range {v16 .. v16}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    .end local v9           #debugFlags:I
    aput-object v9, v5, v7

    const/4 v7, 0x1

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    aput-object v9, v5, v7

    const/4 v7, 0x2

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v9, v0

    aput-object v9, v5, v7

    const/4 v7, 0x3

    aput-object p2, v5, v7

    const/4 v7, 0x4

    if-eqz p3, :cond_1f5

    move-object/from16 v9, p3

    :goto_142
    aput-object v9, v5, v7

    invoke-static {v4, v5}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 1998
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    move v4, v0

    if-eqz v4, :cond_160

    .line 1999
    invoke-static {}, Lcom/android/server/Watchdog;->getInstance()Lcom/android/server/Watchdog;

    move-result-object v4

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    move-object v0, v4

    move-object/from16 v1, p1

    move-object v2, v5

    move/from16 v3, v16

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/Watchdog;->processStarted(Lcom/android/server/Watchdog$PssRequestor;Ljava/lang/String;I)V

    .line 2002
    :cond_160
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    move-object v12, v0

    .line 2003
    .local v12, buf:Ljava/lang/StringBuilder;
    const/4 v4, 0x0

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->setLength(I)V

    .line 2004
    const-string v4, "Start proc "

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2005
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v4, v0

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2006
    const-string v4, " for "

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2007
    move-object v0, v12

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2008
    if-eqz p3, :cond_18e

    .line 2009
    const-string v4, " "

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2010
    move-object v0, v12

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2012
    :cond_18e
    const-string v4, ": pid="

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2013
    move-object v0, v12

    move/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    .line 2014
    const-string v4, " uid="

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2015
    invoke-virtual {v12, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    .line 2016
    const-string v4, " gids={"

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2017
    if-eqz v8, :cond_1f9

    .line 2018
    const/4 v14, 0x0

    .local v14, gi:I
    :goto_1a9
    array-length v4, v8

    if-ge v14, v4, :cond_1f9

    .line 2019
    if-eqz v14, :cond_1b3

    const-string v4, ", "

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2020
    :cond_1b3
    aget v4, v8, v14

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
    :try_end_1b8
    .catch Ljava/lang/RuntimeException; {:try_start_122 .. :try_end_1b8} :catch_1c9

    .line 2018
    add-int/lit8 v14, v14, 0x1

    goto :goto_1a9

    .line 1943
    .end local v6           #uid:I
    .end local v8           #gids:[I
    .end local v11           #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v12           #buf:Ljava/lang/StringBuilder;
    .end local v14           #gi:I
    .end local v16           #pid:I
    :catchall_1bb
    move-exception v5

    :try_start_1bc
    monitor-exit v4
    :try_end_1bd
    .catchall {:try_start_1bc .. :try_end_1bd} :catchall_1bb

    throw v5

    .line 1960
    .restart local v6       #uid:I
    .restart local v8       #gids:[I
    :catch_1be
    move-exception v4

    move-object v13, v4

    .line 1961
    .local v13, e:Landroid/content/pm/PackageManager$NameNotFoundException;
    :try_start_1c0
    const-string v4, "ActivityManager"

    const-string v5, "Unable to retrieve gids"

    invoke-static {v4, v5, v13}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_1c7
    .catch Ljava/lang/RuntimeException; {:try_start_1c0 .. :try_end_1c7} :catch_1c9

    goto/16 :goto_85

    .line 2047
    .end local v6           #uid:I
    .end local v8           #gids:[I
    .end local v13           #e:Landroid/content/pm/PackageManager$NameNotFoundException;
    :catch_1c9
    move-exception v4

    move-object v13, v4

    .line 2049
    .local v13, e:Ljava/lang/RuntimeException;
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 2050
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Failure starting process "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5, v13}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 2052
    .end local v13           #e:Ljava/lang/RuntimeException;
    :goto_1ee
    return-void

    .line 1984
    .restart local v6       #uid:I
    .restart local v8       #gids:[I
    .restart local v9       #debugFlags:I
    :cond_1ef
    const/4 v5, 0x0

    goto/16 :goto_100

    .line 1992
    .restart local v11       #bs:Lcom/android/internal/os/BatteryStatsImpl;
    .restart local v16       #pid:I
    :catchall_1f2
    move-exception v4

    :try_start_1f3
    monitor-exit v11
    :try_end_1f4
    .catchall {:try_start_1f3 .. :try_end_1f4} :catchall_1f2

    :try_start_1f4
    throw v4

    .line 1994
    .end local v9           #debugFlags:I
    :cond_1f5
    const-string v9, ""

    goto/16 :goto_142

    .line 2024
    .restart local v12       #buf:Ljava/lang/StringBuilder;
    :cond_1f9
    const-string v4, "}"

    invoke-virtual {v12, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2025
    const-string v4, "ActivityManager"

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 2026
    if-eqz v16, :cond_213

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move v4, v0

    move/from16 v0, v16

    move v1, v4

    if-ne v0, v1, :cond_22f

    .line 2028
    :cond_213
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move v4, v0

    move v0, v4

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 2029
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 2030
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_1ee

    .line 2031
    :cond_22f
    if-lez v16, :cond_26f

    .line 2032
    move/from16 v0, v16

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 2033
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput-boolean v0, v1, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 2034
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v4, v0

    monitor-enter v4
    :try_end_243
    .catch Ljava/lang/RuntimeException; {:try_start_1f4 .. :try_end_243} :catch_1c9

    .line 2035
    :try_start_243
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v16

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 2036
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const/16 v6, 0x14

    invoke-virtual {v5, v6}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    .end local v6           #uid:I
    move-result-object v15

    .line 2037
    .local v15, msg:Landroid/os/Message;
    move-object/from16 v0, p1

    move-object v1, v15

    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 2038
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v5, v0

    const-wide/16 v6, 0x2710

    invoke-virtual {v5, v15, v6, v7}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 2039
    monitor-exit v4

    goto :goto_1ee

    .end local v15           #msg:Landroid/os/Message;
    :catchall_26c
    move-exception v5

    monitor-exit v4
    :try_end_26e
    .catchall {:try_start_243 .. :try_end_26e} :catchall_26c

    :try_start_26e
    throw v5

    .line 2041
    .restart local v6       #uid:I
    :cond_26f
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p1

    iput v0, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    .line 2042
    new-instance v13, Ljava/lang/RuntimeException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Failure starting process "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ": returned pid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v13, v4}, Ljava/lang/RuntimeException;-><init>(Ljava/lang/String;)V

    .line 2045
    .restart local v13       #e:Ljava/lang/RuntimeException;
    const-string v4, "ActivityManager"

    invoke-virtual {v13}, Ljava/lang/RuntimeException;->getMessage()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5, v13}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_2a8
    .catch Ljava/lang/RuntimeException; {:try_start_26e .. :try_end_2a8} :catch_1c9

    goto/16 :goto_1ee
.end method

.method private startSetupActivityLocked()V
    .registers 24

    .prologue
    .line 2481
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mCheckedForSetup:Z

    move v3, v0

    if-eqz v3, :cond_8

    .line 2528
    :cond_7
    :goto_7
    return-void

    .line 2488
    :cond_8
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v19

    .line 2489
    .local v19, resolver:Landroid/content/ContentResolver;
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v3, v0

    const/4 v4, 0x1

    if-eq v3, v4, :cond_7

    const-string v3, "device_provisioned"

    const/4 v4, 0x0

    move-object/from16 v0, v19

    move-object v1, v3

    move v2, v4

    invoke-static {v0, v1, v2}, Landroid/provider/Settings$Secure;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I

    move-result v3

    if-eqz v3, :cond_7

    .line 2492
    const/4 v3, 0x1

    move v0, v3

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mCheckedForSetup:Z

    .line 2495
    new-instance v5, Landroid/content/Intent;

    const-string v3, "android.intent.action.UPGRADE_SETUP"

    invoke-direct {v5, v3}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 2496
    .local v5, intent:Landroid/content/Intent;
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->mSelf:Lcom/android/server/am/ActivityManagerService;

    iget-object v3, v3, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v3}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v3

    const/16 v4, 0x80

    invoke-virtual {v3, v5, v4}, Landroid/content/pm/PackageManager;->queryIntentActivities(Landroid/content/Intent;I)Ljava/util/List;

    move-result-object v21

    .line 2500
    .local v21, ris:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    const/16 v20, 0x0

    .line 2501
    .local v20, ri:Landroid/content/pm/ResolveInfo;
    const/16 v17, 0x0

    .local v17, i:I
    :goto_45
    if-eqz v21, :cond_6e

    invoke-interface/range {v21 .. v21}, Ljava/util/List;->size()I

    move-result v3

    move/from16 v0, v17

    move v1, v3

    if-ge v0, v1, :cond_6e

    .line 2502
    move-object/from16 v0, v21

    move/from16 v1, v17

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Landroid/content/pm/ResolveInfo;

    iget-object v3, v3, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v3, v3, 0x1

    if-eqz v3, :cond_ec

    .line 2504
    move-object/from16 v0, v21

    move/from16 v1, v17

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v20

    .end local v20           #ri:Landroid/content/pm/ResolveInfo;
    check-cast v20, Landroid/content/pm/ResolveInfo;

    .line 2509
    .restart local v20       #ri:Landroid/content/pm/ResolveInfo;
    :cond_6e
    if-eqz v20, :cond_7

    .line 2510
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->metaData:Landroid/os/Bundle;

    if-eqz v3, :cond_f0

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->metaData:Landroid/os/Bundle;

    const-string v4, "android.SETUP_VERSION"

    invoke-virtual {v3, v4}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    move-object/from16 v22, v3

    .line 2513
    .local v22, vers:Ljava/lang/String;
    :goto_88
    if-nez v22, :cond_a4

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->metaData:Landroid/os/Bundle;

    if-eqz v3, :cond_a4

    .line 2514
    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v3, v0

    iget-object v3, v3, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->metaData:Landroid/os/Bundle;

    const-string v4, "android.SETUP_VERSION"

    invoke-virtual {v3, v4}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v22

    .line 2517
    :cond_a4
    const-string v3, "last_setup_shown"

    move-object/from16 v0, v19

    move-object v1, v3

    invoke-static {v0, v1}, Landroid/provider/Settings$Secure;->getString(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v18

    .line 2519
    .local v18, lastVers:Ljava/lang/String;
    if-eqz v22, :cond_7

    move-object/from16 v0, v22

    move-object/from16 v1, v18

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_7

    .line 2520
    const/high16 v3, 0x1000

    invoke-virtual {v5, v3}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;

    .line 2521
    new-instance v3, Landroid/content/ComponentName;

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v6, v0

    iget-object v6, v6, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v3, v4, v6}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v5, v3}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 2523
    const/4 v4, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v9, v0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v16}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    goto/16 :goto_7

    .line 2501
    .end local v18           #lastVers:Ljava/lang/String;
    .end local v22           #vers:Ljava/lang/String;
    :cond_ec
    add-int/lit8 v17, v17, 0x1

    goto/16 :goto_45

    .line 2510
    :cond_f0
    const/4 v3, 0x0

    move-object/from16 v22, v3

    goto :goto_88
.end method

.method private final startSpecificActivityLocked(Lcom/android/server/am/HistoryRecord;ZZ)V
    .registers 13
    .parameter "r"
    .parameter "andResume"
    .parameter "checkConfig"

    .prologue
    const-wide/16 v2, 0x0

    .line 1842
    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v1, v1, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget v1, v1, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v7

    .line 1845
    .local v7, app:Lcom/android/server/am/ProcessRecord;
    iget-wide v0, p1, Lcom/android/server/am/HistoryRecord;->startTime:J

    cmp-long v0, v0, v2

    if-nez v0, :cond_2e

    .line 1846
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    iput-wide v0, p1, Lcom/android/server/am/HistoryRecord;->startTime:J

    .line 1847
    iget-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    cmp-long v0, v0, v2

    if-nez v0, :cond_24

    .line 1848
    iget-wide v0, p1, Lcom/android/server/am/HistoryRecord;->startTime:J

    iput-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    .line 1854
    :cond_24
    :goto_24
    if-eqz v7, :cond_5e

    iget-object v0, v7, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_5e

    .line 1856
    :try_start_2a
    invoke-direct {p0, p1, v7, p2, p3}, Lcom/android/server/am/ActivityManagerService;->realStartActivityLocked(Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/ProcessRecord;ZZ)Z
    :try_end_2d
    .catch Landroid/os/RemoteException; {:try_start_2a .. :try_end_2d} :catch_3b

    .line 1869
    :goto_2d
    return-void

    .line 1850
    :cond_2e
    iget-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    cmp-long v0, v0, v2

    if-nez v0, :cond_24

    .line 1851
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    iput-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mInitialStartTime:J

    goto :goto_24

    .line 1858
    :catch_3b
    move-exception v8

    .line 1859
    .local v8, e:Landroid/os/RemoteException;
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Exception when starting activity "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    invoke-virtual {v2}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1, v8}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 1867
    .end local v8           #e:Landroid/os/RemoteException;
    :cond_5e
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->processName:Ljava/lang/String;

    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget-object v2, v0, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    const/4 v3, 0x1

    const/4 v4, 0x0

    const-string v5, "activity"

    iget-object v0, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v0}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v6

    move-object v0, p0

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;)Lcom/android/server/am/ProcessRecord;

    goto :goto_2d
.end method

.method private final stopActivityLocked(Lcom/android/server/am/HistoryRecord;)V
    .registers 8
    .parameter "r"

    .prologue
    const/4 v5, 0x0

    const/4 v4, 0x1

    const/4 v3, 0x0

    .line 3838
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v1}, Landroid/content/Intent;->getFlags()I

    move-result v1

    const/high16 v2, 0x4000

    and-int/2addr v1, v2

    if-nez v1, :cond_16

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    iget v1, v1, Landroid/content/pm/ActivityInfo;->flags:I

    and-int/lit16 v1, v1, 0x80

    if-eqz v1, :cond_20

    .line 3840
    :cond_16
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v1, :cond_1f

    .line 3841
    const-string v1, "no-history"

    invoke-direct {p0, p1, v3, v5, v1}, Lcom/android/server/am/ActivityManagerService;->requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z

    .line 3871
    :cond_1f
    :goto_1f
    return-void

    .line 3844
    :cond_20
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_1f

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v1, :cond_1f

    .line 3845
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v1, p1, :cond_35

    .line 3846
    invoke-direct {p0, v5}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object v1

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->setFocusedActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 3848
    :cond_35
    invoke-virtual {p1}, Lcom/android/server/am/HistoryRecord;->resumeKeyDispatchingLocked()V

    .line 3850
    const/4 v1, 0x0

    :try_start_39
    iput-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 3851
    sget-object v1, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 3854
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-nez v1, :cond_49

    .line 3855
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v2, 0x0

    invoke-virtual {v1, p1, v2}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 3857
    :cond_49
    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    iget-boolean v2, p1, Lcom/android/server/am/HistoryRecord;->visible:Z

    iget v3, p1, Lcom/android/server/am/HistoryRecord;->configChangeFlags:I

    invoke-interface {v1, p1, v2, v3}, Landroid/app/IApplicationThread;->scheduleStopActivity(Landroid/os/IBinder;ZI)V
    :try_end_54
    .catch Ljava/lang/Exception; {:try_start_39 .. :try_end_54} :catch_55

    goto :goto_1f

    .line 3858
    :catch_55
    move-exception v1

    move-object v0, v1

    .line 3862
    .local v0, e:Ljava/lang/Exception;
    const-string v1, "ActivityManager"

    const-string v2, "Exception thrown during pause"

    invoke-static {v1, v2, v0}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 3864
    iput-boolean v4, p1, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 3865
    sget-object v1, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v1, p1, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 3866
    iget-boolean v1, p1, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    if-eqz v1, :cond_1f

    .line 3867
    invoke-direct {p0, p1, v4}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    goto :goto_1f
.end method

.method private final topRunningActivityLocked(Landroid/os/IBinder;I)Lcom/android/server/am/HistoryRecord;
    .registers 7
    .parameter "token"
    .parameter "taskId"

    .prologue
    .line 1685
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .line 1686
    .local v0, i:I
    :goto_9
    if-ltz v0, :cond_24

    .line 1687
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 1689
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v2, :cond_21

    if-eq p1, v1, :cond_21

    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v2, v2, Lcom/android/server/am/TaskRecord;->taskId:I

    if-eq p2, v2, :cond_21

    move-object v2, v1

    .line 1694
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_20
    return-object v2

    .line 1692
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_21
    add-int/lit8 v0, v0, -0x1

    .line 1693
    goto :goto_9

    .line 1694
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_24
    const/4 v2, 0x0

    goto :goto_20
.end method

.method private final topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;
    .registers 6
    .parameter "notTop"

    .prologue
    .line 1652
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .line 1653
    .local v0, i:I
    :goto_9
    if-ltz v0, :cond_1e

    .line 1654
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 1655
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v2, :cond_1b

    if-eq v1, p1, :cond_1b

    move-object v2, v1

    .line 1660
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1a
    return-object v2

    .line 1658
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_1b
    add-int/lit8 v0, v0, -0x1

    .line 1659
    goto :goto_9

    .line 1660
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1e
    const/4 v2, 0x0

    goto :goto_1a
.end method

.method private final topRunningNonDelayedActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;
    .registers 6
    .parameter "notTop"

    .prologue
    .line 1664
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .line 1665
    .local v0, i:I
    :goto_9
    if-ltz v0, :cond_22

    .line 1666
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 1667
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v2, :cond_1f

    iget-boolean v2, v1, Lcom/android/server/am/HistoryRecord;->delayedResume:Z

    if-nez v2, :cond_1f

    if-eq v1, p1, :cond_1f

    move-object v2, v1

    .line 1672
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1e
    return-object v2

    .line 1670
    .restart local v1       #r:Lcom/android/server/am/HistoryRecord;
    :cond_1f
    add-int/lit8 v0, v0, -0x1

    .line 1671
    goto :goto_9

    .line 1672
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_22
    const/4 v2, 0x0

    goto :goto_1e
.end method

.method private final trimApplications()V
    .registers 14

    .prologue
    .line 13010
    monitor-enter p0

    .line 13015
    :try_start_1
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    const/4 v11, 0x1

    sub-int v5, v10, v11

    .local v5, i:I
    :goto_a
    if-ltz v5, :cond_8f

    .line 13016
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 13017
    .local v1, app:Lcom/android/server/am/ProcessRecord;
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-nez v10, :cond_82

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    if-nez v10, :cond_82

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v10}, Ljava/util/HashSet;->size()I

    move-result v10

    if-nez v10, :cond_82

    .line 13019
    const-string v10, "ActivityManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Exiting empty application process "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, " ("

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v12, :cond_85

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v12}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v12

    :goto_4b
    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, ")\n"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v10, v11}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 13024
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v10, :cond_87

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    iget v11, p0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v10, v11, :cond_87

    .line 13025
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v10}, Landroid/os/Process;->killProcess(I)V

    .line 13033
    :goto_6b
    const/4 v10, 0x0

    const/4 v11, -0x1

    invoke-direct {p0, v1, v10, v11}, Lcom/android/server/am/ActivityManagerService;->cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V

    .line 13034
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 13036
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v10, :cond_82

    .line 13037
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v10, :cond_82

    .line 13038
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    invoke-virtual {p0, v10}, Lcom/android/server/am/ActivityManagerService;->addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;
    :try_end_82
    .catchall {:try_start_1 .. :try_end_82} :catchall_274

    .line 13015
    :cond_82
    add-int/lit8 v5, v5, -0x1

    goto :goto_a

    .line 13019
    :cond_85
    const/4 v12, 0x0

    goto :goto_4b

    .line 13028
    :cond_87
    :try_start_87
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v10}, Landroid/app/IApplicationThread;->scheduleExit()V
    :try_end_8c
    .catchall {:try_start_87 .. :try_end_8c} :catchall_274
    .catch Ljava/lang/Exception; {:try_start_87 .. :try_end_8c} :catch_8d

    goto :goto_6b

    .line 13029
    :catch_8d
    move-exception v10

    goto :goto_6b

    .line 13048
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    :cond_8f
    :try_start_8f
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    move-result v10

    if-nez v10, :cond_223

    .line 13051
    const/4 v7, 0x0

    .line 13052
    .local v7, numServiceProcs:I
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    const/4 v11, 0x1

    sub-int v5, v10, v11

    :goto_9f
    if-ltz v5, :cond_c2

    .line 13053
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 13055
    .restart local v1       #app:Lcom/android/server/am/ProcessRecord;
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v10, :cond_bd

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v10}, Ljava/util/HashSet;->size()I

    move-result v10

    if-nez v10, :cond_bd

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    if-nez v10, :cond_bd

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    if-lez v10, :cond_bf

    .line 13063
    :cond_bd
    add-int/lit8 v7, v7, 0x1

    .line 13052
    :cond_bf
    add-int/lit8 v5, v5, -0x1

    goto :goto_9f

    .line 13067
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    :cond_c2
    iget v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    .line 13068
    .local v4, curMaxProcs:I
    if-gtz v4, :cond_c7

    const/4 v4, 0x2

    .line 13069
    :cond_c7
    iget-boolean v10, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    if-eqz v10, :cond_cc

    .line 13070
    const/4 v4, 0x1

    .line 13072
    :cond_cc
    add-int/2addr v4, v7

    .line 13077
    const/4 v5, 0x0

    .line 13079
    :goto_ce
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-ge v5, v10, :cond_154

    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-le v10, v4, :cond_154

    .line 13081
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 13084
    .restart local v1       #app:Lcom/android/server/am/ProcessRecord;
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v10, :cond_147

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-nez v10, :cond_147

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    if-nez v10, :cond_147

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v10}, Ljava/util/HashSet;->size()I

    move-result v10

    if-nez v10, :cond_147

    .line 13086
    const-string v10, "ActivityManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Exiting empty application process "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, " ("

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v12, :cond_14a

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v12}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v12

    :goto_121
    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, ")\n"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v10, v11}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 13091
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v10, :cond_14c

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    iget v11, p0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v10, v11, :cond_14c

    .line 13092
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v10}, Landroid/os/Process;->killProcess(I)V

    .line 13104
    :goto_141
    const/4 v10, 0x0

    invoke-direct {p0, v1, v10, v5}, Lcom/android/server/am/ActivityManagerService;->cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V
    :try_end_145
    .catchall {:try_start_8f .. :try_end_145} :catchall_274

    .line 13105
    add-int/lit8 v5, v5, -0x1

    .line 13080
    :cond_147
    add-int/lit8 v5, v5, 0x1

    goto :goto_ce

    .line 13086
    :cond_14a
    const/4 v12, 0x0

    goto :goto_121

    .line 13095
    :cond_14c
    :try_start_14c
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v10}, Landroid/app/IApplicationThread;->scheduleExit()V
    :try_end_151
    .catchall {:try_start_14c .. :try_end_151} :catchall_274
    .catch Ljava/lang/Exception; {:try_start_14c .. :try_end_151} :catch_152

    goto :goto_141

    .line 13096
    :catch_152
    move-exception v10

    goto :goto_141

    .line 13114
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    :cond_154
    const/4 v5, 0x0

    .line 13116
    :goto_155
    :try_start_155
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-ge v5, v10, :cond_223

    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-le v10, v4, :cond_223

    .line 13118
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 13121
    .restart local v1       #app:Lcom/android/server/am/ProcessRecord;
    iget-boolean v10, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v10, :cond_1ab

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    if-nez v10, :cond_1ab

    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v10}, Ljava/util/HashSet;->size()I

    move-result v10

    if-nez v10, :cond_1ab

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    if-nez v10, :cond_1ab

    const/4 v10, 0x1

    move v2, v10

    .line 13124
    .local v2, canQuit:Z
    :goto_183
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 13128
    .local v0, NUMA:I
    const/4 v6, 0x0

    .local v6, j:I
    :goto_18a
    if-ge v6, v0, :cond_1b1

    if-eqz v2, :cond_1b1

    .line 13129
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/HistoryRecord;

    .line 13133
    .local v9, r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->haveState:Z

    if-nez v10, :cond_19e

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->stateNotNeeded:Z

    if-nez v10, :cond_1ae

    :cond_19e
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-nez v10, :cond_1ae

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->stopped:Z

    if-eqz v10, :cond_1ae

    const/4 v10, 0x1

    move v2, v10

    .line 13128
    :goto_1a8
    add-int/lit8 v6, v6, 0x1

    goto :goto_18a

    .line 13121
    .end local v0           #NUMA:I
    .end local v2           #canQuit:Z
    .end local v6           #j:I
    .end local v9           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1ab
    const/4 v10, 0x0

    move v2, v10

    goto :goto_183

    .line 13133
    .restart local v0       #NUMA:I
    .restart local v2       #canQuit:Z
    .restart local v6       #j:I
    .restart local v9       #r:Lcom/android/server/am/HistoryRecord;
    :cond_1ae
    const/4 v10, 0x0

    move v2, v10

    goto :goto_1a8

    .line 13136
    .end local v9           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1b1
    if-eqz v2, :cond_215

    .line 13138
    const/4 v6, 0x0

    :goto_1b4
    if-ge v6, v0, :cond_1cc

    .line 13139
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->activities:Ljava/util/ArrayList;

    invoke-virtual {v10, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/HistoryRecord;

    .line 13140
    .restart local v9       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v10, :cond_1c6

    .line 13141
    const/4 v10, 0x0

    invoke-direct {p0, v9, v10}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    .line 13143
    :cond_1c6
    const/4 v10, 0x0

    iput-object v10, v9, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 13138
    add-int/lit8 v6, v6, 0x1

    goto :goto_1b4

    .line 13145
    .end local v9           #r:Lcom/android/server/am/HistoryRecord;
    :cond_1cc
    const-string v10, "ActivityManager"

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Exiting application process "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, " ("

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v12, :cond_219

    iget-object v12, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v12}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v12

    :goto_1ef
    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, ")\n"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-static {v10, v11}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 13149
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v10, :cond_21b

    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    iget v11, p0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v10, v11, :cond_21b

    .line 13150
    iget v10, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v10}, Landroid/os/Process;->killProcess(I)V

    .line 13162
    :goto_20f
    const/4 v10, 0x0

    invoke-direct {p0, v1, v10, v5}, Lcom/android/server/am/ActivityManagerService;->cleanUpApplicationRecordLocked(Lcom/android/server/am/ProcessRecord;ZI)V
    :try_end_213
    .catchall {:try_start_155 .. :try_end_213} :catchall_274

    .line 13163
    add-int/lit8 v5, v5, -0x1

    .line 13117
    :cond_215
    add-int/lit8 v5, v5, 0x1

    goto/16 :goto_155

    .line 13145
    :cond_219
    const/4 v12, 0x0

    goto :goto_1ef

    .line 13153
    :cond_21b
    :try_start_21b
    iget-object v10, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v10}, Landroid/app/IApplicationThread;->scheduleExit()V
    :try_end_220
    .catchall {:try_start_21b .. :try_end_220} :catchall_274
    .catch Ljava/lang/Exception; {:try_start_21b .. :try_end_220} :catch_221

    goto :goto_20f

    .line 13154
    :catch_221
    move-exception v10

    goto :goto_20f

    .line 13170
    .end local v0           #NUMA:I
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    .end local v2           #canQuit:Z
    .end local v4           #curMaxProcs:I
    .end local v6           #j:I
    .end local v7           #numServiceProcs:I
    :cond_223
    const/16 v3, 0x14

    .line 13171
    .local v3, curMaxActivities:I
    :try_start_225
    iget-boolean v10, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    if-eqz v10, :cond_22a

    .line 13172
    const/4 v3, 0x1

    .line 13177
    :cond_22a
    const/4 v5, 0x0

    .line 13179
    :goto_22b
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-ge v5, v10, :cond_272

    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-le v10, v3, :cond_272

    .line 13181
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/HistoryRecord;

    .line 13186
    .restart local v9       #r:Lcom/android/server/am/HistoryRecord;
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->haveState:Z

    if-nez v10, :cond_24b

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->stateNotNeeded:Z

    if-nez v10, :cond_26f

    :cond_24b
    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->visible:Z

    if-nez v10, :cond_26f

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->stopped:Z

    if-eqz v10, :cond_26f

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-nez v10, :cond_26f

    iget-boolean v10, v9, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v10, :cond_26f

    .line 13188
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v8

    .line 13189
    .local v8, origSize:I
    const/4 v10, 0x1

    invoke-direct {p0, v9, v10}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    .line 13196
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v10

    if-le v8, v10, :cond_26f

    .line 13197
    add-int/lit8 v5, v5, -0x1

    .line 13180
    .end local v8           #origSize:I
    :cond_26f
    add-int/lit8 v5, v5, 0x1

    goto :goto_22b

    .line 13201
    .end local v9           #r:Lcom/android/server/am/HistoryRecord;
    :cond_272
    monitor-exit p0

    .line 13202
    return-void

    .line 13201
    .end local v3           #curMaxActivities:I
    .end local v5           #i:I
    :catchall_274
    move-exception v10

    monitor-exit p0
    :try_end_276
    .catchall {:try_start_225 .. :try_end_276} :catchall_274

    throw v10
.end method

.method private final uninstallPackageLocked(Ljava/lang/String;IZ)V
    .registers 25
    .parameter "name"
    .parameter "uid"
    .parameter "callerWillRestart"

    .prologue
    .line 4956
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Uninstalling process "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 4960
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, ":"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    .line 4961
    .local v17, procNamePrefix:Ljava/lang/String;
    if-gez p2, :cond_3e

    .line 4963
    :try_start_33
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-interface {v0, v1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I
    :try_end_3d
    .catch Landroid/os/RemoteException; {:try_start_33 .. :try_end_3d} :catch_1c4

    move-result p2

    .line 4968
    :cond_3e
    :goto_3e
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v3

    invoke-virtual {v3}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v14

    .line 4969
    .local v14, badApps:Ljava/util/Iterator;,"Ljava/util/Iterator<Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    :cond_4f
    :goto_4f
    invoke-interface {v14}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_68

    .line 4970
    invoke-interface {v14}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Landroid/util/SparseArray;

    .line 4971
    .local v13, ba:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    move-object v0, v13

    move/from16 v1, p2

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    if-eqz v3, :cond_4f

    .line 4972
    invoke-interface {v14}, Ljava/util/Iterator;->remove()V

    goto :goto_4f

    .line 4976
    .end local v13           #ba:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    :cond_68
    new-instance v18, Ljava/util/ArrayList;

    invoke-direct/range {v18 .. v18}, Ljava/util/ArrayList;-><init>()V

    .line 4981
    .local v18, procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    move-object v3, v0

    invoke-virtual {v3}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v3

    invoke-virtual {v3}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v15

    .local v15, i$:Ljava/util/Iterator;
    :cond_7e
    invoke-interface {v15}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_dd

    invoke-interface {v15}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v12

    check-cast v12, Landroid/util/SparseArray;

    .line 4982
    .local v12, apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    invoke-virtual {v12}, Landroid/util/SparseArray;->size()I

    move-result v10

    .line 4983
    .local v10, NA:I
    const/16 v16, 0x0

    .local v16, ia:I
    :goto_90
    move/from16 v0, v16

    move v1, v10

    if-ge v0, v1, :cond_7e

    .line 4984
    move-object v0, v12

    move/from16 v1, v16

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/am/ProcessRecord;

    .line 4985
    .local v11, app:Lcom/android/server/am/ProcessRecord;
    iget-boolean v3, v11, Lcom/android/server/am/ProcessRecord;->removed:Z

    if-eqz v3, :cond_ab

    .line 4986
    move-object/from16 v0, v18

    move-object v1, v11

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4983
    :cond_a8
    :goto_a8
    add-int/lit8 v16, v16, 0x1

    goto :goto_90

    .line 4987
    :cond_ab
    if-lez p2, :cond_bd

    const/16 v3, 0x3e8

    move/from16 v0, p2

    move v1, v3

    if-eq v0, v1, :cond_bd

    iget-object v3, v11, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->uid:I

    move v0, v3

    move/from16 v1, p2

    if-eq v0, v1, :cond_d3

    :cond_bd
    iget-object v3, v11, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_d3

    iget-object v3, v11, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v0, v3

    move-object/from16 v1, v17

    invoke-virtual {v0, v1}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_a8

    .line 4990
    :cond_d3
    const/4 v3, 0x1

    iput-boolean v3, v11, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 4991
    move-object/from16 v0, v18

    move-object v1, v11

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_a8

    .line 4996
    .end local v10           #NA:I
    .end local v11           #app:Lcom/android/server/am/ProcessRecord;
    .end local v12           #apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .end local v16           #ia:I
    :cond_dd
    invoke-virtual/range {v18 .. v18}, Ljava/util/ArrayList;->size()I

    move-result v9

    .line 4997
    .local v9, N:I
    const/4 v5, 0x0

    .end local p2
    .local v5, i:I
    :goto_e2
    if-ge v5, v9, :cond_f9

    .line 4998
    move-object/from16 v0, v18

    move v1, v5

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    check-cast p2, Lcom/android/server/am/ProcessRecord;

    move-object/from16 v0, p0

    move-object/from16 v1, p2

    move/from16 v2, p3

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->removeProcessLocked(Lcom/android/server/am/ProcessRecord;Z)Z

    .line 4997
    add-int/lit8 v5, v5, 0x1

    goto :goto_e2

    .line 5001
    :cond_f9
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v5, v3, v4

    :goto_105
    if-ltz v5, :cond_157

    .line 5002
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 5003
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_154

    .line 5004
    const-string v3, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "  Force finishing activity "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, v4, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v7}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v7

    invoke-virtual {v7}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v3, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 5007
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_148

    .line 5008
    iget-object v3, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v6, 0x1

    iput-boolean v6, v3, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 5010
    :cond_148
    const/4 v3, 0x0

    iput-object v3, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 5011
    const/4 v6, 0x0

    const/4 v7, 0x0

    const-string v8, "uninstall"

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 5001
    :cond_154
    add-int/lit8 v5, v5, -0x1

    goto :goto_105

    .line 5015
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :cond_157
    new-instance v20, Ljava/util/ArrayList;

    invoke-direct/range {v20 .. v20}, Ljava/util/ArrayList;-><init>()V

    .line 5016
    .local v20, services:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ServiceRecord;>;"
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v15

    :cond_169
    :goto_169
    invoke-interface {v15}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_1a0

    invoke-interface {v15}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v19

    check-cast v19, Lcom/android/server/am/ServiceRecord;

    .line 5017
    .local v19, service:Lcom/android/server/am/ServiceRecord;
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->packageName:Ljava/lang/String;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_169

    .line 5018
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v3, v0

    if-eqz v3, :cond_192

    .line 5019
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v3, v0

    const/4 v4, 0x1

    iput-boolean v4, v3, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 5021
    :cond_192
    const/4 v3, 0x0

    move-object v0, v3

    move-object/from16 v1, v19

    iput-object v0, v1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 5022
    move-object/from16 v0, v20

    move-object/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_169

    .line 5026
    .end local v19           #service:Lcom/android/server/am/ServiceRecord;
    :cond_1a0
    invoke-virtual/range {v20 .. v20}, Ljava/util/ArrayList;->size()I

    move-result v9

    .line 5027
    const/4 v5, 0x0

    .end local p1
    :goto_1a5
    if-ge v5, v9, :cond_1bc

    .line 5028
    move-object/from16 v0, v20

    move v1, v5

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcom/android/server/am/ServiceRecord;

    const/4 v3, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move v2, v3

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 5027
    add-int/lit8 v5, v5, 0x1

    goto :goto_1a5

    .line 5031
    :cond_1bc
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object v1, v3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 5032
    return-void

    .line 4964
    .end local v5           #i:I
    .end local v9           #N:I
    .end local v14           #badApps:Ljava/util/Iterator;,"Ljava/util/Iterator<Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    .end local v15           #i$:Ljava/util/Iterator;
    .end local v18           #procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    .end local v20           #services:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ServiceRecord;>;"
    .restart local p1
    .restart local p2
    :catch_1c4
    move-exception v3

    goto/16 :goto_3e
.end method

.method private final unscheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)Z
    .registers 6
    .parameter "r"

    .prologue
    .line 10179
    iget-wide v0, p1, Lcom/android/server/am/ServiceRecord;->restartDelay:J

    const-wide/16 v2, 0x0

    cmp-long v0, v0, v2

    if-nez v0, :cond_a

    .line 10180
    const/4 v0, 0x0

    .line 10185
    :goto_9
    return v0

    .line 10182
    :cond_a
    invoke-virtual {p1}, Lcom/android/server/am/ServiceRecord;->resetRestartCounter()V

    .line 10183
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 10184
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->restarter:Ljava/lang/Runnable;

    invoke-virtual {v0, v1}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V

    .line 10185
    const/4 v0, 0x1

    goto :goto_9
.end method

.method private final updateLRUListLocked(Lcom/android/server/am/ProcessRecord;Z)V
    .registers 5
    .parameter "app"
    .parameter "oomAdj"

    .prologue
    .line 1636
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v0

    .line 1637
    .local v0, lrui:I
    if-ltz v0, :cond_d

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 1638
    :cond_d
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 1640
    if-eqz p2, :cond_17

    .line 1641
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 1643
    :cond_17
    return-void
.end method

.method private final updateLRUListLocked(Lcom/android/server/am/HistoryRecord;)Z
    .registers 4
    .parameter "r"

    .prologue
    .line 1646
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    move-result v0

    .line 1647
    .local v0, hadit:Z
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 1648
    return v0
.end method

.method private final updateOomAdjLocked()Z
    .registers 8

    .prologue
    .line 12975
    const/4 v4, 0x1

    .line 12976
    .local v4, didOomAdj:Z
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->resumedAppLocked()Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 12977
    .local v0, TOP_ACT:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_35

    iget-object v6, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v1, v6

    .line 12985
    .local v1, TOP_APP:Lcom/android/server/am/ProcessRecord;
    :goto_a
    iget v6, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    add-int/lit8 v6, v6, 0x1

    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    .line 12989
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v5

    .line 12990
    .local v5, i:I
    sget v3, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    .line 12991
    .local v3, curHiddenAdj:I
    :cond_18
    :goto_18
    if-lez v5, :cond_3a

    .line 12992
    add-int/lit8 v5, v5, -0x1

    .line 12993
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 12994
    .local v2, app:Lcom/android/server/am/ProcessRecord;
    invoke-direct {p0, v2, v3, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;)Z

    move-result v6

    if-eqz v6, :cond_38

    .line 12995
    iget v6, p0, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MAX_ADJ:I

    if-ge v3, v6, :cond_18

    iget v6, v2, Lcom/android/server/am/ProcessRecord;->curAdj:I

    if-ne v6, v3, :cond_18

    .line 12997
    add-int/lit8 v3, v3, 0x1

    goto :goto_18

    .line 12977
    .end local v1           #TOP_APP:Lcom/android/server/am/ProcessRecord;
    .end local v2           #app:Lcom/android/server/am/ProcessRecord;
    .end local v3           #curHiddenAdj:I
    .end local v5           #i:I
    :cond_35
    const/4 v6, 0x0

    move-object v1, v6

    goto :goto_a

    .line 13000
    .restart local v1       #TOP_APP:Lcom/android/server/am/ProcessRecord;
    .restart local v2       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v3       #curHiddenAdj:I
    .restart local v5       #i:I
    :cond_38
    const/4 v4, 0x0

    goto :goto_18

    .line 13006
    .end local v2           #app:Lcom/android/server/am/ProcessRecord;
    :cond_3a
    iget v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    if-lez v6, :cond_40

    const/4 v6, 0x0

    :goto_3f
    return v6

    :cond_40
    move v6, v4

    goto :goto_3f
.end method

.method private final updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z
    .registers 12
    .parameter "app"

    .prologue
    const/4 v9, 0x1

    const/4 v8, 0x0

    .line 12953
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->resumedAppLocked()Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 12954
    .local v0, TOP_ACT:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_3b

    iget-object v6, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v1, v6

    .line 12955
    .local v1, TOP_APP:Lcom/android/server/am/ProcessRecord;
    :goto_b
    iget v2, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 12956
    .local v2, curAdj:I
    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v6, v7, :cond_3e

    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    iget v7, p0, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MAX_ADJ:I

    if-gt v6, v7, :cond_3e

    move v5, v9

    .line 12959
    .local v5, wasHidden:Z
    :goto_1a
    iget v6, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    add-int/lit8 v6, v6, 0x1

    iput v6, p0, Lcom/android/server/am/ActivityManagerService;->mAdjSeq:I

    .line 12961
    iget v6, p1, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    invoke-direct {p0, p1, v6, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;)Z

    move-result v4

    .line 12962
    .local v4, res:Z
    if-eqz v4, :cond_3a

    .line 12963
    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v6, v7, :cond_40

    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curAdj:I

    iget v7, p0, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MAX_ADJ:I

    if-gt v6, v7, :cond_40

    move v3, v9

    .line 12965
    .local v3, nowHidden:Z
    :goto_35
    if-eq v3, v5, :cond_3a

    .line 12968
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 12971
    .end local v3           #nowHidden:Z
    :cond_3a
    return v4

    .line 12954
    .end local v1           #TOP_APP:Lcom/android/server/am/ProcessRecord;
    .end local v2           #curAdj:I
    .end local v4           #res:Z
    .end local v5           #wasHidden:Z
    :cond_3b
    const/4 v6, 0x0

    move-object v1, v6

    goto :goto_b

    .restart local v1       #TOP_APP:Lcom/android/server/am/ProcessRecord;
    .restart local v2       #curAdj:I
    :cond_3e
    move v5, v8

    .line 12956
    goto :goto_1a

    .restart local v4       #res:Z
    .restart local v5       #wasHidden:Z
    :cond_40
    move v3, v8

    .line 12963
    goto :goto_35
.end method

.method private final updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;)Z
    .registers 12
    .parameter "app"
    .parameter "hiddenAdj"
    .parameter "TOP_APP"

    .prologue
    const/4 v7, 0x1

    .line 12877
    iput p2, p1, Lcom/android/server/am/ProcessRecord;->hiddenAdj:I

    .line 12879
    iget-object v4, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v4, :cond_9

    move v4, v7

    .line 12938
    :goto_8
    return v4

    .line 12883
    :cond_9
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/am/ActivityManagerService;->computeOomAdjLocked(Lcom/android/server/am/ProcessRecord;ILcom/android/server/am/ProcessRecord;)I

    move-result v0

    .line 12885
    .local v0, adj:I
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-eqz v4, :cond_56

    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    iget v5, p0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v4, v5, :cond_56

    .line 12886
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    iget v5, p1, Lcom/android/server/am/ProcessRecord;->setRawAdj:I

    if-eq v4, v5, :cond_30

    .line 12887
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    iget v5, p0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    if-le v4, v5, :cond_58

    iget v4, p1, Lcom/android/server/am/ProcessRecord;->setRawAdj:I

    iget v5, p0, Lcom/android/server/am/ActivityManagerService;->FOREGROUND_APP_ADJ:I

    if-gt v4, v5, :cond_58

    .line 12891
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 12898
    :cond_2c
    :goto_2c
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    iput v4, p1, Lcom/android/server/am/ProcessRecord;->setRawAdj:I

    .line 12900
    :cond_30
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->setAdj:I

    if-eq v0, v4, :cond_3e

    .line 12901
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v4, v0}, Landroid/os/Process;->setOomAdj(II)Z

    move-result v4

    if-eqz v4, :cond_68

    .line 12905
    iput v0, p1, Lcom/android/server/am/ProcessRecord;->setAdj:I

    .line 12910
    :cond_3e
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->setSchedGroup:I

    iget v5, p1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    if-eq v4, v5, :cond_56

    .line 12911
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    iput v4, p1, Lcom/android/server/am/ProcessRecord;->setSchedGroup:I

    .line 12916
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 12918
    .local v2, oldId:J
    :try_start_4c
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    iget v5, p1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    invoke-static {v4, v5}, Landroid/os/Process;->setProcessGroup(II)V
    :try_end_53
    .catchall {:try_start_4c .. :try_end_53} :catchall_96
    .catch Ljava/lang/Exception; {:try_start_4c .. :try_end_53} :catch_6a

    .line 12924
    :goto_53
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .end local v2           #oldId:J
    :cond_56
    move v4, v7

    .line 12938
    goto :goto_8

    .line 12892
    :cond_58
    iget v4, p1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v4, v5, :cond_2c

    iget v4, p1, Lcom/android/server/am/ProcessRecord;->setRawAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-ge v4, v5, :cond_2c

    .line 12896
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcLocked(Lcom/android/server/am/ProcessRecord;)V

    goto :goto_2c

    .line 12907
    :cond_68
    const/4 v4, 0x0

    goto :goto_8

    .line 12919
    .restart local v2       #oldId:J
    :catch_6a
    move-exception v4

    move-object v1, v4

    .line 12920
    .local v1, e:Ljava/lang/Exception;
    :try_start_6c
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Failed setting process group of "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget v6, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " to "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget v6, p1, Lcom/android/server/am/ProcessRecord;->curSchedGroup:I

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12922
    invoke-virtual {v1}, Ljava/lang/Exception;->printStackTrace()V
    :try_end_95
    .catchall {:try_start_6c .. :try_end_95} :catchall_96

    goto :goto_53

    .line 12924
    .end local v1           #e:Ljava/lang/Exception;
    :catchall_96
    move-exception v4

    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v4
.end method

.method private updateUsageStats(Lcom/android/server/am/HistoryRecord;Z)V
    .registers 5
    .parameter "resumedComponent"
    .parameter "resumed"

    .prologue
    .line 2433
    if-eqz p2, :cond_a

    .line 2434
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v0, v1}, Lcom/android/server/am/UsageStatsService;->noteResumeComponent(Landroid/content/ComponentName;)V

    .line 2438
    :goto_9
    return-void

    .line 2436
    :cond_a
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    iget-object v1, p1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v0, v1}, Lcom/android/server/am/UsageStatsService;->notePauseComponent(Landroid/content/ComponentName;)V

    goto :goto_9
.end method


# virtual methods
.method public final activityDestroyed(Landroid/os/IBinder;)V
    .registers 8
    .parameter "token"

    .prologue
    .line 5607
    monitor-enter p0

    .line 5608
    :try_start_1
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v5, 0x11

    invoke-virtual {v4, v5, p1}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 5610
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 5611
    .local v0, index:I
    if-ltz v0, :cond_26

    .line 5612
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 5613
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    sget-object v5, Lcom/android/server/am/ActivityManagerService$ActivityState;->DESTROYING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v4, v5, :cond_26

    .line 5614
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 5615
    .local v1, origId:J
    invoke-direct {p0, v3}, Lcom/android/server/am/ActivityManagerService;->removeActivityFromHistoryLocked(Lcom/android/server/am/HistoryRecord;)V

    .line 5616
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5619
    .end local v1           #origId:J
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_26
    monitor-exit p0

    .line 5620
    return-void

    .line 5619
    .end local v0           #index:I
    :catchall_28
    move-exception v4

    monitor-exit p0
    :try_end_2a
    .catchall {:try_start_1 .. :try_end_2a} :catchall_28

    throw v4
.end method

.method public final activityIdle(Landroid/os/IBinder;)V
    .registers 5
    .parameter "token"

    .prologue
    .line 5318
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 5319
    .local v0, origId:J
    const/4 v2, 0x0

    invoke-virtual {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->activityIdleInternal(Landroid/os/IBinder;Z)V

    .line 5320
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5321
    return-void
.end method

.method final activityIdleInternal(Landroid/os/IBinder;Z)V
    .registers 40
    .parameter "token"
    .parameter "fromTimeout"

    .prologue
    .line 5373
    const/16 v34, 0x0

    .line 5374
    .local v34, stops:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    const/16 v27, 0x0

    .line 5375
    .local v27, finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    const/16 v35, 0x0

    .line 5376
    .local v35, thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    const/16 v22, 0x0

    .line 5377
    .local v22, NS:I
    const/16 v20, 0x0

    .line 5378
    .local v20, NF:I
    const/16 v23, 0x0

    .line 5379
    .local v23, NT:I
    const/16 v33, 0x0

    .line 5380
    .local v33, sendThumbnail:Landroid/app/IApplicationThread;
    const/16 v24, 0x0

    .line 5381
    .local v24, booting:Z
    const/16 v26, 0x0

    .line 5383
    .local v26, enableScreen:Z
    monitor-enter p0

    .line 5384
    if-eqz p1, :cond_23

    .line 5385
    :try_start_15
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v4, v0

    const/16 v5, 0xa

    move-object v0, v4

    move v1, v5

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 5389
    :cond_23
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v30

    .line 5390
    .local v30, index:I
    if-ltz v30, :cond_93

    .line 5391
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move/from16 v1, v30

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 5394
    .local v5, r:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v4, v0

    if-ne v4, v5, :cond_5b

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v4

    if-eqz v4, :cond_5b

    .line 5395
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v4, v0

    const/16 v6, 0x10

    invoke-virtual {v4, v6}, Landroid/os/Handler;->removeMessages(I)V

    .line 5396
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/os/PowerManager$WakeLock;->release()V

    .line 5401
    :cond_5b
    const/4 v4, 0x1

    iput-boolean v4, v5, Lcom/android/server/am/HistoryRecord;->idle:Z

    .line 5402
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    .line 5403
    iget-boolean v4, v5, Lcom/android/server/am/HistoryRecord;->thumbnailNeeded:Z

    if-eqz v4, :cond_79

    iget-object v4, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v4, :cond_79

    iget-object v4, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v4, :cond_79

    .line 5404
    iget-object v4, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v0, v4

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object/from16 v33, v0

    .line 5405
    const/4 v4, 0x0

    iput-boolean v4, v5, Lcom/android/server/am/HistoryRecord;->thumbnailNeeded:Z

    .line 5411
    :cond_79
    const/4 v4, 0x0

    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v4

    move v2, v5

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V

    .line 5414
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    move v4, v0

    if-nez v4, :cond_93

    if-nez p2, :cond_93

    .line 5415
    const/4 v4, 0x1

    move v0, v4

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    .line 5416
    const/16 v26, 0x1

    .line 5421
    :cond_93
    const/4 v4, 0x1

    move-object/from16 v0, p0

    move v1, v4

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->processStoppingActivitiesLocked(Z)Ljava/util/ArrayList;

    move-result-object v34

    .line 5422
    if-eqz v34, :cond_120

    invoke-virtual/range {v34 .. v34}, Ljava/util/ArrayList;->size()I

    move-result v4

    move/from16 v22, v4

    .line 5423
    :goto_a3
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v20

    if-lez v20, :cond_c5

    .line 5424
    new-instance v28, Ljava/util/ArrayList;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    move-object v4, v0

    move-object/from16 v0, v28

    move-object v1, v4

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
    :try_end_bb
    .catchall {:try_start_15 .. :try_end_bb} :catchall_124

    .line 5425
    .end local v27           #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .local v28, finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :try_start_bb
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/ArrayList;->clear()V
    :try_end_c3
    .catchall {:try_start_bb .. :try_end_c3} :catchall_20b

    move-object/from16 v27, v28

    .line 5427
    .end local v28           #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v27       #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :cond_c5
    :try_start_c5
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v23

    if-lez v23, :cond_e7

    .line 5428
    new-instance v36, Ljava/util/ArrayList;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    move-object v4, v0

    move-object/from16 v0, v36

    move-object v1, v4

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V
    :try_end_dd
    .catchall {:try_start_c5 .. :try_end_dd} :catchall_124

    .line 5429
    .end local v35           #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .local v36, thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :try_start_dd
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mCancelledThumbnails:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/ArrayList;->clear()V
    :try_end_e5
    .catchall {:try_start_dd .. :try_end_e5} :catchall_210

    move-object/from16 v35, v36

    .line 5432
    .end local v36           #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v35       #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :cond_e7
    :try_start_e7
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    move/from16 v24, v0

    .line 5433
    const/4 v4, 0x0

    move v0, v4

    move-object/from16 v1, p0

    iput-boolean v0, v1, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    .line 5434
    monitor-exit p0
    :try_end_f4
    .catchall {:try_start_e7 .. :try_end_f4} :catchall_124

    .line 5439
    if-eqz v33, :cond_fd

    .line 5441
    :try_start_f6
    move-object/from16 v0, v33

    move-object/from16 v1, p1

    invoke-interface {v0, v1}, Landroid/app/IApplicationThread;->requestThumbnail(Landroid/os/IBinder;)V
    :try_end_fd
    .catch Ljava/lang/Exception; {:try_start_f6 .. :try_end_fd} :catch_127

    .line 5450
    :cond_fd
    :goto_fd
    const/16 v29, 0x0

    .local v29, i:I
    :goto_ff
    move/from16 v0, v29

    move/from16 v1, v22

    if-ge v0, v1, :cond_149

    .line 5451
    move-object/from16 v0, v34

    move/from16 v1, v29

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 5452
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    monitor-enter p0

    .line 5453
    :try_start_110
    iget-boolean v4, v5, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v4, :cond_13f

    .line 5454
    const/4 v4, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    move v2, v4

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->finishCurrentActivityLocked(Lcom/android/server/am/HistoryRecord;I)Lcom/android/server/am/HistoryRecord;

    .line 5458
    :goto_11c
    monitor-exit p0
    :try_end_11d
    .catchall {:try_start_110 .. :try_end_11d} :catchall_146

    .line 5450
    add-int/lit8 v29, v29, 0x1

    goto :goto_ff

    .line 5422
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    .end local v29           #i:I
    :cond_120
    const/4 v4, 0x0

    move/from16 v22, v4

    goto :goto_a3

    .line 5434
    .end local v30           #index:I
    :catchall_124
    move-exception v4

    :goto_125
    :try_start_125
    monitor-exit p0
    :try_end_126
    .catchall {:try_start_125 .. :try_end_126} :catchall_124

    throw v4

    .line 5442
    .restart local v30       #index:I
    :catch_127
    move-exception v25

    .line 5443
    .local v25, e:Ljava/lang/Exception;
    const-string v4, "ActivityManager"

    const-string v5, "Exception thrown when requesting thumbnail"

    move-object v0, v4

    move-object v1, v5

    move-object/from16 v2, v25

    invoke-static {v0, v1, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 5444
    const/4 v5, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x1

    move-object/from16 v4, p0

    move-object/from16 v6, p1

    invoke-virtual/range {v4 .. v9}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    goto :goto_fd

    .line 5456
    .end local v25           #e:Ljava/lang/Exception;
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    .restart local v29       #i:I
    :cond_13f
    :try_start_13f
    move-object/from16 v0, p0

    move-object v1, v5

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->stopActivityLocked(Lcom/android/server/am/HistoryRecord;)V

    goto :goto_11c

    .line 5458
    :catchall_146
    move-exception v4

    monitor-exit p0
    :try_end_148
    .catchall {:try_start_13f .. :try_end_148} :catchall_146

    throw v4

    .line 5463
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_149
    const/16 v29, 0x0

    :goto_14b
    move/from16 v0, v29

    move/from16 v1, v20

    if-ge v0, v1, :cond_16b

    .line 5464
    move-object/from16 v0, v27

    move/from16 v1, v29

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 5465
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    monitor-enter p0

    .line 5466
    const/4 v4, 0x1

    :try_start_15d
    move-object/from16 v0, p0

    move-object v1, v5

    move v2, v4

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    .line 5467
    monitor-exit p0

    .line 5463
    add-int/lit8 v29, v29, 0x1

    goto :goto_14b

    .line 5467
    :catchall_168
    move-exception v4

    monitor-exit p0
    :try_end_16a
    .catchall {:try_start_15d .. :try_end_16a} :catchall_168

    throw v4

    .line 5471
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_16b
    const/16 v29, 0x0

    :goto_16d
    move/from16 v0, v29

    move/from16 v1, v23

    if-ge v0, v1, :cond_189

    .line 5472
    move-object/from16 v0, v35

    move/from16 v1, v29

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 5473
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x1

    move-object/from16 v4, p0

    invoke-virtual/range {v4 .. v9}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    .line 5471
    add-int/lit8 v29, v29, 0x1

    goto :goto_16d

    .line 5476
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :cond_189
    if-eqz v24, :cond_1f6

    .line 5479
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v21

    .line 5480
    .local v21, NP:I
    if-lez v21, :cond_1c4

    .line 5481
    new-instance v32, Ljava/util/ArrayList;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v4, v0

    move-object/from16 v0, v32

    move-object v1, v4

    invoke-direct {v0, v1}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V

    .line 5483
    .local v32, procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    const/16 v31, 0x0

    .end local p1
    .local v31, ip:I
    :goto_1a5
    move/from16 v0, v31

    move/from16 v1, v21

    if-ge v0, v1, :cond_1c4

    .line 5484
    move-object/from16 v0, v32

    move/from16 v1, v31

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcom/android/server/am/ProcessRecord;

    const-string v4, "on-hold"

    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object v2, v4

    move-object v3, v5

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 5483
    add-int/lit8 v31, v31, 0x1

    goto :goto_1a5

    .line 5488
    .end local v31           #ip:I
    .end local v32           #procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :cond_1c4
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->onBootComplete()Z

    move-result v4

    if-nez v4, :cond_1f6

    .line 5490
    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v4, v0

    const/4 v5, 0x1

    if-eq v4, v5, :cond_1f6

    .line 5492
    monitor-enter p0

    .line 5493
    const/4 v7, 0x0

    const/4 v8, 0x0

    :try_start_1d5
    new-instance v9, Landroid/content/Intent;

    const-string v4, "android.intent.action.BOOT_COMPLETED"

    const/4 v5, 0x0

    invoke-direct {v9, v4, v5}, Landroid/content/Intent;-><init>(Ljava/lang/String;Landroid/net/Uri;)V

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const-string v15, "android.permission.RECEIVE_BOOT_COMPLETED"

    const/16 v16, 0x0

    const/16 v17, 0x0

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move/from16 v18, v0

    const/16 v19, 0x3e8

    move-object/from16 v6, p0

    invoke-direct/range {v6 .. v19}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 5498
    monitor-exit p0
    :try_end_1f6
    .catchall {:try_start_1d5 .. :try_end_1f6} :catchall_208

    .line 5505
    .end local v21           #NP:I
    :cond_1f6
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->trimApplications()V

    .line 5509
    if-eqz v26, :cond_207

    .line 5510
    const/16 v4, 0xbea

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v6

    invoke-static {v4, v6, v7}, Landroid/util/EventLog;->writeEvent(IJ)I

    .line 5512
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->enableScreenAfterBoot()V

    .line 5514
    :cond_207
    return-void

    .line 5498
    .restart local v21       #NP:I
    :catchall_208
    move-exception v4

    :try_start_209
    monitor-exit p0
    :try_end_20a
    .catchall {:try_start_209 .. :try_end_20a} :catchall_208

    throw v4

    .line 5434
    .end local v21           #NP:I
    .end local v27           #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .end local v29           #i:I
    .restart local v28       #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local p1
    :catchall_20b
    move-exception v4

    move-object/from16 v27, v28

    .end local v28           #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v27       #finishes:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    goto/16 :goto_125

    .end local v35           #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v36       #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :catchall_210
    move-exception v4

    move-object/from16 v35, v36

    .end local v36           #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    .restart local v35       #thumbnails:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    goto/16 :goto_125
.end method

.method public final activityPaused(Landroid/os/IBinder;Landroid/os/Bundle;)V
    .registers 7
    .parameter "token"
    .parameter "icicle"

    .prologue
    .line 5532
    if-eqz p2, :cond_10

    invoke-virtual {p2}, Landroid/os/Bundle;->hasFileDescriptors()Z

    move-result v2

    if-eqz v2, :cond_10

    .line 5533
    new-instance v2, Ljava/lang/IllegalArgumentException;

    const-string v3, "File descriptors passed in Bundle"

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 5536
    :cond_10
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 5537
    .local v0, origId:J
    const/4 v2, 0x0

    invoke-virtual {p0, p1, p2, v2}, Lcom/android/server/am/ActivityManagerService;->activityPaused(Landroid/os/IBinder;Landroid/os/Bundle;Z)V

    .line 5538
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5539
    return-void
.end method

.method final activityPaused(Landroid/os/IBinder;Landroid/os/Bundle;Z)V
    .registers 11
    .parameter "token"
    .parameter "icicle"
    .parameter "timeout"

    .prologue
    .line 5546
    const/4 v2, 0x0

    .line 5548
    .local v2, r:Lcom/android/server/am/HistoryRecord;
    monitor-enter p0

    .line 5549
    :try_start_2
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v1

    .line 5550
    .local v1, index:I
    if-ltz v1, :cond_2b

    .line 5551
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v3, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    move-object v0, v3

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    move-object v2, v0

    .line 5552
    if-nez p3, :cond_19

    .line 5553
    iput-object p2, v2, Lcom/android/server/am/HistoryRecord;->icicle:Landroid/os/Bundle;

    .line 5554
    const/4 v3, 0x1

    iput-boolean v3, v2, Lcom/android/server/am/HistoryRecord;->haveState:Z

    .line 5556
    :cond_19
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v4, 0x9

    invoke-virtual {v3, v4, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 5557
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v3, v2, :cond_2d

    .line 5558
    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v3, v2, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 5559
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->completePauseLocked()V

    .line 5567
    :cond_2b
    :goto_2b
    monitor-exit p0

    .line 5568
    return-void

    .line 5561
    :cond_2d
    const/16 v3, 0x753c

    const/4 v4, 0x3

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    invoke-static {v2}, Ljava/lang/System;->identityHashCode(Ljava/lang/Object;)I

    move-result v6

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    aput-object v6, v4, v5

    const/4 v5, 0x1

    iget-object v6, v2, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    aput-object v6, v4, v5

    const/4 v5, 0x2

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v6, :cond_54

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    iget-object v6, v6, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    :goto_4b
    aput-object v6, v4, v5

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    goto :goto_2b

    .line 5567
    .end local v1           #index:I
    :catchall_51
    move-exception v3

    monitor-exit p0
    :try_end_53
    .catchall {:try_start_2 .. :try_end_53} :catchall_51

    throw v3

    .line 5561
    .restart local v1       #index:I
    :cond_54
    :try_start_54
    const-string v6, "(none)"
    :try_end_56
    .catchall {:try_start_54 .. :try_end_56} :catchall_51

    goto :goto_4b
.end method

.method public final activityStopped(Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;)V
    .registers 14
    .parameter "token"
    .parameter "thumbnail"
    .parameter "description"

    .prologue
    const/4 v3, 0x0

    .line 5575
    const/4 v2, 0x0

    .line 5577
    .local v2, r:Lcom/android/server/am/HistoryRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v8

    .line 5579
    .local v8, origId:J
    monitor-enter p0

    .line 5580
    :try_start_7
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v7

    .line 5581
    .local v7, index:I
    if-ltz v7, :cond_32

    .line 5582
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v1, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    move-object v0, v4

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    move-object v2, v0

    .line 5583
    iput-object p2, v2, Lcom/android/server/am/HistoryRecord;->thumbnail:Landroid/graphics/Bitmap;

    .line 5584
    iput-object p3, v2, Lcom/android/server/am/HistoryRecord;->description:Ljava/lang/CharSequence;

    .line 5585
    const/4 v1, 0x1

    iput-boolean v1, v2, Lcom/android/server/am/HistoryRecord;->stopped:Z

    .line 5586
    sget-object v1, Lcom/android/server/am/ActivityManagerService$ActivityState;->STOPPED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    iput-object v1, v2, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    .line 5587
    iget-boolean v1, v2, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-nez v1, :cond_32

    .line 5588
    iget-boolean v1, v2, Lcom/android/server/am/HistoryRecord;->configDestroy:Z

    if-eqz v1, :cond_32

    .line 5589
    const/4 v1, 0x1

    invoke-direct {p0, v2, v1}, Lcom/android/server/am/ActivityManagerService;->destroyActivityLocked(Lcom/android/server/am/HistoryRecord;Z)Z

    .line 5590
    const/4 v1, 0x0

    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 5594
    :cond_32
    monitor-exit p0
    :try_end_33
    .catchall {:try_start_7 .. :try_end_33} :catchall_43

    .line 5596
    if-eqz v2, :cond_3c

    .line 5597
    const/4 v6, 0x0

    move-object v1, p0

    move-object v4, v3

    move-object v5, v3

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    .line 5600
    :cond_3c
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->trimApplications()V

    .line 5602
    invoke-static {v8, v9}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5603
    return-void

    .line 5594
    .end local v7           #index:I
    :catchall_43
    move-exception v1

    :try_start_44
    monitor-exit p0
    :try_end_45
    .catchall {:try_start_44 .. :try_end_45} :catchall_43

    throw v1
.end method

.method final addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;
    .registers 7
    .parameter "info"

    .prologue
    const/4 v3, 0x0

    const/4 v4, 0x1

    .line 7773
    iget-object v1, p1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v2, p1, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->getProcessRecordLocked(Ljava/lang/String;I)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 7775
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    if-nez v0, :cond_1c

    .line 7776
    invoke-virtual {p0, v3, p1, v3}, Lcom/android/server/am/ActivityManagerService;->newProcessRecordLocked(Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 7777
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    iget-object v2, p1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget v3, p1, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v1, v2, v3, v0}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 7778
    invoke-direct {p0, v0, v4}, Lcom/android/server/am/ActivityManagerService;->updateLRUListLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 7781
    :cond_1c
    iget v1, p1, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v1, v1, 0x9

    const/16 v2, 0x9

    if-ne v1, v2, :cond_2a

    .line 7783
    iput-boolean v4, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    .line 7784
    const/16 v1, -0xc

    iput v1, v0, Lcom/android/server/am/ProcessRecord;->maxAdj:I

    .line 7786
    :cond_2a
    iget-object v1, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v1, :cond_42

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->indexOf(Ljava/lang/Object;)I

    move-result v1

    if-gez v1, :cond_42

    .line 7787
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    invoke-virtual {v1, v0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 7788
    const-string v1, "added application"

    iget-object v2, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-direct {p0, v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;)V

    .line 7791
    :cond_42
    return-object v0
.end method

.method final addProcessToGcListLocked(Lcom/android/server/am/ProcessRecord;)V
    .registers 8
    .parameter "proc"

    .prologue
    .line 12845
    const/4 v0, 0x0

    .line 12846
    .local v0, added:Z
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v1, v2, v3

    .local v1, i:I
    :goto_a
    if-ltz v1, :cond_24

    .line 12847
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    iget-wide v2, v2, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    iget-wide v4, p1, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    cmp-long v2, v2, v4

    if-gez v2, :cond_2d

    .line 12849
    const/4 v0, 0x1

    .line 12850
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    add-int/lit8 v3, v1, 0x1

    invoke-virtual {v2, v3, p1}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 12854
    :cond_24
    if-nez v0, :cond_2c

    .line 12855
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    const/4 v3, 0x0

    invoke-virtual {v2, v3, p1}, Ljava/util/ArrayList;->add(ILjava/lang/Object;)V

    .line 12857
    :cond_2c
    return-void

    .line 12846
    :cond_2d
    add-int/lit8 v1, v1, -0x1

    goto :goto_a
.end method

.method final appNotRespondingLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;)V
    .registers 27
    .parameter "app"
    .parameter "activity"
    .parameter "reportedActivity"
    .parameter "annotation"

    .prologue
    .line 4550
    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    move v3, v0

    if-nez v3, :cond_e

    move-object/from16 v0, p1

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->crashing:Z

    move v3, v0

    if-eqz v3, :cond_f

    .line 4682
    :cond_e
    :goto_e
    return-void

    .line 4555
    :cond_f
    const/16 v3, 0x7538

    const/4 v4, 0x3

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v6, v0

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    aput-object v6, v4, v5

    const/4 v5, 0x1

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v6, v0

    aput-object v6, v4, v5

    const/4 v5, 0x2

    aput-object p4, v4, v5

    invoke-static {v3, v4}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 4559
    const-string v3, "1"

    const-string v4, "ro.secure"

    const-string v5, "0"

    invoke-static {v4, v5}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v15

    .line 4560
    .local v15, isSecure:Z
    if-eqz v15, :cond_58

    invoke-virtual/range {p1 .. p1}, Lcom/android/server/am/ProcessRecord;->isInterestingToUserLocked()Z

    move-result v3

    if-nez v3, :cond_58

    invoke-static {}, Landroid/os/Process;->myPid()I

    move-result v3

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    if-eq v3, v4, :cond_58

    .line 4561
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v3, v0

    invoke-static {v3}, Landroid/os/Process;->killProcess(I)V

    goto :goto_e

    .line 4567
    :cond_58
    const/16 v19, 0x0

    .line 4569
    .local v19, processInfo:Ljava/lang/String;
    invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->updateCpuStatsNow()V

    .line 4570
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    move-object v3, v0

    monitor-enter v3

    .line 4571
    :try_start_63
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object v4, v0

    invoke-virtual {v4}, Lcom/android/server/ProcessStats;->printCurrentState()Ljava/lang/String;

    move-result-object v19

    .line 4572
    monitor-exit v3
    :try_end_6d
    .catchall {:try_start_63 .. :try_end_6d} :catchall_172

    .line 4575
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStringBuilder:Ljava/lang/StringBuilder;

    move-object v14, v0

    .line 4576
    .local v14, info:Ljava/lang/StringBuilder;
    const/4 v3, 0x0

    invoke-virtual {v14, v3}, Ljava/lang/StringBuilder;->setLength(I)V

    .line 4577
    const-string v3, "ANR in process: "

    invoke-virtual {v14, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4578
    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v3, v0

    invoke-virtual {v14, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4579
    if-eqz p3, :cond_a0

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v3, v0

    if-eqz v3, :cond_a0

    .line 4580
    const-string v3, " (last in "

    invoke-virtual {v14, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4581
    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v3, v0

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v14, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4582
    const-string v3, ")"

    invoke-virtual {v14, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4584
    :cond_a0
    if-eqz p4, :cond_ad

    .line 4585
    const-string v3, "\nAnnotation: "

    invoke-virtual {v14, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4586
    move-object v0, v14

    move-object/from16 v1, p4

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4589
    :cond_ad
    const-string v3, "\nCPU usage:\n"

    invoke-virtual {v14, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4590
    move-object v0, v14

    move-object/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4592
    const-string v3, "ActivityManager"

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 4595
    const/4 v3, 0x1

    invoke-static {v3}, Lcom/android/server/am/ActivityManagerService;->prepareTraceFile(Z)Z

    move-result v11

    .line 4596
    .local v11, fileDump:Z
    if-nez v11, :cond_175

    .line 4599
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v3, v0

    const/4 v4, 0x3

    invoke-static {v3, v4}, Landroid/os/Process;->sendSignal(II)V

    .line 4646
    :goto_d1
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v3, v0

    if-eqz v3, :cond_10d

    .line 4648
    :try_start_d8
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v3, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v4, v0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v5, v0

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-interface {v3, v4, v5, v6}, Landroid/app/IActivityController;->appNotResponding(Ljava/lang/String;ILjava/lang/String;)I
    :try_end_ee
    .catch Landroid/os/RemoteException; {:try_start_d8 .. :try_end_ee} :catch_105

    move-result v21

    .line 4650
    .local v21, res:I
    if-eqz v21, :cond_10d

    .line 4651
    if-gez v21, :cond_10d

    .line 4655
    const-wide/16 v3, 0x7d0

    :try_start_f5
    move-object/from16 v0, p0

    move-wide v1, v3

    invoke-virtual {v0, v1, v2}, Ljava/lang/Object;->wait(J)V
    :try_end_fb
    .catch Ljava/lang/InterruptedException; {:try_start_f5 .. :try_end_fb} :catch_23b
    .catch Landroid/os/RemoteException; {:try_start_f5 .. :try_end_fb} :catch_105

    .line 4659
    :goto_fb
    :try_start_fb
    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v3, v0

    invoke-static {v3}, Landroid/os/Process;->killProcess(I)V
    :try_end_103
    .catch Landroid/os/RemoteException; {:try_start_fb .. :try_end_103} :catch_105

    goto/16 :goto_e

    .line 4663
    .end local v21           #res:I
    :catch_105
    move-exception v3

    move-object v10, v3

    .line 4664
    .local v10, e:Landroid/os/RemoteException;
    const/4 v3, 0x0

    move-object v0, v3

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    .line 4668
    .end local v10           #e:Landroid/os/RemoteException;
    :cond_10d
    if-eqz p2, :cond_22e

    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->shortComponentName:Ljava/lang/String;

    move-object v3, v0

    move-object v5, v3

    :goto_115
    if-eqz p4, :cond_232

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "ANR "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p4

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object v6, v3

    :goto_12e
    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    const/4 v8, 0x0

    move-object/from16 v3, p0

    move-object/from16 v4, p1

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->makeAppNotRespondingLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[B)V

    .line 4672
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v18

    .line 4673
    .local v18, msg:Landroid/os/Message;
    new-instance v17, Ljava/util/HashMap;

    invoke-direct/range {v17 .. v17}, Ljava/util/HashMap;-><init>()V

    .line 4674
    .local v17, map:Ljava/util/HashMap;
    const/4 v3, 0x2

    move v0, v3

    move-object/from16 v1, v18

    iput v0, v1, Landroid/os/Message;->what:I

    .line 4675
    move-object/from16 v0, v17

    move-object/from16 v1, v18

    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 4676
    const-string v3, "app"

    move-object/from16 v0, v17

    move-object v1, v3

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 4677
    if-eqz p2, :cond_165

    .line 4678
    const-string v3, "activity"

    move-object/from16 v0, v17

    move-object v1, v3

    move-object/from16 v2, p2

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 4681
    :cond_165
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v3, v0

    move-object v0, v3

    move-object/from16 v1, v18

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    goto/16 :goto_e

    .line 4572
    .end local v11           #fileDump:Z
    .end local v14           #info:Ljava/lang/StringBuilder;
    .end local v17           #map:Ljava/util/HashMap;
    .end local v18           #msg:Landroid/os/Message;
    :catchall_172
    move-exception v4

    :try_start_173
    monitor-exit v3
    :try_end_174
    .catchall {:try_start_173 .. :try_end_174} :catchall_172

    throw v4

    .line 4602
    .restart local v11       #fileDump:Z
    .restart local v14       #info:Ljava/lang/StringBuilder;
    :cond_175
    monitor-enter p0

    .line 4604
    const/4 v3, 0x3

    :try_start_177
    new-array v13, v3, [I

    .line 4605
    .local v13, imppids:[I
    const/4 v12, 0x0

    .line 4606
    .local v12, i:I
    const/4 v3, 0x0

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    aput v4, v13, v3

    .line 4607
    add-int/lit8 v12, v12, 0x1

    .line 4608
    if-eqz p3, :cond_1af

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v3, v0

    if-eqz v3, :cond_1af

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v3, v0

    iget-object v3, v3, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v3, :cond_1af

    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v3, v0

    iget v3, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    move-object/from16 v0, p1

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    if-eq v3, v4, :cond_1af

    .line 4611
    move-object/from16 v0, p3

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v3, v0

    iget v3, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    aput v3, v13, v12

    .line 4612
    add-int/lit8 v12, v12, 0x1

    .line 4614
    :cond_1af
    invoke-static {}, Landroid/os/Process;->myPid()I

    move-result v3

    aput v3, v13, v12

    .line 4615
    const/4 v12, 0x0

    :goto_1b6
    array-length v3, v13

    if-ge v12, v3, :cond_1d6

    aget v3, v13, v12

    if-eqz v3, :cond_1d6

    .line 4616
    aget v3, v13, v12

    const/4 v4, 0x3

    invoke-static {v3, v4}, Landroid/os/Process;->sendSignal(II)V

    .line 4617
    monitor-enter p0
    :try_end_1c4
    .catchall {:try_start_177 .. :try_end_1c4} :catchall_1d3

    .line 4619
    const-wide/16 v3, 0xc8

    :try_start_1c6
    move-object/from16 v0, p0

    move-wide v1, v3

    invoke-virtual {v0, v1, v2}, Ljava/lang/Object;->wait(J)V
    :try_end_1cc
    .catchall {:try_start_1c6 .. :try_end_1cc} :catchall_1d0
    .catch Ljava/lang/InterruptedException; {:try_start_1c6 .. :try_end_1cc} :catch_237

    .line 4622
    :goto_1cc
    :try_start_1cc
    monitor-exit p0

    .line 4615
    add-int/lit8 v12, v12, 0x1

    goto :goto_1b6

    .line 4622
    :catchall_1d0
    move-exception v3

    monitor-exit p0
    :try_end_1d2
    .catchall {:try_start_1cc .. :try_end_1d2} :catchall_1d0

    :try_start_1d2
    throw v3

    .line 4643
    .end local v12           #i:I
    .end local v13           #imppids:[I
    :catchall_1d3
    move-exception v3

    monitor-exit p0
    :try_end_1d5
    .catchall {:try_start_1d2 .. :try_end_1d5} :catchall_1d3

    throw v3

    .line 4624
    .restart local v12       #i:I
    .restart local v13       #imppids:[I
    :cond_1d6
    :try_start_1d6
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v3

    const/4 v4, 0x1

    sub-int v12, v3, v4

    :goto_1e2
    if-ltz v12, :cond_22b

    .line 4625
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    move-object v3, v0

    invoke-virtual {v3, v12}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v20

    check-cast v20, Lcom/android/server/am/ProcessRecord;

    .line 4626
    .local v20, r:Lcom/android/server/am/ProcessRecord;
    const/4 v9, 0x0

    .line 4627
    .local v9, done:Z
    const/16 v16, 0x0

    .local v16, j:I
    :goto_1f2
    array-length v3, v13

    move/from16 v0, v16

    move v1, v3

    if-ge v0, v1, :cond_206

    aget v3, v13, v16

    if-eqz v3, :cond_206

    .line 4628
    aget v3, v13, v16

    move-object/from16 v0, v20

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    if-ne v3, v4, :cond_225

    .line 4629
    const/4 v9, 0x1

    .line 4633
    :cond_206
    if-nez v9, :cond_222

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v3, v0

    if-eqz v3, :cond_222

    .line 4634
    move-object/from16 v0, v20

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v3, v0

    const/4 v4, 0x3

    invoke-static {v3, v4}, Landroid/os/Process;->sendSignal(II)V

    .line 4635
    monitor-enter p0
    :try_end_219
    .catchall {:try_start_1d6 .. :try_end_219} :catchall_1d3

    .line 4637
    const-wide/16 v3, 0xc8

    :try_start_21b
    move-object/from16 v0, p0

    move-wide v1, v3

    invoke-virtual {v0, v1, v2}, Ljava/lang/Object;->wait(J)V
    :try_end_221
    .catchall {:try_start_21b .. :try_end_221} :catchall_228
    .catch Ljava/lang/InterruptedException; {:try_start_21b .. :try_end_221} :catch_239

    .line 4640
    :goto_221
    :try_start_221
    monitor-exit p0

    .line 4624
    :cond_222
    add-int/lit8 v12, v12, -0x1

    goto :goto_1e2

    .line 4627
    :cond_225
    add-int/lit8 v16, v16, 0x1

    goto :goto_1f2

    .line 4640
    :catchall_228
    move-exception v3

    monitor-exit p0
    :try_end_22a
    .catchall {:try_start_221 .. :try_end_22a} :catchall_228

    :try_start_22a
    throw v3

    .line 4643
    .end local v9           #done:Z
    .end local v16           #j:I
    .end local v20           #r:Lcom/android/server/am/ProcessRecord;
    :cond_22b
    monitor-exit p0
    :try_end_22c
    .catchall {:try_start_22a .. :try_end_22c} :catchall_1d3

    goto/16 :goto_d1

    .line 4668
    .end local v12           #i:I
    .end local v13           #imppids:[I
    :cond_22e
    const/4 v3, 0x0

    move-object v5, v3

    goto/16 :goto_115

    :cond_232
    const-string v3, "ANR"

    move-object v6, v3

    goto/16 :goto_12e

    .line 4620
    .restart local v12       #i:I
    .restart local v13       #imppids:[I
    :catch_237
    move-exception v3

    goto :goto_1cc

    .line 4638
    .restart local v9       #done:Z
    .restart local v16       #j:I
    .restart local v20       #r:Lcom/android/server/am/ProcessRecord;
    :catch_239
    move-exception v3

    goto :goto_221

    .line 4656
    .end local v9           #done:Z
    .end local v12           #i:I
    .end local v13           #imppids:[I
    .end local v16           #j:I
    .end local v20           #r:Lcom/android/server/am/ProcessRecord;
    .restart local v21       #res:I
    :catch_23b
    move-exception v3

    goto/16 :goto_fb
.end method

.method public final attachApplication(Landroid/app/IApplicationThread;)V
    .registers 6
    .parameter "thread"

    .prologue
    .line 5309
    monitor-enter p0

    .line 5310
    :try_start_1
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v0

    .line 5311
    .local v0, callingPid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 5312
    .local v1, origId:J
    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->attachApplicationLocked(Landroid/app/IApplicationThread;I)Z

    .line 5313
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 5314
    monitor-exit p0

    .line 5315
    return-void

    .line 5314
    .end local v0           #callingPid:I
    .end local v1           #origId:J
    :catchall_11
    move-exception v3

    monitor-exit p0
    :try_end_13
    .catchall {:try_start_1 .. :try_end_13} :catchall_11

    throw v3
.end method

.method public backupAgentCreated(Ljava/lang/String;Landroid/os/IBinder;)V
    .registers 10
    .parameter "agentPackageName"
    .parameter "agent"

    .prologue
    const-string v6, "ActivityManager"

    .line 10961
    const-string v4, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "backupAgentCreated: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " = "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v6, v4}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 10964
    monitor-enter p0

    .line 10965
    :try_start_25
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    invoke-virtual {p1, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_4d

    .line 10966
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Backup agent created for "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " but not requested!"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 10967
    monitor-exit p0

    .line 10984
    :goto_4c
    return-void

    .line 10970
    :cond_4d
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
    :try_end_50
    .catchall {:try_start_25 .. :try_end_50} :catchall_63

    move-result-wide v2

    .line 10972
    .local v2, oldIdent:J
    :try_start_51
    const-string v4, "backup"

    invoke-static {v4}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v4

    invoke-static {v4}, Landroid/backup/IBackupManager$Stub;->asInterface(Landroid/os/IBinder;)Landroid/backup/IBackupManager;

    move-result-object v0

    .line 10974
    .local v0, bm:Landroid/backup/IBackupManager;
    invoke-interface {v0, p1, p2}, Landroid/backup/IBackupManager;->agentConnected(Ljava/lang/String;Landroid/os/IBinder;)V
    :try_end_5e
    .catchall {:try_start_51 .. :try_end_5e} :catchall_76
    .catch Landroid/os/RemoteException; {:try_start_51 .. :try_end_5e} :catch_7b
    .catch Ljava/lang/Exception; {:try_start_51 .. :try_end_5e} :catch_66

    .line 10981
    :try_start_5e
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 10983
    .end local v0           #bm:Landroid/backup/IBackupManager;
    :goto_61
    monitor-exit p0

    goto :goto_4c

    .end local v2           #oldIdent:J
    :catchall_63
    move-exception v4

    monitor-exit p0
    :try_end_65
    .catchall {:try_start_5e .. :try_end_65} :catchall_63

    throw v4

    .line 10977
    .restart local v2       #oldIdent:J
    :catch_66
    move-exception v4

    move-object v1, v4

    .line 10978
    .local v1, e:Ljava/lang/Exception;
    :try_start_68
    const-string v4, "ActivityManager"

    const-string v5, "Exception trying to deliver BackupAgent binding: "

    invoke-static {v4, v5}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10979
    invoke-virtual {v1}, Ljava/lang/Exception;->printStackTrace()V
    :try_end_72
    .catchall {:try_start_68 .. :try_end_72} :catchall_76

    .line 10981
    :try_start_72
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    goto :goto_61

    .end local v1           #e:Ljava/lang/Exception;
    :catchall_76
    move-exception v4

    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v4

    .line 10975
    :catch_7b
    move-exception v4

    .line 10981
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V
    :try_end_7f
    .catchall {:try_start_72 .. :try_end_7f} :catchall_63

    goto :goto_61
.end method

.method public bindBackupAgent(Landroid/content/pm/ApplicationInfo;I)Z
    .registers 15
    .parameter "app"
    .parameter "backupMode"

    .prologue
    const/4 v11, 0x0

    const-string v2, "ActivityManager"

    .line 10909
    const-string v0, "ActivityManager"

    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    const-string v1, "startBackupAgent: app="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v0

    const-string v1, " mode="

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v2, v0}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 10910
    const-string v0, "android.permission.BACKUP"

    const-string v1, "startBackupAgent"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 10912
    monitor-enter p0

    .line 10914
    const/4 v9, 0x0

    .line 10915
    .local v9, ss:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;
    :try_start_2e
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v0}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v10

    .line 10916
    .local v10, stats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v10
    :try_end_35
    .catchall {:try_start_2e .. :try_end_35} :catchall_7a

    .line 10917
    :try_start_35
    iget v0, p1, Landroid/content/pm/ApplicationInfo;->uid:I

    iget-object v1, p1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v2, p1, Landroid/content/pm/ApplicationInfo;->name:Ljava/lang/String;

    invoke-virtual {v10, v0, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl;->getServiceStatsLocked(ILjava/lang/String;Ljava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    move-result-object v9

    .line 10918
    monitor-exit v10
    :try_end_40
    .catchall {:try_start_35 .. :try_end_40} :catchall_77

    .line 10920
    :try_start_40
    new-instance v8, Lcom/android/server/am/BackupRecord;

    invoke-direct {v8, v9, p1, p2}, Lcom/android/server/am/BackupRecord;-><init>(Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;Landroid/content/pm/ApplicationInfo;I)V

    .line 10921
    .local v8, r:Lcom/android/server/am/BackupRecord;
    new-instance v6, Landroid/content/ComponentName;

    iget-object v0, p1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v1, p1, Landroid/content/pm/ApplicationInfo;->backupAgentName:Ljava/lang/String;

    invoke-direct {v6, v0, v1}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    .line 10923
    .local v6, hostingName:Landroid/content/ComponentName;
    iget-object v1, p1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "backup"

    move-object v0, p0

    move-object v2, p1

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->startProcessLocked(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;ZILjava/lang/String;Landroid/content/ComponentName;)Lcom/android/server/am/ProcessRecord;

    move-result-object v7

    .line 10925
    .local v7, proc:Lcom/android/server/am/ProcessRecord;
    if-nez v7, :cond_7d

    .line 10926
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unable to start backup agent process "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 10927
    monitor-exit p0
    :try_end_75
    .catchall {:try_start_40 .. :try_end_75} :catchall_7a

    move v0, v11

    .line 10956
    :goto_76
    return v0

    .line 10918
    .end local v6           #hostingName:Landroid/content/ComponentName;
    .end local v7           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v8           #r:Lcom/android/server/am/BackupRecord;
    :catchall_77
    move-exception v0

    :try_start_78
    monitor-exit v10
    :try_end_79
    .catchall {:try_start_78 .. :try_end_79} :catchall_77

    :try_start_79
    throw v0

    .line 10954
    .end local v10           #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :catchall_7a
    move-exception v0

    monitor-exit p0
    :try_end_7c
    .catchall {:try_start_79 .. :try_end_7c} :catchall_7a

    throw v0

    .line 10930
    .restart local v6       #hostingName:Landroid/content/ComponentName;
    .restart local v7       #proc:Lcom/android/server/am/ProcessRecord;
    .restart local v8       #r:Lcom/android/server/am/BackupRecord;
    .restart local v10       #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :cond_7d
    :try_start_7d
    iput-object v7, v8, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 10931
    iput-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    .line 10932
    iget-object v0, p1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iput-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    .line 10935
    invoke-direct {p0, v7}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 10939
    iget-object v0, v7, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_ac

    .line 10940
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Agent proc already running: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_a4
    .catchall {:try_start_7d .. :try_end_a4} :catchall_7a

    .line 10942
    :try_start_a4
    iget-object v0, v7, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0, p1, p2}, Landroid/app/IApplicationThread;->scheduleCreateBackupAgent(Landroid/content/pm/ApplicationInfo;I)V
    :try_end_a9
    .catchall {:try_start_a4 .. :try_end_a9} :catchall_7a
    .catch Landroid/os/RemoteException; {:try_start_a4 .. :try_end_a9} :catch_b4

    .line 10954
    :goto_a9
    :try_start_a9
    monitor-exit p0

    .line 10956
    const/4 v0, 0x1

    goto :goto_76

    .line 10948
    :cond_ac
    const-string v0, "ActivityManager"

    const-string v1, "Agent proc not running, waiting for attach"

    invoke-static {v0, v1}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_b3
    .catchall {:try_start_a9 .. :try_end_b3} :catchall_7a

    goto :goto_a9

    .line 10943
    :catch_b4
    move-exception v0

    goto :goto_a9
.end method

.method public bindService(Landroid/app/IApplicationThread;Landroid/os/IBinder;Landroid/content/Intent;Ljava/lang/String;Landroid/app/IServiceConnection;I)I
    .registers 26
    .parameter "caller"
    .parameter "token"
    .parameter "service"
    .parameter "resolvedType"
    .parameter "connection"
    .parameter "flags"

    .prologue
    .line 10557
    if-eqz p3, :cond_16

    invoke-virtual/range {p3 .. p3}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v16

    const/16 v17, 0x1

    move/from16 v0, v16

    move/from16 v1, v17

    if-ne v0, v1, :cond_16

    .line 10558
    new-instance v16, Ljava/lang/IllegalArgumentException;

    const-string v17, "File descriptors passed in Intent"

    invoke-direct/range {v16 .. v17}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v16

    .line 10561
    :cond_16
    monitor-enter p0

    .line 10565
    :try_start_17
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v10

    .line 10566
    .local v10, callerApp:Lcom/android/server/am/ProcessRecord;
    if-nez v10, :cond_59

    .line 10567
    new-instance v16, Ljava/lang/SecurityException;

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "Unable to find app for caller "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, " (pid="

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v18

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, ") when binding service "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-direct/range {v16 .. v17}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v16

    .line 10656
    .end local v10           #callerApp:Lcom/android/server/am/ProcessRecord;
    :catchall_56
    move-exception v16

    monitor-exit p0
    :try_end_58
    .catchall {:try_start_17 .. :try_end_58} :catchall_56

    throw v16

    .line 10573
    .restart local v10       #callerApp:Lcom/android/server/am/ProcessRecord;
    :cond_59
    const/4 v5, 0x0

    .line 10574
    .local v5, activity:Lcom/android/server/am/HistoryRecord;
    if-eqz p2, :cond_95

    .line 10575
    :try_start_5c
    move-object/from16 v0, p0

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v6

    .line 10576
    .local v6, aindex:I
    if-gez v6, :cond_86

    .line 10577
    const-string v16, "ActivityManager"

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "Binding with unknown activity: "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-static/range {v16 .. v17}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10578
    const/16 v16, 0x0

    monitor-exit p0

    .line 10658
    .end local v6           #aindex:I
    :goto_85
    return v16

    .line 10580
    .restart local v6       #aindex:I
    :cond_86
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move v1, v6

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #activity:Lcom/android/server/am/HistoryRecord;
    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 10583
    .end local v6           #aindex:I
    .restart local v5       #activity:Lcom/android/server/am/HistoryRecord;
    :cond_95
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v16

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v17

    move-object/from16 v0, p0

    move-object/from16 v1, p3

    move-object/from16 v2, p4

    move/from16 v3, v16

    move/from16 v4, v17

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->retrieveServiceLocked(Landroid/content/Intent;Ljava/lang/String;II)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    move-result-object v14

    .line 10586
    .local v14, res:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    if-nez v14, :cond_b1

    .line 10587
    const/16 v16, 0x0

    monitor-exit p0

    goto :goto_85

    .line 10589
    :cond_b1
    move-object v0, v14

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    move-object/from16 v16, v0

    if-nez v16, :cond_bc

    .line 10590
    const/16 v16, -0x1

    monitor-exit p0

    goto :goto_85

    .line 10592
    :cond_bc
    iget-object v15, v14, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    .line 10594
    .local v15, s:Lcom/android/server/am/ServiceRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v12

    .line 10596
    .local v12, origId:J
    move-object/from16 v0, p0

    move-object v1, v15

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->unscheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)Z

    move-result v16

    if-eqz v16, :cond_cb

    .line 10601
    :cond_cb
    move-object v0, v15

    move-object/from16 v1, p3

    move-object v2, v10

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ServiceRecord;->retrieveAppBindingLocked(Landroid/content/Intent;Lcom/android/server/am/ProcessRecord;)Lcom/android/server/am/AppBindRecord;

    move-result-object v7

    .line 10602
    .local v7, b:Lcom/android/server/am/AppBindRecord;
    new-instance v9, Lcom/android/server/am/ConnectionRecord;

    move-object v0, v9

    move-object v1, v7

    move-object v2, v5

    move-object/from16 v3, p5

    move/from16 v4, p6

    invoke-direct {v0, v1, v2, v3, v4}, Lcom/android/server/am/ConnectionRecord;-><init>(Lcom/android/server/am/AppBindRecord;Lcom/android/server/am/HistoryRecord;Landroid/app/IServiceConnection;I)V

    .line 10605
    .local v9, c:Lcom/android/server/am/ConnectionRecord;
    invoke-interface/range {p5 .. p5}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v8

    .line 10606
    .local v8, binder:Landroid/os/IBinder;
    move-object v0, v15

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object v1, v8

    move-object v2, v9

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 10607
    move-object v0, v7

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->connections:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object v1, v9

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 10608
    if-eqz v5, :cond_118

    .line 10609
    move-object v0, v5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    move-object/from16 v16, v0

    if-nez v16, :cond_10d

    .line 10610
    new-instance v16, Ljava/util/HashSet;

    invoke-direct/range {v16 .. v16}, Ljava/util/HashSet;-><init>()V

    move-object/from16 v0, v16

    move-object v1, v5

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    .line 10612
    :cond_10d
    move-object v0, v5

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->connections:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object v1, v9

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 10614
    :cond_118
    move-object v0, v7

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->connections:Ljava/util/HashSet;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object v1, v9

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 10615
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    move-object v1, v8

    move-object v2, v9

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 10617
    and-int/lit8 v16, p6, 0x1

    if-eqz v16, :cond_15b

    .line 10618
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v16

    move-wide/from16 v0, v16

    move-object v2, v15

    iput-wide v0, v2, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    .line 10619
    invoke-virtual/range {p3 .. p3}, Landroid/content/Intent;->getFlags()I

    move-result v16

    const/16 v17, 0x0

    move-object/from16 v0, p0

    move-object v1, v15

    move/from16 v2, v16

    move/from16 v3, v17

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->bringUpServiceLocked(Lcom/android/server/am/ServiceRecord;IZ)Z

    move-result v16

    if-nez v16, :cond_15b

    .line 10620
    const/16 v16, 0x0

    monitor-exit p0

    goto/16 :goto_85

    .line 10624
    :cond_15b
    move-object v0, v15

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v16, v0

    if-eqz v16, :cond_16e

    .line 10626
    move-object v0, v15

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v16, v0

    move-object/from16 v0, p0

    move-object/from16 v1, v16

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 10634
    :cond_16e
    move-object v0, v15

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v16, v0

    if-eqz v16, :cond_232

    move-object v0, v7

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    iget-boolean v0, v0, Lcom/android/server/am/IntentBindRecord;->received:Z

    move/from16 v16, v0
    :try_end_180
    .catchall {:try_start_5c .. :try_end_180} :catchall_56

    if-eqz v16, :cond_232

    .line 10638
    :try_start_182
    move-object v0, v9

    iget-object v0, v0, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    move-object/from16 v16, v0

    move-object v0, v15

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    move-object/from16 v17, v0

    move-object v0, v7

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    move-object/from16 v18, v0

    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/IntentBindRecord;->binder:Landroid/os/IBinder;

    move-object/from16 v18, v0

    invoke-interface/range {v16 .. v18}, Landroid/app/IServiceConnection;->connected(Landroid/content/ComponentName;Landroid/os/IBinder;)V
    :try_end_19a
    .catchall {:try_start_182 .. :try_end_19a} :catchall_56
    .catch Ljava/lang/Exception; {:try_start_182 .. :try_end_19a} :catch_1d7

    .line 10648
    :goto_19a
    :try_start_19a
    move-object v0, v7

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    move-object/from16 v16, v0

    invoke-virtual/range {v16 .. v16}, Ljava/util/HashMap;->size()I

    move-result v16

    const/16 v17, 0x1

    move/from16 v0, v16

    move/from16 v1, v17

    if-ne v0, v1, :cond_1cf

    move-object v0, v7

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    iget-boolean v0, v0, Lcom/android/server/am/IntentBindRecord;->doRebind:Z

    move/from16 v16, v0

    if-eqz v16, :cond_1cf

    .line 10649
    move-object v0, v7

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    move-object/from16 v16, v0

    const/16 v17, 0x1

    move-object/from16 v0, p0

    move-object v1, v15

    move-object/from16 v2, v16

    move/from16 v3, v17

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z

    .line 10655
    :cond_1cf
    :goto_1cf
    invoke-static {v12, v13}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 10656
    monitor-exit p0

    .line 10658
    const/16 v16, 0x1

    goto/16 :goto_85

    .line 10639
    :catch_1d7
    move-exception v16

    move-object/from16 v11, v16

    .line 10640
    .local v11, e:Ljava/lang/Exception;
    const-string v16, "ActivityManager"

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "Failure sending service "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v15

    iget-object v0, v0, Lcom/android/server/am/ServiceRecord;->shortName:Ljava/lang/String;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, " to connection "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v9

    iget-object v0, v0, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    move-object/from16 v18, v0

    invoke-interface/range {v18 .. v18}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v18

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, " (in "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object v0, v9

    iget-object v0, v0, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    move-object/from16 v18, v0

    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    move-object/from16 v18, v0

    move-object/from16 v0, v18

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object/from16 v18, v0

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, ")"

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    move-object/from16 v0, v16

    move-object/from16 v1, v17

    move-object v2, v11

    invoke-static {v0, v1, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_19a

    .line 10651
    .end local v11           #e:Ljava/lang/Exception;
    :cond_232
    move-object v0, v7

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    move-object/from16 v16, v0

    move-object/from16 v0, v16

    iget-boolean v0, v0, Lcom/android/server/am/IntentBindRecord;->requested:Z

    move/from16 v16, v0

    if-nez v16, :cond_1cf

    .line 10652
    move-object v0, v7

    iget-object v0, v0, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    move-object/from16 v16, v0

    const/16 v17, 0x0

    move-object/from16 v0, p0

    move-object v1, v15

    move-object/from16 v2, v16

    move/from16 v3, v17

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z
    :try_end_250
    .catchall {:try_start_19a .. :try_end_250} :catchall_56

    goto/16 :goto_1cf
.end method

.method public final broadcastIntent(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZ)I
    .registers 32
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "resultTo"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "map"
    .parameter "requiredPermission"
    .parameter "serialized"
    .parameter "sticky"

    .prologue
    .line 11456
    if-eqz p2, :cond_11

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v2

    const/4 v3, 0x1

    if-ne v2, v3, :cond_11

    .line 11457
    new-instance v2, Ljava/lang/IllegalArgumentException;

    const-string v3, "File descriptors passed in Intent"

    invoke-direct {v2, v3}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 11460
    :cond_11
    monitor-enter p0

    .line 11461
    :try_start_12
    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    move v2, v0

    if-nez v2, :cond_36

    .line 11464
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getFlags()I

    move-result v16

    .line 11465
    .local v16, flags:I
    const/high16 v2, 0x2000

    and-int v2, v2, v16

    if-eqz v2, :cond_6a

    .line 11466
    new-instance v17, Landroid/content/Intent;

    move-object/from16 v0, v17

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V
    :try_end_2c
    .catchall {:try_start_12 .. :try_end_2c} :catchall_99

    .line 11467
    .end local p2
    .local v17, intent:Landroid/content/Intent;
    const/high16 v2, 0x4000

    :try_start_2e
    move-object/from16 v0, v17

    move v1, v2

    invoke-virtual {v0, v1}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;
    :try_end_34
    .catchall {:try_start_2e .. :try_end_34} :catchall_9f

    move-object/from16 p2, v17

    .line 11475
    .end local v16           #flags:I
    .end local v17           #intent:Landroid/content/Intent;
    .restart local p2
    :cond_36
    :try_start_36
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v3

    .line 11476
    .local v3, callerApp:Lcom/android/server/am/ProcessRecord;
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v14

    .line 11477
    .local v14, callingPid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v15

    .line 11478
    .local v15, callingUid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v18

    .line 11479
    .local v18, origId:J
    if-eqz v3, :cond_9c

    iget-object v2, v3, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    move-object v4, v2

    :goto_4d
    move-object/from16 v2, p0

    move-object/from16 v5, p2

    move-object/from16 v6, p3

    move-object/from16 v7, p4

    move/from16 v8, p5

    move-object/from16 v9, p6

    move-object/from16 v10, p7

    move-object/from16 v11, p8

    move/from16 v12, p9

    move/from16 v13, p10

    invoke-direct/range {v2 .. v15}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    move-result v20

    .line 11484
    .local v20, res:I
    invoke-static/range {v18 .. v19}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11485
    monitor-exit p0

    return v20

    .line 11468
    .end local v3           #callerApp:Lcom/android/server/am/ProcessRecord;
    .end local v14           #callingPid:I
    .end local v15           #callingUid:I
    .end local v18           #origId:J
    .end local v20           #res:I
    .restart local v16       #flags:I
    :cond_6a
    const/high16 v2, 0x4000

    and-int v2, v2, v16

    if-nez v2, :cond_36

    .line 11469
    const-string v2, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Attempt to launch receivers of broadcast intent "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object v0, v3

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " before boot completion"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 11471
    new-instance v2, Ljava/lang/IllegalStateException;

    const-string v3, "Cannot broadcast before boot completed"

    invoke-direct {v2, v3}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 11486
    .end local v16           #flags:I
    :catchall_99
    move-exception v2

    :goto_9a
    monitor-exit p0
    :try_end_9b
    .catchall {:try_start_36 .. :try_end_9b} :catchall_99

    throw v2

    .line 11479
    .restart local v3       #callerApp:Lcom/android/server/am/ProcessRecord;
    .restart local v14       #callingPid:I
    .restart local v15       #callingUid:I
    .restart local v18       #origId:J
    :cond_9c
    const/4 v2, 0x0

    move-object v4, v2

    goto :goto_4d

    .line 11486
    .end local v3           #callerApp:Lcom/android/server/am/ProcessRecord;
    .end local v14           #callingPid:I
    .end local v15           #callingUid:I
    .end local v18           #origId:J
    .end local p2
    .restart local v16       #flags:I
    .restart local v17       #intent:Landroid/content/Intent;
    :catchall_9f
    move-exception v2

    move-object/from16 p2, v17

    .end local v17           #intent:Landroid/content/Intent;
    .restart local p2
    goto :goto_9a
.end method

.method broadcastIntentInPackage(Ljava/lang/String;ILandroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZ)I
    .registers 29
    .parameter "packageName"
    .parameter "uid"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "resultTo"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "map"
    .parameter "requiredPermission"
    .parameter "serialized"
    .parameter "sticky"

    .prologue
    .line 11493
    monitor-enter p0

    .line 11494
    :try_start_1
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v14

    .line 11495
    .local v14, origId:J
    const/4 v1, 0x0

    const/4 v12, -0x1

    move-object/from16 v0, p0

    move-object/from16 v2, p1

    move-object/from16 v3, p3

    move-object/from16 v4, p4

    move-object/from16 v5, p5

    move/from16 v6, p6

    move-object/from16 v7, p7

    move-object/from16 v8, p8

    move-object/from16 v9, p9

    move/from16 v10, p10

    move/from16 v11, p11

    move/from16 v13, p2

    invoke-direct/range {v0 .. v13}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    move-result v16

    .line 11498
    .local v16, res:I
    invoke-static {v14, v15}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11499
    monitor-exit p0

    return v16

    .line 11500
    .end local v14           #origId:J
    .end local v16           #res:I
    :catchall_28
    move-exception v0

    monitor-exit p0
    :try_end_2a
    .catchall {:try_start_1 .. :try_end_2a} :catchall_28

    throw v0
.end method

.method public cancelIntentSender(Landroid/content/IIntentSender;)V
    .registers 9
    .parameter "sender"

    .prologue
    .line 5748
    instance-of v5, p1, Lcom/android/server/am/PendingIntentRecord;

    if-nez v5, :cond_5

    .line 5770
    :goto_4
    return-void

    .line 5751
    :cond_5
    monitor-enter p0

    .line 5752
    :try_start_6
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/PendingIntentRecord;

    move-object v3, v0
    :try_end_a
    .catchall {:try_start_6 .. :try_end_a} :catchall_62

    .line 5754
    .local v3, rec:Lcom/android/server/am/PendingIntentRecord;
    :try_start_a
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    iget-object v6, v3, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v6, v6, Lcom/android/server/am/PendingIntentRecord$Key;->packageName:Ljava/lang/String;

    invoke-interface {v5, v6}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I

    move-result v4

    .line 5756
    .local v4, uid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    if-eq v4, v5, :cond_65

    .line 5757
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: cancelIntentSender() from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " is not allowed to cancel packges "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    iget-object v6, v3, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v6, v6, Lcom/android/server/am/PendingIntentRecord$Key;->packageName:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    .line 5762
    .local v2, msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    invoke-static {v5, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5763
    new-instance v5, Ljava/lang/SecurityException;

    invoke-direct {v5, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5
    :try_end_5a
    .catchall {:try_start_a .. :try_end_5a} :catchall_62
    .catch Landroid/os/RemoteException; {:try_start_a .. :try_end_5a} :catch_5a

    .line 5765
    .end local v2           #msg:Ljava/lang/String;
    .end local v4           #uid:I
    :catch_5a
    move-exception v5

    move-object v1, v5

    .line 5766
    .local v1, e:Landroid/os/RemoteException;
    :try_start_5c
    new-instance v5, Ljava/lang/SecurityException;

    invoke-direct {v5, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/Throwable;)V

    throw v5

    .line 5769
    .end local v1           #e:Landroid/os/RemoteException;
    .end local v3           #rec:Lcom/android/server/am/PendingIntentRecord;
    :catchall_62
    move-exception v5

    monitor-exit p0
    :try_end_64
    .catchall {:try_start_5c .. :try_end_64} :catchall_62

    throw v5

    .line 5768
    .restart local v3       #rec:Lcom/android/server/am/PendingIntentRecord;
    .restart local v4       #uid:I
    :cond_65
    const/4 v5, 0x1

    :try_start_66
    invoke-virtual {p0, v3, v5}, Lcom/android/server/am/ActivityManagerService;->cancelIntentSenderLocked(Lcom/android/server/am/PendingIntentRecord;Z)V

    .line 5769
    monitor-exit p0
    :try_end_6a
    .catchall {:try_start_66 .. :try_end_6a} :catchall_62

    goto :goto_4
.end method

.method cancelIntentSenderLocked(Lcom/android/server/am/PendingIntentRecord;Z)V
    .registers 5
    .parameter "rec"
    .parameter "cleanActivity"

    .prologue
    .line 5773
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/PendingIntentRecord;->canceled:Z

    .line 5774
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    iget-object v1, p1, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 5775
    if-eqz p2, :cond_1d

    iget-object v0, p1, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord$Key;->activity:Lcom/android/server/am/HistoryRecord;

    if-eqz v0, :cond_1d

    .line 5776
    iget-object v0, p1, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord$Key;->activity:Lcom/android/server/am/HistoryRecord;

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    iget-object v1, p1, Lcom/android/server/am/PendingIntentRecord;->ref:Ljava/lang/ref/WeakReference;

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 5778
    :cond_1d
    return-void
.end method

.method checkAppSwitchAllowedLocked(IILjava/lang/String;)Z
    .registers 10
    .parameter "callingPid"
    .parameter "callingUid"
    .parameter "name"

    .prologue
    const/4 v5, 0x1

    .line 7958
    iget-wide v1, p0, Lcom/android/server/am/ActivityManagerService;->mAppSwitchesAllowedTime:J

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v3

    cmp-long v1, v1, v3

    if-gez v1, :cond_d

    move v1, v5

    .line 7970
    :goto_c
    return v1

    .line 7962
    :cond_d
    const-string v1, "android.permission.STOP_APP_SWITCHES"

    const/4 v2, -0x1

    invoke-virtual {p0, v1, p1, p2, v2}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v0

    .line 7965
    .local v0, perm:I
    if-nez v0, :cond_18

    move v1, v5

    .line 7966
    goto :goto_c

    .line 7969
    :cond_18
    const-string v1, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v2, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, " request from "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, " stopped"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 7970
    const/4 v1, 0x0

    goto :goto_c
.end method

.method checkCallingPermission(Ljava/lang/String;)I
    .registers 4
    .parameter "permission"

    .prologue
    .line 6032
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v0

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    invoke-virtual {p0, p1, v0, v1}, Lcom/android/server/am/ActivityManagerService;->checkPermission(Ljava/lang/String;II)I

    move-result v0

    return v0
.end method

.method checkComponentPermission(Ljava/lang/String;III)I
    .registers 12
    .parameter "permission"
    .parameter "pid"
    .parameter "uid"
    .parameter "reqUid"

    .prologue
    const/4 v5, 0x0

    const/4 v4, -0x1

    const-string v6, "ActivityManager"

    .line 5981
    sget-object v2, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    invoke-virtual {v2}, Ljava/lang/ThreadLocal;->get()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ActivityManagerService$Identity;

    .line 5982
    .local v1, tlsIdentity:Lcom/android/server/am/ActivityManagerService$Identity;
    if-eqz v1, :cond_3e

    .line 5983
    const-string v2, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "checkComponentPermission() adjusting {pid,uid} to {"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    iget v3, v1, Lcom/android/server/am/ActivityManagerService$Identity;->pid:I

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, ","

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    iget v3, v1, Lcom/android/server/am/ActivityManagerService$Identity;->uid:I

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, "}"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v6, v2}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 5985
    iget p3, v1, Lcom/android/server/am/ActivityManagerService$Identity;->uid:I

    .line 5986
    iget p2, v1, Lcom/android/server/am/ActivityManagerService$Identity;->pid:I

    .line 5990
    :cond_3e
    if-eqz p3, :cond_4e

    const/16 v2, 0x3e8

    if-eq p3, v2, :cond_4e

    iget v2, p0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq p2, v2, :cond_4e

    invoke-static {}, Landroid/os/Process;->supportsProcesses()Z

    move-result v2

    if-nez v2, :cond_50

    :cond_4e
    move v2, v5

    .line 6008
    :goto_4f
    return v2

    .line 5995
    :cond_50
    if-ltz p4, :cond_56

    if-eq p3, p4, :cond_56

    move v2, v4

    .line 5996
    goto :goto_4f

    .line 5998
    :cond_56
    if-nez p1, :cond_5a

    move v2, v5

    .line 5999
    goto :goto_4f

    .line 6002
    :cond_5a
    :try_start_5a
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v2

    invoke-interface {v2, p1, p3}, Landroid/content/pm/IPackageManager;->checkUidPermission(Ljava/lang/String;I)I
    :try_end_61
    .catch Landroid/os/RemoteException; {:try_start_5a .. :try_end_61} :catch_63

    move-result v2

    goto :goto_4f

    .line 6004
    :catch_63
    move-exception v2

    move-object v0, v2

    .line 6006
    .local v0, e:Landroid/os/RemoteException;
    const-string v2, "ActivityManager"

    const-string v2, "PackageManager is dead?!?"

    invoke-static {v6, v2, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    move v2, v4

    .line 6008
    goto :goto_4f
.end method

.method public checkPermission(Ljava/lang/String;II)I
    .registers 5
    .parameter "permission"
    .parameter "pid"
    .parameter "uid"

    .prologue
    const/4 v0, -0x1

    .line 6021
    if-nez p1, :cond_4

    .line 6024
    :goto_3
    return v0

    :cond_4
    invoke-virtual {p0, p1, p2, p3, v0}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v0

    goto :goto_3
.end method

.method public checkUriPermission(Landroid/net/Uri;III)I
    .registers 8
    .parameter "uri"
    .parameter "pid"
    .parameter "uid"
    .parameter "modeFlags"

    .prologue
    const/4 v2, 0x0

    .line 6093
    sget-object v1, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    invoke-virtual {v1}, Ljava/lang/ThreadLocal;->get()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ActivityManagerService$Identity;

    .line 6094
    .local v0, tlsIdentity:Lcom/android/server/am/ActivityManagerService$Identity;
    if-eqz v0, :cond_f

    .line 6095
    iget p3, v0, Lcom/android/server/am/ActivityManagerService$Identity;->uid:I

    .line 6096
    iget p2, v0, Lcom/android/server/am/ActivityManagerService$Identity;->pid:I

    .line 6100
    :cond_f
    iget v1, p0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-ne p2, v1, :cond_15

    move v1, v2

    .line 6104
    :goto_14
    return v1

    .line 6103
    :cond_15
    monitor-enter p0

    .line 6104
    :try_start_16
    invoke-direct {p0, p1, p3, p4}, Lcom/android/server/am/ActivityManagerService;->checkUriPermissionLocked(Landroid/net/Uri;II)Z

    move-result v1

    if-eqz v1, :cond_22

    move v1, v2

    :goto_1d
    monitor-exit p0

    goto :goto_14

    .line 6107
    :catchall_1f
    move-exception v1

    monitor-exit p0
    :try_end_21
    .catchall {:try_start_16 .. :try_end_21} :catchall_1f

    throw v1

    .line 6104
    :cond_22
    const/4 v1, -0x1

    goto :goto_1d
.end method

.method public clearApplicationUserData(Ljava/lang/String;Landroid/content/pm/IPackageDataObserver;)Z
    .registers 28
    .parameter "packageName"
    .parameter "observer"

    .prologue
    .line 4813
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v24

    .line 4814
    .local v24, uid:I
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v21

    .line 4815
    .local v21, pid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v19

    .line 4817
    .local v19, callingId:J
    :try_start_c
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v23

    .line 4818
    .local v23, pm:Landroid/content/pm/IPackageManager;
    const/16 v22, -0x1

    .line 4819
    .local v22, pkgUid:I
    monitor-enter p0
    :try_end_13
    .catchall {:try_start_c .. :try_end_13} :catchall_dc

    .line 4821
    :try_start_13
    move-object/from16 v0, v23

    move-object/from16 v1, p1

    invoke-interface {v0, v1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I
    :try_end_1a
    .catchall {:try_start_13 .. :try_end_1a} :catchall_d9
    .catch Landroid/os/RemoteException; {:try_start_13 .. :try_end_1a} :catch_e1

    move-result v22

    .line 4824
    :goto_1b
    const/4 v5, -0x1

    move/from16 v0, v22

    move v1, v5

    if-ne v0, v1, :cond_42

    .line 4825
    :try_start_21
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Invalid packageName:"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4826
    const/4 v5, 0x0

    monitor-exit p0
    :try_end_3e
    .catchall {:try_start_21 .. :try_end_3e} :catchall_d9

    .line 4852
    invoke-static/range {v19 .. v20}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4854
    :goto_41
    return v5

    .line 4828
    :cond_42
    move/from16 v0, v24

    move/from16 v1, v22

    if-eq v0, v1, :cond_59

    :try_start_48
    const-string v5, "android.permission.CLEAR_APP_USER_DATA"

    const/4 v6, -0x1

    move-object/from16 v0, p0

    move-object v1, v5

    move/from16 v2, v21

    move/from16 v3, v24

    move v4, v6

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;III)I

    move-result v5

    if-nez v5, :cond_a4

    .line 4832
    :cond_59
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, v22

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->restartPackageLocked(Ljava/lang/String;I)V

    .line 4838
    monitor-exit p0
    :try_end_63
    .catchall {:try_start_48 .. :try_end_63} :catchall_d9

    .line 4842
    :try_start_63
    move-object/from16 v0, v23

    move-object/from16 v1, p1

    move-object/from16 v2, p2

    invoke-interface {v0, v1, v2}, Landroid/content/pm/IPackageManager;->clearApplicationUserData(Ljava/lang/String;Landroid/content/pm/IPackageDataObserver;)V

    .line 4843
    new-instance v8, Landroid/content/Intent;

    const-string v5, "android.intent.action.PACKAGE_DATA_CLEARED"

    const-string v6, "package"

    const/4 v7, 0x0

    move-object v0, v6

    move-object/from16 v1, p1

    move-object v2, v7

    invoke-static {v0, v1, v2}, Landroid/net/Uri;->fromParts(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v6

    invoke-direct {v8, v5, v6}, Landroid/content/Intent;-><init>(Ljava/lang/String;Landroid/net/Uri;)V

    .line 4845
    .local v8, intent:Landroid/content/Intent;
    const-string v5, "android.intent.extra.UID"

    move-object v0, v8

    move-object v1, v5

    move/from16 v2, v22

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;I)Landroid/content/Intent;

    .line 4846
    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move/from16 v17, v0

    const/16 v18, 0x3e8

    move-object/from16 v5, p0

    invoke-direct/range {v5 .. v18}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I
    :try_end_9f
    .catchall {:try_start_63 .. :try_end_9f} :catchall_dc
    .catch Landroid/os/RemoteException; {:try_start_63 .. :try_end_9f} :catch_e4

    .line 4852
    .end local v8           #intent:Landroid/content/Intent;
    :goto_9f
    invoke-static/range {v19 .. v20}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4854
    const/4 v5, 0x1

    goto :goto_41

    .line 4834
    :cond_a4
    :try_start_a4
    new-instance v5, Ljava/lang/SecurityException;

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    move-object v0, v6

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " does not have permission:"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "android.permission.CLEAR_APP_USER_DATA"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " to clear data"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "for process:"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object v0, v6

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v5, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 4838
    :catchall_d9
    move-exception v5

    monitor-exit p0
    :try_end_db
    .catchall {:try_start_a4 .. :try_end_db} :catchall_d9

    :try_start_db
    throw v5
    :try_end_dc
    .catchall {:try_start_db .. :try_end_dc} :catchall_dc

    .line 4852
    .end local v22           #pkgUid:I
    .end local v23           #pm:Landroid/content/pm/IPackageManager;
    :catchall_dc
    move-exception v5

    invoke-static/range {v19 .. v20}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v5

    .line 4822
    .restart local v22       #pkgUid:I
    .restart local v23       #pm:Landroid/content/pm/IPackageManager;
    :catch_e1
    move-exception v5

    goto/16 :goto_1b

    .line 4849
    :catch_e4
    move-exception v5

    goto :goto_9f
.end method

.method public closeSystemDialogs(Ljava/lang/String;)V
    .registers 23
    .parameter "reason"

    .prologue
    .line 4917
    new-instance v6, Landroid/content/Intent;

    const-string v3, "android.intent.action.CLOSE_SYSTEM_DIALOGS"

    invoke-direct {v6, v3}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 4918
    .local v6, intent:Landroid/content/Intent;
    if-eqz p1, :cond_12

    .line 4919
    const-string v3, "reason"

    move-object v0, v6

    move-object v1, v3

    move-object/from16 v2, p1

    invoke-virtual {v0, v1, v2}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Ljava/lang/String;)Landroid/content/Intent;

    .line 4922
    :cond_12
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v16

    .line 4923
    .local v16, uid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v18

    .line 4924
    .local v18, origId:J
    monitor-enter p0

    .line 4925
    :try_start_1b
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/os/RemoteCallbackList;->beginBroadcast()I

    move-result v17

    .line 4926
    .local v17, i:I
    :cond_24
    :goto_24
    if-lez v17, :cond_42

    .line 4927
    add-int/lit8 v17, v17, -0x1

    .line 4928
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    move-object v3, v0

    move-object v0, v3

    move/from16 v1, v17

    invoke-virtual {v0, v1}, Landroid/os/RemoteCallbackList;->getBroadcastItem(I)Landroid/os/IInterface;

    move-result-object v20

    check-cast v20, Landroid/app/IActivityWatcher;
    :try_end_36
    .catchall {:try_start_1b .. :try_end_36} :catchall_5f

    .line 4929
    .local v20, w:Landroid/app/IActivityWatcher;
    if-eqz v20, :cond_24

    .line 4931
    :try_start_38
    move-object/from16 v0, v20

    move-object/from16 v1, p1

    invoke-interface {v0, v1}, Landroid/app/IActivityWatcher;->closingSystemDialogs(Ljava/lang/String;)V
    :try_end_3f
    .catchall {:try_start_38 .. :try_end_3f} :catchall_5f
    .catch Landroid/os/RemoteException; {:try_start_38 .. :try_end_3f} :catch_40

    goto :goto_24

    .line 4932
    :catch_40
    move-exception v3

    goto :goto_24

    .line 4936
    .end local v20           #w:Landroid/app/IActivityWatcher;
    :cond_42
    :try_start_42
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    move-object v3, v0

    invoke-virtual {v3}, Landroid/os/RemoteCallbackList;->finishBroadcast()V

    .line 4938
    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, -0x1

    move-object/from16 v3, p0

    invoke-direct/range {v3 .. v16}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 4940
    monitor-exit p0
    :try_end_5b
    .catchall {:try_start_42 .. :try_end_5b} :catchall_5f

    .line 4941
    invoke-static/range {v18 .. v19}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4942
    return-void

    .line 4940
    .end local v17           #i:I
    :catchall_5f
    move-exception v3

    :try_start_60
    monitor-exit p0
    :try_end_61
    .catchall {:try_start_60 .. :try_end_61} :catchall_5f

    throw v3
.end method

.method public collectPss(Lcom/android/server/Watchdog$PssStats;)V
    .registers 8
    .parameter "stats"

    .prologue
    const/4 v4, 0x0

    .line 8191
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyPss:I

    .line 8192
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyCount:I

    .line 8193
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundPss:I

    .line 8194
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundCount:I

    .line 8195
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mServicePss:I

    .line 8196
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mServiceCount:I

    .line 8197
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisiblePss:I

    .line 8198
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisibleCount:I

    .line 8199
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundPss:I

    .line 8200
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundCount:I

    .line 8201
    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mNoPssCount:I

    .line 8202
    monitor-enter p0

    .line 8204
    :try_start_18
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    array-length v4, v4

    iget-object v5, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    array-length v5, v5

    if-ge v4, v5, :cond_34

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    array-length v4, v4

    move v0, v4

    .line 8206
    .local v0, NPD:I
    :goto_24
    const/4 v1, 0x0

    .line 8207
    .local v1, aggr:I
    const/4 v2, 0x0

    .local v2, i:I
    :goto_26
    if-ge v2, v0, :cond_39

    .line 8208
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mProcDeaths:[I

    aget v4, v4, v2

    add-int/2addr v1, v4

    .line 8209
    iget-object v4, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    aput v1, v4, v2

    .line 8207
    add-int/lit8 v2, v2, 0x1

    goto :goto_26

    .line 8204
    .end local v0           #NPD:I
    .end local v1           #aggr:I
    .end local v2           #i:I
    :cond_34
    iget-object v4, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    array-length v4, v4

    move v0, v4

    goto :goto_24

    .line 8211
    .restart local v0       #NPD:I
    .restart local v1       #aggr:I
    .restart local v2       #i:I
    :cond_39
    :goto_39
    iget-object v4, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    array-length v4, v4

    if-ge v2, v4, :cond_46

    .line 8212
    iget-object v4, p1, Lcom/android/server/Watchdog$PssStats;->mProcDeaths:[I

    const/4 v5, 0x0

    aput v5, v4, v2

    .line 8213
    add-int/lit8 v2, v2, 0x1

    goto :goto_39

    .line 8216
    :cond_46
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v4

    const/4 v5, 0x1

    sub-int v2, v4, v5

    :goto_4f
    if-ltz v2, :cond_cc

    .line 8217
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 8218
    .local v3, proc:Lcom/android/server/am/ProcessRecord;
    iget-boolean v4, v3, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v4, :cond_60

    .line 8216
    :goto_5d
    add-int/lit8 v2, v2, -0x1

    goto :goto_4f

    .line 8222
    :cond_60
    iget v4, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    if-nez v4, :cond_6e

    .line 8223
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mNoPssCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mNoPssCount:I

    goto :goto_5d

    .line 8243
    .end local v0           #NPD:I
    .end local v1           #aggr:I
    .end local v2           #i:I
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    :catchall_6b
    move-exception v4

    monitor-exit p0
    :try_end_6d
    .catchall {:try_start_18 .. :try_end_6d} :catchall_6b

    throw v4

    .line 8226
    .restart local v0       #NPD:I
    .restart local v1       #aggr:I
    .restart local v2       #i:I
    .restart local v3       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_6e
    :try_start_6e
    iget v4, v3, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    if-ne v4, v5, :cond_82

    .line 8227
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyPss:I

    iget v5, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    add-int/2addr v4, v5

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyPss:I

    .line 8228
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyCount:I

    goto :goto_5d

    .line 8229
    :cond_82
    iget v4, v3, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->CONTENT_PROVIDER_ADJ:I

    if-ne v4, v5, :cond_96

    .line 8230
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyPss:I

    iget v5, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    add-int/2addr v4, v5

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyPss:I

    .line 8231
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mEmptyCount:I

    goto :goto_5d

    .line 8232
    :cond_96
    iget v4, v3, Lcom/android/server/am/ProcessRecord;->setAdj:I

    sget v5, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v4, v5, :cond_aa

    .line 8233
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundPss:I

    iget v5, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    add-int/2addr v4, v5

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundPss:I

    .line 8234
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mBackgroundCount:I

    goto :goto_5d

    .line 8235
    :cond_aa
    iget v4, v3, Lcom/android/server/am/ProcessRecord;->setAdj:I

    iget v5, p0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-lt v4, v5, :cond_be

    .line 8236
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisiblePss:I

    iget v5, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    add-int/2addr v4, v5

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisiblePss:I

    .line 8237
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisibleCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mVisibleCount:I

    goto :goto_5d

    .line 8239
    :cond_be
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundPss:I

    iget v5, v3, Lcom/android/server/am/ProcessRecord;->lastPss:I

    add-int/2addr v4, v5

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundPss:I

    .line 8240
    iget v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundCount:I

    add-int/lit8 v4, v4, 0x1

    iput v4, p1, Lcom/android/server/Watchdog$PssStats;->mForegroundCount:I

    goto :goto_5d

    .line 8243
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_cc
    monitor-exit p0
    :try_end_cd
    .catchall {:try_start_6e .. :try_end_cd} :catchall_6b

    .line 8244
    return-void
.end method

.method createAppErrorIntentLocked(Lcom/android/server/am/ProcessRecord;)Landroid/content/Intent;
    .registers 5
    .parameter "r"

    .prologue
    .line 8685
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->createAppErrorReportLocked(Lcom/android/server/am/ProcessRecord;)Landroid/app/ApplicationErrorReport;

    move-result-object v0

    .line 8686
    .local v0, report:Landroid/app/ApplicationErrorReport;
    if-nez v0, :cond_8

    .line 8687
    const/4 v2, 0x0

    .line 8693
    :goto_7
    return-object v2

    .line 8689
    :cond_8
    new-instance v1, Landroid/content/Intent;

    const-string v2, "android.intent.action.APP_ERROR"

    invoke-direct {v1, v2}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 8690
    .local v1, result:Landroid/content/Intent;
    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->errorReportReceiver:Landroid/content/ComponentName;

    invoke-virtual {v1, v2}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 8691
    const-string v2, "android.intent.extra.BUG_REPORT"

    invoke-virtual {v1, v2, v0}, Landroid/content/Intent;->putExtra(Ljava/lang/String;Landroid/os/Parcelable;)Landroid/content/Intent;

    .line 8692
    const/high16 v2, 0x1000

    invoke-virtual {v1, v2}, Landroid/content/Intent;->addFlags(I)Landroid/content/Intent;

    move-object v2, v1

    .line 8693
    goto :goto_7
.end method

.method createAppErrorReportLocked(Lcom/android/server/am/ProcessRecord;)Landroid/app/ApplicationErrorReport;
    .registers 13
    .parameter "r"

    .prologue
    const/4 v10, 0x0

    .line 8697
    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->errorReportReceiver:Landroid/content/ComponentName;

    if-nez v8, :cond_7

    move-object v8, v10

    .line 8755
    :goto_6
    return-object v8

    .line 8701
    :cond_7
    iget-boolean v8, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-nez v8, :cond_11

    iget-boolean v8, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-nez v8, :cond_11

    move-object v8, v10

    .line 8702
    goto :goto_6

    .line 8706
    :cond_11
    :try_start_11
    new-instance v5, Landroid/app/ApplicationErrorReport;

    invoke-direct {v5}, Landroid/app/ApplicationErrorReport;-><init>()V

    .line 8707
    .local v5, report:Landroid/app/ApplicationErrorReport;
    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v8, v8, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iput-object v8, v5, Landroid/app/ApplicationErrorReport;->packageName:Ljava/lang/String;

    .line 8708
    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->errorReportReceiver:Landroid/content/ComponentName;

    invoke-virtual {v8}, Landroid/content/ComponentName;->getPackageName()Ljava/lang/String;

    move-result-object v8

    iput-object v8, v5, Landroid/app/ApplicationErrorReport;->installerPackageName:Ljava/lang/String;

    .line 8709
    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iput-object v8, v5, Landroid/app/ApplicationErrorReport;->processName:Ljava/lang/String;

    .line 8711
    iget-boolean v8, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-eqz v8, :cond_a5

    .line 8712
    const/4 v8, 0x1

    iput v8, v5, Landroid/app/ApplicationErrorReport;->type:I

    .line 8713
    new-instance v8, Landroid/app/ApplicationErrorReport$CrashInfo;

    invoke-direct {v8}, Landroid/app/ApplicationErrorReport$CrashInfo;-><init>()V

    iput-object v8, v5, Landroid/app/ApplicationErrorReport;->crashInfo:Landroid/app/ApplicationErrorReport$CrashInfo;

    .line 8715
    new-instance v0, Ljava/io/ByteArrayInputStream;

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->crashingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    iget-object v8, v8, Landroid/app/ActivityManager$ProcessErrorStateInfo;->crashData:[B

    invoke-direct {v0, v8}, Ljava/io/ByteArrayInputStream;-><init>([B)V

    .line 8717
    .local v0, byteStream:Ljava/io/ByteArrayInputStream;
    new-instance v2, Ljava/io/DataInputStream;

    invoke-direct {v2, v0}, Ljava/io/DataInputStream;-><init>(Ljava/io/InputStream;)V

    .line 8718
    .local v2, dataStream:Ljava/io/DataInputStream;
    new-instance v1, Landroid/server/data/CrashData;

    invoke-direct {v1, v2}, Landroid/server/data/CrashData;-><init>(Ljava/io/DataInput;)V

    .line 8719
    .local v1, crashData:Landroid/server/data/CrashData;
    invoke-virtual {v1}, Landroid/server/data/CrashData;->getThrowableData()Landroid/server/data/ThrowableData;

    move-result-object v6

    .line 8721
    .local v6, throwData:Landroid/server/data/ThrowableData;
    invoke-virtual {v1}, Landroid/server/data/CrashData;->getTime()J

    move-result-wide v8

    iput-wide v8, v5, Landroid/app/ApplicationErrorReport;->time:J

    .line 8722
    iget-object v8, v5, Landroid/app/ApplicationErrorReport;->crashInfo:Landroid/app/ApplicationErrorReport$CrashInfo;

    invoke-virtual {v6}, Landroid/server/data/ThrowableData;->toString()Ljava/lang/String;

    move-result-object v9

    iput-object v9, v8, Landroid/app/ApplicationErrorReport$CrashInfo;->stackTrace:Ljava/lang/String;

    .line 8727
    invoke-virtual {v6}, Landroid/server/data/ThrowableData;->getMessage()Ljava/lang/String;

    move-result-object v3

    .line 8728
    .local v3, exceptionMessage:Ljava/lang/String;
    :cond_5f
    :goto_5f
    invoke-virtual {v6}, Landroid/server/data/ThrowableData;->getCause()Landroid/server/data/ThrowableData;

    move-result-object v8

    if-eqz v8, :cond_77

    .line 8729
    invoke-virtual {v6}, Landroid/server/data/ThrowableData;->getCause()Landroid/server/data/ThrowableData;

    move-result-object v6

    .line 8730
    invoke-virtual {v6}, Landroid/server/data/ThrowableData;->getMessage()Ljava/lang/String;

    move-result-object v4

    .line 8731
    .local v4, msg:Ljava/lang/String;
    if-eqz v4, :cond_5f

    invoke-virtual {v4}, Ljava/lang/String;->length()I

    move-result v8

    if-lez v8, :cond_5f

    .line 8732
    move-object v3, v4

    goto :goto_5f

    .line 8735
    .end local v4           #msg:Ljava/lang/String;
    :cond_77
    invoke-virtual {v6}, Landroid/server/data/ThrowableData;->getStackTrace()[Landroid/server/data/StackTraceElementData;

    move-result-object v8

    const/4 v9, 0x0

    aget-object v7, v8, v9

    .line 8736
    .local v7, trace:Landroid/server/data/StackTraceElementData;
    iget-object v8, v5, Landroid/app/ApplicationErrorReport;->crashInfo:Landroid/app/ApplicationErrorReport$CrashInfo;

    iput-object v3, v8, Landroid/app/ApplicationErrorReport$CrashInfo;->exceptionMessage:Ljava/lang/String;

    .line 8737
    iget-object v8, v5, Landroid/app/ApplicationErrorReport;->crashInfo:Landroid/app/ApplicationErrorReport$CrashInfo;

    invoke-virtual {v6}, Landroid/server/data/ThrowableData;->getType()Ljava/lang/String;

    move-result-object v9

    iput-object v9, v8, Landroid/app/ApplicationErrorReport$CrashInfo;->exceptionClassName:Ljava/lang/String;

    .line 8738
    iget-object v8, v5, Landroid/app/ApplicationErrorReport;->crashInfo:Landroid/app/ApplicationErrorReport$CrashInfo;

    invoke-virtual {v7}, Landroid/server/data/StackTraceElementData;->getFileName()Ljava/lang/String;

    move-result-object v9

    iput-object v9, v8, Landroid/app/ApplicationErrorReport$CrashInfo;->throwFileName:Ljava/lang/String;

    .line 8739
    iget-object v8, v5, Landroid/app/ApplicationErrorReport;->crashInfo:Landroid/app/ApplicationErrorReport$CrashInfo;

    invoke-virtual {v7}, Landroid/server/data/StackTraceElementData;->getClassName()Ljava/lang/String;

    move-result-object v9

    iput-object v9, v8, Landroid/app/ApplicationErrorReport$CrashInfo;->throwClassName:Ljava/lang/String;

    .line 8740
    iget-object v8, v5, Landroid/app/ApplicationErrorReport;->crashInfo:Landroid/app/ApplicationErrorReport$CrashInfo;

    invoke-virtual {v7}, Landroid/server/data/StackTraceElementData;->getMethodName()Ljava/lang/String;

    move-result-object v9

    iput-object v9, v8, Landroid/app/ApplicationErrorReport$CrashInfo;->throwMethodName:Ljava/lang/String;

    .end local v0           #byteStream:Ljava/io/ByteArrayInputStream;
    .end local v1           #crashData:Landroid/server/data/CrashData;
    .end local v2           #dataStream:Ljava/io/DataInputStream;
    .end local v3           #exceptionMessage:Ljava/lang/String;
    .end local v6           #throwData:Landroid/server/data/ThrowableData;
    .end local v7           #trace:Landroid/server/data/StackTraceElementData;
    :cond_a2
    :goto_a2
    move-object v8, v5

    .line 8750
    goto/16 :goto_6

    .line 8741
    :cond_a5
    iget-boolean v8, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-eqz v8, :cond_a2

    .line 8742
    const/4 v8, 0x2

    iput v8, v5, Landroid/app/ApplicationErrorReport;->type:I

    .line 8743
    new-instance v8, Landroid/app/ApplicationErrorReport$AnrInfo;

    invoke-direct {v8}, Landroid/app/ApplicationErrorReport$AnrInfo;-><init>()V

    iput-object v8, v5, Landroid/app/ApplicationErrorReport;->anrInfo:Landroid/app/ApplicationErrorReport$AnrInfo;

    .line 8745
    iget-object v8, v5, Landroid/app/ApplicationErrorReport;->anrInfo:Landroid/app/ApplicationErrorReport$AnrInfo;

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    iget-object v9, v9, Landroid/app/ActivityManager$ProcessErrorStateInfo;->tag:Ljava/lang/String;

    iput-object v9, v8, Landroid/app/ApplicationErrorReport$AnrInfo;->activity:Ljava/lang/String;

    .line 8746
    iget-object v8, v5, Landroid/app/ApplicationErrorReport;->anrInfo:Landroid/app/ApplicationErrorReport$AnrInfo;

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    iget-object v9, v9, Landroid/app/ActivityManager$ProcessErrorStateInfo;->shortMsg:Ljava/lang/String;

    iput-object v9, v8, Landroid/app/ApplicationErrorReport$AnrInfo;->cause:Ljava/lang/String;

    .line 8747
    iget-object v8, v5, Landroid/app/ApplicationErrorReport;->anrInfo:Landroid/app/ApplicationErrorReport$AnrInfo;

    iget-object v9, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    iget-object v9, v9, Landroid/app/ActivityManager$ProcessErrorStateInfo;->longMsg:Ljava/lang/String;

    iput-object v9, v8, Landroid/app/ApplicationErrorReport$AnrInfo;->info:Ljava/lang/String;
    :try_end_cb
    .catch Ljava/io/IOException; {:try_start_11 .. :try_end_cb} :catch_cc

    goto :goto_a2

    .line 8751
    .end local v5           #report:Landroid/app/ApplicationErrorReport;
    :catch_cc
    move-exception v8

    move-object v8, v10

    .line 8755
    goto/16 :goto_6
.end method

.method protected dump(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;)V
    .registers 30
    .parameter "fd"
    .parameter "pw"
    .parameter "args"

    .prologue
    .line 8838
    monitor-enter p0

    .line 8839
    :try_start_1
    const-string v5, "android.permission.DUMP"

    move-object/from16 v0, p0

    move-object v1, v5

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v5

    if-eqz v5, :cond_45

    .line 8841
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: can\'t dump ActivityManager from from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " without permission "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "android.permission.DUMP"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8846
    monitor-exit p0

    .line 9054
    .end local p1
    :goto_44
    return-void

    .line 8848
    .restart local p1
    :cond_45
    move-object/from16 v0, p3

    array-length v0, v0

    move v5, v0

    if-eqz v5, :cond_5e

    const-string v5, "service"

    const/4 v6, 0x0

    aget-object v6, p3, v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_5e

    .line 8849
    invoke-virtual/range {p0 .. p3}, Lcom/android/server/am/ActivityManagerService;->dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;)V

    .line 8850
    monitor-exit p0

    goto :goto_44

    .line 9053
    .end local p1
    :catchall_5b
    move-exception v5

    monitor-exit p0
    :try_end_5d
    .catchall {:try_start_1 .. :try_end_5d} :catchall_5b

    throw v5

    .line 8852
    .restart local p1
    :cond_5e
    :try_start_5e
    const-string v5, "Activities in Current Activity Manager State:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8853
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "  "

    const-string v7, "Hist"

    const/4 v8, 0x1

    move-object/from16 v0, p2

    move-object v1, v5

    move-object v2, v6

    move-object v3, v7

    move v4, v8

    invoke-static {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 8854
    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8855
    const-string v5, "  Running activities (most recent first):"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8856
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLRUActivities:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "  "

    const-string v7, "Run"

    const/4 v8, 0x0

    move-object/from16 v0, p2

    move-object v1, v5

    move-object v2, v6

    move-object v3, v7

    move v4, v8

    invoke-static {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 8857
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_ca

    .line 8858
    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8859
    const-string v5, "  Activities waiting for another to become visible:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8860
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "  "

    const-string v7, "Wait"

    const/4 v8, 0x0

    move-object/from16 v0, p2

    move-object v1, v5

    move-object v2, v6

    move-object v3, v7

    move v4, v8

    invoke-static {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 8862
    :cond_ca
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_f8

    .line 8863
    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8864
    const-string v5, "  Activities waiting to stop:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8865
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "  "

    const-string v7, "Stop"

    const/4 v8, 0x0

    move-object/from16 v0, p2

    move-object v1, v5

    move-object v2, v6

    move-object v3, v7

    move v4, v8

    invoke-static {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 8867
    :cond_f8
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_126

    .line 8868
    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8869
    const-string v5, "  Activities waiting to finish:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8870
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mFinishingActivities:Ljava/util/ArrayList;

    move-object v5, v0

    const-string v6, "  "

    const-string v7, "Fin"

    const/4 v8, 0x0

    move-object/from16 v0, p2

    move-object v1, v5

    move-object v2, v6

    move-object v3, v7

    move v4, v8

    invoke-static {v0, v1, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->dumpHistoryList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Z)V

    .line 8873
    :cond_126
    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8874
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  mPausingActivity: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8875
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  mResumedActivity: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8876
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  mFocusedActivity: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mFocusedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8877
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  mLastPausedActivity: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLastPausedActivity:Lcom/android/server/am/HistoryRecord;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8879
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_20d

    .line 8880
    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8881
    const-string v5, "Recent tasks in Current Activity Manager State:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8883
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v11

    .line 8884
    .local v11, N:I
    const/4 v13, 0x0

    .end local p1
    .local v13, i:I
    :goto_1cb
    if-ge v13, v11, :cond_20d

    .line 8885
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v13}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v24

    check-cast v24, Lcom/android/server/am/TaskRecord;

    .line 8886
    .local v24, tr:Lcom/android/server/am/TaskRecord;
    const-string v5, "  * Recent #"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p2

    move v1, v13

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    const-string v5, ": "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 8887
    move-object/from16 v0, p2

    move-object/from16 v1, v24

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 8888
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v13}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcom/android/server/am/TaskRecord;

    const-string v5, "    "

    move-object/from16 v0, p1

    move-object/from16 v1, p2

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/TaskRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 8884
    add-int/lit8 v13, v13, 0x1

    goto :goto_1cb

    .line 8892
    .end local v11           #N:I
    .end local v13           #i:I
    .end local v24           #tr:Lcom/android/server/am/TaskRecord;
    :cond_20d
    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8893
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  mCurTask: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mCurTask:I

    move v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8895
    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8896
    const-string v5, "Processes in Current Activity Manager State:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8898
    const/16 v16, 0x0

    .line 8899
    .local v16, needSep:Z
    const/16 v19, 0x0

    .line 8901
    .local v19, numPers:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v5

    invoke-virtual {v5}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v14

    .local v14, i$:Ljava/util/Iterator;
    :cond_258
    invoke-interface {v14}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_2cc

    invoke-interface {v14}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v21

    check-cast v21, Landroid/util/SparseArray;

    .line 8902
    .local v21, procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    invoke-virtual/range {v21 .. v21}, Landroid/util/SparseArray;->size()I

    move-result v12

    .line 8903
    .local v12, NA:I
    const/4 v15, 0x0

    .local v15, ia:I
    :goto_269
    if-ge v15, v12, :cond_258

    .line 8904
    if-nez v16, :cond_277

    .line 8905
    const-string v5, "  All known processes:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8906
    const/16 v16, 0x1

    .line 8908
    :cond_277
    move-object/from16 v0, v21

    move v1, v15

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Lcom/android/server/am/ProcessRecord;

    .line 8909
    .local v23, r:Lcom/android/server/am/ProcessRecord;
    move-object/from16 v0, v23

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    move v5, v0

    if-eqz v5, :cond_2c9

    const-string v5, "  *PERS*"

    :goto_289
    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 8910
    const-string v5, " UID "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, v21

    move v1, v15

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v5

    move-object/from16 v0, p2

    move v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 8911
    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p2

    move-object/from16 v1, v23

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 8912
    const-string v5, "    "

    move-object/from16 v0, v23

    move-object/from16 v1, p2

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Lcom/android/server/am/ProcessRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 8913
    move-object/from16 v0, v23

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    move v5, v0

    if-eqz v5, :cond_2c6

    .line 8914
    add-int/lit8 v19, v19, 0x1

    .line 8903
    :cond_2c6
    add-int/lit8 v15, v15, 0x1

    goto :goto_269

    .line 8909
    :cond_2c9
    const-string v5, "  *APP*"

    goto :goto_289

    .line 8919
    .end local v12           #NA:I
    .end local v15           #ia:I
    .end local v21           #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .end local v23           #r:Lcom/android/server/am/ProcessRecord;
    :cond_2cc
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_2fe

    .line 8920
    if-eqz v16, :cond_2e1

    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8921
    :cond_2e1
    const/16 v16, 0x1

    .line 8922
    const-string v5, "  Running processes (most recent first):"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8923
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    move-object v6, v0

    const-string v7, "    "

    const-string v8, "App "

    const-string v9, "PERS"

    const/4 v10, 0x1

    move-object/from16 v5, p2

    invoke-static/range {v5 .. v10}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 8925
    const/16 v16, 0x1

    .line 8928
    :cond_2fe
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v5, v0

    monitor-enter v5
    :try_end_304
    .catchall {:try_start_5e .. :try_end_304} :catchall_5b

    .line 8929
    :try_start_304
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v6, v0

    invoke-virtual {v6}, Landroid/util/SparseArray;->size()I

    move-result v6

    if-lez v6, :cond_360

    .line 8930
    if-eqz v16, :cond_319

    const-string v6, " "

    move-object/from16 v0, p2

    move-object v1, v6

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8931
    :cond_319
    const/16 v16, 0x1

    .line 8932
    const-string v6, "  PID mappings:"

    move-object/from16 v0, p2

    move-object v1, v6

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8933
    const/4 v13, 0x0

    .restart local v13       #i:I
    :goto_324
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v6, v0

    invoke-virtual {v6}, Landroid/util/SparseArray;->size()I

    move-result v6

    if-ge v13, v6, :cond_360

    .line 8934
    const-string v6, "    PID #"

    move-object/from16 v0, p2

    move-object v1, v6

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v6, v0

    invoke-virtual {v6, v13}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v6

    move-object/from16 v0, p2

    move v1, v6

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 8935
    const-string v6, ": "

    move-object/from16 v0, p2

    move-object v1, v6

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object v6, v0

    invoke-virtual {v6, v13}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v6

    move-object/from16 v0, p2

    move-object v1, v6

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 8933
    add-int/lit8 v13, v13, 0x1

    goto :goto_324

    .line 8938
    .end local v13           #i:I
    :cond_360
    monitor-exit v5
    :try_end_361
    .catchall {:try_start_304 .. :try_end_361} :catchall_3bd

    .line 8940
    :try_start_361
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/util/SparseArray;->size()I

    move-result v5

    if-lez v5, :cond_3c0

    .line 8941
    if-eqz v16, :cond_376

    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8942
    :cond_376
    const/16 v16, 0x1

    .line 8943
    const-string v5, "  Foreground Processes:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8944
    const/4 v13, 0x0

    .restart local v13       #i:I
    :goto_381
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/util/SparseArray;->size()I

    move-result v5

    if-ge v13, v5, :cond_3c0

    .line 8945
    const-string v5, "    PID #"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    move-object v5, v0

    invoke-virtual {v5, v13}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v5

    move-object/from16 v0, p2

    move v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 8946
    const-string v5, ": "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    move-object v5, v0

    invoke-virtual {v5, v13}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V
    :try_end_3ba
    .catchall {:try_start_361 .. :try_end_3ba} :catchall_5b

    .line 8944
    add-int/lit8 v13, v13, 0x1

    goto :goto_381

    .line 8938
    .end local v13           #i:I
    :catchall_3bd
    move-exception v6

    :try_start_3be
    monitor-exit v5
    :try_end_3bf
    .catchall {:try_start_3be .. :try_end_3bf} :catchall_3bd

    :try_start_3bf
    throw v6

    .line 8950
    :cond_3c0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_3f0

    .line 8951
    if-eqz v16, :cond_3d5

    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8952
    :cond_3d5
    const/16 v16, 0x1

    .line 8953
    const-string v5, "  Persisent processes that are starting:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8954
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPersistentStartingProcesses:Ljava/util/ArrayList;

    move-object v6, v0

    const-string v7, "    "

    const-string v8, "Starting Norm"

    const-string v9, "Restarting PERS"

    const/4 v10, 0x0

    move-object/from16 v5, p2

    invoke-static/range {v5 .. v10}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 8958
    :cond_3f0
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_420

    .line 8959
    if-eqz v16, :cond_405

    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8960
    :cond_405
    const/16 v16, 0x1

    .line 8961
    const-string v5, "  Processes that are starting:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8962
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartingProcesses:Ljava/util/ArrayList;

    move-object v6, v0

    const-string v7, "    "

    const-string v8, "Starting Norm"

    const-string v9, "Starting PERS"

    const/4 v10, 0x0

    move-object/from16 v5, p2

    invoke-static/range {v5 .. v10}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 8966
    :cond_420
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_450

    .line 8967
    if-eqz v16, :cond_435

    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8968
    :cond_435
    const/16 v16, 0x1

    .line 8969
    const-string v5, "  Processes that are being removed:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8970
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRemovedProcesses:Ljava/util/ArrayList;

    move-object v6, v0

    const-string v7, "    "

    const-string v8, "Removed Norm"

    const-string v9, "Removed PERS"

    const/4 v10, 0x0

    move-object/from16 v5, p2

    invoke-static/range {v5 .. v10}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 8974
    :cond_450
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_480

    .line 8975
    if-eqz v16, :cond_465

    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8976
    :cond_465
    const/16 v16, 0x1

    .line 8977
    const-string v5, "  Processes that are on old until the system is ready:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8978
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesOnHold:Ljava/util/ArrayList;

    move-object v6, v0

    const-string v7, "    "

    const-string v8, "OnHold Norm"

    const-string v9, "OnHold PERS"

    const/4 v10, 0x0

    move-object/from16 v5, p2

    invoke-static/range {v5 .. v10}, Lcom/android/server/am/ActivityManagerService;->dumpProcessList(Ljava/io/PrintWriter;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Z)I

    .line 8982
    :cond_480
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_511

    .line 8983
    if-eqz v16, :cond_495

    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8984
    :cond_495
    const/16 v16, 0x1

    .line 8985
    const-string v5, "  Processes that are waiting to GC:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8986
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v17

    .line 8987
    .local v17, now:J
    const/4 v13, 0x0

    .restart local v13       #i:I
    :goto_4a4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v13, v5, :cond_511

    .line 8988
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v13}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v20

    check-cast v20, Lcom/android/server/am/ProcessRecord;

    .line 8989
    .local v20, proc:Lcom/android/server/am/ProcessRecord;
    const-string v5, "    Process "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, p2

    move-object/from16 v1, v20

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 8990
    const-string v5, "      lowMem="

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, v20

    iget-boolean v0, v0, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    move v5, v0

    move-object/from16 v0, p2

    move v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Z)V

    .line 8991
    const-string v5, ", last gced="

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 8992
    move-object/from16 v0, v20

    iget-wide v0, v0, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    move-wide v5, v0

    sub-long v5, v17, v5

    move-object/from16 v0, p2

    move-wide v1, v5

    invoke-virtual {v0, v1, v2}, Ljava/io/PrintWriter;->print(J)V

    .line 8993
    const-string v5, " ms ago, last lowMwm="

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 8994
    move-object/from16 v0, v20

    iget-wide v0, v0, Lcom/android/server/am/ProcessRecord;->lastLowMemory:J

    move-wide v5, v0

    sub-long v5, v17, v5

    move-object/from16 v0, p2

    move-wide v1, v5

    invoke-virtual {v0, v1, v2}, Ljava/io/PrintWriter;->print(J)V

    .line 8995
    const-string v5, " ms ago"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 8987
    add-int/lit8 v13, v13, 0x1

    goto :goto_4a4

    .line 9000
    .end local v13           #i:I
    .end local v17           #now:J
    .end local v20           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_511
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v5

    invoke-virtual {v5}, Ljava/util/HashMap;->size()I

    move-result v5

    if-lez v5, :cond_5b4

    .line 9001
    if-eqz v16, :cond_52a

    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9002
    :cond_52a
    const/16 v16, 0x1

    .line 9003
    const-string v5, "  Time since processes crashed:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9004
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v17

    .line 9006
    .restart local v17       #now:J
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v5

    invoke-virtual {v5}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v14

    :cond_549
    invoke-interface {v14}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_5b4

    invoke-interface {v14}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v22

    check-cast v22, Ljava/util/Map$Entry;

    .line 9007
    .local v22, procs:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    invoke-interface/range {v22 .. v22}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v25

    check-cast v25, Landroid/util/SparseArray;

    .line 9008
    .local v25, uids:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    invoke-virtual/range {v25 .. v25}, Landroid/util/SparseArray;->size()I

    move-result v11

    .line 9009
    .restart local v11       #N:I
    const/4 v13, 0x0

    .restart local v13       #i:I
    :goto_560
    if-ge v13, v11, :cond_549

    .line 9010
    const-string v5, "    Process "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-interface/range {v22 .. v22}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Ljava/lang/String;

    move-object/from16 v0, p2

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9011
    const-string v5, " uid "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, v25

    move v1, v13

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v5

    move-object/from16 v0, p2

    move v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 9012
    const-string v5, ": last crashed "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9013
    move-object/from16 v0, v25

    move v1, v13

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Ljava/lang/Long;

    invoke-virtual/range {p1 .. p1}, Ljava/lang/Long;->longValue()J

    move-result-wide v5

    sub-long v5, v17, v5

    move-object/from16 v0, p2

    move-wide v1, v5

    invoke-virtual {v0, v1, v2}, Ljava/io/PrintWriter;->print(J)V

    .line 9014
    const-string v5, " ms ago"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9009
    add-int/lit8 v13, v13, 0x1

    goto :goto_560

    .line 9019
    .end local v11           #N:I
    .end local v13           #i:I
    .end local v17           #now:J
    .end local v22           #procs:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    .end local v25           #uids:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    :cond_5b4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v5

    invoke-virtual {v5}, Ljava/util/HashMap;->size()I

    move-result v5

    if-lez v5, :cond_643

    .line 9020
    if-eqz v16, :cond_5cd

    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9021
    :cond_5cd
    const/16 v16, 0x1

    .line 9022
    const-string v5, "  Bad processes:"

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9024
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    move-object v5, v0

    invoke-virtual {v5}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v5

    invoke-virtual {v5}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v14

    :cond_5e8
    invoke-interface {v14}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_643

    invoke-interface {v14}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v22

    check-cast v22, Ljava/util/Map$Entry;

    .line 9025
    .restart local v22       #procs:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    invoke-interface/range {v22 .. v22}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v25

    check-cast v25, Landroid/util/SparseArray;

    .line 9026
    .restart local v25       #uids:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    invoke-virtual/range {v25 .. v25}, Landroid/util/SparseArray;->size()I

    move-result v11

    .line 9027
    .restart local v11       #N:I
    const/4 v13, 0x0

    .restart local v13       #i:I
    :goto_5ff
    if-ge v13, v11, :cond_5e8

    .line 9028
    const-string v5, "    Bad process "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-interface/range {v22 .. v22}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Ljava/lang/String;

    move-object/from16 v0, p2

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9029
    const-string v5, " uid "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    move-object/from16 v0, v25

    move v1, v13

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v5

    move-object/from16 v0, p2

    move v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(I)V

    .line 9030
    const-string v5, ": crashed at time "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9031
    move-object/from16 v0, v25

    move v1, v13

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9027
    add-int/lit8 v13, v13, 0x1

    goto :goto_5ff

    .line 9036
    .end local v11           #N:I
    .end local v13           #i:I
    .end local v22           #procs:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Landroid/util/SparseArray<Ljava/lang/Long;>;>;"
    .end local v25           #uids:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Ljava/lang/Long;>;"
    :cond_643
    const-string v5, " "

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9037
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  Total persistent processes: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9038
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  mHomeProcess: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHomeProcess:Lcom/android/server/am/ProcessRecord;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9039
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  mConfiguration: "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9040
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  mStartRunning="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    move v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " mSystemReady="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    move v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " mBooting="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    move v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " mBooted="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    move v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " mFactoryTest="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    move v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9045
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  mSleeping="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    move v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " mShuttingDown="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    move v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9046
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  mGoingToSleep="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9047
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  mLaunchingActivity="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9048
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  mDebugApp="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "/orig="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " mDebugTransient="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mDebugTransient:Z

    move v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " mOrigWaitForDebugger="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    move v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9051
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  mAlwaysFinishActivities="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-boolean v0, v0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    move v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " mController="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    move-object v1, v5

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9053
    monitor-exit p0
    :try_end_7df
    .catchall {:try_start_3bf .. :try_end_7df} :catchall_5b

    goto/16 :goto_44
.end method

.method dumpBroadcasts(Ljava/io/PrintWriter;)V
    .registers 14
    .parameter "pw"

    .prologue
    const/4 v11, 0x1

    const-string v9, ":"

    const-string v9, "    "

    const-string v9, " "

    .line 9112
    monitor-enter p0

    .line 9113
    :try_start_8
    const-string v9, "android.permission.DUMP"

    invoke-virtual {p0, v9}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v9

    if-eqz v9, :cond_46

    .line 9115
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Permission Denial: can\'t dump ActivityManager from from pid="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ", uid="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " without permission "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, "android.permission.DUMP"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9120
    monitor-exit p0

    .line 9196
    :goto_45
    return-void

    .line 9122
    :cond_46
    const-string v9, "Broadcasts in Current Activity Manager State:"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9124
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->size()I

    move-result v9

    if-lez v9, :cond_84

    .line 9125
    const-string v9, " "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9126
    const-string v9, "  Registered Receivers:"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9127
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v6

    .line 9128
    .local v6, it:Ljava/util/Iterator;
    :goto_67
    invoke-interface {v6}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_84

    .line 9129
    invoke-interface {v6}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ReceiverList;

    .line 9130
    .local v7, r:Lcom/android/server/am/ReceiverList;
    const-string v9, "  * "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9131
    const-string v9, "    "

    invoke-virtual {v7, p1, v9}, Lcom/android/server/am/ReceiverList;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_67

    .line 9195
    .end local v6           #it:Ljava/util/Iterator;
    .end local v7           #r:Lcom/android/server/am/ReceiverList;
    :catchall_81
    move-exception v9

    monitor-exit p0
    :try_end_83
    .catchall {:try_start_8 .. :try_end_83} :catchall_81

    throw v9

    .line 9135
    :cond_84
    :try_start_84
    const-string v9, " "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9136
    const-string v9, "Receiver Resolver Table:"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9137
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    const-string v10, "  "

    invoke-virtual {v9, p1, v10}, Lcom/android/server/IntentResolver;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9139
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    if-gtz v9, :cond_a9

    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    if-gtz v9, :cond_a9

    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    if-eqz v9, :cond_14e

    .line 9141
    :cond_a9
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    if-lez v9, :cond_bb

    .line 9142
    const-string v9, " "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9143
    const-string v9, "  Active broadcasts:"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9145
    :cond_bb
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    sub-int v3, v9, v11

    .local v3, i:I
    :goto_c3
    if-ltz v3, :cond_f1

    .line 9146
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "  Broadcast #"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ":"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9147
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v9, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/BroadcastRecord;

    const-string v10, "    "

    invoke-virtual {v9, p1, v10}, Lcom/android/server/am/BroadcastRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9145
    add-int/lit8 v3, v3, -0x1

    goto :goto_c3

    .line 9149
    :cond_f1
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    if-lez v9, :cond_103

    .line 9150
    const-string v9, " "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9151
    const-string v9, "  Active serialized broadcasts:"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9153
    :cond_103
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    sub-int v3, v9, v11

    :goto_10b
    if-ltz v3, :cond_139

    .line 9154
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "  Serialized Broadcast #"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ":"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9155
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mOrderedBroadcasts:Ljava/util/ArrayList;

    invoke-virtual {v9, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/BroadcastRecord;

    const-string v10, "    "

    invoke-virtual {v9, p1, v10}, Lcom/android/server/am/BroadcastRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9153
    add-int/lit8 v3, v3, -0x1

    goto :goto_10b

    .line 9157
    :cond_139
    const-string v9, " "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9158
    const-string v9, "  Pending broadcast:"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9159
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    if-eqz v9, :cond_1ec

    .line 9160
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    const-string v10, "    "

    invoke-virtual {v9, p1, v10}, Lcom/android/server/am/BroadcastRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9166
    .end local v3           #i:I
    :cond_14e
    :goto_14e
    const-string v9, " "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9167
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "  mBroadcastsScheduled="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    iget-boolean v10, p0, Lcom/android/server/am/ActivityManagerService;->mBroadcastsScheduled:Z

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9168
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    if-eqz v9, :cond_1f3

    .line 9169
    const-string v9, " "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9170
    const-string v9, "  Sticky broadcasts:"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9171
    new-instance v8, Ljava/lang/StringBuilder;

    const/16 v9, 0x80

    invoke-direct {v8, v9}, Ljava/lang/StringBuilder;-><init>(I)V

    .line 9173
    .local v8, sb:Ljava/lang/StringBuilder;
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v4

    .local v4, i$:Ljava/util/Iterator;
    :cond_18a
    invoke-interface {v4}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_1f3

    invoke-interface {v4}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/util/Map$Entry;

    .line 9174
    .local v2, ent:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Ljava/util/ArrayList<Landroid/content/Intent;>;>;"
    const-string v9, "  * Sticky action "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-interface {v2}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Ljava/lang/String;

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9175
    const-string v9, ":"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9176
    invoke-interface {v2}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Ljava/util/ArrayList;

    .line 9177
    .local v5, intents:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 9178
    .local v0, N:I
    const/4 v3, 0x0

    .restart local v3       #i:I
    :goto_1b4
    if-ge v3, v0, :cond_18a

    .line 9179
    const/4 v9, 0x0

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->setLength(I)V

    .line 9180
    const-string v9, "    Intent: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 9181
    invoke-virtual {v5, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Landroid/content/Intent;

    const/4 v10, 0x1

    const/4 v11, 0x0

    invoke-virtual {v9, v8, v10, v11}, Landroid/content/Intent;->toShortString(Ljava/lang/StringBuilder;ZZ)V

    .line 9182
    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9183
    invoke-virtual {v5, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Landroid/content/Intent;

    invoke-virtual {v9}, Landroid/content/Intent;->getExtras()Landroid/os/Bundle;

    move-result-object v1

    .line 9184
    .local v1, bundle:Landroid/os/Bundle;
    if-eqz v1, :cond_1e9

    .line 9185
    const-string v9, "      "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9186
    invoke-virtual {v1}, Landroid/os/Bundle;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9178
    :cond_1e9
    add-int/lit8 v3, v3, 0x1

    goto :goto_1b4

    .line 9162
    .end local v0           #N:I
    .end local v1           #bundle:Landroid/os/Bundle;
    .end local v2           #ent:Ljava/util/Map$Entry;,"Ljava/util/Map$Entry<Ljava/lang/String;Ljava/util/ArrayList<Landroid/content/Intent;>;>;"
    .end local v4           #i$:Ljava/util/Iterator;
    .end local v5           #intents:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    .end local v8           #sb:Ljava/lang/StringBuilder;
    :cond_1ec
    const-string v9, "    (null)"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    goto/16 :goto_14e

    .line 9192
    .end local v3           #i:I
    :cond_1f3
    const-string v9, " "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9193
    const-string v9, "  mHandler:"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9194
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    new-instance v10, Landroid/util/PrintWriterPrinter;

    invoke-direct {v10, p1}, Landroid/util/PrintWriterPrinter;-><init>(Ljava/io/PrintWriter;)V

    const-string v11, "    "

    invoke-virtual {v9, v10, v11}, Landroid/os/Handler;->dump(Landroid/util/Printer;Ljava/lang/String;)V

    .line 9195
    monitor-exit p0
    :try_end_20a
    .catchall {:try_start_84 .. :try_end_20a} :catchall_81

    goto/16 :goto_45
.end method

.method dumpProviders(Ljava/io/PrintWriter;)V
    .registers 13
    .parameter "pw"

    .prologue
    const-string v9, "android.permission.DUMP"

    const-string v9, ": "

    const-string v9, "    "

    const-string v9, " "

    .line 9272
    monitor-enter p0

    .line 9273
    :try_start_9
    const-string v9, "android.permission.DUMP"

    invoke-virtual {p0, v9}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v9

    if-eqz v9, :cond_47

    .line 9275
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Permission Denial: can\'t dump ActivityManager from from pid="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ", uid="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " without permission "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, "android.permission.DUMP"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9280
    monitor-exit p0

    .line 9339
    :goto_46
    return-void

    .line 9283
    :cond_47
    const-string v9, "Content Providers in Current Activity Manager State:"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9285
    const/4 v4, 0x0

    .line 9287
    .local v4, needSep:Z
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->size()I

    move-result v9

    if-lez v9, :cond_8f

    .line 9288
    if-eqz v4, :cond_5c

    const-string v9, " "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9289
    :cond_5c
    const-string v9, "  Published content providers (by class):"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9290
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .line 9291
    .local v3, it:Ljava/util/Iterator;
    :goto_6b
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_8e

    .line 9292
    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/util/Map$Entry;

    .line 9293
    .local v0, e:Ljava/util/Map$Entry;
    invoke-interface {v0}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ContentProviderRecord;

    .line 9294
    .local v7, r:Lcom/android/server/am/ContentProviderRecord;
    const-string v9, "  * "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9295
    const-string v9, "    "

    invoke-virtual {v7, p1, v9}, Lcom/android/server/am/ContentProviderRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_6b

    .line 9338
    .end local v0           #e:Ljava/util/Map$Entry;
    .end local v3           #it:Ljava/util/Iterator;
    .end local v4           #needSep:Z
    .end local v7           #r:Lcom/android/server/am/ContentProviderRecord;
    :catchall_8b
    move-exception v9

    monitor-exit p0
    :try_end_8d
    .catchall {:try_start_9 .. :try_end_8d} :catchall_8b

    throw v9

    .line 9297
    .restart local v3       #it:Ljava/util/Iterator;
    .restart local v4       #needSep:Z
    :cond_8e
    const/4 v4, 0x1

    .line 9300
    .end local v3           #it:Ljava/util/Iterator;
    :cond_8f
    :try_start_8f
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->size()I

    move-result v9

    if-lez v9, :cond_d3

    .line 9301
    const-string v9, " "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9302
    const-string v9, "  Authority to provider mappings:"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9303
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v3

    .line 9304
    .restart local v3       #it:Ljava/util/Iterator;
    :goto_ab
    invoke-interface {v3}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_d2

    .line 9305
    invoke-interface {v3}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/util/Map$Entry;

    .line 9306
    .restart local v0       #e:Ljava/util/Map$Entry;
    invoke-interface {v0}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/am/ContentProviderRecord;

    .line 9307
    .restart local v7       #r:Lcom/android/server/am/ContentProviderRecord;
    const-string v9, "  "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-interface {v0}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v9

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/Object;)V

    const-string v9, ": "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9308
    invoke-virtual {p1, v7}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    goto :goto_ab

    .line 9310
    .end local v0           #e:Ljava/util/Map$Entry;
    .end local v7           #r:Lcom/android/server/am/ContentProviderRecord;
    :cond_d2
    const/4 v4, 0x1

    .line 9313
    .end local v3           #it:Ljava/util/Iterator;
    :cond_d3
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    if-lez v9, :cond_10c

    .line 9314
    if-eqz v4, :cond_e2

    const-string v9, " "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9315
    :cond_e2
    const-string v9, "  Launching content providers:"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9316
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v9

    const/4 v10, 0x1

    sub-int v1, v9, v10

    .local v1, i:I
    :goto_f0
    if-ltz v1, :cond_10b

    .line 9317
    const-string v9, "  Launching #"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v1}, Ljava/io/PrintWriter;->print(I)V

    const-string v9, ": "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    .line 9318
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v9, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9316
    add-int/lit8 v1, v1, -0x1

    goto :goto_f0

    .line 9320
    :cond_10b
    const/4 v4, 0x1

    .line 9323
    .end local v1           #i:I
    :cond_10c
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v9}, Landroid/util/SparseArray;->size()I

    move-result v9

    if-lez v9, :cond_165

    .line 9324
    invoke-virtual {p1}, Ljava/io/PrintWriter;->println()V

    .line 9325
    const-string v9, "Granted Uri Permissions:"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9326
    const/4 v1, 0x0

    .restart local v1       #i:I
    :goto_11d
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v9}, Landroid/util/SparseArray;->size()I

    move-result v9

    if-ge v1, v9, :cond_165

    .line 9327
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v9, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v8

    .line 9328
    .local v8, uid:I
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mGrantedUriPermissions:Landroid/util/SparseArray;

    invoke-virtual {v9, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Ljava/util/HashMap;

    .line 9330
    .local v6, perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    const-string v9, "  * UID "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v8}, Ljava/io/PrintWriter;->print(I)V

    .line 9331
    const-string v9, " holds:"

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9332
    invoke-virtual {v6}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .local v2, i$:Ljava/util/Iterator;
    :goto_148
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_162

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/UriPermission;

    .line 9333
    .local v5, perm:Lcom/android/server/am/UriPermission;
    const-string v9, "    "

    invoke-virtual {p1, v9}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9334
    const-string v9, "      "

    invoke-virtual {v5, p1, v9}, Lcom/android/server/am/UriPermission;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_148

    .line 9326
    .end local v5           #perm:Lcom/android/server/am/UriPermission;
    :cond_162
    add-int/lit8 v1, v1, 0x1

    goto :goto_11d

    .line 9338
    .end local v1           #i:I
    .end local v2           #i$:Ljava/util/Iterator;
    .end local v6           #perms:Ljava/util/HashMap;,"Ljava/util/HashMap<Landroid/net/Uri;Lcom/android/server/am/UriPermission;>;"
    .end local v8           #uid:I
    :cond_165
    monitor-exit p0
    :try_end_166
    .catchall {:try_start_8f .. :try_end_166} :catchall_8b

    goto/16 :goto_46
.end method

.method dumpSenders(Ljava/io/PrintWriter;)V
    .registers 7
    .parameter "pw"

    .prologue
    const-string v3, "android.permission.DUMP"

    const-string v3, "  * "

    .line 9342
    monitor-enter p0

    .line 9343
    :try_start_5
    const-string v3, "android.permission.DUMP"

    invoke-virtual {p0, v3}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v3

    if-eqz v3, :cond_43

    .line 9345
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Permission Denial: can\'t dump ActivityManager from from pid="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v4

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, ", uid="

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v4

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " without permission "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "android.permission.DUMP"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p1, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9350
    monitor-exit p0

    .line 9370
    :goto_42
    return-void

    .line 9353
    :cond_43
    const-string v3, "Pending Intents in Current Activity Manager State:"

    invoke-virtual {p1, v3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9355
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    invoke-virtual {v3}, Ljava/util/HashMap;->size()I

    move-result v3

    if-lez v3, :cond_8e

    .line 9356
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    invoke-virtual {v3}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v3

    invoke-interface {v3}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v0

    .line 9358
    .local v0, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;>;"
    :goto_5a
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_8e

    .line 9359
    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/lang/ref/WeakReference;

    .line 9360
    .local v2, ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    if-eqz v2, :cond_82

    invoke-virtual {v2}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/PendingIntentRecord;

    move-object v1, v3

    .line 9361
    .local v1, rec:Lcom/android/server/am/PendingIntentRecord;
    :goto_6f
    if-eqz v1, :cond_85

    .line 9362
    const-string v3, "  * "

    invoke-virtual {p1, v3}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9363
    const-string v3, "    "

    invoke-virtual {v1, p1, v3}, Lcom/android/server/am/PendingIntentRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_5a

    .line 9369
    .end local v0           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;>;"
    .end local v1           #rec:Lcom/android/server/am/PendingIntentRecord;
    .end local v2           #ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    :catchall_7f
    move-exception v3

    monitor-exit p0
    :try_end_81
    .catchall {:try_start_5 .. :try_end_81} :catchall_7f

    throw v3

    .line 9360
    .restart local v0       #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;>;"
    .restart local v2       #ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    :cond_82
    const/4 v3, 0x0

    move-object v1, v3

    goto :goto_6f

    .line 9365
    .restart local v1       #rec:Lcom/android/server/am/PendingIntentRecord;
    :cond_85
    :try_start_85
    const-string v3, "  * "

    invoke-virtual {p1, v3}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v2}, Ljava/io/PrintWriter;->print(Ljava/lang/Object;)V

    goto :goto_5a

    .line 9369
    .end local v0           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;>;"
    .end local v1           #rec:Lcom/android/server/am/PendingIntentRecord;
    .end local v2           #ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    :cond_8e
    monitor-exit p0
    :try_end_8f
    .catchall {:try_start_85 .. :try_end_8f} :catchall_7f

    goto :goto_42
.end method

.method protected dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;[Ljava/lang/String;)V
    .registers 13
    .parameter "fd"
    .parameter "pw"
    .parameter "args"

    .prologue
    const/4 v7, 0x1

    const/4 v8, 0x2

    .line 9068
    array-length v6, p3

    if-ne v6, v7, :cond_f

    .line 9069
    const/4 v1, 0x0

    .line 9070
    .local v1, componentNameString:Ljava/lang/String;
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->EMPTY_STRING_ARRAY:[Ljava/lang/String;

    .line 9071
    .local v3, newArgs:[Ljava/lang/String;
    const/4 v4, 0x0

    .line 9080
    .local v4, r:Lcom/android/server/am/ServiceRecord;
    :cond_9
    :goto_9
    if-eqz v4, :cond_31

    .line 9081
    invoke-direct {p0, p1, p2, v4, v3}, Lcom/android/server/am/ActivityManagerService;->dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;Lcom/android/server/am/ServiceRecord;[Ljava/lang/String;)V

    .line 9090
    :cond_e
    return-void

    .line 9073
    .end local v1           #componentNameString:Ljava/lang/String;
    .end local v3           #newArgs:[Ljava/lang/String;
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_f
    aget-object v1, p3, v7

    .line 9074
    .restart local v1       #componentNameString:Ljava/lang/String;
    invoke-static {v1}, Landroid/content/ComponentName;->unflattenFromString(Ljava/lang/String;)Landroid/content/ComponentName;

    move-result-object v0

    .line 9075
    .local v0, componentName:Landroid/content/ComponentName;
    if-eqz v0, :cond_2e

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v6, v0}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/am/ServiceRecord;

    move-object v4, v6

    .line 9076
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    :goto_20
    array-length v6, p3

    sub-int/2addr v6, v8

    new-array v3, v6, [Ljava/lang/String;

    .line 9077
    .restart local v3       #newArgs:[Ljava/lang/String;
    array-length v6, p3

    if-le v6, v8, :cond_9

    const/4 v6, 0x0

    array-length v7, p3

    sub-int/2addr v7, v8

    invoke-static {p3, v8, v3, v6, v7}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V

    goto :goto_9

    .line 9075
    .end local v3           #newArgs:[Ljava/lang/String;
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_2e
    const/4 v6, 0x0

    move-object v4, v6

    goto :goto_20

    .line 9083
    .end local v0           #componentName:Landroid/content/ComponentName;
    .restart local v3       #newArgs:[Ljava/lang/String;
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    :cond_31
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v6}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v6

    invoke-interface {v6}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .local v2, i$:Ljava/util/Iterator;
    :cond_3b
    :goto_3b
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v6

    if-eqz v6, :cond_e

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ServiceRecord;

    .line 9084
    .local v5, r1:Lcom/android/server/am/ServiceRecord;
    if-eqz v1, :cond_55

    iget-object v6, v5, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v6}, Landroid/content/ComponentName;->flattenToString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v6, v1}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v6

    if-eqz v6, :cond_3b

    .line 9086
    :cond_55
    invoke-direct {p0, p1, p2, v5, v3}, Lcom/android/server/am/ActivityManagerService;->dumpService(Ljava/io/FileDescriptor;Ljava/io/PrintWriter;Lcom/android/server/am/ServiceRecord;[Ljava/lang/String;)V

    goto :goto_3b
.end method

.method dumpServices(Ljava/io/PrintWriter;)V
    .registers 9
    .parameter "pw"

    .prologue
    const-string v5, "android.permission.DUMP"

    const-string v5, "  * "

    const-string v5, " "

    const-string v5, "    "

    .line 9199
    monitor-enter p0

    .line 9200
    :try_start_9
    const-string v5, "android.permission.DUMP"

    invoke-virtual {p0, v5}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v5

    if-eqz v5, :cond_47

    .line 9202
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: can\'t dump ActivityManager from from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " without permission "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "android.permission.DUMP"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9207
    monitor-exit p0

    .line 9269
    :goto_46
    return-void

    .line 9209
    :cond_47
    const-string v5, "Services in Current Activity Manager State:"

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9211
    const/4 v3, 0x0

    .line 9213
    .local v3, needSep:Z
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->size()I

    move-result v5

    if-lez v5, :cond_82

    .line 9214
    const-string v5, "  Active services:"

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9215
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .line 9216
    .local v2, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    :goto_64
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_81

    .line 9217
    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord;

    .line 9218
    .local v4, r:Lcom/android/server/am/ServiceRecord;
    const-string v5, "  * "

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9219
    const-string v5, "    "

    invoke-virtual {v4, p1, v5}, Lcom/android/server/am/ServiceRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_64

    .line 9268
    .end local v2           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    .end local v3           #needSep:Z
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :catchall_7e
    move-exception v5

    monitor-exit p0
    :try_end_80
    .catchall {:try_start_9 .. :try_end_80} :catchall_7e

    throw v5

    .line 9221
    .restart local v2       #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    .restart local v3       #needSep:Z
    :cond_81
    const/4 v3, 0x1

    .line 9224
    .end local v2           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    :cond_82
    :try_start_82
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_b8

    .line 9225
    if-eqz v3, :cond_91

    const-string v5, " "

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9226
    :cond_91
    const-string v5, "  Pending services:"

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9227
    const/4 v0, 0x0

    .local v0, i:I
    :goto_97
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v0, v5, :cond_b7

    .line 9228
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPendingServices:Ljava/util/ArrayList;

    invoke-virtual {v5, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord;

    .line 9229
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    const-string v5, "  * Pending "

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9230
    const-string v5, "    "

    invoke-virtual {v4, p1, v5}, Lcom/android/server/am/ServiceRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9227
    add-int/lit8 v0, v0, 0x1

    goto :goto_97

    .line 9232
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_b7
    const/4 v3, 0x1

    .line 9235
    .end local v0           #i:I
    :cond_b8
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_ee

    .line 9236
    if-eqz v3, :cond_c7

    const-string v5, " "

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9237
    :cond_c7
    const-string v5, "  Restarting services:"

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9238
    const/4 v0, 0x0

    .restart local v0       #i:I
    :goto_cd
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v0, v5, :cond_ed

    .line 9239
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord;

    .line 9240
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    const-string v5, "  * Restarting "

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9241
    const-string v5, "    "

    invoke-virtual {v4, p1, v5}, Lcom/android/server/am/ServiceRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9238
    add-int/lit8 v0, v0, 0x1

    goto :goto_cd

    .line 9243
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_ed
    const/4 v3, 0x1

    .line 9246
    .end local v0           #i:I
    :cond_ee
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-lez v5, :cond_124

    .line 9247
    if-eqz v3, :cond_fd

    const-string v5, " "

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9248
    :cond_fd
    const-string v5, "  Stopping services:"

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9249
    const/4 v0, 0x0

    .restart local v0       #i:I
    :goto_103
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v0, v5, :cond_123

    .line 9250
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v5, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ServiceRecord;

    .line 9251
    .restart local v4       #r:Lcom/android/server/am/ServiceRecord;
    const-string v5, "  * Stopping "

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9252
    const-string v5, "    "

    invoke-virtual {v4, p1, v5}, Lcom/android/server/am/ServiceRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    .line 9249
    add-int/lit8 v0, v0, 0x1

    goto :goto_103

    .line 9254
    .end local v4           #r:Lcom/android/server/am/ServiceRecord;
    :cond_123
    const/4 v3, 0x1

    .line 9257
    .end local v0           #i:I
    :cond_124
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->size()I

    move-result v5

    if-lez v5, :cond_15c

    .line 9258
    if-eqz v3, :cond_133

    const-string v5, " "

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9259
    :cond_133
    const-string v5, "  Connection bindings to services:"

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    .line 9260
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .line 9262
    .local v1, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :goto_142
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_15c

    .line 9263
    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ConnectionRecord;

    .line 9264
    .local v4, r:Lcom/android/server/am/ConnectionRecord;
    const-string v5, "  * "

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v4}, Ljava/io/PrintWriter;->println(Ljava/lang/Object;)V

    .line 9265
    const-string v5, "    "

    invoke-virtual {v4, p1, v5}, Lcom/android/server/am/ConnectionRecord;->dump(Ljava/io/PrintWriter;Ljava/lang/String;)V

    goto :goto_142

    .line 9268
    .end local v1           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    .end local v4           #r:Lcom/android/server/am/ConnectionRecord;
    :cond_15c
    monitor-exit p0
    :try_end_15d
    .catchall {:try_start_82 .. :try_end_15d} :catchall_7e

    goto/16 :goto_46
.end method

.method enableScreenAfterBoot()V
    .registers 2

    .prologue
    .line 5367
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v0}, Lcom/android/server/WindowManagerService;->enableScreenAfterBoot()V

    .line 5368
    return-void
.end method

.method enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V
    .registers 6
    .parameter "permission"
    .parameter "func"

    .prologue
    .line 6041
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v1

    if-nez v1, :cond_7

    .line 6043
    return-void

    .line 6046
    :cond_7
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Permission Denial: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " from pid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ", uid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " requires "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 6050
    .local v0, msg:Ljava/lang/String;
    const-string v1, "ActivityManager"

    invoke-static {v1, v0}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6051
    new-instance v1, Ljava/lang/SecurityException;

    invoke-direct {v1, v0}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1
.end method

.method final ensureScreenEnabled()V
    .registers 5

    .prologue
    const/4 v2, 0x1

    .line 5518
    monitor-enter p0

    .line 5519
    :try_start_2
    iget-boolean v1, p0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    if-nez v1, :cond_1a

    move v0, v2

    .line 5520
    .local v0, enableScreen:Z
    :goto_7
    const/4 v1, 0x1

    iput-boolean v1, p0, Lcom/android/server/am/ActivityManagerService;->mBooted:Z

    .line 5521
    monitor-exit p0
    :try_end_b
    .catchall {:try_start_2 .. :try_end_b} :catchall_1d

    .line 5523
    if-eqz v0, :cond_19

    .line 5524
    const/16 v1, 0xbea

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v2

    invoke-static {v1, v2, v3}, Landroid/util/EventLog;->writeEvent(IJ)I

    .line 5526
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->enableScreenAfterBoot()V

    .line 5528
    :cond_19
    return-void

    .line 5519
    .end local v0           #enableScreen:Z
    :cond_1a
    const/4 v1, 0x0

    move v0, v1

    goto :goto_7

    .line 5521
    :catchall_1d
    move-exception v1

    :try_start_1e
    monitor-exit p0
    :try_end_1f
    .catchall {:try_start_1e .. :try_end_1f} :catchall_1d

    throw v1
.end method

.method public final enterSafeMode()V
    .registers 6

    .prologue
    .line 8037
    monitor-enter p0

    .line 8040
    :try_start_1
    iget-boolean v2, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z
    :try_end_3
    .catchall {:try_start_1 .. :try_end_3} :catchall_4a

    if-nez v2, :cond_48

    .line 8042
    :try_start_5
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v2

    invoke-interface {v2}, Landroid/content/pm/IPackageManager;->enterSafeMode()V
    :try_end_c
    .catchall {:try_start_5 .. :try_end_c} :catchall_4a
    .catch Landroid/os/RemoteException; {:try_start_5 .. :try_end_c} :catch_4d

    .line 8046
    :goto_c
    :try_start_c
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-static {v2}, Landroid/view/LayoutInflater;->from(Landroid/content/Context;)Landroid/view/LayoutInflater;

    move-result-object v2

    const v3, 0x109004b

    const/4 v4, 0x0

    invoke-virtual {v2, v3, v4}, Landroid/view/LayoutInflater;->inflate(ILandroid/view/ViewGroup;)Landroid/view/View;

    move-result-object v1

    .line 8048
    .local v1, v:Landroid/view/View;
    new-instance v0, Landroid/view/WindowManager$LayoutParams;

    invoke-direct {v0}, Landroid/view/WindowManager$LayoutParams;-><init>()V

    .line 8049
    .local v0, lp:Landroid/view/WindowManager$LayoutParams;
    const/16 v2, 0x7d6

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->type:I

    .line 8050
    const/4 v2, -0x2

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->width:I

    .line 8051
    const/4 v2, -0x2

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->height:I

    .line 8052
    const/16 v2, 0x53

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->gravity:I

    .line 8053
    invoke-virtual {v1}, Landroid/view/View;->getBackground()Landroid/graphics/drawable/Drawable;

    move-result-object v2

    invoke-virtual {v2}, Landroid/graphics/drawable/Drawable;->getOpacity()I

    move-result v2

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->format:I

    .line 8054
    const/16 v2, 0x18

    iput v2, v0, Landroid/view/WindowManager$LayoutParams;->flags:I

    .line 8056
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    const-string v3, "window"

    invoke-virtual {v2, v3}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/view/WindowManager;

    invoke-interface {v2, v1, v0}, Landroid/view/WindowManager;->addView(Landroid/view/View;Landroid/view/ViewGroup$LayoutParams;)V

    .line 8059
    .end local v0           #lp:Landroid/view/WindowManager$LayoutParams;
    .end local v1           #v:Landroid/view/View;
    :cond_48
    monitor-exit p0

    .line 8060
    return-void

    .line 8059
    :catchall_4a
    move-exception v2

    monitor-exit p0
    :try_end_4c
    .catchall {:try_start_c .. :try_end_4c} :catchall_4a

    throw v2

    .line 8043
    :catch_4d
    move-exception v2

    goto :goto_c
.end method

.method public final finishActivity(Landroid/os/IBinder;ILandroid/content/Intent;)Z
    .registers 13
    .parameter "token"
    .parameter "resultCode"
    .parameter "resultData"

    .prologue
    const/4 v8, 0x0

    .line 4090
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->checkScreenIdle()V

    .line 4092
    if-eqz p3, :cond_15

    invoke-virtual {p3}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v6

    const/4 v7, 0x1

    if-ne v6, v7, :cond_15

    .line 4093
    new-instance v6, Ljava/lang/IllegalArgumentException;

    const-string v7, "File descriptors passed in Intent"

    invoke-direct {v6, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 4096
    :cond_15
    monitor-enter p0

    .line 4097
    :try_start_16
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    if-eqz v6, :cond_38

    .line 4099
    const/4 v6, 0x0

    invoke-direct {p0, p1, v6}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Landroid/os/IBinder;I)Lcom/android/server/am/HistoryRecord;
    :try_end_1e
    .catchall {:try_start_16 .. :try_end_1e} :catchall_35

    move-result-object v1

    .line 4100
    .local v1, next:Lcom/android/server/am/HistoryRecord;
    if-eqz v1, :cond_38

    .line 4102
    const/4 v5, 0x1

    .line 4104
    .local v5, resumeOK:Z
    :try_start_22
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    iget-object v7, v1, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    invoke-interface {v6, v7}, Landroid/app/IActivityController;->activityResuming(Ljava/lang/String;)Z
    :try_end_29
    .catchall {:try_start_22 .. :try_end_29} :catchall_35
    .catch Landroid/os/RemoteException; {:try_start_22 .. :try_end_29} :catch_2f

    move-result v5

    .line 4109
    :goto_2a
    if-nez v5, :cond_38

    .line 4110
    :try_start_2c
    monitor-exit p0

    move v6, v8

    .line 4118
    .end local v1           #next:Lcom/android/server/am/HistoryRecord;
    .end local v5           #resumeOK:Z
    :goto_2e
    return v6

    .line 4105
    .restart local v1       #next:Lcom/android/server/am/HistoryRecord;
    .restart local v5       #resumeOK:Z
    :catch_2f
    move-exception v6

    move-object v0, v6

    .line 4106
    .local v0, e:Landroid/os/RemoteException;
    const/4 v6, 0x0

    iput-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    goto :goto_2a

    .line 4119
    .end local v0           #e:Landroid/os/RemoteException;
    .end local v1           #next:Lcom/android/server/am/HistoryRecord;
    .end local v5           #resumeOK:Z
    :catchall_35
    move-exception v6

    monitor-exit p0
    :try_end_37
    .catchall {:try_start_2c .. :try_end_37} :catchall_35

    throw v6

    .line 4114
    :cond_38
    :try_start_38
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 4115
    .local v2, origId:J
    const-string v6, "app-request"

    invoke-direct {p0, p1, p2, p3, v6}, Lcom/android/server/am/ActivityManagerService;->requestFinishActivityLocked(Landroid/os/IBinder;ILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v4

    .line 4117
    .local v4, res:Z
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4118
    monitor-exit p0
    :try_end_46
    .catchall {:try_start_38 .. :try_end_46} :catchall_35

    move v6, v4

    goto :goto_2e
.end method

.method public finishInstrumentation(Landroid/app/IApplicationThread;ILandroid/os/Bundle;)V
    .registers 10
    .parameter "target"
    .parameter "resultCode"
    .parameter "results"

    .prologue
    .line 12202
    if-eqz p3, :cond_10

    invoke-virtual {p3}, Landroid/os/Bundle;->hasFileDescriptors()Z

    move-result v3

    if-eqz v3, :cond_10

    .line 12203
    new-instance v3, Ljava/lang/IllegalArgumentException;

    const-string v4, "File descriptors passed in Intent"

    invoke-direct {v3, v4}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 12206
    :cond_10
    monitor-enter p0

    .line 12207
    :try_start_11
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 12208
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    if-nez v0, :cond_31

    .line 12209
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "finishInstrumentation: no app for "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 12210
    monitor-exit p0

    .line 12216
    :goto_30
    return-void

    .line 12212
    :cond_31
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 12213
    .local v1, origId:J
    invoke-virtual {p0, v0, p2, p3}, Lcom/android/server/am/ActivityManagerService;->finishInstrumentationLocked(Lcom/android/server/am/ProcessRecord;ILandroid/os/Bundle;)V

    .line 12214
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 12215
    monitor-exit p0

    goto :goto_30

    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    .end local v1           #origId:J
    :catchall_3d
    move-exception v3

    monitor-exit p0
    :try_end_3f
    .catchall {:try_start_11 .. :try_end_3f} :catchall_3d

    throw v3
.end method

.method finishInstrumentationLocked(Lcom/android/server/am/ProcessRecord;ILandroid/os/Bundle;)V
    .registers 7
    .parameter "app"
    .parameter "resultCode"
    .parameter "results"

    .prologue
    const/4 v2, 0x0

    .line 12180
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    if-eqz v0, :cond_c

    .line 12183
    :try_start_5
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    invoke-interface {v0, v1, p2, p3}, Landroid/app/IInstrumentationWatcher;->instrumentationFinished(Landroid/content/ComponentName;ILandroid/os/Bundle;)V
    :try_end_c
    .catch Landroid/os/RemoteException; {:try_start_5 .. :try_end_c} :catch_1e

    .line 12190
    :cond_c
    :goto_c
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    .line 12191
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    .line 12192
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    .line 12193
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationProfileFile:Ljava/lang/String;

    .line 12194
    iput-object v2, p1, Lcom/android/server/am/ProcessRecord;->instrumentationArguments:Landroid/os/Bundle;

    .line 12196
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    const/4 v1, -0x1

    const/4 v2, 0x0

    invoke-direct {p0, v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->uninstallPackageLocked(Ljava/lang/String;IZ)V

    .line 12197
    return-void

    .line 12187
    :catch_1e
    move-exception v0

    goto :goto_c
.end method

.method public finishOtherInstances(Landroid/os/IBinder;Landroid/content/ComponentName;)V
    .registers 13
    .parameter "token"
    .parameter "className"

    .prologue
    .line 7267
    monitor-enter p0

    .line 7268
    :try_start_1
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v8

    .line 7270
    .local v8, origId:J
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v6

    .line 7271
    .local v6, N:I
    const/4 v7, 0x0

    .line 7272
    .local v7, lastTask:Lcom/android/server/am/TaskRecord;
    const/4 v2, 0x0

    .local v2, i:I
    :goto_d
    if-ge v2, v6, :cond_39

    .line 7273
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 7274
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->realActivity:Landroid/content/ComponentName;

    invoke-virtual {v0, p2}, Landroid/content/ComponentName;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_34

    if-eq v1, p1, :cond_34

    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v7, v0, :cond_34

    .line 7276
    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "others"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_34

    .line 7278
    add-int/lit8 v2, v2, -0x1

    .line 7279
    add-int/lit8 v6, v6, -0x1

    .line 7282
    :cond_34
    iget-object v7, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7272
    add-int/lit8 v2, v2, 0x1

    goto :goto_d

    .line 7285
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_39
    invoke-static {v8, v9}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7286
    monitor-exit p0

    .line 7287
    return-void

    .line 7286
    .end local v2           #i:I
    .end local v6           #N:I
    .end local v7           #lastTask:Lcom/android/server/am/TaskRecord;
    .end local v8           #origId:J
    :catchall_3e
    move-exception v0

    monitor-exit p0
    :try_end_40
    .catchall {:try_start_1 .. :try_end_40} :catchall_3e

    throw v0
.end method

.method public finishReceiver(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;Z)V
    .registers 16
    .parameter "who"
    .parameter "resultCode"
    .parameter "resultData"
    .parameter "resultExtras"
    .parameter "resultAbort"

    .prologue
    .line 11592
    if-eqz p4, :cond_10

    invoke-virtual {p4}, Landroid/os/Bundle;->hasFileDescriptors()Z

    move-result v0

    if-eqz v0, :cond_10

    .line 11593
    new-instance v0, Ljava/lang/IllegalArgumentException;

    const-string v1, "File descriptors passed in Bundle"

    invoke-direct {v0, v1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 11598
    :cond_10
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v8

    .line 11600
    .local v8, origId:J
    monitor-enter p0

    .line 11601
    const/4 v6, 0x1

    move-object v0, p0

    move-object v1, p1

    move v2, p2

    move-object v3, p3

    move-object v4, p4

    move v5, p5

    :try_start_1c
    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    move-result v7

    .line 11603
    .local v7, doNext:Z
    monitor-exit p0
    :try_end_21
    .catchall {:try_start_1c .. :try_end_21} :catchall_2e

    .line 11605
    if-eqz v7, :cond_27

    .line 11606
    const/4 v0, 0x0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->processNextBroadcast(Z)V

    .line 11608
    :cond_27
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->trimApplications()V

    .line 11610
    invoke-static {v8, v9}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 11611
    return-void

    .line 11603
    .end local v7           #doNext:Z
    :catchall_2e
    move-exception v0

    :try_start_2f
    monitor-exit p0
    :try_end_30
    .catchall {:try_start_2f .. :try_end_30} :catchall_2e

    throw v0
.end method

.method public final finishSubActivity(Landroid/os/IBinder;Ljava/lang/String;I)V
    .registers 14
    .parameter "token"
    .parameter "resultWho"
    .parameter "requestCode"

    .prologue
    .line 4150
    monitor-enter p0

    .line 4151
    :try_start_1
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v6

    .line 4152
    .local v6, index:I
    if-gez v6, :cond_9

    .line 4153
    monitor-exit p0

    .line 4173
    :goto_8
    return-void

    .line 4155
    :cond_9
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/am/HistoryRecord;

    .line 4157
    .local v9, self:Lcom/android/server/am/HistoryRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v7

    .line 4160
    .local v7, origId:J
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    const/4 v3, 0x1

    sub-int v2, v0, v3

    .local v2, i:I
    :goto_1e
    if-ltz v2, :cond_4d

    .line 4161
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 4162
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    if-ne v0, v9, :cond_4a

    iget v0, v1, Lcom/android/server/am/HistoryRecord;->requestCode:I

    if-ne v0, p3, :cond_4a

    .line 4163
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    if-nez v0, :cond_36

    if-eqz p2, :cond_42

    :cond_36
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    if-eqz v0, :cond_4a

    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    invoke-virtual {v0, p2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_4a

    .line 4165
    :cond_42
    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "request-sub"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 4160
    :cond_4a
    add-int/lit8 v2, v2, -0x1

    goto :goto_1e

    .line 4171
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_4d
    invoke-static {v7, v8}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4172
    monitor-exit p0

    goto :goto_8

    .end local v2           #i:I
    .end local v6           #index:I
    .end local v7           #origId:J
    .end local v9           #self:Lcom/android/server/am/HistoryRecord;
    :catchall_52
    move-exception v0

    monitor-exit p0
    :try_end_54
    .catchall {:try_start_1 .. :try_end_54} :catchall_52

    throw v0
.end method

.method foregroundTokenDied(Lcom/android/server/am/ActivityManagerService$ForegroundToken;)V
    .registers 7
    .parameter "token"

    .prologue
    .line 5805
    monitor-enter p0

    .line 5806
    :try_start_1
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v2
    :try_end_4
    .catchall {:try_start_1 .. :try_end_4} :catchall_29

    .line 5807
    :try_start_4
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    iget v4, p1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->pid:I

    invoke-virtual {v3, v4}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ActivityManagerService$ForegroundToken;

    .line 5809
    .local v0, cur:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    if-eq v0, p1, :cond_13

    .line 5810
    monitor-exit v2
    :try_end_11
    .catchall {:try_start_4 .. :try_end_11} :catchall_38

    :try_start_11
    monitor-exit p0
    :try_end_12
    .catchall {:try_start_11 .. :try_end_12} :catchall_29

    .line 5822
    :goto_12
    return-void

    .line 5812
    :cond_13
    :try_start_13
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    iget v4, p1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->pid:I

    invoke-virtual {v3, v4}, Landroid/util/SparseArray;->remove(I)V

    .line 5813
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    iget v4, p1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->pid:I

    invoke-virtual {v3, v4}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 5814
    .local v1, pr:Lcom/android/server/am/ProcessRecord;
    if-nez v1, :cond_2c

    .line 5815
    monitor-exit v2
    :try_end_27
    .catchall {:try_start_13 .. :try_end_27} :catchall_38

    :try_start_27
    monitor-exit p0

    goto :goto_12

    .line 5821
    .end local v0           #cur:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .end local v1           #pr:Lcom/android/server/am/ProcessRecord;
    :catchall_29
    move-exception v2

    monitor-exit p0
    :try_end_2b
    .catchall {:try_start_27 .. :try_end_2b} :catchall_29

    throw v2

    .line 5817
    .restart local v0       #cur:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .restart local v1       #pr:Lcom/android/server/am/ProcessRecord;
    :cond_2c
    const/4 v3, 0x0

    :try_start_2d
    iput-object v3, v1, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 5818
    const/4 v3, 0x0

    iput-boolean v3, v1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 5819
    monitor-exit v2
    :try_end_33
    .catchall {:try_start_2d .. :try_end_33} :catchall_38

    .line 5820
    :try_start_33
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 5821
    monitor-exit p0
    :try_end_37
    .catchall {:try_start_33 .. :try_end_37} :catchall_29

    goto :goto_12

    .line 5819
    .end local v0           #cur:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .end local v1           #pr:Lcom/android/server/am/ProcessRecord;
    :catchall_38
    move-exception v3

    :try_start_39
    monitor-exit v2
    :try_end_3a
    .catchall {:try_start_39 .. :try_end_3a} :catchall_38

    :try_start_3a
    throw v3
    :try_end_3b
    .catchall {:try_start_3a .. :try_end_3b} :catchall_29
.end method

.method public getActivityClassForToken(Landroid/os/IBinder;)Landroid/content/ComponentName;
    .registers 5
    .parameter "token"

    .prologue
    .line 5648
    monitor-enter p0

    .line 5649
    :try_start_1
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 5650
    .local v0, index:I
    if-ltz v0, :cond_17

    .line 5651
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 5652
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    monitor-exit p0

    .line 5654
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_16
    return-object v2

    :cond_17
    const/4 v2, 0x0

    monitor-exit p0

    goto :goto_16

    .line 5655
    .end local v0           #index:I
    :catchall_1a
    move-exception v2

    monitor-exit p0
    :try_end_1c
    .catchall {:try_start_1 .. :try_end_1c} :catchall_1a

    throw v2
.end method

.method public getCallingActivity(Landroid/os/IBinder;)Landroid/content/ComponentName;
    .registers 4
    .parameter "token"

    .prologue
    .line 5630
    monitor-enter p0

    .line 5631
    :try_start_1
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getCallingRecordLocked(Landroid/os/IBinder;)Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 5632
    .local v0, r:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_f

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v1}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v1

    :goto_d
    monitor-exit p0

    return-object v1

    :cond_f
    const/4 v1, 0x0

    goto :goto_d

    .line 5633
    .end local v0           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_11
    move-exception v1

    monitor-exit p0
    :try_end_13
    .catchall {:try_start_1 .. :try_end_13} :catchall_11

    throw v1
.end method

.method public getCallingPackage(Landroid/os/IBinder;)Ljava/lang/String;
    .registers 4
    .parameter "token"

    .prologue
    .line 5623
    monitor-enter p0

    .line 5624
    :try_start_1
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getCallingRecordLocked(Landroid/os/IBinder;)Lcom/android/server/am/HistoryRecord;

    move-result-object v0

    .line 5625
    .local v0, r:Lcom/android/server/am/HistoryRecord;
    if-eqz v0, :cond_11

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_11

    iget-object v1, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v1, v1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    :goto_f
    monitor-exit p0

    return-object v1

    :cond_11
    const/4 v1, 0x0

    goto :goto_f

    .line 5626
    .end local v0           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_13
    move-exception v1

    monitor-exit p0
    :try_end_15
    .catchall {:try_start_1 .. :try_end_15} :catchall_13

    throw v1
.end method

.method public getConfiguration()Landroid/content/res/Configuration;
    .registers 3

    .prologue
    .line 12243
    monitor-enter p0

    .line 12244
    :try_start_1
    new-instance v0, Landroid/content/res/Configuration;

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    invoke-direct {v0, v1}, Landroid/content/res/Configuration;-><init>(Landroid/content/res/Configuration;)V

    .line 12245
    .local v0, ci:Landroid/content/res/Configuration;
    monitor-exit p0

    .line 12246
    return-object v0

    .line 12245
    .end local v0           #ci:Landroid/content/res/Configuration;
    :catchall_a
    move-exception v1

    monitor-exit p0
    :try_end_c
    .catchall {:try_start_1 .. :try_end_c} :catchall_a

    throw v1
.end method

.method public final getContentProvider(Landroid/app/IApplicationThread;Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;
    .registers 6
    .parameter "caller"
    .parameter "name"

    .prologue
    .line 7630
    if-nez p1, :cond_20

    .line 7631
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "null IApplicationThread when getting content provider "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 7633
    .local v0, msg:Ljava/lang/String;
    const-string v1, "ActivityManager"

    invoke-static {v1, v0}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 7634
    new-instance v1, Ljava/lang/SecurityException;

    invoke-direct {v1, v0}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 7637
    .end local v0           #msg:Ljava/lang/String;
    :cond_20
    invoke-direct {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->getContentProviderImpl(Landroid/app/IApplicationThread;Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;

    move-result-object v1

    return-object v1
.end method

.method public getDeviceConfigurationInfo()Landroid/content/pm/ConfigurationInfo;
    .registers 4

    .prologue
    .line 12223
    new-instance v0, Landroid/content/pm/ConfigurationInfo;

    invoke-direct {v0}, Landroid/content/pm/ConfigurationInfo;-><init>()V

    .line 12224
    .local v0, config:Landroid/content/pm/ConfigurationInfo;
    monitor-enter p0

    .line 12225
    :try_start_6
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->touchscreen:I

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqTouchScreen:I

    .line 12226
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->keyboard:I

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqKeyboardType:I

    .line 12227
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->navigation:I

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqNavigation:I

    .line 12228
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->navigation:I

    const/4 v2, 0x2

    if-eq v1, v2, :cond_26

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->navigation:I

    const/4 v2, 0x3

    if-ne v1, v2, :cond_2c

    .line 12230
    :cond_26
    iget v1, v0, Landroid/content/pm/ConfigurationInfo;->reqInputFeatures:I

    or-int/lit8 v1, v1, 0x2

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqInputFeatures:I

    .line 12232
    :cond_2c
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->keyboard:I

    if-eqz v1, :cond_3f

    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget v1, v1, Landroid/content/res/Configuration;->keyboard:I

    const/4 v2, 0x1

    if-eq v1, v2, :cond_3f

    .line 12234
    iget v1, v0, Landroid/content/pm/ConfigurationInfo;->reqInputFeatures:I

    or-int/lit8 v1, v1, 0x1

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqInputFeatures:I

    .line 12236
    :cond_3f
    iget v1, p0, Lcom/android/server/am/ActivityManagerService;->GL_ES_VERSION:I

    iput v1, v0, Landroid/content/pm/ConfigurationInfo;->reqGlEsVersion:I

    .line 12237
    monitor-exit p0

    .line 12238
    return-object v0

    .line 12237
    :catchall_45
    move-exception v1

    monitor-exit p0
    :try_end_47
    .catchall {:try_start_6 .. :try_end_47} :catchall_45

    throw v1
.end method

.method public getIntentSender(ILjava/lang/String;Landroid/os/IBinder;Ljava/lang/String;ILandroid/content/Intent;Ljava/lang/String;I)Landroid/content/IIntentSender;
    .registers 32
    .parameter "type"
    .parameter "packageName"
    .parameter "token"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "flags"

    .prologue
    .line 5673
    if-eqz p6, :cond_11

    invoke-virtual/range {p6 .. p6}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v5

    const/4 v6, 0x1

    if-ne v5, v6, :cond_11

    .line 5674
    new-instance v5, Ljava/lang/IllegalArgumentException;

    const-string v6, "File descriptors passed in Intent"

    invoke-direct {v5, v6}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 5677
    :cond_11
    monitor-enter p0

    .line 5678
    :try_start_12
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I
    :try_end_15
    .catchall {:try_start_12 .. :try_end_15} :catchall_94

    move-result v13

    .line 5680
    .local v13, callingUid:I
    if-eqz v13, :cond_97

    const/16 v5, 0x3e8

    if-eq v13, v5, :cond_97

    :try_start_1c
    invoke-static {}, Landroid/os/Process;->supportsProcesses()Z

    move-result v5

    if-eqz v5, :cond_97

    .line 5682
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-interface {v0, v1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I

    move-result v21

    .line 5684
    .local v21, uid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    move/from16 v0, v21

    move v1, v5

    if-eq v0, v1, :cond_97

    .line 5685
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: getIntentSender() from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", (need uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move/from16 v1, v21

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ")"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " is not allowed to send as package "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    .line 5690
    .local v17, msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    move-object v0, v5

    move-object/from16 v1, v17

    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5691
    new-instance v5, Ljava/lang/SecurityException;

    move-object v0, v5

    move-object/from16 v1, v17

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5
    :try_end_8c
    .catchall {:try_start_1c .. :try_end_8c} :catchall_94
    .catch Landroid/os/RemoteException; {:try_start_1c .. :try_end_8c} :catch_8c

    .line 5694
    .end local v17           #msg:Ljava/lang/String;
    .end local v21           #uid:I
    :catch_8c
    move-exception v5

    move-object v15, v5

    .line 5695
    .local v15, e:Landroid/os/RemoteException;
    :try_start_8e
    new-instance v5, Ljava/lang/SecurityException;

    invoke-direct {v5, v15}, Ljava/lang/SecurityException;-><init>(Ljava/lang/Throwable;)V

    throw v5

    .line 5744
    .end local v13           #callingUid:I
    .end local v15           #e:Landroid/os/RemoteException;
    .end local p2
    :catchall_94
    move-exception v5

    monitor-exit p0
    :try_end_96
    .catchall {:try_start_8e .. :try_end_96} :catchall_94

    throw v5

    .line 5697
    .restart local v13       #callingUid:I
    .restart local p2
    :cond_97
    const/4 v7, 0x0

    .line 5698
    .local v7, activity:Lcom/android/server/am/HistoryRecord;
    const/4 v5, 0x3

    move/from16 v0, p1

    move v1, v5

    if-ne v0, v1, :cond_c0

    .line 5699
    :try_start_9e
    move-object/from16 v0, p0

    move-object/from16 v1, p3

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v16

    .line 5700
    .local v16, index:I
    if-gez v16, :cond_ab

    .line 5701
    const/4 v5, 0x0

    monitor-exit p0

    .line 5743
    .end local v16           #index:I
    .end local p2
    :goto_aa
    return-object v5

    .line 5703
    .restart local v16       #index:I
    .restart local p2
    :cond_ab
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v5, v0

    move-object v0, v5

    move/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    .end local v7           #activity:Lcom/android/server/am/HistoryRecord;
    check-cast v7, Lcom/android/server/am/HistoryRecord;

    .line 5704
    .restart local v7       #activity:Lcom/android/server/am/HistoryRecord;
    iget-boolean v5, v7, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v5, :cond_c0

    .line 5705
    const/4 v5, 0x0

    monitor-exit p0

    goto :goto_aa

    .line 5709
    .end local v16           #index:I
    :cond_c0
    const/high16 v5, 0x2000

    and-int v5, v5, p8

    if-eqz v5, :cond_11e

    const/4 v5, 0x1

    move/from16 v18, v5

    .line 5710
    .local v18, noCreate:Z
    :goto_c9
    const/high16 v5, 0x1000

    and-int v5, v5, p8

    if-eqz v5, :cond_122

    const/4 v5, 0x1

    move v14, v5

    .line 5711
    .local v14, cancelCurrent:Z
    :goto_d1
    const/high16 v5, 0x800

    and-int v5, v5, p8

    if-eqz v5, :cond_125

    const/4 v5, 0x1

    move/from16 v22, v5

    .line 5712
    .local v22, updateCurrent:Z
    :goto_da
    const v5, -0x38000001

    and-int p8, p8, v5

    .line 5715
    new-instance v4, Lcom/android/server/am/PendingIntentRecord$Key;

    move/from16 v5, p1

    move-object/from16 v6, p2

    move-object/from16 v8, p4

    move/from16 v9, p5

    move-object/from16 v10, p6

    move-object/from16 v11, p7

    move/from16 v12, p8

    invoke-direct/range {v4 .. v12}, Lcom/android/server/am/PendingIntentRecord$Key;-><init>(ILjava/lang/String;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;ILandroid/content/Intent;Ljava/lang/String;I)V

    .line 5719
    .local v4, key:Lcom/android/server/am/PendingIntentRecord$Key;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    move-object v5, v0

    invoke-virtual {v5, v4}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v20

    check-cast v20, Ljava/lang/ref/WeakReference;

    .line 5720
    .local v20, ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    if-eqz v20, :cond_129

    invoke-virtual/range {v20 .. v20}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object p2

    .end local p2
    check-cast p2, Lcom/android/server/am/PendingIntentRecord;

    move-object/from16 v19, p2

    .line 5721
    .local v19, rec:Lcom/android/server/am/PendingIntentRecord;
    :goto_107
    if-eqz v19, :cond_13b

    .line 5722
    if-nez v14, :cond_12d

    .line 5723
    if-eqz v22, :cond_11a

    .line 5724
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    move-object v5, v0

    iget-object v5, v5, Lcom/android/server/am/PendingIntentRecord$Key;->requestIntent:Landroid/content/Intent;

    move-object v0, v5

    move-object/from16 v1, p6

    invoke-virtual {v0, v1}, Landroid/content/Intent;->replaceExtras(Landroid/content/Intent;)Landroid/content/Intent;

    .line 5726
    :cond_11a
    monitor-exit p0

    move-object/from16 v5, v19

    goto :goto_aa

    .line 5709
    .end local v4           #key:Lcom/android/server/am/PendingIntentRecord$Key;
    .end local v14           #cancelCurrent:Z
    .end local v18           #noCreate:Z
    .end local v19           #rec:Lcom/android/server/am/PendingIntentRecord;
    .end local v20           #ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    .end local v22           #updateCurrent:Z
    .restart local p2
    :cond_11e
    const/4 v5, 0x0

    move/from16 v18, v5

    goto :goto_c9

    .line 5710
    .restart local v18       #noCreate:Z
    :cond_122
    const/4 v5, 0x0

    move v14, v5

    goto :goto_d1

    .line 5711
    .restart local v14       #cancelCurrent:Z
    :cond_125
    const/4 v5, 0x0

    move/from16 v22, v5

    goto :goto_da

    .line 5720
    .restart local v4       #key:Lcom/android/server/am/PendingIntentRecord$Key;
    .restart local v20       #ref:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Lcom/android/server/am/PendingIntentRecord;>;"
    .restart local v22       #updateCurrent:Z
    :cond_129
    const/4 v5, 0x0

    move-object/from16 v19, v5

    goto :goto_107

    .line 5728
    .end local p2
    .restart local v19       #rec:Lcom/android/server/am/PendingIntentRecord;
    :cond_12d
    const/4 v5, 0x1

    move v0, v5

    move-object/from16 v1, v19

    iput-boolean v0, v1, Lcom/android/server/am/PendingIntentRecord;->canceled:Z

    .line 5729
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    move-object v5, v0

    invoke-virtual {v5, v4}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 5731
    :cond_13b
    if-eqz v18, :cond_142

    .line 5732
    monitor-exit p0

    move-object/from16 v5, v19

    goto/16 :goto_aa

    .line 5734
    :cond_142
    new-instance v19, Lcom/android/server/am/PendingIntentRecord;

    .end local v19           #rec:Lcom/android/server/am/PendingIntentRecord;
    move-object/from16 v0, v19

    move-object/from16 v1, p0

    move-object v2, v4

    move v3, v13

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/PendingIntentRecord;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/PendingIntentRecord$Key;I)V

    .line 5735
    .restart local v19       #rec:Lcom/android/server/am/PendingIntentRecord;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mIntentSenderRecords:Ljava/util/HashMap;

    move-object v5, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord;->ref:Ljava/lang/ref/WeakReference;

    move-object v6, v0

    invoke-virtual {v5, v4, v6}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 5736
    const/4 v5, 0x3

    move/from16 v0, p1

    move v1, v5

    if-ne v0, v1, :cond_175

    .line 5737
    iget-object v5, v7, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    if-nez v5, :cond_16b

    .line 5738
    new-instance v5, Ljava/util/HashSet;

    invoke-direct {v5}, Ljava/util/HashSet;-><init>()V

    iput-object v5, v7, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    .line 5741
    :cond_16b
    iget-object v5, v7, Lcom/android/server/am/HistoryRecord;->pendingResults:Ljava/util/HashSet;

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/PendingIntentRecord;->ref:Ljava/lang/ref/WeakReference;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 5743
    :cond_175
    monitor-exit p0
    :try_end_176
    .catchall {:try_start_9e .. :try_end_176} :catchall_94

    move-object/from16 v5, v19

    goto/16 :goto_aa
.end method

.method public getMemoryInfo(Landroid/app/ActivityManager$MemoryInfo;)V
    .registers 7
    .parameter "outInfo"

    .prologue
    .line 6448
    invoke-static {}, Landroid/os/Process;->getFreeMemory()I

    move-result v0

    int-to-long v0, v0

    iput-wide v0, p1, Landroid/app/ActivityManager$MemoryInfo;->availMem:J

    .line 6449
    iget v0, p0, Lcom/android/server/am/ActivityManagerService;->HOME_APP_MEM:I

    int-to-long v0, v0

    iput-wide v0, p1, Landroid/app/ActivityManager$MemoryInfo;->threshold:J

    .line 6450
    iget-wide v0, p1, Landroid/app/ActivityManager$MemoryInfo;->availMem:J

    iget v2, p0, Lcom/android/server/am/ActivityManagerService;->HOME_APP_MEM:I

    iget v3, p0, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MEM:I

    iget v4, p0, Lcom/android/server/am/ActivityManagerService;->HOME_APP_MEM:I

    sub-int/2addr v3, v4

    div-int/lit8 v3, v3, 0x2

    add-int/2addr v2, v3

    int-to-long v2, v2

    cmp-long v0, v0, v2

    if-gez v0, :cond_21

    const/4 v0, 0x1

    :goto_1e
    iput-boolean v0, p1, Landroid/app/ActivityManager$MemoryInfo;->lowMemory:Z

    .line 6452
    return-void

    .line 6450
    :cond_21
    const/4 v0, 0x0

    goto :goto_1e
.end method

.method public getPackageForIntentSender(Landroid/content/IIntentSender;)Ljava/lang/String;
    .registers 6
    .parameter "pendingResult"

    .prologue
    const/4 v3, 0x0

    .line 5781
    instance-of v2, p1, Lcom/android/server/am/PendingIntentRecord;

    if-nez v2, :cond_7

    move-object v2, v3

    .line 5791
    :goto_6
    return-object v2

    .line 5784
    :cond_7
    monitor-enter p0

    .line 5786
    :try_start_8
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/PendingIntentRecord;

    move-object v1, v0

    .line 5787
    .local v1, res:Lcom/android/server/am/PendingIntentRecord;
    iget-object v2, v1, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v2, v2, Lcom/android/server/am/PendingIntentRecord$Key;->packageName:Ljava/lang/String;
    :try_end_10
    .catchall {:try_start_8 .. :try_end_10} :catchall_12
    .catch Ljava/lang/ClassCastException; {:try_start_8 .. :try_end_10} :catch_15

    :try_start_10
    monitor-exit p0

    goto :goto_6

    .line 5790
    .end local v1           #res:Lcom/android/server/am/PendingIntentRecord;
    :catchall_12
    move-exception v2

    monitor-exit p0
    :try_end_14
    .catchall {:try_start_10 .. :try_end_14} :catchall_12

    throw v2

    .line 5788
    :catch_15
    move-exception v2

    .line 5790
    :try_start_16
    monitor-exit p0
    :try_end_17
    .catchall {:try_start_16 .. :try_end_17} :catchall_12

    move-object v2, v3

    .line 5791
    goto :goto_6
.end method

.method public getPackageForToken(Landroid/os/IBinder;)Ljava/lang/String;
    .registers 5
    .parameter "token"

    .prologue
    .line 5659
    monitor-enter p0

    .line 5660
    :try_start_1
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 5661
    .local v0, index:I
    if-ltz v0, :cond_13

    .line 5662
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 5663
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v2, v1, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    monitor-exit p0

    .line 5665
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :goto_12
    return-object v2

    :cond_13
    const/4 v2, 0x0

    monitor-exit p0

    goto :goto_12

    .line 5666
    .end local v0           #index:I
    :catchall_16
    move-exception v2

    monitor-exit p0
    :try_end_18
    .catchall {:try_start_1 .. :try_end_18} :catchall_16

    throw v2
.end method

.method public getProcessLimit()I
    .registers 2

    .prologue
    .line 5801
    iget v0, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    return v0
.end method

.method public getProcessesInErrorState()Ljava/util/List;
    .registers 10
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/List",
            "<",
            "Landroid/app/ActivityManager$ProcessErrorStateInfo;",
            ">;"
        }
    .end annotation

    .prologue
    .line 8760
    const/4 v2, 0x0

    .line 8762
    .local v2, errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    monitor-enter p0

    .line 8765
    :try_start_2
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I
    :try_end_7
    .catchall {:try_start_2 .. :try_end_7} :catchall_75

    move-result v0

    .line 8766
    .local v0, N:I
    const/4 v4, 0x0

    .local v4, i:I
    move-object v3, v2

    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .local v3, errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    :goto_a
    if-ge v4, v0, :cond_73

    .line 8767
    :try_start_c
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 8768
    .local v1, app:Lcom/android/server/am/ProcessRecord;
    iget-object v6, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v6, :cond_71

    iget-boolean v6, v1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-nez v6, :cond_20

    iget-boolean v6, v1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-eqz v6, :cond_71

    .line 8771
    :cond_20
    const/4 v5, 0x0

    .line 8772
    .local v5, report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    iget-boolean v6, v1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-eqz v6, :cond_38

    .line 8773
    iget-object v5, v1, Lcom/android/server/am/ProcessRecord;->crashingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 8778
    :cond_27
    :goto_27
    if-eqz v5, :cond_3f

    .line 8779
    if-nez v3, :cond_7b

    .line 8780
    new-instance v2, Ljava/util/ArrayList;

    const/4 v6, 0x1

    invoke-direct {v2, v6}, Ljava/util/ArrayList;-><init>(I)V
    :try_end_31
    .catchall {:try_start_c .. :try_end_31} :catchall_78

    .line 8782
    .end local v3           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v2       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    :goto_31
    :try_start_31
    invoke-interface {v2, v5}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_34
    .catchall {:try_start_31 .. :try_end_34} :catchall_75

    .line 8766
    .end local v5           #report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    :goto_34
    add-int/lit8 v4, v4, 0x1

    move-object v3, v2

    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v3       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    goto :goto_a

    .line 8774
    .restart local v5       #report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    :cond_38
    :try_start_38
    iget-boolean v6, v1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-eqz v6, :cond_27

    .line 8775
    iget-object v5, v1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    goto :goto_27

    .line 8784
    :cond_3f
    const-string v6, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Missing app error report, app = "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, v1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " crashing = "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-boolean v8, v1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " notResponding = "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-boolean v8, v1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .end local v5           #report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    :cond_71
    move-object v2, v3

    .end local v3           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v2       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    goto :goto_34

    .line 8790
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v3       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    :cond_73
    monitor-exit p0
    :try_end_74
    .catchall {:try_start_38 .. :try_end_74} :catchall_78

    .line 8792
    return-object v3

    .line 8790
    .end local v0           #N:I
    .end local v3           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .end local v4           #i:I
    .restart local v2       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    :catchall_75
    move-exception v6

    :goto_76
    :try_start_76
    monitor-exit p0
    :try_end_77
    .catchall {:try_start_76 .. :try_end_77} :catchall_75

    throw v6

    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v0       #N:I
    .restart local v3       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v4       #i:I
    :catchall_78
    move-exception v6

    move-object v2, v3

    .end local v3           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v2       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    goto :goto_76

    .end local v2           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v1       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v3       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v5       #report:Landroid/app/ActivityManager$ProcessErrorStateInfo;
    :cond_7b
    move-object v2, v3

    .end local v3           #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    .restart local v2       #errList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$ProcessErrorStateInfo;>;"
    goto :goto_31
.end method

.method public getRecentTasks(II)Ljava/util/List;
    .registers 10
    .parameter "maxNum"
    .parameter "flags"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(II)",
            "Ljava/util/List",
            "<",
            "Landroid/app/ActivityManager$RecentTaskInfo;",
            ">;"
        }
    .end annotation

    .prologue
    .line 6598
    monitor-enter p0

    .line 6599
    :try_start_1
    const-string v5, "android.permission.GET_TASKS"

    const-string v6, "getRecentTasks()"

    invoke-virtual {p0, v5, v6}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 6602
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 6603
    .local v0, N:I
    new-instance v2, Ljava/util/ArrayList;

    if-ge p1, v0, :cond_5c

    move v5, p1

    :goto_13
    invoke-direct {v2, v5}, Ljava/util/ArrayList;-><init>(I)V

    .line 6606
    .local v2, res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RecentTaskInfo;>;"
    const/4 v1, 0x0

    .local v1, i:I
    :goto_17
    if-ge v1, v0, :cond_63

    if-lez p1, :cond_63

    .line 6607
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/TaskRecord;

    .line 6608
    .local v4, tr:Lcom/android/server/am/TaskRecord;
    and-int/lit8 v5, p2, 0x1

    if-nez v5, :cond_36

    iget-object v5, v4, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-eqz v5, :cond_36

    iget-object v5, v4, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v5}, Landroid/content/Intent;->getFlags()I

    move-result v5

    const/high16 v6, 0x80

    and-int/2addr v5, v6

    if-nez v5, :cond_59

    .line 6612
    :cond_36
    new-instance v3, Landroid/app/ActivityManager$RecentTaskInfo;

    invoke-direct {v3}, Landroid/app/ActivityManager$RecentTaskInfo;-><init>()V

    .line 6614
    .local v3, rti:Landroid/app/ActivityManager$RecentTaskInfo;
    iget v5, v4, Lcom/android/server/am/TaskRecord;->numActivities:I

    if-lez v5, :cond_5e

    iget v5, v4, Lcom/android/server/am/TaskRecord;->taskId:I

    :goto_41
    iput v5, v3, Landroid/app/ActivityManager$RecentTaskInfo;->id:I

    .line 6615
    new-instance v5, Landroid/content/Intent;

    iget-object v6, v4, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    if-eqz v6, :cond_60

    iget-object v6, v4, Lcom/android/server/am/TaskRecord;->intent:Landroid/content/Intent;

    :goto_4b
    invoke-direct {v5, v6}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    iput-object v5, v3, Landroid/app/ActivityManager$RecentTaskInfo;->baseIntent:Landroid/content/Intent;

    .line 6617
    iget-object v5, v4, Lcom/android/server/am/TaskRecord;->origActivity:Landroid/content/ComponentName;

    iput-object v5, v3, Landroid/app/ActivityManager$RecentTaskInfo;->origActivity:Landroid/content/ComponentName;

    .line 6618
    invoke-virtual {v2, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 6619
    add-int/lit8 p1, p1, -0x1

    .line 6606
    .end local v3           #rti:Landroid/app/ActivityManager$RecentTaskInfo;
    :cond_59
    add-int/lit8 v1, v1, 0x1

    goto :goto_17

    .end local v1           #i:I
    .end local v2           #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RecentTaskInfo;>;"
    .end local v4           #tr:Lcom/android/server/am/TaskRecord;
    :cond_5c
    move v5, v0

    .line 6603
    goto :goto_13

    .line 6614
    .restart local v1       #i:I
    .restart local v2       #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RecentTaskInfo;>;"
    .restart local v3       #rti:Landroid/app/ActivityManager$RecentTaskInfo;
    .restart local v4       #tr:Lcom/android/server/am/TaskRecord;
    :cond_5e
    const/4 v5, -0x1

    goto :goto_41

    .line 6615
    :cond_60
    iget-object v6, v4, Lcom/android/server/am/TaskRecord;->affinityIntent:Landroid/content/Intent;

    goto :goto_4b

    .line 6622
    .end local v3           #rti:Landroid/app/ActivityManager$RecentTaskInfo;
    .end local v4           #tr:Lcom/android/server/am/TaskRecord;
    :cond_63
    monitor-exit p0

    return-object v2

    .line 6623
    .end local v0           #N:I
    .end local v1           #i:I
    .end local v2           #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RecentTaskInfo;>;"
    :catchall_65
    move-exception v5

    monitor-exit p0
    :try_end_67
    .catchall {:try_start_1 .. :try_end_67} :catchall_65

    throw v5
.end method

.method public getRequestedOrientation(Landroid/os/IBinder;)I
    .registers 5
    .parameter "token"

    .prologue
    .line 3826
    monitor-enter p0

    .line 3827
    :try_start_1
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v0

    .line 3828
    .local v0, index:I
    if-gez v0, :cond_a

    .line 3829
    const/4 v2, -0x1

    monitor-exit p0

    .line 3832
    :goto_9
    return v2

    .line 3831
    :cond_a
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 3832
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v2, v1}, Lcom/android/server/WindowManagerService;->getAppOrientation(Landroid/view/IApplicationToken;)I

    move-result v2

    monitor-exit p0

    goto :goto_9

    .line 3833
    .end local v0           #index:I
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_1a
    move-exception v2

    monitor-exit p0
    :try_end_1c
    .catchall {:try_start_1 .. :try_end_1c} :catchall_1a

    throw v2
.end method

.method public getRunningAppProcesses()Ljava/util/List;
    .registers 11
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/List",
            "<",
            "Landroid/app/ActivityManager$RunningAppProcessInfo;",
            ">;"
        }
    .end annotation

    .prologue
    .line 8797
    const/4 v5, 0x0

    .line 8798
    .local v5, runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    monitor-enter p0

    .line 8800
    :try_start_2
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I
    :try_end_7
    .catchall {:try_start_2 .. :try_end_7} :catchall_7f

    move-result v0

    .line 8801
    .local v0, N:I
    const/4 v4, 0x0

    .local v4, i:I
    move-object v6, v5

    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .local v6, runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :goto_a
    if-ge v4, v0, :cond_7d

    .line 8802
    :try_start_c
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v7, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 8803
    .local v2, app:Lcom/android/server/am/ProcessRecord;
    iget-object v7, v2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v7, :cond_83

    iget-boolean v7, v2, Lcom/android/server/am/ProcessRecord;->crashing:Z

    if-nez v7, :cond_83

    iget-boolean v7, v2, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    if-nez v7, :cond_83

    .line 8805
    new-instance v3, Landroid/app/ActivityManager$RunningAppProcessInfo;

    iget-object v7, v2, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    iget v8, v2, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v2}, Lcom/android/server/am/ProcessRecord;->getPackageList()[Ljava/lang/String;

    move-result-object v9

    invoke-direct {v3, v7, v8, v9}, Landroid/app/ActivityManager$RunningAppProcessInfo;-><init>(Ljava/lang/String;I[Ljava/lang/String;)V

    .line 8808
    .local v3, currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    iget v1, v2, Lcom/android/server/am/ProcessRecord;->curAdj:I

    .line 8809
    .local v1, adj:I
    sget v7, Lcom/android/server/am/ActivityManagerService;->CONTENT_PROVIDER_ADJ:I

    if-lt v1, v7, :cond_45

    .line 8810
    const/16 v7, 0x1f4

    iput v7, v3, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    .line 8826
    :goto_37
    if-nez v6, :cond_81

    .line 8827
    new-instance v5, Ljava/util/ArrayList;

    invoke-direct {v5}, Ljava/util/ArrayList;-><init>()V
    :try_end_3e
    .catchall {:try_start_c .. :try_end_3e} :catchall_56

    .line 8829
    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :goto_3e
    :try_start_3e
    invoke-interface {v5, v3}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_41
    .catchall {:try_start_3e .. :try_end_41} :catchall_7f

    .line 8801
    .end local v1           #adj:I
    .end local v3           #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    :goto_41
    add-int/lit8 v4, v4, 0x1

    move-object v6, v5

    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v6       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    goto :goto_a

    .line 8811
    .restart local v1       #adj:I
    .restart local v3       #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    :cond_45
    :try_start_45
    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-lt v1, v7, :cond_5a

    .line 8812
    const/16 v7, 0x190

    iput v7, v3, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    .line 8813
    sget v7, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    sub-int v7, v1, v7

    add-int/lit8 v7, v7, 0x1

    iput v7, v3, Landroid/app/ActivityManager$RunningAppProcessInfo;->lru:I
    :try_end_55
    .catchall {:try_start_45 .. :try_end_55} :catchall_56

    goto :goto_37

    .line 8832
    .end local v1           #adj:I
    .end local v2           #app:Lcom/android/server/am/ProcessRecord;
    .end local v3           #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    :catchall_56
    move-exception v7

    move-object v5, v6

    .end local v0           #N:I
    .end local v4           #i:I
    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :goto_58
    :try_start_58
    monitor-exit p0
    :try_end_59
    .catchall {:try_start_58 .. :try_end_59} :catchall_7f

    throw v7

    .line 8814
    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v0       #N:I
    .restart local v1       #adj:I
    .restart local v2       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v3       #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    .restart local v4       #i:I
    .restart local v6       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :cond_5a
    :try_start_5a
    iget v7, p0, Lcom/android/server/am/ActivityManagerService;->HOME_APP_ADJ:I

    if-lt v1, v7, :cond_66

    .line 8815
    const/16 v7, 0x190

    iput v7, v3, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    .line 8816
    const/4 v7, 0x0

    iput v7, v3, Landroid/app/ActivityManager$RunningAppProcessInfo;->lru:I

    goto :goto_37

    .line 8817
    :cond_66
    iget v7, p0, Lcom/android/server/am/ActivityManagerService;->SECONDARY_SERVER_ADJ:I

    if-lt v1, v7, :cond_6f

    .line 8818
    const/16 v7, 0x12c

    iput v7, v3, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    goto :goto_37

    .line 8819
    :cond_6f
    iget v7, p0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-lt v1, v7, :cond_78

    .line 8820
    const/16 v7, 0xc8

    iput v7, v3, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    goto :goto_37

    .line 8822
    :cond_78
    const/16 v7, 0x64

    iput v7, v3, Landroid/app/ActivityManager$RunningAppProcessInfo;->importance:I

    goto :goto_37

    .line 8832
    .end local v1           #adj:I
    .end local v2           #app:Lcom/android/server/am/ProcessRecord;
    .end local v3           #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    :cond_7d
    monitor-exit p0
    :try_end_7e
    .catchall {:try_start_5a .. :try_end_7e} :catchall_56

    .line 8833
    return-object v6

    .line 8832
    .end local v0           #N:I
    .end local v4           #i:I
    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :catchall_7f
    move-exception v7

    goto :goto_58

    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v0       #N:I
    .restart local v1       #adj:I
    .restart local v2       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v3       #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    .restart local v4       #i:I
    .restart local v6       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :cond_81
    move-object v5, v6

    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    goto :goto_3e

    .end local v1           #adj:I
    .end local v3           #currApp:Landroid/app/ActivityManager$RunningAppProcessInfo;
    .end local v5           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v6       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    :cond_83
    move-object v5, v6

    .end local v6           #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    .restart local v5       #runList:Ljava/util/List;,"Ljava/util/List<Landroid/app/ActivityManager$RunningAppProcessInfo;>;"
    goto :goto_41
.end method

.method public getServices(II)Ljava/util/List;
    .registers 10
    .parameter "maxNum"
    .parameter "flags"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(II)",
            "Ljava/util/List",
            "<",
            "Landroid/app/ActivityManager$RunningServiceInfo;",
            ">;"
        }
    .end annotation

    .prologue
    .line 9823
    monitor-enter p0

    .line 9824
    :try_start_1
    new-instance v4, Ljava/util/ArrayList;

    invoke-direct {v4}, Ljava/util/ArrayList;-><init>()V

    .line 9827
    .local v4, res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RunningServiceInfo;>;"
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->size()I

    move-result v5

    if-lez v5, :cond_35

    .line 9828
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mServices:Ljava/util/HashMap;

    invoke-virtual {v5}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v5

    invoke-interface {v5}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .line 9829
    .local v2, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    :goto_18
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_35

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v5, p1, :cond_35

    .line 9830
    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/ServiceRecord;

    invoke-virtual {p0, v5}, Lcom/android/server/am/ActivityManagerService;->makeRunningServiceInfoLocked(Lcom/android/server/am/ServiceRecord;)Landroid/app/ActivityManager$RunningServiceInfo;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_18

    .line 9843
    .end local v2           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    .end local v4           #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RunningServiceInfo;>;"
    :catchall_32
    move-exception v5

    monitor-exit p0
    :try_end_34
    .catchall {:try_start_1 .. :try_end_34} :catchall_32

    throw v5

    .line 9834
    .restart local v4       #res:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ActivityManager$RunningServiceInfo;>;"
    :cond_35
    const/4 v0, 0x0

    .local v0, i:I
    :goto_36
    :try_start_36
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v0, v5, :cond_5a

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v5, p1, :cond_5a

    .line 9835
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v5, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ServiceRecord;

    .line 9836
    .local v3, r:Lcom/android/server/am/ServiceRecord;
    invoke-virtual {p0, v3}, Lcom/android/server/am/ActivityManagerService;->makeRunningServiceInfoLocked(Lcom/android/server/am/ServiceRecord;)Landroid/app/ActivityManager$RunningServiceInfo;

    move-result-object v1

    .line 9838
    .local v1, info:Landroid/app/ActivityManager$RunningServiceInfo;
    iget-wide v5, v3, Lcom/android/server/am/ServiceRecord;->nextRestartTime:J

    iput-wide v5, v1, Landroid/app/ActivityManager$RunningServiceInfo;->restarting:J

    .line 9839
    invoke-virtual {v4, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 9834
    add-int/lit8 v0, v0, 0x1

    goto :goto_36

    .line 9842
    .end local v1           #info:Landroid/app/ActivityManager$RunningServiceInfo;
    .end local v3           #r:Lcom/android/server/am/ServiceRecord;
    :cond_5a
    monitor-exit p0
    :try_end_5b
    .catchall {:try_start_36 .. :try_end_5b} :catchall_32

    return-object v4
.end method

.method public getTaskForActivity(Landroid/os/IBinder;Z)I
    .registers 4
    .parameter "token"
    .parameter "onlyRoot"

    .prologue
    .line 7172
    monitor-enter p0

    .line 7173
    :try_start_1
    invoke-virtual {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->getTaskForActivityLocked(Landroid/os/IBinder;Z)I

    move-result v0

    monitor-exit p0

    return v0

    .line 7174
    :catchall_7
    move-exception v0

    monitor-exit p0
    :try_end_9
    .catchall {:try_start_1 .. :try_end_9} :catchall_7

    throw v0
.end method

.method getTaskForActivityLocked(Landroid/os/IBinder;Z)I
    .registers 9
    .parameter "token"
    .parameter "onlyRoot"

    .prologue
    const/4 v5, -0x1

    .line 7178
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 7179
    .local v0, N:I
    const/4 v2, 0x0

    .line 7180
    .local v2, lastTask:Lcom/android/server/am/TaskRecord;
    const/4 v1, 0x0

    .local v1, i:I
    :goto_9
    if-ge v1, v0, :cond_27

    .line 7181
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v4, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 7182
    .local v3, r:Lcom/android/server/am/HistoryRecord;
    if-ne v3, p1, :cond_22

    .line 7183
    if-eqz p2, :cond_1b

    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v2, v4, :cond_20

    .line 7184
    :cond_1b
    iget-object v4, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v4, v4, Lcom/android/server/am/TaskRecord;->taskId:I

    .line 7191
    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :goto_1f
    return v4

    .restart local v3       #r:Lcom/android/server/am/HistoryRecord;
    :cond_20
    move v4, v5

    .line 7186
    goto :goto_1f

    .line 7188
    :cond_22
    iget-object v2, v3, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7180
    add-int/lit8 v1, v1, 0x1

    goto :goto_9

    .end local v3           #r:Lcom/android/server/am/HistoryRecord;
    :cond_27
    move v4, v5

    .line 7191
    goto :goto_1f
.end method

.method public getTasks(IILandroid/app/IThumbnailReceiver;)Ljava/util/List;
    .registers 27
    .parameter "maxNum"
    .parameter "flags"
    .parameter "receiver"

    .prologue
    .line 6460
    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    .line 6462
    .local v11, list:Ljava/util/ArrayList;
    const/16 v16, 0x0

    .line 6463
    .local v16, pending:Lcom/android/server/am/PendingThumbnailsRecord;
    const/16 v22, 0x0

    .line 6464
    .local v22, topThumbnail:Landroid/app/IApplicationThread;
    const/4 v4, 0x0

    .line 6466
    .local v4, topRecord:Lcom/android/server/am/HistoryRecord;
    monitor-enter p0

    .line 6471
    :try_start_b
    const-string v2, "android.permission.GET_TASKS"

    move-object/from16 v0, p0

    move-object v1, v2

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I
    :try_end_13
    .catchall {:try_start_b .. :try_end_13} :catchall_57

    move-result v2

    if-eqz v2, :cond_5a

    .line 6473
    if-eqz p3, :cond_1b

    .line 6477
    :try_start_18
    invoke-interface/range {p3 .. p3}, Landroid/app/IThumbnailReceiver;->finished()V
    :try_end_1b
    .catchall {:try_start_18 .. :try_end_1b} :catchall_57
    .catch Landroid/os/RemoteException; {:try_start_18 .. :try_end_1b} :catch_1b2

    .line 6481
    :cond_1b
    :goto_1b
    :try_start_1b
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Permission Denial: getTasks() from pid="

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, ", uid="

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, " requires "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, "android.permission.GET_TASKS"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v12

    .line 6485
    .local v12, msg:Ljava/lang/String;
    const-string v2, "ActivityManager"

    invoke-static {v2, v12}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6486
    new-instance v2, Ljava/lang/SecurityException;

    invoke-direct {v2, v12}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 6568
    .end local v12           #msg:Ljava/lang/String;
    .end local p2
    :catchall_57
    move-exception v2

    :goto_58
    monitor-exit p0
    :try_end_59
    .catchall {:try_start_1b .. :try_end_59} :catchall_57

    throw v2

    .line 6489
    .restart local p2
    :cond_5a
    :try_start_5a
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v2, v0

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v18, v2, v3

    .line 6490
    .local v18, pos:I
    if-ltz v18, :cond_16e

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v2, v0

    move-object v0, v2

    move/from16 v1, v18

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    .end local p2
    check-cast p2, Lcom/android/server/am/HistoryRecord;
    :try_end_76
    .catchall {:try_start_5a .. :try_end_76} :catchall_57

    move-object/from16 v13, p2

    .line 6492
    .local v13, next:Lcom/android/server/am/HistoryRecord;
    :goto_78
    const/16 v20, 0x0

    .line 6493
    .local v20, top:Lcom/android/server/am/HistoryRecord;
    const/16 v21, 0x0

    .line 6494
    .local v21, topDescription:Ljava/lang/CharSequence;
    const/4 v9, 0x0

    .line 6495
    .local v9, curTask:Lcom/android/server/am/TaskRecord;
    const/4 v14, 0x0

    .line 6496
    .local v14, numActivities:I
    const/4 v15, 0x0

    .local v15, numRunning:I
    move-object/from16 v17, v16

    .line 6497
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .local v17, pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :goto_81
    if-ltz v18, :cond_182

    if-lez p1, :cond_182

    .line 6498
    move-object/from16 v19, v13

    .line 6499
    .local v19, r:Lcom/android/server/am/HistoryRecord;
    add-int/lit8 v18, v18, -0x1

    .line 6500
    if-ltz v18, :cond_172

    :try_start_8b
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v2, v0

    move-object v0, v2

    move/from16 v1, v18

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p2

    check-cast p2, Lcom/android/server/am/HistoryRecord;

    move-object/from16 v13, p2

    .line 6503
    :goto_9b
    if-eqz v20, :cond_b2

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object v2, v0

    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->INITIALIZING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v2, v3, :cond_c1

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v2, v0

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v3, v0

    if-ne v2, v3, :cond_c1

    .line 6506
    :cond_b2
    move-object/from16 v20, v19

    .line 6507
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->description:Ljava/lang/CharSequence;

    move-object/from16 v21, v0

    .line 6508
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    move-object v9, v0

    .line 6509
    const/4 v15, 0x0

    move v14, v15

    .line 6513
    :cond_c1
    add-int/lit8 v14, v14, 0x1

    .line 6514
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    if-eqz v2, :cond_d5

    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    iget-object v2, v2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v2, :cond_d5

    .line 6515
    add-int/lit8 v15, v15, 0x1

    .line 6517
    :cond_d5
    if-nez v21, :cond_dd

    .line 6518
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->description:Ljava/lang/CharSequence;

    move-object/from16 v21, v0

    .line 6527
    :cond_dd
    if-eqz v13, :cond_e3

    iget-object v2, v13, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    if-eq v2, v9, :cond_1bd

    .line 6528
    :cond_e3
    new-instance v8, Landroid/app/ActivityManager$RunningTaskInfo;

    invoke-direct {v8}, Landroid/app/ActivityManager$RunningTaskInfo;-><init>()V

    .line 6530
    .local v8, ci:Landroid/app/ActivityManager$RunningTaskInfo;
    iget v2, v9, Lcom/android/server/am/TaskRecord;->taskId:I

    iput v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->id:I

    .line 6531
    move-object/from16 v0, v19

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v2, v0

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    iput-object v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->baseActivity:Landroid/content/ComponentName;

    .line 6532
    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v2, v0

    invoke-virtual {v2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v2

    iput-object v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->topActivity:Landroid/content/ComponentName;

    .line 6533
    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->thumbnail:Landroid/graphics/Bitmap;

    move-object v2, v0

    iput-object v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->thumbnail:Landroid/graphics/Bitmap;

    .line 6534
    move-object/from16 v0, v21

    move-object v1, v8

    iput-object v0, v1, Landroid/app/ActivityManager$RunningTaskInfo;->description:Ljava/lang/CharSequence;

    .line 6535
    iput v14, v8, Landroid/app/ActivityManager$RunningTaskInfo;->numActivities:I

    .line 6536
    iput v15, v8, Landroid/app/ActivityManager$RunningTaskInfo;->numRunning:I

    .line 6539
    iget-object v2, v8, Landroid/app/ActivityManager$RunningTaskInfo;->thumbnail:Landroid/graphics/Bitmap;

    if-nez v2, :cond_1ba

    if-eqz p3, :cond_1ba

    .line 6544
    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object v2, v0

    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->RESUMED:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-eq v2, v3, :cond_12a

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->state:Lcom/android/server/am/ActivityManagerService$ActivityState;

    move-object v2, v0

    sget-object v3, Lcom/android/server/am/ActivityManagerService$ActivityState;->PAUSING:Lcom/android/server/am/ActivityManagerService$ActivityState;

    if-ne v2, v3, :cond_14d

    .line 6546
    :cond_12a
    move-object/from16 v0, v20

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->idle:Z

    move v2, v0

    if-eqz v2, :cond_176

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    if-eqz v2, :cond_176

    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    iget-object v2, v2, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v2, :cond_176

    .line 6548
    move-object/from16 v4, v20

    .line 6549
    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v2, v0

    move-object v0, v2

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object/from16 v22, v0

    .line 6554
    :cond_14d
    :goto_14d
    if-nez v17, :cond_1b7

    .line 6555
    new-instance v16, Lcom/android/server/am/PendingThumbnailsRecord;

    move-object/from16 v0, v16

    move-object/from16 v1, p3

    invoke-direct {v0, v1}, Lcom/android/server/am/PendingThumbnailsRecord;-><init>(Landroid/app/IThumbnailReceiver;)V
    :try_end_158
    .catchall {:try_start_8b .. :try_end_158} :catchall_17d

    .line 6557
    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :goto_158
    :try_start_158
    move-object/from16 v0, v16

    iget-object v0, v0, Lcom/android/server/am/PendingThumbnailsRecord;->pendingRecords:Ljava/util/HashSet;

    move-object v2, v0

    move-object v0, v2

    move-object/from16 v1, v20

    invoke-virtual {v0, v1}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 6559
    :goto_163
    invoke-virtual {v11, v8}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_166
    .catchall {:try_start_158 .. :try_end_166} :catchall_57

    .line 6560
    add-int/lit8 p1, p1, -0x1

    .line 6561
    const/16 v20, 0x0

    .end local v8           #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    :goto_16a
    move-object/from16 v17, v16

    .line 6563
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto/16 :goto_81

    .line 6490
    .end local v9           #curTask:Lcom/android/server/am/TaskRecord;
    .end local v13           #next:Lcom/android/server/am/HistoryRecord;
    .end local v14           #numActivities:I
    .end local v15           #numRunning:I
    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .end local v19           #r:Lcom/android/server/am/HistoryRecord;
    .end local v20           #top:Lcom/android/server/am/HistoryRecord;
    .end local v21           #topDescription:Ljava/lang/CharSequence;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local p2
    :cond_16e
    const/4 v2, 0x0

    move-object v13, v2

    goto/16 :goto_78

    .line 6500
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .end local p2
    .restart local v9       #curTask:Lcom/android/server/am/TaskRecord;
    .restart local v13       #next:Lcom/android/server/am/HistoryRecord;
    .restart local v14       #numActivities:I
    .restart local v15       #numRunning:I
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v19       #r:Lcom/android/server/am/HistoryRecord;
    .restart local v20       #top:Lcom/android/server/am/HistoryRecord;
    .restart local v21       #topDescription:Ljava/lang/CharSequence;
    :cond_172
    const/4 v2, 0x0

    move-object v13, v2

    goto/16 :goto_9b

    .line 6551
    .restart local v8       #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    :cond_176
    const/4 v2, 0x1

    :try_start_177
    move v0, v2

    move-object/from16 v1, v20

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->thumbnailNeeded:Z

    goto :goto_14d

    .line 6568
    .end local v8           #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    .end local v19           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_17d
    move-exception v2

    move-object/from16 v16, v17

    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto/16 :goto_58

    .line 6565
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_182
    if-eqz v17, :cond_18f

    .line 6566
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    move-object v2, v0

    move-object v0, v2

    move-object/from16 v1, v17

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 6568
    :cond_18f
    monitor-exit p0
    :try_end_190
    .catchall {:try_start_177 .. :try_end_190} :catchall_17d

    .line 6572
    if-eqz v22, :cond_198

    .line 6575
    :try_start_192
    move-object/from16 v0, v22

    move-object v1, v4

    invoke-interface {v0, v1}, Landroid/app/IApplicationThread;->requestThumbnail(Landroid/os/IBinder;)V
    :try_end_198
    .catch Ljava/lang/Exception; {:try_start_192 .. :try_end_198} :catch_1a0

    .line 6582
    :cond_198
    :goto_198
    if-nez v17, :cond_19f

    if-eqz p3, :cond_19f

    .line 6588
    :try_start_19c
    invoke-interface/range {p3 .. p3}, Landroid/app/IThumbnailReceiver;->finished()V
    :try_end_19f
    .catch Landroid/os/RemoteException; {:try_start_19c .. :try_end_19f} :catch_1b5

    .line 6593
    :cond_19f
    :goto_19f
    return-object v11

    .line 6576
    :catch_1a0
    move-exception v10

    .line 6577
    .local v10, e:Ljava/lang/Exception;
    const-string v2, "ActivityManager"

    const-string v3, "Exception thrown when requesting thumbnail"

    invoke-static {v2, v3, v10}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 6578
    const/4 v3, 0x0

    const/4 v5, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x1

    move-object/from16 v2, p0

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    goto :goto_198

    .line 6478
    .end local v9           #curTask:Lcom/android/server/am/TaskRecord;
    .end local v10           #e:Ljava/lang/Exception;
    .end local v13           #next:Lcom/android/server/am/HistoryRecord;
    .end local v14           #numActivities:I
    .end local v15           #numRunning:I
    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .end local v18           #pos:I
    .end local v20           #top:Lcom/android/server/am/HistoryRecord;
    .end local v21           #topDescription:Ljava/lang/CharSequence;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local p2
    :catch_1b2
    move-exception v2

    goto/16 :goto_1b

    .line 6589
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .end local p2
    .restart local v9       #curTask:Lcom/android/server/am/TaskRecord;
    .restart local v13       #next:Lcom/android/server/am/HistoryRecord;
    .restart local v14       #numActivities:I
    .restart local v15       #numRunning:I
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v18       #pos:I
    .restart local v20       #top:Lcom/android/server/am/HistoryRecord;
    .restart local v21       #topDescription:Ljava/lang/CharSequence;
    :catch_1b5
    move-exception v2

    goto :goto_19f

    .restart local v8       #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    .restart local v19       #r:Lcom/android/server/am/HistoryRecord;
    :cond_1b7
    move-object/from16 v16, v17

    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto :goto_158

    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_1ba
    move-object/from16 v16, v17

    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto :goto_163

    .end local v8           #ci:Landroid/app/ActivityManager$RunningTaskInfo;
    .end local v16           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v17       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_1bd
    move-object/from16 v16, v17

    .end local v17           #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v16       #pending:Lcom/android/server/am/PendingThumbnailsRecord;
    goto :goto_16a
.end method

.method public goingToSleep()V
    .registers 3

    .prologue
    .line 7843
    monitor-enter p0

    .line 7844
    const/4 v0, 0x1

    :try_start_2
    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    .line 7845
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v1, 0x0

    invoke-virtual {v0, v1}, Lcom/android/server/WindowManagerService;->setEventDispatching(Z)V

    .line 7847
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v0, :cond_13

    .line 7848
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->pauseIfSleepingLocked()V

    .line 7852
    :goto_11
    monitor-exit p0

    .line 7853
    return-void

    .line 7850
    :cond_13
    const-string v0, "ActivityManager"

    const-string v1, "goingToSleep with no resumed activity!"

    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_11

    .line 7852
    :catchall_1b
    move-exception v0

    monitor-exit p0
    :try_end_1d
    .catchall {:try_start_2 .. :try_end_1d} :catchall_1b

    throw v0
.end method

.method public grantUriPermission(Landroid/app/IApplicationThread;Ljava/lang/String;Landroid/net/Uri;I)V
    .registers 12
    .parameter "caller"
    .parameter "targetPkg"
    .parameter "uri"
    .parameter "modeFlags"

    .prologue
    const-string v0, "ActivityManager"

    .line 6250
    monitor-enter p0

    .line 6251
    :try_start_3
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v6

    .line 6252
    .local v6, r:Lcom/android/server/am/ProcessRecord;
    if-nez v6, :cond_2f

    .line 6253
    new-instance v0, Ljava/lang/SecurityException;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Unable to find app for caller "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " when granting permission to uri "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 6268
    .end local v6           #r:Lcom/android/server/am/ProcessRecord;
    :catchall_2c
    move-exception v0

    monitor-exit p0
    :try_end_2e
    .catchall {:try_start_3 .. :try_end_2e} :catchall_2c

    throw v0

    .line 6257
    .restart local v6       #r:Lcom/android/server/am/ProcessRecord;
    :cond_2f
    if-nez p2, :cond_3a

    .line 6258
    :try_start_31
    const-string v0, "ActivityManager"

    const-string v1, "grantUriPermission: null target"

    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6259
    monitor-exit p0

    .line 6269
    :goto_39
    return-void

    .line 6261
    :cond_3a
    if-nez p3, :cond_45

    .line 6262
    const-string v0, "ActivityManager"

    const-string v1, "grantUriPermission: null uri"

    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6263
    monitor-exit p0

    goto :goto_39

    .line 6266
    :cond_45
    iget-object v0, v6, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v1, v0, Landroid/content/pm/ApplicationInfo;->uid:I

    const/4 v5, 0x0

    move-object v0, p0

    move-object v2, p2

    move-object v3, p3

    move v4, p4

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionLocked(ILjava/lang/String;Landroid/net/Uri;ILcom/android/server/am/HistoryRecord;)V

    .line 6268
    monitor-exit p0
    :try_end_52
    .catchall {:try_start_31 .. :try_end_52} :catchall_2c

    goto :goto_39
.end method

.method handleAppCrashLocked(Lcom/android/server/am/ProcessRecord;)Z
    .registers 13
    .parameter "app"

    .prologue
    .line 8488
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v8

    .line 8490
    .local v8, now:J
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v0, v1, v2}, Lcom/android/server/ProcessMap;->get(Ljava/lang/String;I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Ljava/lang/Long;

    .line 8492
    .local v6, crashTime:Ljava/lang/Long;
    if-eqz v6, :cond_ee

    invoke-virtual {v6}, Ljava/lang/Long;->longValue()J

    move-result-wide v3

    const-wide/32 v5, 0xea60

    add-long/2addr v3, v5

    cmp-long v0, v8, v3

    if-gez v0, :cond_ee

    .line 8494
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Process "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v2, v2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " has crashed too many times: killing!"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8496
    const/16 v0, 0x7550

    const/4 v1, 0x2

    new-array v1, v1, [Ljava/lang/Object;

    const/4 v2, 0x0

    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    aput-object v3, v1, v2

    const/4 v2, 0x1

    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v3, v3, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 8498
    const/4 v0, 0x0

    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->killServicesLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 8499
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    const/4 v1, 0x1

    sub-int v2, v0, v1

    .local v2, i:I
    :goto_6b
    if-ltz v2, :cond_a6

    .line 8500
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 8501
    .local v1, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v1, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-ne v0, p1, :cond_a3

    .line 8502
    const-string v0, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "  Force finishing activity "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, v1, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    invoke-virtual {v4}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v4

    invoke-virtual {v4}, Landroid/content/ComponentName;->flattenToShortString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v0, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 8505
    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "crashed"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 8499
    :cond_a3
    add-int/lit8 v2, v2, -0x1

    goto :goto_6b

    .line 8508
    .end local v1           #r:Lcom/android/server/am/HistoryRecord;
    :cond_a6
    iget-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v0, :cond_ee

    .line 8513
    const/16 v0, 0x753f

    const/4 v1, 0x2

    new-array v1, v1, [Ljava/lang/Object;

    const/4 v2, 0x0

    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    .end local v2           #i:I
    iget v3, v3, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    aput-object v3, v1, v2

    const/4 v2, 0x1

    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    aput-object v3, v1, v2

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 8515
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mBadProcesses:Lcom/android/server/ProcessMap;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v3

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 8516
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->bad:Z

    .line 8517
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v0, v1, v2}, Lcom/android/server/ProcessMap;->remove(Ljava/lang/String;I)V

    .line 8518
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->removed:Z

    .line 8519
    const/4 v0, 0x0

    invoke-direct {p0, p1, v0}, Lcom/android/server/am/ActivityManagerService;->removeProcessLocked(Lcom/android/server/am/ProcessRecord;Z)Z

    .line 8520
    const/4 v0, 0x0

    .line 8536
    :goto_ed
    return v0

    .line 8525
    :cond_ee
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v0}, Ljava/util/HashSet;->size()I

    move-result v0

    if-eqz v0, :cond_10f

    .line 8528
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v0}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v7

    .line 8529
    .local v7, it:Ljava/util/Iterator;
    :goto_fc
    invoke-interface {v7}, Ljava/util/Iterator;->hasNext()Z

    move-result v0

    if-eqz v0, :cond_10f

    .line 8530
    invoke-interface {v7}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/am/ServiceRecord;

    .line 8531
    .local v10, sr:Lcom/android/server/am/ServiceRecord;
    iget v0, v10, Lcom/android/server/am/ServiceRecord;->crashCount:I

    add-int/lit8 v0, v0, 0x1

    iput v0, v10, Lcom/android/server/am/ServiceRecord;->crashCount:I

    goto :goto_fc

    .line 8535
    .end local v7           #it:Ljava/util/Iterator;
    .end local v10           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_10f
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    iget-object v1, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v2, v2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v3

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 8536
    const/4 v0, 0x1

    goto :goto_ed
.end method

.method public handleApplicationError(Landroid/os/IBinder;ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;[B)I
    .registers 35
    .parameter "app"
    .parameter "flags"
    .parameter "tag"
    .parameter "shortMsg"
    .parameter "longMsg"
    .parameter "crashData"

    .prologue
    .line 8572
    new-instance v27, Lcom/android/server/am/AppErrorResult;

    invoke-direct/range {v27 .. v27}, Lcom/android/server/am/AppErrorResult;-><init>()V

    .line 8573
    .local v27, result:Lcom/android/server/am/AppErrorResult;
    const/16 v25, 0x0

    .line 8574
    .local v25, r:Lcom/android/server/am/ProcessRecord;
    monitor-enter p0

    .line 8575
    if-eqz p1, :cond_56

    .line 8576
    :try_start_a
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    move-object v4, v0

    invoke-virtual {v4}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v4

    invoke-virtual {v4}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v4

    invoke-interface {v4}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v18

    .local v18, i$:Ljava/util/Iterator;
    :cond_1b
    :goto_1b
    invoke-interface/range {v18 .. v18}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_56

    invoke-interface/range {v18 .. v18}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Landroid/util/SparseArray;

    .line 8577
    .local v15, apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    invoke-virtual {v15}, Landroid/util/SparseArray;->size()I

    move-result v13

    .line 8578
    .local v13, NA:I
    const/16 v19, 0x0

    .local v19, ia:I
    :goto_2d
    move/from16 v0, v19

    move v1, v13

    if-ge v0, v1, :cond_1b

    .line 8579
    move-object v0, v15

    move/from16 v1, v19

    invoke-virtual {v0, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v24

    check-cast v24, Lcom/android/server/am/ProcessRecord;

    .line 8580
    .local v24, p:Lcom/android/server/am/ProcessRecord;
    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v4, v0

    if-eqz v4, :cond_53

    move-object/from16 v0, v24

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v4, v0

    invoke-interface {v4}, Landroid/app/IApplicationThread;->asBinder()Landroid/os/IBinder;

    move-result-object v4

    move-object v0, v4

    move-object/from16 v1, p1

    if-ne v0, v1, :cond_53

    .line 8581
    move-object/from16 v25, v24

    .line 8582
    goto :goto_1b

    .line 8578
    :cond_53
    add-int/lit8 v19, v19, 0x1

    goto :goto_2d

    .line 8588
    .end local v13           #NA:I
    .end local v15           #apps:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .end local v18           #i$:Ljava/util/Iterator;
    .end local v19           #ia:I
    .end local v24           #p:Lcom/android/server/am/ProcessRecord;
    :cond_56
    if-eqz v25, :cond_61

    .line 8591
    move-object/from16 v0, v25

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    const/4 v5, 0x3

    invoke-static {v4, v5}, Landroid/os/Process;->sendSignal(II)V

    .line 8596
    :cond_61
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v4, v0
    :try_end_66
    .catchall {:try_start_a .. :try_end_66} :catchall_163

    if-eqz v4, :cond_bf

    .line 8598
    if-eqz v25, :cond_ad

    :try_start_6a
    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v4, v0

    move-object v5, v4

    .line 8599
    .local v5, name:Ljava/lang/String;
    :goto_70
    if-eqz v25, :cond_b0

    move-object/from16 v0, v25

    iget v0, v0, Lcom/android/server/am/ProcessRecord;->pid:I

    move v4, v0

    move v6, v4

    .line 8600
    .local v6, pid:I
    :goto_78
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    move-object v4, v0

    move-object/from16 v7, p4

    move-object/from16 v8, p5

    move-object/from16 v9, p6

    invoke-interface/range {v4 .. v9}, Landroid/app/IActivityController;->appCrashed(Ljava/lang/String;ILjava/lang/String;Ljava/lang/String;[B)Z

    move-result v4

    if-nez v4, :cond_bf

    .line 8602
    const-string v4, "ActivityManager"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Force-killing crashed app "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    .end local v5           #name:Ljava/lang/String;
    const-string v7, " at watcher\'s request"

    invoke-virtual {v5, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8604
    invoke-static {v6}, Landroid/os/Process;->killProcess(I)V
    :try_end_aa
    .catchall {:try_start_6a .. :try_end_aa} :catchall_163
    .catch Landroid/os/RemoteException; {:try_start_6a .. :try_end_aa} :catch_b6

    .line 8605
    const/4 v4, 0x0

    :try_start_ab
    monitor-exit p0
    :try_end_ac
    .catchall {:try_start_ab .. :try_end_ac} :catchall_163

    .line 8681
    .end local v6           #pid:I
    :goto_ac
    return v4

    .line 8598
    :cond_ad
    const/4 v4, 0x0

    move-object v5, v4

    goto :goto_70

    .line 8599
    .restart local v5       #name:Ljava/lang/String;
    :cond_b0
    :try_start_b0
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I
    :try_end_b3
    .catchall {:try_start_b0 .. :try_end_b3} :catchall_163
    .catch Landroid/os/RemoteException; {:try_start_b0 .. :try_end_b3} :catch_b6

    move-result v4

    move v6, v4

    goto :goto_78

    .line 8607
    .end local v5           #name:Ljava/lang/String;
    :catch_b6
    move-exception v4

    move-object/from16 v17, v4

    .line 8608
    .local v17, e:Landroid/os/RemoteException;
    const/4 v4, 0x0

    :try_start_ba
    move-object v0, v4

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    .line 8612
    .end local v17           #e:Landroid/os/RemoteException;
    :cond_bf
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v22

    .line 8615
    .local v22, origId:J
    if-eqz v25, :cond_166

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v4, v0

    if-eqz v4, :cond_166

    .line 8616
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Error in app "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " running instrumentation "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    move-object v6, v0

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ":"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8618
    if-eqz p4, :cond_11b

    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p4

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8619
    :cond_11b
    if-eqz p5, :cond_138

    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "  "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8620
    :cond_138
    new-instance v20, Landroid/os/Bundle;

    invoke-direct/range {v20 .. v20}, Landroid/os/Bundle;-><init>()V

    .line 8621
    .local v20, info:Landroid/os/Bundle;
    const-string v4, "shortMsg"

    move-object/from16 v0, v20

    move-object v1, v4

    move-object/from16 v2, p4

    invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 8622
    const-string v4, "longMsg"

    move-object/from16 v0, v20

    move-object v1, v4

    move-object/from16 v2, p5

    invoke-virtual {v0, v1, v2}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 8623
    const/4 v4, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, v25

    move v2, v4

    move-object/from16 v3, v20

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->finishInstrumentationLocked(Lcom/android/server/am/ProcessRecord;ILandroid/os/Bundle;)V

    .line 8624
    invoke-static/range {v22 .. v23}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 8625
    const/4 v4, 0x0

    monitor-exit p0

    goto/16 :goto_ac

    .line 8657
    .end local v20           #info:Landroid/os/Bundle;
    .end local v22           #origId:J
    :catchall_163
    move-exception v4

    monitor-exit p0
    :try_end_165
    .catchall {:try_start_ba .. :try_end_165} :catchall_163

    throw v4

    .line 8628
    .restart local v22       #origId:J
    :cond_166
    if-eqz v25, :cond_17e

    move-object/from16 v7, p0

    move-object/from16 v8, v25

    move-object/from16 v9, p3

    move-object/from16 v10, p4

    move-object/from16 v11, p5

    move-object/from16 v12, p6

    .line 8629
    :try_start_174
    invoke-virtual/range {v7 .. v12}, Lcom/android/server/am/ActivityManagerService;->makeAppCrashingLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[B)Z

    move-result v4

    if-nez v4, :cond_1e9

    .line 8630
    const/4 v4, 0x0

    monitor-exit p0

    goto/16 :goto_ac

    .line 8633
    :cond_17e
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Some application object "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " tag "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p3

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " has crashed, but I don\'t know who it is."

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8635
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "ShortMsg:"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p4

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8636
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "LongMsg:"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object v0, v5

    move-object/from16 v1, p5

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8637
    invoke-static/range {v22 .. v23}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 8638
    const/4 v4, 0x0

    monitor-exit p0

    goto/16 :goto_ac

    .line 8641
    :cond_1e9
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v21

    .line 8642
    .local v21, msg:Landroid/os/Message;
    const/4 v4, 0x1

    move v0, v4

    move-object/from16 v1, v21

    iput v0, v1, Landroid/os/Message;->what:I

    .line 8643
    new-instance v16, Ljava/util/HashMap;

    invoke-direct/range {v16 .. v16}, Ljava/util/HashMap;-><init>()V

    .line 8644
    .local v16, data:Ljava/util/HashMap;
    const-string v4, "result"

    move-object/from16 v0, v16

    move-object v1, v4

    move-object/from16 v2, v27

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 8645
    const-string v4, "app"

    move-object/from16 v0, v16

    move-object v1, v4

    move-object/from16 v2, v25

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 8646
    const-string v4, "flags"

    invoke-static/range {p2 .. p2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    move-object/from16 v0, v16

    move-object v1, v4

    move-object v2, v5

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 8647
    const-string v4, "shortMsg"

    move-object/from16 v0, v16

    move-object v1, v4

    move-object/from16 v2, p4

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 8648
    const-string v4, "longMsg"

    move-object/from16 v0, v16

    move-object v1, v4

    move-object/from16 v2, p5

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 8649
    if-eqz v25, :cond_244

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v4, v0

    iget v4, v4, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v4, v4, 0x1

    if-eqz v4, :cond_244

    .line 8651
    const-string v4, "crashData"

    move-object/from16 v0, v16

    move-object v1, v4

    move-object/from16 v2, p6

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 8653
    :cond_244
    move-object/from16 v0, v16

    move-object/from16 v1, v21

    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 8654
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v21

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 8656
    invoke-static/range {v22 .. v23}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 8657
    monitor-exit p0
    :try_end_259
    .catchall {:try_start_174 .. :try_end_259} :catchall_163

    .line 8659
    invoke-virtual/range {v27 .. v27}, Lcom/android/server/am/AppErrorResult;->get()I

    move-result v26

    .line 8661
    .local v26, res:I
    const/4 v14, 0x0

    .line 8662
    .local v14, appErrorIntent:Landroid/content/Intent;
    monitor-enter p0

    .line 8663
    if-eqz v25, :cond_27f

    .line 8664
    :try_start_261
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessCrashTimes:Lcom/android/server/ProcessMap;

    move-object v4, v0

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    move-object/from16 v0, v25

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    move-object v6, v0

    iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v7

    invoke-static {v7, v8}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    invoke-virtual {v4, v5, v6, v7}, Lcom/android/server/ProcessMap;->put(Ljava/lang/String;ILjava/lang/Object;)Ljava/lang/Object;

    .line 8667
    :cond_27f
    const/4 v4, 0x2

    move/from16 v0, v26

    move v1, v4

    if-ne v0, v1, :cond_28f

    .line 8668
    move-object/from16 v0, p0

    move-object/from16 v1, v25

    invoke-virtual {v0, v1}, Lcom/android/server/am/ActivityManagerService;->createAppErrorIntentLocked(Lcom/android/server/am/ProcessRecord;)Landroid/content/Intent;

    move-result-object v14

    .line 8669
    const/16 v26, 0x0

    .line 8671
    :cond_28f
    monitor-exit p0
    :try_end_290
    .catchall {:try_start_261 .. :try_end_290} :catchall_29e

    .line 8673
    if-eqz v14, :cond_29a

    .line 8675
    :try_start_292
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    invoke-virtual {v4, v14}, Landroid/content/Context;->startActivity(Landroid/content/Intent;)V
    :try_end_29a
    .catch Landroid/content/ActivityNotFoundException; {:try_start_292 .. :try_end_29a} :catch_2a1

    :cond_29a
    :goto_29a
    move/from16 v4, v26

    .line 8681
    goto/16 :goto_ac

    .line 8671
    :catchall_29e
    move-exception v4

    :try_start_29f
    monitor-exit p0
    :try_end_2a0
    .catchall {:try_start_29f .. :try_end_2a0} :catchall_29e

    throw v4

    .line 8676
    :catch_2a1
    move-exception v4

    move-object/from16 v17, v4

    .line 8677
    .local v17, e:Landroid/content/ActivityNotFoundException;
    const-string v4, "ActivityManager"

    const-string v5, "bug report receiver dissappeared"

    move-object v0, v4

    move-object v1, v5

    move-object/from16 v2, v17

    invoke-static {v0, v1, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_29a
.end method

.method killAppAtUsersRequest(Lcom/android/server/am/ProcessRecord;Landroid/app/Dialog;Z)V
    .registers 7
    .parameter "app"
    .parameter "fromDialog"
    .parameter "crashed"

    .prologue
    .line 8463
    monitor-enter p0

    .line 8464
    const/4 v0, 0x0

    :try_start_2
    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    .line 8465
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->crashingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 8466
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    .line 8467
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 8468
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    if-ne v0, p2, :cond_14

    .line 8469
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->anrDialog:Landroid/app/Dialog;

    .line 8471
    :cond_14
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    if-ne v0, p2, :cond_1b

    .line 8472
    const/4 v0, 0x0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->waitDialog:Landroid/app/Dialog;

    .line 8474
    :cond_1b
    iget v0, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    if-lez v0, :cond_5b

    iget v0, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    iget v1, p0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    if-eq v0, v1, :cond_5b

    .line 8475
    if-eqz p3, :cond_2a

    .line 8476
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->handleAppCrashLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 8478
    :cond_2a
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Killing process "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p1, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " (pid="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget v2, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, ") at user\'s request"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 8481
    iget v0, p1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v0}, Landroid/os/Process;->killProcess(I)V

    .line 8484
    :cond_5b
    monitor-exit p0

    .line 8485
    return-void

    .line 8484
    :catchall_5d
    move-exception v0

    monitor-exit p0
    :try_end_5f
    .catchall {:try_start_2 .. :try_end_5f} :catchall_5d

    throw v0
.end method

.method public killApplicationWithUid(Ljava/lang/String;I)V
    .registers 8
    .parameter "pkg"
    .parameter "uid"

    .prologue
    .line 4893
    if-nez p1, :cond_3

    .line 4914
    :goto_2
    return-void

    .line 4897
    :cond_3
    if-gez p2, :cond_1e

    .line 4898
    const-string v2, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Invalid uid specified for pkg : "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_2

    .line 4901
    :cond_1e
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v0

    .line 4903
    .local v0, callerUid:I
    const/16 v2, 0x3e8

    if-ne v0, v2, :cond_3b

    .line 4905
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v3, 0x16

    invoke-virtual {v2, v3}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v1

    .line 4906
    .local v1, msg:Landroid/os/Message;
    iput p2, v1, Landroid/os/Message;->arg1:I

    .line 4907
    const/4 v2, 0x0

    iput v2, v1, Landroid/os/Message;->arg2:I

    .line 4908
    iput-object p1, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 4909
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v2, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    goto :goto_2

    .line 4911
    .end local v1           #msg:Landroid/os/Message;
    :cond_3b
    new-instance v2, Ljava/lang/SecurityException;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " cannot kill pkg: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2
.end method

.method public killPidsForMemory([I)Z
    .registers 14
    .parameter "pids"

    .prologue
    const-string v7, "ActivityManager"

    .line 8081
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v7

    const/16 v8, 0x3e8

    if-eq v7, v8, :cond_12

    .line 8082
    new-instance v7, Ljava/lang/SecurityException;

    const-string v8, "killPidsForMemory only available to the system"

    invoke-direct {v7, v8}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v7

    .line 8088
    :cond_12
    const/4 v2, 0x0

    .line 8089
    .local v2, killed:Z
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v7

    .line 8090
    :try_start_16
    array-length v8, p1

    new-array v5, v8, [I

    .line 8091
    .local v5, types:[I
    const/4 v6, 0x0

    .line 8092
    .local v6, worstType:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_1b
    array-length v8, p1

    if-ge v1, v8, :cond_34

    .line 8093
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    aget v9, p1, v1

    invoke-virtual {v8, v9}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 8094
    .local v3, proc:Lcom/android/server/am/ProcessRecord;
    if-eqz v3, :cond_31

    .line 8095
    iget v4, v3, Lcom/android/server/am/ProcessRecord;->setAdj:I

    .line 8096
    .local v4, type:I
    aput v4, v5, v1

    .line 8097
    if-le v4, v6, :cond_31

    .line 8098
    move v6, v4

    .line 8092
    .end local v4           #type:I
    :cond_31
    add-int/lit8 v1, v1, 0x1

    goto :goto_1b

    .line 8105
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_34
    sget v8, Lcom/android/server/am/ActivityManagerService;->EMPTY_APP_ADJ:I

    if-ge v6, v8, :cond_3e

    sget v8, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    if-le v6, v8, :cond_3e

    .line 8106
    sget v6, Lcom/android/server/am/ActivityManagerService;->HIDDEN_APP_MIN_ADJ:I

    .line 8108
    :cond_3e
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Killing processes for memory at adjustment "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8109
    const/4 v1, 0x0

    :goto_57
    array-length v8, p1

    if-ge v1, v8, :cond_bc

    .line 8110
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    aget v9, p1, v1

    invoke-virtual {v8, v9}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 8111
    .restart local v3       #proc:Lcom/android/server/am/ProcessRecord;
    if-nez v3, :cond_69

    .line 8109
    :cond_66
    :goto_66
    add-int/lit8 v1, v1, 0x1

    goto :goto_57

    .line 8114
    :cond_69
    iget v0, v3, Lcom/android/server/am/ProcessRecord;->setAdj:I

    .line 8115
    .local v0, adj:I
    if-lt v0, v6, :cond_66

    .line 8116
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Killing for memory: "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, " (adj "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ")"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 8118
    const/16 v8, 0x7547

    const/4 v9, 0x3

    new-array v9, v9, [Ljava/lang/Object;

    const/4 v10, 0x0

    iget v11, v3, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v11

    aput-object v11, v9, v10

    const/4 v10, 0x1

    iget-object v11, v3, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    aput-object v11, v9, v10

    const/4 v10, 0x2

    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v11

    aput-object v11, v9, v10

    invoke-static {v8, v9}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 8120
    const/4 v2, 0x1

    .line 8121
    aget v8, p1, v1

    invoke-static {v8}, Landroid/os/Process;->killProcess(I)V

    goto :goto_66

    .line 8124
    .end local v0           #adj:I
    .end local v1           #i:I
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v5           #types:[I
    .end local v6           #worstType:I
    :catchall_b9
    move-exception v8

    monitor-exit v7
    :try_end_bb
    .catchall {:try_start_16 .. :try_end_bb} :catchall_b9

    throw v8

    .restart local v1       #i:I
    .restart local v5       #types:[I
    .restart local v6       #worstType:I
    :cond_bc
    :try_start_bc
    monitor-exit v7
    :try_end_bd
    .catchall {:try_start_bc .. :try_end_bd} :catchall_b9

    .line 8125
    return v2
.end method

.method makeAppCrashingLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[B)Z
    .registers 13
    .parameter "app"
    .parameter "tag"
    .parameter "shortMsg"
    .parameter "longMsg"
    .parameter "crashData"

    .prologue
    const/4 v2, 0x1

    .line 8389
    iput-boolean v2, p1, Lcom/android/server/am/ProcessRecord;->crashing:Z

    move-object v0, p0

    move-object v1, p1

    move-object v3, p2

    move-object v4, p3

    move-object v5, p4

    move-object v6, p5

    .line 8390
    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->generateProcessError(Lcom/android/server/am/ProcessRecord;ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;[B)Landroid/app/ActivityManager$ProcessErrorStateInfo;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->crashingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 8392
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->startAppProblemLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 8393
    invoke-virtual {p1}, Lcom/android/server/am/ProcessRecord;->stopFreezingAllLocked()V

    .line 8394
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->handleAppCrashLocked(Lcom/android/server/am/ProcessRecord;)Z

    move-result v0

    return v0
.end method

.method makeAppNotRespondingLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[B)V
    .registers 13
    .parameter "app"
    .parameter "tag"
    .parameter "shortMsg"
    .parameter "longMsg"
    .parameter "crashData"

    .prologue
    .line 8424
    const/4 v0, 0x1

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->notResponding:Z

    .line 8425
    const/4 v2, 0x2

    move-object v0, p0

    move-object v1, p1

    move-object v3, p2

    move-object v4, p3

    move-object v5, p4

    move-object v6, p5

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->generateProcessError(Lcom/android/server/am/ProcessRecord;ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;[B)Landroid/app/ActivityManager$ProcessErrorStateInfo;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->notRespondingReport:Landroid/app/ActivityManager$ProcessErrorStateInfo;

    .line 8428
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->startAppProblemLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 8429
    invoke-virtual {p1}, Lcom/android/server/am/ProcessRecord;->stopFreezingAllLocked()V

    .line 8430
    return-void
.end method

.method makeRunningServiceInfoLocked(Lcom/android/server/am/ServiceRecord;)Landroid/app/ActivityManager$RunningServiceInfo;
    .registers 5
    .parameter "r"

    .prologue
    .line 9805
    new-instance v0, Landroid/app/ActivityManager$RunningServiceInfo;

    invoke-direct {v0}, Landroid/app/ActivityManager$RunningServiceInfo;-><init>()V

    .line 9807
    .local v0, info:Landroid/app/ActivityManager$RunningServiceInfo;
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    iput-object v1, v0, Landroid/app/ActivityManager$RunningServiceInfo;->service:Landroid/content/ComponentName;

    .line 9808
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v1, :cond_13

    .line 9809
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget v1, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    iput v1, v0, Landroid/app/ActivityManager$RunningServiceInfo;->pid:I

    .line 9811
    :cond_13
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->processName:Ljava/lang/String;

    iput-object v1, v0, Landroid/app/ActivityManager$RunningServiceInfo;->process:Ljava/lang/String;

    .line 9812
    iget-boolean v1, p1, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    iput-boolean v1, v0, Landroid/app/ActivityManager$RunningServiceInfo;->foreground:Z

    .line 9813
    iget-wide v1, p1, Lcom/android/server/am/ServiceRecord;->createTime:J

    iput-wide v1, v0, Landroid/app/ActivityManager$RunningServiceInfo;->activeSince:J

    .line 9814
    iget-boolean v1, p1, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    iput-boolean v1, v0, Landroid/app/ActivityManager$RunningServiceInfo;->started:Z

    .line 9815
    iget-object v1, p1, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->size()I

    move-result v1

    iput v1, v0, Landroid/app/ActivityManager$RunningServiceInfo;->clientCount:I

    .line 9816
    iget v1, p1, Lcom/android/server/am/ServiceRecord;->crashCount:I

    iput v1, v0, Landroid/app/ActivityManager$RunningServiceInfo;->crashCount:I

    .line 9817
    iget-wide v1, p1, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    iput-wide v1, v0, Landroid/app/ActivityManager$RunningServiceInfo;->lastActivityTime:J

    .line 9818
    return-object v0
.end method

.method public monitor()V
    .registers 2

    .prologue
    .line 13307
    monitor-enter p0

    :try_start_1
    monitor-exit p0

    .line 13308
    return-void

    .line 13307
    :catchall_3
    move-exception v0

    monitor-exit p0
    :try_end_5
    .catchall {:try_start_1 .. :try_end_5} :catchall_3

    throw v0
.end method

.method public moveActivityTaskToBack(Landroid/os/IBinder;Z)Z
    .registers 8
    .parameter "token"
    .parameter "nonRoot"

    .prologue
    const/4 v4, 0x0

    .line 7068
    monitor-enter p0

    .line 7069
    :try_start_2
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 7070
    .local v0, origId:J
    if-nez p2, :cond_15

    const/4 v3, 0x1

    :goto_9
    invoke-virtual {p0, p1, v3}, Lcom/android/server/am/ActivityManagerService;->getTaskForActivityLocked(Landroid/os/IBinder;Z)I

    move-result v2

    .line 7071
    .local v2, taskId:I
    if-ltz v2, :cond_17

    .line 7072
    invoke-direct {p0, v2}, Lcom/android/server/am/ActivityManagerService;->moveTaskToBackLocked(I)Z

    move-result v3

    monitor-exit p0

    .line 7076
    :goto_14
    return v3

    .end local v2           #taskId:I
    :cond_15
    move v3, v4

    .line 7070
    goto :goto_9

    .line 7074
    .restart local v2       #taskId:I
    :cond_17
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7075
    monitor-exit p0

    move v3, v4

    .line 7076
    goto :goto_14

    .line 7075
    .end local v0           #origId:J
    .end local v2           #taskId:I
    :catchall_1d
    move-exception v3

    monitor-exit p0
    :try_end_1f
    .catchall {:try_start_2 .. :try_end_1f} :catchall_1d

    throw v3
.end method

.method public moveTaskBackwards(I)V
    .registers 7
    .parameter "task"

    .prologue
    .line 7153
    const-string v2, "android.permission.REORDER_TASKS"

    const-string v3, "moveTaskBackwards()"

    invoke-virtual {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 7156
    monitor-enter p0

    .line 7157
    :try_start_8
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v2

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    const-string v4, "Task backwards"

    invoke-virtual {p0, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkAppSwitchAllowedLocked(IILjava/lang/String;)Z

    move-result v2

    if-nez v2, :cond_1a

    .line 7159
    monitor-exit p0

    .line 7165
    :goto_19
    return-void

    .line 7161
    :cond_1a
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 7162
    .local v0, origId:J
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->moveTaskBackwardsLocked(I)V

    .line 7163
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7164
    monitor-exit p0

    goto :goto_19

    .end local v0           #origId:J
    :catchall_26
    move-exception v2

    monitor-exit p0
    :try_end_28
    .catchall {:try_start_8 .. :try_end_28} :catchall_26

    throw v2
.end method

.method public moveTaskToBack(I)V
    .registers 7
    .parameter "task"

    .prologue
    .line 7042
    const-string v2, "android.permission.REORDER_TASKS"

    const-string v3, "moveTaskToBack()"

    invoke-virtual {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 7045
    monitor-enter p0

    .line 7046
    :try_start_8
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v2, :cond_26

    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    iget-object v2, v2, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v2, v2, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v2, p1, :cond_26

    .line 7047
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v2

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v3

    const-string v4, "Task to back"

    invoke-virtual {p0, v2, v3, v4}, Lcom/android/server/am/ActivityManagerService;->checkAppSwitchAllowedLocked(IILjava/lang/String;)Z

    move-result v2

    if-nez v2, :cond_26

    .line 7049
    monitor-exit p0

    .line 7056
    :goto_25
    return-void

    .line 7052
    :cond_26
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 7053
    .local v0, origId:J
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->moveTaskToBackLocked(I)Z

    .line 7054
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7055
    monitor-exit p0

    goto :goto_25

    .end local v0           #origId:J
    :catchall_32
    move-exception v2

    monitor-exit p0
    :try_end_34
    .catchall {:try_start_8 .. :try_end_34} :catchall_32

    throw v2
.end method

.method public moveTaskToFront(I)V
    .registers 11
    .parameter "task"

    .prologue
    .line 6954
    const-string v6, "android.permission.REORDER_TASKS"

    const-string v7, "moveTaskToFront()"

    invoke-virtual {p0, v6, v7}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 6957
    monitor-enter p0

    .line 6958
    :try_start_8
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v7

    const-string v8, "Task to front"

    invoke-virtual {p0, v6, v7, v8}, Lcom/android/server/am/ActivityManagerService;->checkAppSwitchAllowedLocked(IILjava/lang/String;)Z

    move-result v6

    if-nez v6, :cond_1a

    .line 6960
    monitor-exit p0

    .line 6983
    :goto_19
    return-void

    .line 6962
    :cond_1a
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J
    :try_end_1d
    .catchall {:try_start_8 .. :try_end_1d} :catchall_3b

    move-result-wide v3

    .line 6964
    .local v3, origId:J
    :try_start_1e
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 6965
    .local v0, N:I
    const/4 v2, 0x0

    .local v2, i:I
    :goto_25
    if-ge v2, v0, :cond_41

    .line 6966
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mRecentTasks:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/TaskRecord;

    .line 6967
    .local v5, tr:Lcom/android/server/am/TaskRecord;
    iget v6, v5, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v6, p1, :cond_3e

    .line 6968
    invoke-direct {p0, v5}, Lcom/android/server/am/ActivityManagerService;->moveTaskToFrontLocked(Lcom/android/server/am/TaskRecord;)V
    :try_end_36
    .catchall {:try_start_1e .. :try_end_36} :catchall_67

    .line 6980
    :try_start_36
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 6969
    monitor-exit p0

    goto :goto_19

    .line 6982
    .end local v0           #N:I
    .end local v2           #i:I
    .end local v3           #origId:J
    .end local v5           #tr:Lcom/android/server/am/TaskRecord;
    :catchall_3b
    move-exception v6

    monitor-exit p0
    :try_end_3d
    .catchall {:try_start_36 .. :try_end_3d} :catchall_3b

    throw v6

    .line 6965
    .restart local v0       #N:I
    .restart local v2       #i:I
    .restart local v3       #origId:J
    .restart local v5       #tr:Lcom/android/server/am/TaskRecord;
    :cond_3e
    add-int/lit8 v2, v2, 0x1

    goto :goto_25

    .line 6972
    .end local v5           #tr:Lcom/android/server/am/TaskRecord;
    :cond_41
    :try_start_41
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    const/4 v7, 0x1

    sub-int v2, v6, v7

    :goto_4a
    if-ltz v2, :cond_6c

    .line 6973
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    .line 6974
    .local v1, hr:Lcom/android/server/am/HistoryRecord;
    iget-object v6, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    iget v6, v6, Lcom/android/server/am/TaskRecord;->taskId:I

    if-ne v6, p1, :cond_64

    .line 6975
    iget-object v6, v1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    invoke-direct {p0, v6}, Lcom/android/server/am/ActivityManagerService;->moveTaskToFrontLocked(Lcom/android/server/am/TaskRecord;)V
    :try_end_5f
    .catchall {:try_start_41 .. :try_end_5f} :catchall_67

    .line 6980
    :try_start_5f
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 6976
    monitor-exit p0

    goto :goto_19

    .line 6972
    :cond_64
    add-int/lit8 v2, v2, -0x1

    goto :goto_4a

    .line 6980
    .end local v0           #N:I
    .end local v1           #hr:Lcom/android/server/am/HistoryRecord;
    .end local v2           #i:I
    :catchall_67
    move-exception v6

    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v6

    .restart local v0       #N:I
    .restart local v2       #i:I
    :cond_6c
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 6982
    monitor-exit p0
    :try_end_70
    .catchall {:try_start_5f .. :try_end_70} :catchall_3b

    goto :goto_19
.end method

.method final newProcessRecordLocked(Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)Lcom/android/server/am/ProcessRecord;
    .registers 8
    .parameter "thread"
    .parameter "info"
    .parameter "customProcess"

    .prologue
    .line 7763
    if-eqz p3, :cond_18

    move-object v0, p3

    .line 7764
    .local v0, proc:Ljava/lang/String;
    :goto_3
    const/4 v1, 0x0

    .line 7765
    .local v1, ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v3}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v2

    .line 7766
    .local v2, stats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v2

    .line 7767
    :try_start_b
    iget v3, p2, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-virtual {v2, v3, v0}, Lcom/android/internal/os/BatteryStatsImpl;->getProcessStatsLocked(ILjava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-result-object v1

    .line 7768
    monitor-exit v2
    :try_end_12
    .catchall {:try_start_b .. :try_end_12} :catchall_1c

    .line 7769
    new-instance v3, Lcom/android/server/am/ProcessRecord;

    invoke-direct {v3, v1, p1, p2, v0}, Lcom/android/server/am/ProcessRecord;-><init>(Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;Landroid/app/IApplicationThread;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;)V

    return-object v3

    .line 7763
    .end local v0           #proc:Ljava/lang/String;
    .end local v1           #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    .end local v2           #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :cond_18
    iget-object v3, p2, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    move-object v0, v3

    goto :goto_3

    .line 7768
    .restart local v0       #proc:Ljava/lang/String;
    .restart local v1       #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    .restart local v2       #stats:Lcom/android/internal/os/BatteryStatsImpl;
    :catchall_1c
    move-exception v3

    :try_start_1d
    monitor-exit v2
    :try_end_1e
    .catchall {:try_start_1d .. :try_end_1e} :catchall_1c

    throw v3
.end method

.method public noteWakeupAlarm(Landroid/content/IIntentSender;)V
    .registers 9
    .parameter "sender"

    .prologue
    .line 8063
    instance-of v6, p1, Lcom/android/server/am/PendingIntentRecord;

    if-nez v6, :cond_5

    .line 8078
    :goto_4
    return-void

    .line 8066
    :cond_5
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v4

    .line 8067
    .local v4, stats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v4

    .line 8068
    :try_start_c
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->isOnBattery()Z

    move-result v6

    if-eqz v6, :cond_33

    .line 8069
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v6}, Lcom/android/server/am/BatteryStatsService;->enforceCallingPermission()V

    .line 8070
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/PendingIntentRecord;

    move-object v3, v0

    .line 8071
    .local v3, rec:Lcom/android/server/am/PendingIntentRecord;
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v1

    .line 8072
    .local v1, MY_UID:I
    iget v6, v3, Lcom/android/server/am/PendingIntentRecord;->uid:I

    if-ne v6, v1, :cond_38

    const/16 v6, 0x3e8

    move v5, v6

    .line 8073
    .local v5, uid:I
    :goto_28
    iget-object v6, v3, Lcom/android/server/am/PendingIntentRecord;->key:Lcom/android/server/am/PendingIntentRecord$Key;

    iget-object v6, v6, Lcom/android/server/am/PendingIntentRecord$Key;->packageName:Ljava/lang/String;

    invoke-virtual {v4, v5, v6}, Lcom/android/internal/os/BatteryStatsImpl;->getPackageStatsLocked(ILjava/lang/String;)Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg;

    move-result-object v2

    .line 8075
    .local v2, pkg:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg;
    invoke-virtual {v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg;->incWakeupsLocked()V

    .line 8077
    .end local v1           #MY_UID:I
    .end local v2           #pkg:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg;
    .end local v3           #rec:Lcom/android/server/am/PendingIntentRecord;
    .end local v5           #uid:I
    :cond_33
    monitor-exit v4

    goto :goto_4

    :catchall_35
    move-exception v6

    monitor-exit v4
    :try_end_37
    .catchall {:try_start_c .. :try_end_37} :catchall_35

    throw v6

    .line 8072
    .restart local v1       #MY_UID:I
    .restart local v3       #rec:Lcom/android/server/am/PendingIntentRecord;
    :cond_38
    :try_start_38
    iget v6, v3, Lcom/android/server/am/PendingIntentRecord;->uid:I
    :try_end_3a
    .catchall {:try_start_38 .. :try_end_3a} :catchall_35

    move v5, v6

    goto :goto_28
.end method

.method public onTransact(ILandroid/os/Parcel;Landroid/os/Parcel;I)Z
    .registers 8
    .parameter "code"
    .parameter "data"
    .parameter "reply"
    .parameter "flags"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 1519
    :try_start_0
    invoke-super {p0, p1, p2, p3, p4}, Landroid/app/ActivityManagerNative;->onTransact(ILandroid/os/Parcel;Landroid/os/Parcel;I)Z
    :try_end_3
    .catch Ljava/lang/RuntimeException; {:try_start_0 .. :try_end_3} :catch_5

    move-result v1

    return v1

    .line 1520
    :catch_5
    move-exception v0

    .line 1523
    .local v0, e:Ljava/lang/RuntimeException;
    instance-of v1, v0, Ljava/lang/SecurityException;

    if-nez v1, :cond_11

    .line 1524
    const-string v1, "ActivityManager"

    const-string v2, "Activity Manager Crash"

    invoke-static {v1, v2, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 1526
    :cond_11
    throw v0
.end method

.method public openContentUri(Landroid/net/Uri;)Landroid/os/ParcelFileDescriptor;
    .registers 9
    .parameter "uri"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 7812
    invoke-virtual {p1}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v1

    .line 7813
    .local v1, name:Ljava/lang/String;
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->getContentProviderExternal(Ljava/lang/String;)Landroid/app/IActivityManager$ContentProviderHolder;

    move-result-object v0

    .line 7814
    .local v0, cph:Landroid/app/IActivityManager$ContentProviderHolder;
    const/4 v2, 0x0

    .line 7815
    .local v2, pfd:Landroid/os/ParcelFileDescriptor;
    if-eqz v0, :cond_35

    .line 7823
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    new-instance v4, Lcom/android/server/am/ActivityManagerService$Identity;

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-direct {v4, p0, v5, v6}, Lcom/android/server/am/ActivityManagerService$Identity;-><init>(Lcom/android/server/am/ActivityManagerService;II)V

    invoke-virtual {v3, v4}, Ljava/lang/ThreadLocal;->set(Ljava/lang/Object;)V

    .line 7826
    :try_start_1d
    iget-object v3, v0, Landroid/app/IActivityManager$ContentProviderHolder;->provider:Landroid/content/IContentProvider;

    const-string v4, "r"

    invoke-interface {v3, p1, v4}, Landroid/content/IContentProvider;->openFile(Landroid/net/Uri;Ljava/lang/String;)Landroid/os/ParcelFileDescriptor;
    :try_end_24
    .catchall {:try_start_1d .. :try_end_24} :catchall_2e
    .catch Ljava/io/FileNotFoundException; {:try_start_1d .. :try_end_24} :catch_54

    move-result-object v2

    .line 7831
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    :goto_27
    invoke-virtual {v3}, Ljava/lang/ThreadLocal;->remove()V

    .line 7835
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->removeContentProviderExternal(Ljava/lang/String;)V

    .line 7839
    :goto_2d
    return-object v2

    .line 7831
    :catchall_2e
    move-exception v3

    sget-object v4, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    invoke-virtual {v4}, Ljava/lang/ThreadLocal;->remove()V

    throw v3

    .line 7837
    :cond_35
    const-string v3, "ActivityManager"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Failed to get provider for authority \'"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "\'"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_2d

    .line 7827
    :catch_54
    move-exception v3

    .line 7831
    sget-object v3, Lcom/android/server/am/ActivityManagerService;->sCallerIdentity:Ljava/lang/ThreadLocal;

    goto :goto_27
.end method

.method pauseIfSleepingLocked()V
    .registers 3

    .prologue
    .line 7893
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    if-nez v0, :cond_8

    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    if-eqz v0, :cond_32

    .line 7894
    :cond_8
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v0

    if-nez v0, :cond_29

    .line 7895
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->acquire()V

    .line 7896
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v0

    if-eqz v0, :cond_29

    .line 7897
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingActivity:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->release()V

    .line 7898
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v1, 0x10

    invoke-virtual {v0, v1}, Landroid/os/Handler;->removeMessages(I)V

    .line 7905
    :cond_29
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-nez v0, :cond_32

    .line 7908
    const/4 v0, 0x0

    const/4 v1, 0x1

    invoke-direct {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->startPausingLocked(ZZ)V

    .line 7911
    :cond_32
    return-void
.end method

.method public peekService(Landroid/content/Intent;Ljava/lang/String;)Landroid/os/IBinder;
    .registers 9
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    .line 10472
    if-eqz p1, :cond_11

    invoke-virtual {p1}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v3

    const/4 v4, 0x1

    if-ne v3, v4, :cond_11

    .line 10473
    new-instance v3, Ljava/lang/IllegalArgumentException;

    const-string v4, "File descriptors passed in Intent"

    invoke-direct {v3, v4}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 10476
    :cond_11
    const/4 v2, 0x0

    .line 10478
    .local v2, ret:Landroid/os/IBinder;
    monitor-enter p0

    .line 10479
    :try_start_13
    invoke-direct {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->findServiceLocked(Landroid/content/Intent;Ljava/lang/String;)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    move-result-object v1

    .line 10481
    .local v1, r:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    if-eqz v1, :cond_77

    .line 10483
    iget-object v3, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    if-nez v3, :cond_65

    .line 10484
    new-instance v3, Ljava/lang/SecurityException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Permission Denial: Accessing service "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v5, v5, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " from pid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ", uid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " requires "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    iget-object v5, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->permission:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 10495
    .end local v1           #r:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    :catchall_62
    move-exception v3

    monitor-exit p0
    :try_end_64
    .catchall {:try_start_13 .. :try_end_64} :catchall_62

    throw v3

    .line 10490
    .restart local v1       #r:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    :cond_65
    :try_start_65
    iget-object v3, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v3, v3, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    iget-object v4, v1, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v4, v4, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v3, v4}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/IntentBindRecord;

    .line 10491
    .local v0, ib:Lcom/android/server/am/IntentBindRecord;
    if-eqz v0, :cond_77

    .line 10492
    iget-object v2, v0, Lcom/android/server/am/IntentBindRecord;->binder:Landroid/os/IBinder;

    .line 10495
    .end local v0           #ib:Lcom/android/server/am/IntentBindRecord;
    :cond_77
    monitor-exit p0
    :try_end_78
    .catchall {:try_start_65 .. :try_end_78} :catchall_62

    .line 10497
    return-object v2
.end method

.method final performAppGcLocked(Lcom/android/server/am/ProcessRecord;)V
    .registers 4
    .parameter "app"

    .prologue
    .line 12750
    :try_start_0
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    iput-wide v0, p1, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    .line 12751
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_16

    .line 12752
    iget-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    if-eqz v0, :cond_17

    .line 12753
    const/4 v0, 0x0

    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    .line 12754
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0}, Landroid/app/IApplicationThread;->scheduleLowMemory()V

    .line 12762
    :cond_16
    :goto_16
    return-void

    .line 12756
    :cond_17
    iget-object v0, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0}, Landroid/app/IApplicationThread;->processInBackground()V
    :try_end_1c
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_1c} :catch_1d

    goto :goto_16

    .line 12759
    :catch_1d
    move-exception v0

    goto :goto_16
.end method

.method final performAppGcsIfAppropriateLocked()V
    .registers 2

    .prologue
    .line 12811
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->canGcNow()Z

    move-result v0

    if-eqz v0, :cond_a

    .line 12812
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->performAppGcsLocked()V

    .line 12817
    :goto_9
    return-void

    .line 12816
    :cond_a
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    goto :goto_9
.end method

.method final performAppGcsLocked()V
    .registers 7

    .prologue
    .line 12779
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 12780
    .local v0, N:I
    if-gtz v0, :cond_9

    .line 12805
    :cond_8
    :goto_8
    return-void

    .line 12783
    :cond_9
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->canGcNow()Z

    move-result v2

    if-eqz v2, :cond_8

    .line 12784
    :cond_f
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    if-lez v2, :cond_42

    .line 12785
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    const/4 v3, 0x0

    invoke-virtual {v2, v3}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 12786
    .local v1, proc:Lcom/android/server/am/ProcessRecord;
    iget v2, v1, Lcom/android/server/am/ProcessRecord;->curRawAdj:I

    iget v3, p0, Lcom/android/server/am/ActivityManagerService;->VISIBLE_APP_ADJ:I

    if-gt v2, v3, :cond_2a

    iget-boolean v2, v1, Lcom/android/server/am/ProcessRecord;->reportLowMemory:Z

    if-eqz v2, :cond_f

    .line 12787
    :cond_2a
    iget-wide v2, v1, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    const-wide/32 v4, 0xea60

    add-long/2addr v2, v4

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v4

    cmp-long v2, v2, v4

    if-gtz v2, :cond_3f

    .line 12791
    invoke-virtual {p0, v1}, Lcom/android/server/am/ActivityManagerService;->performAppGcLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 12792
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    goto :goto_8

    .line 12797
    :cond_3f
    invoke-virtual {p0, v1}, Lcom/android/server/am/ActivityManagerService;->addProcessToGcListLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 12803
    .end local v1           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_42
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    goto :goto_8
.end method

.method final performServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)V
    .registers 4
    .parameter "r"

    .prologue
    .line 10172
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRestartingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_9

    .line 10176
    :goto_8
    return-void

    .line 10175
    :cond_9
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v0}, Landroid/content/Intent$FilterComparison;->getIntent()Landroid/content/Intent;

    move-result-object v0

    invoke-virtual {v0}, Landroid/content/Intent;->getFlags()I

    move-result v0

    const/4 v1, 0x1

    invoke-direct {p0, p1, v0, v1}, Lcom/android/server/am/ActivityManagerService;->bringUpServiceLocked(Lcom/android/server/am/ServiceRecord;IZ)Z

    goto :goto_8
.end method

.method final processStoppingActivitiesLocked(Z)Ljava/util/ArrayList;
    .registers 9
    .parameter "remove"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(Z)",
            "Ljava/util/ArrayList",
            "<",
            "Lcom/android/server/am/HistoryRecord;",
            ">;"
        }
    .end annotation

    .prologue
    const/4 v6, 0x0

    .line 5325
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 5326
    .local v0, N:I
    if-gtz v0, :cond_b

    const/4 v5, 0x0

    .line 5363
    :goto_a
    return-object v5

    .line 5328
    :cond_b
    const/4 v4, 0x0

    .line 5330
    .local v4, stops:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_5b

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    iget-boolean v5, v5, Lcom/android/server/am/HistoryRecord;->nowVisible:Z

    if-eqz v5, :cond_5b

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    iget-boolean v5, v5, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    if-nez v5, :cond_5b

    const/4 v5, 0x1

    move v2, v5

    .line 5333
    .local v2, nowVisible:Z
    :goto_1e
    const/4 v1, 0x0

    .local v1, i:I
    :goto_1f
    if-ge v1, v0, :cond_5d

    .line 5334
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/HistoryRecord;

    .line 5338
    .local v3, s:Lcom/android/server/am/HistoryRecord;
    iget-boolean v5, v3, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    if-eqz v5, :cond_3f

    if-eqz v2, :cond_3f

    .line 5339
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWaitingVisibleActivities:Ljava/util/ArrayList;

    invoke-virtual {v5, v3}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 5340
    iput-boolean v6, v3, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    .line 5341
    iget-boolean v5, v3, Lcom/android/server/am/HistoryRecord;->finishing:Z

    if-eqz v5, :cond_3f

    .line 5348
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v5, v3, v6}, Lcom/android/server/WindowManagerService;->setAppVisibility(Landroid/os/IBinder;Z)V

    .line 5351
    :cond_3f
    iget-boolean v5, v3, Lcom/android/server/am/HistoryRecord;->waitingVisible:Z

    if-nez v5, :cond_58

    if-eqz p1, :cond_58

    .line 5353
    if-nez v4, :cond_4c

    .line 5354
    new-instance v4, Ljava/util/ArrayList;

    .end local v4           #stops:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    invoke-direct {v4}, Ljava/util/ArrayList;-><init>()V

    .line 5356
    .restart local v4       #stops:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/HistoryRecord;>;"
    :cond_4c
    invoke-virtual {v4, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 5357
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingActivities:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 5358
    add-int/lit8 v0, v0, -0x1

    .line 5359
    add-int/lit8 v1, v1, -0x1

    .line 5333
    :cond_58
    add-int/lit8 v1, v1, 0x1

    goto :goto_1f

    .end local v1           #i:I
    .end local v2           #nowVisible:Z
    .end local v3           #s:Lcom/android/server/am/HistoryRecord;
    :cond_5b
    move v2, v6

    .line 5330
    goto :goto_1e

    .restart local v1       #i:I
    .restart local v2       #nowVisible:Z
    :cond_5d
    move-object v5, v4

    .line 5363
    goto :goto_a
.end method

.method public profileControl(Ljava/lang/String;ZLjava/lang/String;Landroid/os/ParcelFileDescriptor;)Z
    .registers 15
    .parameter "process"
    .parameter "start"
    .parameter "path"
    .parameter "fd"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 13247
    :try_start_0
    monitor-enter p0
    :try_end_1
    .catchall {:try_start_0 .. :try_end_1} :catchall_1e
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_1} :catch_14

    .line 13250
    :try_start_1
    const-string v7, "android.permission.SET_ACTIVITY_WATCHER"

    invoke-virtual {p0, v7}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v7

    if-eqz v7, :cond_25

    .line 13252
    new-instance v7, Ljava/lang/SecurityException;

    const-string v8, "Requires permission android.permission.SET_ACTIVITY_WATCHER"

    invoke-direct {v7, v8}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v7

    .line 13292
    :catchall_11
    move-exception v7

    monitor-exit p0
    :try_end_13
    .catchall {:try_start_1 .. :try_end_13} :catchall_11

    :try_start_13
    throw v7
    :try_end_14
    .catchall {:try_start_13 .. :try_end_14} :catchall_1e
    .catch Landroid/os/RemoteException; {:try_start_13 .. :try_end_14} :catch_14

    .line 13293
    :catch_14
    move-exception v7

    move-object v2, v7

    .line 13294
    .local v2, e:Landroid/os/RemoteException;
    :try_start_16
    new-instance v7, Ljava/lang/IllegalStateException;

    const-string v8, "Process disappeared"

    invoke-direct {v7, v8}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw v7
    :try_end_1e
    .catchall {:try_start_16 .. :try_end_1e} :catchall_1e

    .line 13296
    .end local v2           #e:Landroid/os/RemoteException;
    :catchall_1e
    move-exception v7

    if-eqz p4, :cond_24

    .line 13298
    :try_start_21
    invoke-virtual {p4}, Landroid/os/ParcelFileDescriptor;->close()V
    :try_end_24
    .catch Ljava/io/IOException; {:try_start_21 .. :try_end_24} :catch_c4

    .line 13296
    :cond_24
    :goto_24
    throw v7

    .line 13256
    :cond_25
    if-eqz p2, :cond_31

    if-nez p4, :cond_31

    .line 13257
    :try_start_29
    new-instance v7, Ljava/lang/IllegalArgumentException;

    const-string v8, "null fd"

    invoke-direct {v7, v8}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v7
    :try_end_31
    .catchall {:try_start_29 .. :try_end_31} :catchall_11

    .line 13260
    :cond_31
    const/4 v5, 0x0

    .line 13262
    .local v5, proc:Lcom/android/server/am/ProcessRecord;
    :try_start_32
    invoke-static {p1}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I

    move-result v4

    .line 13263
    .local v4, pid:I
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v8
    :try_end_39
    .catchall {:try_start_32 .. :try_end_39} :catchall_11
    .catch Ljava/lang/NumberFormatException; {:try_start_32 .. :try_end_39} :catch_83

    .line 13264
    :try_start_39
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v7, v4}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v7

    move-object v0, v7

    check-cast v0, Lcom/android/server/am/ProcessRecord;

    move-object v5, v0

    .line 13265
    monitor-exit v8
    :try_end_44
    .catchall {:try_start_39 .. :try_end_44} :catchall_80

    .line 13269
    .end local v4           #pid:I
    :goto_44
    if-nez v5, :cond_61

    .line 13270
    :try_start_46
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mProcessNames:Lcom/android/server/ProcessMap;

    invoke-virtual {v7}, Lcom/android/server/ProcessMap;->getMap()Ljava/util/HashMap;

    move-result-object v1

    .line 13272
    .local v1, all:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;>;"
    invoke-virtual {v1, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/util/SparseArray;

    .line 13273
    .local v6, procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    if-eqz v6, :cond_61

    invoke-virtual {v6}, Landroid/util/SparseArray;->size()I

    move-result v7

    if-lez v7, :cond_61

    .line 13274
    const/4 v7, 0x0

    invoke-virtual {v6, v7}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v5

    .end local v5           #proc:Lcom/android/server/am/ProcessRecord;
    check-cast v5, Lcom/android/server/am/ProcessRecord;

    .line 13278
    .end local v1           #all:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;>;"
    .end local v6           #procs:Landroid/util/SparseArray;,"Landroid/util/SparseArray<Lcom/android/server/am/ProcessRecord;>;"
    .restart local v5       #proc:Lcom/android/server/am/ProcessRecord;
    :cond_61
    if-eqz v5, :cond_67

    iget-object v7, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v7, :cond_85

    .line 13279
    :cond_67
    new-instance v7, Ljava/lang/IllegalArgumentException;

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Unknown process: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-direct {v7, v8}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v7
    :try_end_80
    .catchall {:try_start_46 .. :try_end_80} :catchall_11

    .line 13265
    .restart local v4       #pid:I
    :catchall_80
    move-exception v7

    :try_start_81
    monitor-exit v8
    :try_end_82
    .catchall {:try_start_81 .. :try_end_82} :catchall_80

    :try_start_82
    throw v7
    :try_end_83
    .catchall {:try_start_82 .. :try_end_83} :catchall_11
    .catch Ljava/lang/NumberFormatException; {:try_start_82 .. :try_end_83} :catch_83

    .line 13266
    .end local v4           #pid:I
    :catch_83
    move-exception v7

    goto :goto_44

    .line 13282
    :cond_85
    :try_start_85
    const-string v7, "1"

    const-string v8, "ro.secure"

    const-string v9, "0"

    invoke-static {v8, v9}, Landroid/os/SystemProperties;->get(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    .line 13283
    .local v3, isSecure:Z
    if-eqz v3, :cond_b6

    .line 13284
    iget-object v7, v5, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v7, v7, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v7, v7, 0x2

    if-nez v7, :cond_b6

    .line 13285
    new-instance v7, Ljava/lang/SecurityException;

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Process not debuggable: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-direct {v7, v8}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v7

    .line 13289
    :cond_b6
    iget-object v7, v5, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v7, p2, p3, p4}, Landroid/app/IApplicationThread;->profilerControl(ZLjava/lang/String;Landroid/os/ParcelFileDescriptor;)V

    .line 13290
    const/4 p4, 0x0

    .line 13291
    const/4 v7, 0x1

    monitor-exit p0
    :try_end_be
    .catchall {:try_start_85 .. :try_end_be} :catchall_11

    .line 13296
    if-eqz p4, :cond_c3

    .line 13298
    :try_start_c0
    #Replaced unresolvable odex instruction with a throw
    throw p4
    #invoke-virtual-quick {p4}, vtable@0xb
    :try_end_c3
    .catch Ljava/io/IOException; {:try_start_c0 .. :try_end_c3} :catch_c7

    .line 13291
    :cond_c3
    :goto_c3
    return v7

    .line 13299
    .end local v3           #isSecure:Z
    .end local v5           #proc:Lcom/android/server/am/ProcessRecord;
    :catch_c4
    move-exception v8

    goto/16 :goto_24

    .restart local v3       #isSecure:Z
    .restart local v5       #proc:Lcom/android/server/am/ProcessRecord;
    :catch_c7
    move-exception v8

    goto :goto_c3
.end method

.method public final publishContentProviders(Landroid/app/IApplicationThread;Ljava/util/List;)V
    .registers 16
    .parameter "caller"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Landroid/app/IApplicationThread;",
            "Ljava/util/List",
            "<",
            "Landroid/app/IActivityManager$ContentProviderHolder;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 7699
    .local p2, providers:Ljava/util/List;,"Ljava/util/List<Landroid/app/IActivityManager$ContentProviderHolder;>;"
    if-nez p2, :cond_3

    .line 7749
    :goto_2
    return-void

    .line 7703
    :cond_3
    monitor-enter p0

    .line 7704
    :try_start_4
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v8

    .line 7705
    .local v8, r:Lcom/android/server/am/ProcessRecord;
    if-nez v8, :cond_3a

    .line 7706
    new-instance v10, Ljava/lang/SecurityException;

    new-instance v11, Ljava/lang/StringBuilder;

    invoke-direct {v11}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "Unable to find app for caller "

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, " (pid="

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v12

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v11

    const-string v12, ") when publishing content providers"

    invoke-virtual {v11, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v11

    invoke-virtual {v11}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-direct {v10, v11}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v10

    .line 7748
    .end local v8           #r:Lcom/android/server/am/ProcessRecord;
    :catchall_37
    move-exception v10

    monitor-exit p0
    :try_end_39
    .catchall {:try_start_4 .. :try_end_39} :catchall_37

    throw v10

    .line 7712
    .restart local v8       #r:Lcom/android/server/am/ProcessRecord;
    :cond_3a
    :try_start_3a
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 7714
    .local v6, origId:J
    invoke-interface {p2}, Ljava/util/List;->size()I

    move-result v0

    .line 7715
    .local v0, N:I
    const/4 v3, 0x0

    .local v3, i:I
    :goto_43
    if-ge v3, v0, :cond_b6

    .line 7716
    invoke-interface {p2, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Landroid/app/IActivityManager$ContentProviderHolder;

    .line 7717
    .local v9, src:Landroid/app/IActivityManager$ContentProviderHolder;
    if-eqz v9, :cond_55

    iget-object v10, v9, Landroid/app/IActivityManager$ContentProviderHolder;->info:Landroid/content/pm/ProviderInfo;

    if-eqz v10, :cond_55

    iget-object v10, v9, Landroid/app/IActivityManager$ContentProviderHolder;->provider:Landroid/content/IContentProvider;

    if-nez v10, :cond_58

    .line 7715
    :cond_55
    :goto_55
    add-int/lit8 v3, v3, 0x1

    goto :goto_43

    .line 7720
    :cond_58
    iget-object v10, v8, Lcom/android/server/am/ProcessRecord;->pubProviders:Ljava/util/HashMap;

    iget-object v11, v9, Landroid/app/IActivityManager$ContentProviderHolder;->info:Landroid/content/pm/ProviderInfo;

    iget-object v11, v11, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v10, v11}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ContentProviderRecord;

    .line 7722
    .local v2, dst:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v2, :cond_55

    .line 7723
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v11, v2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v11, v11, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v10, v11, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7724
    iget-object v10, v2, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v10, v10, Landroid/content/pm/ProviderInfo;->authority:Ljava/lang/String;

    const-string v11, ";"

    invoke-virtual {v10, v11}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v5

    .line 7725
    .local v5, names:[Ljava/lang/String;
    const/4 v4, 0x0

    .local v4, j:I
    :goto_7a
    array-length v10, v5

    if-ge v4, v10, :cond_87

    .line 7726
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    aget-object v11, v5, v4

    invoke-virtual {v10, v11, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 7725
    add-int/lit8 v4, v4, 0x1

    goto :goto_7a

    .line 7729
    :cond_87
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v10}, Ljava/util/ArrayList;->size()I

    move-result v1

    .line 7731
    .local v1, NL:I
    const/4 v4, 0x0

    :goto_8e
    if-ge v4, v1, :cond_a4

    .line 7732
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v10, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v10

    if-ne v10, v2, :cond_a1

    .line 7733
    iget-object v10, p0, Lcom/android/server/am/ActivityManagerService;->mLaunchingProviders:Ljava/util/ArrayList;

    invoke-virtual {v10, v4}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 7734
    add-int/lit8 v4, v4, -0x1

    .line 7735
    add-int/lit8 v1, v1, -0x1

    .line 7731
    :cond_a1
    add-int/lit8 v4, v4, 0x1

    goto :goto_8e

    .line 7738
    :cond_a4
    monitor-enter v2
    :try_end_a5
    .catchall {:try_start_3a .. :try_end_a5} :catchall_37

    .line 7739
    :try_start_a5
    iget-object v10, v9, Landroid/app/IActivityManager$ContentProviderHolder;->provider:Landroid/content/IContentProvider;

    iput-object v10, v2, Lcom/android/server/am/ContentProviderRecord;->provider:Landroid/content/IContentProvider;

    .line 7740
    iput-object v8, v2, Lcom/android/server/am/ContentProviderRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 7741
    invoke-virtual {v2}, Ljava/lang/Object;->notifyAll()V

    .line 7742
    monitor-exit v2
    :try_end_af
    .catchall {:try_start_a5 .. :try_end_af} :catchall_b3

    .line 7743
    :try_start_af
    invoke-direct {p0, v8}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z
    :try_end_b2
    .catchall {:try_start_af .. :try_end_b2} :catchall_37

    goto :goto_55

    .line 7742
    :catchall_b3
    move-exception v10

    :try_start_b4
    monitor-exit v2
    :try_end_b5
    .catchall {:try_start_b4 .. :try_end_b5} :catchall_b3

    :try_start_b5
    throw v10

    .line 7747
    .end local v1           #NL:I
    .end local v2           #dst:Lcom/android/server/am/ContentProviderRecord;
    .end local v4           #j:I
    .end local v5           #names:[Ljava/lang/String;
    .end local v9           #src:Landroid/app/IActivityManager$ContentProviderHolder;
    :cond_b6
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7748
    monitor-exit p0
    :try_end_ba
    .catchall {:try_start_b5 .. :try_end_ba} :catchall_37

    goto/16 :goto_2
.end method

.method public publishService(Landroid/os/IBinder;Landroid/content/Intent;Landroid/os/IBinder;)V
    .registers 16
    .parameter "token"
    .parameter "intent"
    .parameter "service"

    .prologue
    const/4 v10, 0x1

    .line 10733
    if-eqz p2, :cond_11

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v9

    if-ne v9, v10, :cond_11

    .line 10734
    new-instance v9, Ljava/lang/IllegalArgumentException;

    const-string v10, "File descriptors passed in Intent"

    invoke-direct {v9, v10}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v9

    .line 10737
    :cond_11
    monitor-enter p0

    .line 10738
    :try_start_12
    instance-of v9, p1, Lcom/android/server/am/ServiceRecord;

    if-nez v9, :cond_21

    .line 10739
    new-instance v9, Ljava/lang/IllegalArgumentException;

    const-string v10, "Invalid service token"

    invoke-direct {v9, v10}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v9

    .line 10785
    :catchall_1e
    move-exception v9

    monitor-exit p0
    :try_end_20
    .catchall {:try_start_12 .. :try_end_20} :catchall_1e

    throw v9

    .line 10741
    :cond_21
    :try_start_21
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object v8, v0

    .line 10743
    .local v8, r:Lcom/android/server/am/ServiceRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 10747
    .local v6, origId:J
    if-eqz v8, :cond_c7

    .line 10748
    new-instance v4, Landroid/content/Intent$FilterComparison;

    invoke-direct {v4, p2}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V

    .line 10750
    .local v4, filter:Landroid/content/Intent$FilterComparison;
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v9, v4}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/IntentBindRecord;

    .line 10751
    .local v1, b:Lcom/android/server/am/IntentBindRecord;
    if-eqz v1, :cond_bb

    iget-boolean v9, v1, Lcom/android/server/am/IntentBindRecord;->received:Z

    if-nez v9, :cond_bb

    .line 10752
    iput-object p3, v1, Lcom/android/server/am/IntentBindRecord;->binder:Landroid/os/IBinder;

    .line 10753
    const/4 v9, 0x1

    iput-boolean v9, v1, Lcom/android/server/am/IntentBindRecord;->requested:Z

    .line 10754
    const/4 v9, 0x1

    iput-boolean v9, v1, Lcom/android/server/am/IntentBindRecord;->received:Z

    .line 10755
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->size()I

    move-result v9

    if-lez v9, :cond_bb

    .line 10756
    iget-object v9, v8, Lcom/android/server/am/ServiceRecord;->connections:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v5

    .line 10758
    .local v5, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_58
    :goto_58
    invoke-interface {v5}, Ljava/util/Iterator;->hasNext()Z

    move-result v9

    if-eqz v9, :cond_bb

    .line 10759
    invoke-interface {v5}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ConnectionRecord;

    .line 10760
    .local v2, c:Lcom/android/server/am/ConnectionRecord;
    iget-object v9, v2, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v9, v9, Lcom/android/server/am/AppBindRecord;->intent:Lcom/android/server/am/IntentBindRecord;

    iget-object v9, v9, Lcom/android/server/am/IntentBindRecord;->intent:Landroid/content/Intent$FilterComparison;

    invoke-virtual {v4, v9}, Landroid/content/Intent$FilterComparison;->equals(Ljava/lang/Object;)Z
    :try_end_6d
    .catchall {:try_start_21 .. :try_end_6d} :catchall_1e

    move-result v9

    if-eqz v9, :cond_58

    .line 10771
    :try_start_70
    iget-object v9, v2, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    iget-object v10, v8, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-interface {v9, v10, p3}, Landroid/app/IServiceConnection;->connected(Landroid/content/ComponentName;Landroid/os/IBinder;)V
    :try_end_77
    .catchall {:try_start_70 .. :try_end_77} :catchall_1e
    .catch Ljava/lang/Exception; {:try_start_70 .. :try_end_77} :catch_78

    goto :goto_58

    .line 10772
    :catch_78
    move-exception v9

    move-object v3, v9

    .line 10773
    .local v3, e:Ljava/lang/Exception;
    :try_start_7a
    const-string v9, "ActivityManager"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Failure sending service "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    iget-object v11, v8, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, " to connection "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    iget-object v11, v2, Lcom/android/server/am/ConnectionRecord;->conn:Landroid/app/IServiceConnection;

    invoke-interface {v11}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v11

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, " (in "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    iget-object v11, v2, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v11, v11, Lcom/android/server/am/AppBindRecord;->client:Lcom/android/server/am/ProcessRecord;

    iget-object v11, v11, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, ")"

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10, v3}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_58

    .line 10781
    .end local v2           #c:Lcom/android/server/am/ConnectionRecord;
    .end local v3           #e:Ljava/lang/Exception;
    .end local v5           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ConnectionRecord;>;"
    :cond_bb
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v9, v8}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v9

    invoke-virtual {p0, v8, v9}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 10783
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 10785
    .end local v1           #b:Lcom/android/server/am/IntentBindRecord;
    .end local v4           #filter:Landroid/content/Intent$FilterComparison;
    :cond_c7
    monitor-exit p0
    :try_end_c8
    .catchall {:try_start_7a .. :try_end_c8} :catchall_1e

    .line 10786
    return-void
.end method

.method final readFile(Ljava/lang/String;)Ljava/lang/String;
    .registers 8
    .parameter "filename"

    .prologue
    .line 4538
    :try_start_0
    new-instance v0, Ljava/io/FileInputStream;

    invoke-direct {v0, p1}, Ljava/io/FileInputStream;-><init>(Ljava/lang/String;)V

    .line 4539
    .local v0, fs:Ljava/io/FileInputStream;
    const/16 v3, 0x2000

    new-array v1, v3, [B

    .line 4540
    .local v1, inp:[B
    invoke-virtual {v0, v1}, Ljava/io/FileInputStream;->read([B)I

    move-result v2

    .line 4541
    .local v2, size:I
    invoke-virtual {v0}, Ljava/io/FileInputStream;->close()V

    .line 4542
    new-instance v3, Ljava/lang/String;

    const/4 v4, 0x0

    const/4 v5, 0x0

    invoke-direct {v3, v1, v4, v5, v2}, Ljava/lang/String;-><init>([BIII)V
    :try_end_17
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_17} :catch_18

    .line 4545
    .end local v0           #fs:Ljava/io/FileInputStream;
    .end local v1           #inp:[B
    .end local v2           #size:I
    :goto_17
    return-object v3

    .line 4543
    :catch_18
    move-exception v3

    .line 4545
    const-string v3, ""

    goto :goto_17
.end method

.method public registerActivityWatcher(Landroid/app/IActivityWatcher;)V
    .registers 3
    .parameter "watcher"

    .prologue
    .line 8029
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v0, p1}, Landroid/os/RemoteCallbackList;->register(Landroid/os/IInterface;)Z

    .line 8030
    return-void
.end method

.method public registerReceiver(Landroid/app/IApplicationThread;Landroid/content/IIntentReceiver;Landroid/content/IntentFilter;Ljava/lang/String;)Landroid/content/Intent;
    .registers 33
    .parameter "caller"
    .parameter "receiver"
    .parameter "filter"
    .parameter "permission"

    .prologue
    .line 11060
    monitor-enter p0

    .line 11061
    const/4 v6, 0x0

    .line 11062
    .local v6, callerApp:Lcom/android/server/am/ProcessRecord;
    if-eqz p1, :cond_44

    .line 11063
    :try_start_4
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v6

    .line 11064
    if-nez v6, :cond_44

    .line 11065
    new-instance v5, Ljava/lang/SecurityException;

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unable to find app for caller "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " (pid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ") when registering receiver "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object v0, v7

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-direct {v5, v7}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 11141
    .end local p1
    :catchall_41
    move-exception v5

    monitor-exit p0
    :try_end_43
    .catchall {:try_start_4 .. :try_end_43} :catchall_41

    throw v5

    .line 11072
    .restart local p1
    :cond_44
    const/16 v23, 0x0

    .line 11075
    .local v23, allSticky:Ljava/util/List;
    :try_start_46
    invoke-virtual/range {p3 .. p3}, Landroid/content/IntentFilter;->actionsIterator()Ljava/util/Iterator;

    move-result-object v22

    .line 11076
    .local v22, actions:Ljava/util/Iterator;
    if-eqz v22, :cond_65

    .line 11077
    :goto_4c
    invoke-interface/range {v22 .. v22}, Ljava/util/Iterator;->hasNext()Z

    move-result v5

    if-eqz v5, :cond_71

    .line 11078
    invoke-interface/range {v22 .. v22}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v21

    check-cast v21, Ljava/lang/String;

    .line 11079
    .local v21, action:Ljava/lang/String;
    move-object/from16 v0, p0

    move-object/from16 v1, v21

    move-object/from16 v2, p3

    move-object/from16 v3, v23

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->getStickies(Ljava/lang/String;Landroid/content/IntentFilter;Ljava/util/List;)Ljava/util/List;

    move-result-object v23

    .line 11080
    goto :goto_4c

    .line 11082
    .end local v21           #action:Ljava/lang/String;
    :cond_65
    const/4 v5, 0x0

    move-object/from16 v0, p0

    move-object v1, v5

    move-object/from16 v2, p3

    move-object/from16 v3, v23

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->getStickies(Ljava/lang/String;Landroid/content/IntentFilter;Ljava/util/List;)Ljava/util/List;

    move-result-object v23

    .line 11087
    :cond_71
    if-eqz v23, :cond_83

    const/4 v5, 0x0

    move-object/from16 v0, v23

    move v1, v5

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object p1

    .end local p1
    check-cast p1, Landroid/content/Intent;

    move-object/from16 v27, p1

    .line 11092
    .local v27, sticky:Landroid/content/Intent;
    :goto_7f
    if-nez p2, :cond_87

    .line 11093
    monitor-exit p0

    .line 11140
    :goto_82
    return-object v27

    .line 11087
    .end local v27           #sticky:Landroid/content/Intent;
    .restart local p1
    :cond_83
    const/4 v5, 0x0

    move-object/from16 v27, v5

    goto :goto_7f

    .line 11096
    .end local p1
    .restart local v27       #sticky:Landroid/content/Intent;
    :cond_87
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    move-object v5, v0

    invoke-interface/range {p2 .. p2}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v7

    invoke-virtual {v5, v7}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/ReceiverList;

    .line 11098
    .local v4, rl:Lcom/android/server/am/ReceiverList;
    if-nez v4, :cond_c0

    .line 11099
    new-instance v4, Lcom/android/server/am/ReceiverList;

    .end local v4           #rl:Lcom/android/server/am/ReceiverList;
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v7

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v8

    move-object/from16 v5, p0

    move-object/from16 v9, p2

    invoke-direct/range {v4 .. v9}, Lcom/android/server/am/ReceiverList;-><init>(Lcom/android/server/am/ActivityManagerService;Lcom/android/server/am/ProcessRecord;IILandroid/content/IIntentReceiver;)V

    .line 11102
    .restart local v4       #rl:Lcom/android/server/am/ReceiverList;
    iget-object v5, v4, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v5, :cond_139

    .line 11103
    iget-object v5, v4, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v5, v5, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v5, v4}, Ljava/util/HashSet;->add(Ljava/lang/Object;)Z

    .line 11112
    :goto_b4
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    move-object v5, v0

    invoke-interface/range {p2 .. p2}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v7

    invoke-virtual {v5, v7, v4}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 11114
    :cond_c0
    new-instance v24, Lcom/android/server/am/BroadcastFilter;

    move-object/from16 v0, v24

    move-object/from16 v1, p3

    move-object v2, v4

    move-object/from16 v3, p4

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/BroadcastFilter;-><init>(Landroid/content/IntentFilter;Lcom/android/server/am/ReceiverList;Ljava/lang/String;)V

    .line 11115
    .local v24, bf:Lcom/android/server/am/BroadcastFilter;
    move-object v0, v4

    move-object/from16 v1, v24

    invoke-virtual {v0, v1}, Lcom/android/server/am/ReceiverList;->add(Ljava/lang/Object;)Z

    .line 11116
    invoke-virtual/range {v24 .. v24}, Lcom/android/server/am/BroadcastFilter;->debugCheck()Z

    move-result v5

    if-nez v5, :cond_df

    .line 11117
    const-string v5, "ActivityManager"

    const-string v7, "==> For Dynamic broadast"

    invoke-static {v5, v7}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11119
    :cond_df
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    move-object v5, v0

    move-object v0, v5

    move-object/from16 v1, v24

    invoke-virtual {v0, v1}, Lcom/android/server/IntentResolver;->addFilter(Landroid/content/IntentFilter;)V

    .line 11123
    if-eqz v23, :cond_14c

    .line 11124
    new-instance v14, Ljava/util/ArrayList;

    invoke-direct {v14}, Ljava/util/ArrayList;-><init>()V

    .line 11125
    .local v14, receivers:Ljava/util/ArrayList;
    move-object v0, v14

    move-object/from16 v1, v24

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 11127
    invoke-interface/range {v23 .. v23}, Ljava/util/List;->size()I

    move-result v20

    .line 11128
    .local v20, N:I
    const/16 v26, 0x0

    .local v26, i:I
    :goto_fd
    move/from16 v0, v26

    move/from16 v1, v20

    if-ge v0, v1, :cond_14c

    .line 11129
    move-object/from16 v0, v23

    move/from16 v1, v26

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Landroid/content/Intent;

    .line 11130
    .local v8, intent:Landroid/content/Intent;
    new-instance v7, Lcom/android/server/am/BroadcastRecord;

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, -0x1

    const/4 v12, -0x1

    const/4 v13, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    const/16 v17, 0x0

    const/16 v18, 0x0

    const/16 v19, 0x0

    invoke-direct/range {v7 .. v19}, Lcom/android/server/am/BroadcastRecord;-><init>(Landroid/content/Intent;Lcom/android/server/am/ProcessRecord;Ljava/lang/String;IILjava/lang/String;Ljava/util/List;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Z)V

    .line 11133
    .local v7, r:Lcom/android/server/am/BroadcastRecord;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-nez v5, :cond_12e

    .line 11134
    invoke-direct/range {p0 .. p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 11136
    :cond_12e
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mParallelBroadcasts:Ljava/util/ArrayList;

    move-object v5, v0

    invoke-virtual {v5, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_136
    .catchall {:try_start_46 .. :try_end_136} :catchall_41

    .line 11128
    add-int/lit8 v26, v26, 0x1

    goto :goto_fd

    .line 11106
    .end local v7           #r:Lcom/android/server/am/BroadcastRecord;
    .end local v8           #intent:Landroid/content/Intent;
    .end local v14           #receivers:Ljava/util/ArrayList;
    .end local v20           #N:I
    .end local v24           #bf:Lcom/android/server/am/BroadcastFilter;
    .end local v26           #i:I
    :cond_139
    :try_start_139
    invoke-interface/range {p2 .. p2}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v5

    const/4 v7, 0x0

    invoke-interface {v5, v4, v7}, Landroid/os/IBinder;->linkToDeath(Landroid/os/IBinder$DeathRecipient;I)V
    :try_end_141
    .catchall {:try_start_139 .. :try_end_141} :catchall_41
    .catch Landroid/os/RemoteException; {:try_start_139 .. :try_end_141} :catch_146

    .line 11110
    const/4 v5, 0x1

    :try_start_142
    iput-boolean v5, v4, Lcom/android/server/am/ReceiverList;->linkedToDeath:Z

    goto/16 :goto_b4

    .line 11107
    :catch_146
    move-exception v5

    move-object/from16 v25, v5

    .line 11108
    .local v25, e:Landroid/os/RemoteException;
    monitor-exit p0

    goto/16 :goto_82

    .line 11140
    .end local v25           #e:Landroid/os/RemoteException;
    .restart local v24       #bf:Lcom/android/server/am/BroadcastFilter;
    :cond_14c
    monitor-exit p0
    :try_end_14d
    .catchall {:try_start_142 .. :try_end_14d} :catchall_41

    goto/16 :goto_82
.end method

.method public removeContentProvider(Landroid/app/IApplicationThread;Ljava/lang/String;)V
    .registers 9
    .parameter "caller"
    .parameter "name"

    .prologue
    .line 7649
    monitor-enter p0

    .line 7650
    :try_start_1
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v3, p2}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/am/ContentProviderRecord;

    .line 7651
    .local v0, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-nez v0, :cond_d

    .line 7654
    monitor-exit p0

    .line 7676
    :goto_c
    return-void

    .line 7656
    :cond_d
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v2

    .line 7657
    .local v2, r:Lcom/android/server/am/ProcessRecord;
    if-nez v2, :cond_39

    .line 7658
    new-instance v3, Ljava/lang/SecurityException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unable to find app for caller "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " when removing content provider "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 7675
    .end local v0           #cpr:Lcom/android/server/am/ContentProviderRecord;
    .end local v2           #r:Lcom/android/server/am/ProcessRecord;
    :catchall_36
    move-exception v3

    monitor-exit p0
    :try_end_38
    .catchall {:try_start_1 .. :try_end_38} :catchall_36

    throw v3

    .line 7663
    .restart local v0       #cpr:Lcom/android/server/am/ContentProviderRecord;
    .restart local v2       #r:Lcom/android/server/am/ProcessRecord;
    :cond_39
    :try_start_39
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByClass:Ljava/util/HashMap;

    iget-object v4, v0, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    iget-object v4, v4, Landroid/content/pm/ProviderInfo;->name:Ljava/lang/String;

    invoke-virtual {v3, v4}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ContentProviderRecord;

    .line 7666
    .local v1, localCpr:Lcom/android/server/am/ContentProviderRecord;
    iget-object v3, v1, Lcom/android/server/am/ContentProviderRecord;->appInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    iget-object v4, v2, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget-object v4, v4, Landroid/content/pm/ApplicationInfo;->processName:Ljava/lang/String;

    if-ne v3, v4, :cond_51

    .line 7669
    monitor-exit p0

    goto :goto_c

    .line 7671
    :cond_51
    iget-object v3, v1, Lcom/android/server/am/ContentProviderRecord;->clients:Ljava/util/HashSet;

    invoke-virtual {v3, v2}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 7672
    iget-object v3, v2, Lcom/android/server/am/ProcessRecord;->conProviders:Ljava/util/HashSet;

    invoke-virtual {v3, v1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 7674
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 7675
    monitor-exit p0
    :try_end_5f
    .catchall {:try_start_39 .. :try_end_5f} :catchall_36

    goto :goto_c
.end method

.method removeReceiverLocked(Lcom/android/server/am/ReceiverList;)V
    .registers 6
    .parameter "rl"

    .prologue
    .line 11182
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    iget-object v3, p1, Lcom/android/server/am/ReceiverList;->receiver:Landroid/content/IIntentReceiver;

    invoke-interface {v3}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 11183
    invoke-virtual {p1}, Lcom/android/server/am/ReceiverList;->size()I

    move-result v0

    .line 11184
    .local v0, N:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_10
    if-ge v1, v0, :cond_20

    .line 11185
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mReceiverResolver:Lcom/android/server/IntentResolver;

    invoke-virtual {p1, v1}, Lcom/android/server/am/ReceiverList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/content/IntentFilter;

    invoke-virtual {v3, v2}, Lcom/android/server/IntentResolver;->removeFilter(Landroid/content/IntentFilter;)V

    .line 11184
    add-int/lit8 v1, v1, 0x1

    goto :goto_10

    .line 11187
    :cond_20
    return-void
.end method

.method removeRequestedPss(Lcom/android/server/am/ProcessRecord;)V
    .registers 4
    .parameter "proc"

    .prologue
    .line 8175
    const/4 v0, 0x0

    .line 8176
    .local v0, callback:Ljava/lang/Runnable;
    monitor-enter p0

    .line 8177
    :try_start_2
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-virtual {v1, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_17

    .line 8178
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-virtual {v1}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-nez v1, :cond_17

    .line 8179
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssCallback:Ljava/lang/Runnable;

    .line 8180
    const/4 v1, 0x0

    iput-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssCallback:Ljava/lang/Runnable;

    .line 8183
    :cond_17
    monitor-exit p0
    :try_end_18
    .catchall {:try_start_2 .. :try_end_18} :catchall_1e

    .line 8185
    if-eqz v0, :cond_1d

    .line 8186
    invoke-interface {v0}, Ljava/lang/Runnable;->run()V

    .line 8188
    :cond_1d
    return-void

    .line 8183
    :catchall_1e
    move-exception v1

    :try_start_1f
    monitor-exit p0
    :try_end_20
    .catchall {:try_start_1f .. :try_end_20} :catchall_1e

    throw v1
.end method

.method public reportPss(Landroid/app/IApplicationThread;I)V
    .registers 7
    .parameter "caller"
    .parameter "pss"

    .prologue
    .line 8132
    monitor-enter p0

    .line 8133
    if-nez p1, :cond_5

    .line 8134
    :try_start_3
    monitor-exit p0

    .line 8148
    :cond_4
    :goto_4
    return-void

    .line 8136
    :cond_5
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 8137
    .local v0, callerApp:Lcom/android/server/am/ProcessRecord;
    if-nez v0, :cond_10

    .line 8138
    monitor-exit p0

    goto :goto_4

    .line 8143
    .end local v0           #callerApp:Lcom/android/server/am/ProcessRecord;
    :catchall_d
    move-exception v3

    monitor-exit p0
    :try_end_f
    .catchall {:try_start_3 .. :try_end_f} :catchall_d

    throw v3

    .line 8140
    .restart local v0       #callerApp:Lcom/android/server/am/ProcessRecord;
    :cond_10
    :try_start_10
    iput p2, v0, Lcom/android/server/am/ProcessRecord;->lastPss:I

    .line 8141
    move-object v2, v0

    .line 8142
    .local v2, req:Lcom/android/server/Watchdog$PssRequestor;
    iget-object v1, v0, Lcom/android/server/am/ProcessRecord;->processName:Ljava/lang/String;

    .line 8143
    .local v1, name:Ljava/lang/String;
    monitor-exit p0
    :try_end_16
    .catchall {:try_start_10 .. :try_end_16} :catchall_d

    .line 8144
    invoke-static {}, Lcom/android/server/Watchdog;->getInstance()Lcom/android/server/Watchdog;

    move-result-object v3

    invoke-virtual {v3, v2, v1, p2}, Lcom/android/server/Watchdog;->reportPss(Lcom/android/server/Watchdog$PssRequestor;Ljava/lang/String;I)V

    .line 8145
    iget-boolean v3, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v3, :cond_4

    .line 8146
    invoke-virtual {p0, v0}, Lcom/android/server/am/ActivityManagerService;->removeRequestedPss(Lcom/android/server/am/ProcessRecord;)V

    goto :goto_4
.end method

.method public reportThumbnail(Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;)V
    .registers 12
    .parameter "token"
    .parameter "thumbnail"
    .parameter "description"

    .prologue
    .line 7296
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 7297
    .local v6, origId:J
    const/4 v1, 0x0

    const/4 v5, 0x1

    move-object v0, p0

    move-object v2, p1

    move-object v3, p2

    move-object v4, p3

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V

    .line 7298
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7299
    return-void
.end method

.method public requestPss(Ljava/lang/Runnable;)V
    .registers 8
    .parameter "completeCallback"

    .prologue
    const/4 v5, 0x1

    .line 8152
    monitor-enter p0

    .line 8153
    :try_start_2
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssCallback:Ljava/lang/Runnable;

    .line 8154
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->clear()V

    .line 8155
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v4

    sub-int v0, v4, v5

    .local v0, i:I
    :goto_11
    if-ltz v0, :cond_27

    .line 8156
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v4, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 8157
    .local v2, proc:Lcom/android/server/am/ProcessRecord;
    iget-boolean v4, v2, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-nez v4, :cond_24

    .line 8158
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-virtual {v4, v2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 8155
    :cond_24
    add-int/lit8 v0, v0, -0x1

    goto :goto_11

    .line 8161
    .end local v2           #proc:Lcom/android/server/am/ProcessRecord;
    :cond_27
    new-instance v3, Ljava/util/ArrayList;

    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mRequestPssList:Ljava/util/ArrayList;

    invoke-direct {v3, v4}, Ljava/util/ArrayList;-><init>(Ljava/util/Collection;)V

    .line 8162
    .local v3, procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    monitor-exit p0
    :try_end_2f
    .catchall {:try_start_2 .. :try_end_2f} :catchall_53

    .line 8164
    invoke-static {}, Landroid/os/Process;->myTid()I

    move-result v4

    invoke-static {v4}, Landroid/os/Process;->getThreadPriority(I)I

    move-result v1

    .line 8165
    .local v1, oldPri:I
    const/16 v4, 0xa

    invoke-static {v4}, Landroid/os/Process;->setThreadPriority(I)V

    .line 8166
    invoke-virtual {v3}, Ljava/util/ArrayList;->size()I

    move-result v4

    sub-int v0, v4, v5

    :goto_42
    if-ltz v0, :cond_56

    .line 8167
    invoke-virtual {v3, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ProcessRecord;

    .line 8168
    .restart local v2       #proc:Lcom/android/server/am/ProcessRecord;
    const/4 v4, 0x0

    iput v4, v2, Lcom/android/server/am/ProcessRecord;->lastPss:I

    .line 8169
    invoke-virtual {v2}, Lcom/android/server/am/ProcessRecord;->requestPss()V

    .line 8166
    add-int/lit8 v0, v0, -0x1

    goto :goto_42

    .line 8162
    .end local v0           #i:I
    .end local v1           #oldPri:I
    .end local v2           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v3           #procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :catchall_53
    move-exception v4

    :try_start_54
    monitor-exit p0
    :try_end_55
    .catchall {:try_start_54 .. :try_end_55} :catchall_53

    throw v4

    .line 8171
    .restart local v0       #i:I
    .restart local v1       #oldPri:I
    .restart local v3       #procs:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/android/server/am/ProcessRecord;>;"
    :cond_56
    invoke-static {v1}, Landroid/os/Process;->setThreadPriority(I)V

    .line 8172
    return-void
.end method

.method public restartPackage(Ljava/lang/String;)V
    .registers 11
    .parameter "packageName"

    .prologue
    const-string v8, "android.permission.RESTART_PACKAGES"

    const-string v7, "ActivityManager"

    .line 4858
    const-string v5, "android.permission.RESTART_PACKAGES"

    invoke-virtual {p0, v8}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v5

    if-eqz v5, :cond_48

    .line 4860
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Permission Denial: restartPackage() from pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ", uid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " requires "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "android.permission.RESTART_PACKAGES"

    invoke-virtual {v5, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    .line 4864
    .local v2, msg:Ljava/lang/String;
    const-string v5, "ActivityManager"

    invoke-static {v7, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4865
    new-instance v5, Ljava/lang/SecurityException;

    invoke-direct {v5, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 4868
    .end local v2           #msg:Ljava/lang/String;
    :cond_48
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 4870
    .local v0, callingId:J
    :try_start_4c
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    .line 4871
    .local v4, pm:Landroid/content/pm/IPackageManager;
    const/4 v3, -0x1

    .line 4872
    .local v3, pkgUid:I
    monitor-enter p0
    :try_end_52
    .catchall {:try_start_4c .. :try_end_52} :catchall_7e

    .line 4874
    :try_start_52
    invoke-interface {v4, p1}, Landroid/content/pm/IPackageManager;->getPackageUid(Ljava/lang/String;)I
    :try_end_55
    .catchall {:try_start_52 .. :try_end_55} :catchall_7b
    .catch Landroid/os/RemoteException; {:try_start_52 .. :try_end_55} :catch_83

    move-result v3

    .line 4877
    :goto_56
    const/4 v5, -0x1

    if-ne v3, v5, :cond_76

    .line 4878
    :try_start_59
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Invalid packageName: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4879
    monitor-exit p0
    :try_end_72
    .catchall {:try_start_59 .. :try_end_72} :catchall_7b

    .line 4884
    :goto_72
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4886
    return-void

    .line 4881
    :cond_76
    :try_start_76
    invoke-direct {p0, p1, v3}, Lcom/android/server/am/ActivityManagerService;->restartPackageLocked(Ljava/lang/String;I)V

    .line 4882
    monitor-exit p0

    goto :goto_72

    :catchall_7b
    move-exception v5

    monitor-exit p0
    :try_end_7d
    .catchall {:try_start_76 .. :try_end_7d} :catchall_7b

    :try_start_7d
    throw v5
    :try_end_7e
    .catchall {:try_start_7d .. :try_end_7e} :catchall_7e

    .line 4884
    .end local v3           #pkgUid:I
    .end local v4           #pm:Landroid/content/pm/IPackageManager;
    :catchall_7e
    move-exception v5

    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    throw v5

    .line 4875
    .restart local v3       #pkgUid:I
    .restart local v4       #pm:Landroid/content/pm/IPackageManager;
    :catch_83
    move-exception v5

    goto :goto_56
.end method

.method public resumeAppSwitches()V
    .registers 3

    .prologue
    .line 7942
    const-string v0, "android.permission.STOP_APP_SWITCHES"

    invoke-virtual {p0, v0}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v0

    if-eqz v0, :cond_10

    .line 7944
    new-instance v0, Ljava/lang/SecurityException;

    const-string v1, "Requires permission android.permission.STOP_APP_SWITCHES"

    invoke-direct {v0, v1}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 7948
    :cond_10
    monitor-enter p0

    .line 7952
    const-wide/16 v0, 0x0

    :try_start_13
    iput-wide v0, p0, Lcom/android/server/am/ActivityManagerService;->mAppSwitchesAllowedTime:J

    .line 7953
    monitor-exit p0

    .line 7954
    return-void

    .line 7953
    :catchall_17
    move-exception v0

    monitor-exit p0
    :try_end_19
    .catchall {:try_start_13 .. :try_end_19} :catchall_17

    throw v0
.end method

.method public revokeUriPermission(Landroid/app/IApplicationThread;Landroid/net/Uri;I)V
    .registers 12
    .parameter "caller"
    .parameter "uri"
    .parameter "modeFlags"

    .prologue
    const-string v5, "ActivityManager"

    .line 6391
    monitor-enter p0

    .line 6392
    :try_start_3
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v4

    .line 6393
    .local v4, r:Lcom/android/server/am/ProcessRecord;
    if-nez v4, :cond_2f

    .line 6394
    new-instance v5, Ljava/lang/SecurityException;

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Unable to find app for caller "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " when revoking permission to uri "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v5, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 6430
    .end local v4           #r:Lcom/android/server/am/ProcessRecord;
    :catchall_2c
    move-exception v5

    monitor-exit p0
    :try_end_2e
    .catchall {:try_start_3 .. :try_end_2e} :catchall_2c

    throw v5

    .line 6398
    .restart local v4       #r:Lcom/android/server/am/ProcessRecord;
    :cond_2f
    if-nez p2, :cond_3a

    .line 6399
    :try_start_31
    const-string v5, "ActivityManager"

    const-string v6, "revokeUriPermission: null uri"

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6400
    monitor-exit p0

    .line 6431
    :goto_39
    return-void

    .line 6403
    :cond_3a
    and-int/lit8 p3, p3, 0x3

    .line 6405
    if-nez p3, :cond_40

    .line 6406
    monitor-exit p0

    goto :goto_39

    .line 6409
    :cond_40
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v3

    .line 6411
    .local v3, pm:Landroid/content/pm/IPackageManager;
    invoke-virtual {p2}, Landroid/net/Uri;->getAuthority()Ljava/lang/String;

    move-result-object v0

    .line 6412
    .local v0, authority:Ljava/lang/String;
    const/4 v2, 0x0

    .line 6413
    .local v2, pi:Landroid/content/pm/ProviderInfo;
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mProvidersByName:Ljava/util/HashMap;

    invoke-virtual {v5, v0}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ContentProviderRecord;

    .line 6415
    .local v1, cpr:Lcom/android/server/am/ContentProviderRecord;
    if-eqz v1, :cond_71

    .line 6416
    iget-object v2, v1, Lcom/android/server/am/ContentProviderRecord;->info:Landroid/content/pm/ProviderInfo;

    .line 6424
    :goto_55
    if-nez v2, :cond_78

    .line 6425
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "No content provider found for: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 6426
    monitor-exit p0
    :try_end_70
    .catchall {:try_start_31 .. :try_end_70} :catchall_2c

    goto :goto_39

    .line 6419
    :cond_71
    const/16 v5, 0x800

    :try_start_73
    invoke-interface {v3, v0, v5}, Landroid/content/pm/IPackageManager;->resolveContentProvider(Ljava/lang/String;I)Landroid/content/pm/ProviderInfo;
    :try_end_76
    .catchall {:try_start_73 .. :try_end_76} :catchall_2c
    .catch Landroid/os/RemoteException; {:try_start_73 .. :try_end_76} :catch_81

    move-result-object v2

    goto :goto_55

    .line 6429
    :cond_78
    :try_start_78
    iget-object v5, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;

    iget v5, v5, Landroid/content/pm/ApplicationInfo;->uid:I

    invoke-direct {p0, v5, p2, p3}, Lcom/android/server/am/ActivityManagerService;->revokeUriPermissionLocked(ILandroid/net/Uri;I)V

    .line 6430
    monitor-exit p0
    :try_end_80
    .catchall {:try_start_78 .. :try_end_80} :catchall_2c

    goto :goto_39

    .line 6421
    :catch_81
    move-exception v5

    goto :goto_55
.end method

.method final scheduleAppGcLocked(Lcom/android/server/am/ProcessRecord;)V
    .registers 8
    .parameter "app"

    .prologue
    .line 12865
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    .line 12866
    .local v0, now:J
    iget-wide v2, p1, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    const-wide/32 v4, 0xea60

    add-long/2addr v2, v4

    cmp-long v2, v2, v0

    if-lez v2, :cond_f

    .line 12873
    :cond_e
    :goto_e
    return-void

    .line 12869
    :cond_f
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v2, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_e

    .line 12870
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->addProcessToGcListLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 12871
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V

    goto :goto_e
.end method

.method final scheduleAppGcsLocked()V
    .registers 13

    .prologue
    const-wide/16 v10, 0x1388

    const/4 v8, 0x5

    const/4 v7, 0x0

    .line 12823
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v6, v8}, Landroid/os/Handler;->removeMessages(I)V

    .line 12825
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    if-lez v6, :cond_3f

    .line 12827
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v6, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 12828
    .local v3, proc:Lcom/android/server/am/ProcessRecord;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v6, v8}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 12830
    .local v0, msg:Landroid/os/Message;
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mProcessesToGc:Ljava/util/ArrayList;

    invoke-virtual {v6, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/am/ProcessRecord;

    iget-wide v6, v6, Lcom/android/server/am/ProcessRecord;->lastRequestedGc:J

    const-wide/32 v8, 0xea60

    add-long v4, v6, v8

    .line 12831
    .local v4, when:J
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    .line 12832
    .local v1, now:J
    add-long v6, v1, v10

    cmp-long v6, v4, v6

    if-gez v6, :cond_3a

    .line 12833
    add-long v4, v1, v10

    .line 12835
    :cond_3a
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v6, v0, v4, v5}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z

    .line 12837
    .end local v0           #msg:Landroid/os/Message;
    .end local v1           #now:J
    .end local v3           #proc:Lcom/android/server/am/ProcessRecord;
    .end local v4           #when:J
    :cond_3f
    return-void
.end method

.method sendActivityResultLocked(ILcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V
    .registers 15
    .parameter "callingUid"
    .parameter "r"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "resultCode"
    .parameter "data"

    .prologue
    .line 4125
    if-lez p1, :cond_7

    .line 4126
    iget-object v0, p2, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    invoke-direct {p0, p1, v0, p6, p2}, Lcom/android/server/am/ActivityManagerService;->grantUriPermissionFromIntentLocked(ILjava/lang/String;Landroid/content/Intent;Lcom/android/server/am/HistoryRecord;)V

    .line 4133
    :cond_7
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-ne v0, p2, :cond_44

    iget-object v0, p2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_44

    iget-object v0, p2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v0, :cond_44

    .line 4135
    :try_start_15
    new-instance v7, Ljava/util/ArrayList;

    invoke-direct {v7}, Ljava/util/ArrayList;-><init>()V

    .line 4136
    .local v7, list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ResultInfo;>;"
    new-instance v0, Landroid/app/ResultInfo;

    invoke-direct {v0, p3, p4, p5, p6}, Landroid/app/ResultInfo;-><init>(Ljava/lang/String;IILandroid/content/Intent;)V

    invoke-virtual {v7, v0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 4138
    iget-object v0, p2, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v0, p2, v7}, Landroid/app/IApplicationThread;->scheduleSendResult(Landroid/os/IBinder;Ljava/util/List;)V
    :try_end_29
    .catch Ljava/lang/Exception; {:try_start_15 .. :try_end_29} :catch_2a

    .line 4146
    .end local v7           #list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/app/ResultInfo;>;"
    :goto_29
    return-void

    .line 4140
    :catch_2a
    move-exception v0

    move-object v6, v0

    .line 4141
    .local v6, e:Ljava/lang/Exception;
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Exception thrown sending result to "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 4145
    .end local v6           #e:Ljava/lang/Exception;
    :cond_44
    const/4 v1, 0x0

    move-object v0, p2

    move-object v2, p3

    move v3, p4

    move v4, p5

    move-object v5, p6

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/HistoryRecord;->addResultLocked(Lcom/android/server/am/HistoryRecord;Ljava/lang/String;IILandroid/content/Intent;)V

    goto :goto_29
.end method

.method final sendPendingThumbnail(Lcom/android/server/am/HistoryRecord;Landroid/os/IBinder;Landroid/graphics/Bitmap;Ljava/lang/CharSequence;Z)V
    .registers 17
    .parameter "r"
    .parameter "token"
    .parameter "thumbnail"
    .parameter "description"
    .parameter "always"

    .prologue
    .line 7303
    const/4 v8, 0x0

    .line 7304
    .local v8, task:Lcom/android/server/am/TaskRecord;
    const/4 v6, 0x0

    .line 7308
    .local v6, receivers:Ljava/util/ArrayList;
    monitor-enter p0

    .line 7309
    if-nez p1, :cond_17

    .line 7310
    :try_start_5
    invoke-direct {p0, p2}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v4

    .line 7311
    .local v4, index:I
    if-gez v4, :cond_d

    .line 7312
    monitor-exit p0

    .line 7366
    .end local v4           #index:I
    :goto_c
    return-void

    .line 7314
    .restart local v4       #index:I
    :cond_d
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v9, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v9

    move-object v0, v9

    check-cast v0, Lcom/android/server/am/HistoryRecord;

    move-object p1, v0

    .line 7316
    .end local v4           #index:I
    :cond_17
    if-nez p3, :cond_1d

    .line 7317
    iget-object p3, p1, Lcom/android/server/am/HistoryRecord;->thumbnail:Landroid/graphics/Bitmap;

    .line 7318
    iget-object p4, p1, Lcom/android/server/am/HistoryRecord;->description:Ljava/lang/CharSequence;

    .line 7320
    :cond_1d
    if-nez p3, :cond_26

    if-nez p5, :cond_26

    .line 7324
    monitor-exit p0

    goto :goto_c

    .line 7348
    :catchall_23
    move-exception v9

    :goto_24
    monitor-exit p0
    :try_end_25
    .catchall {:try_start_5 .. :try_end_25} :catchall_23

    throw v9

    .line 7326
    :cond_26
    :try_start_26
    iget-object v8, p1, Lcom/android/server/am/HistoryRecord;->task:Lcom/android/server/am/TaskRecord;

    .line 7328
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I
    :try_end_2d
    .catchall {:try_start_26 .. :try_end_2d} :catchall_23

    move-result v1

    .line 7329
    .local v1, N:I
    const/4 v3, 0x0

    .local v3, i:I
    move-object v7, v6

    .line 7330
    .end local v6           #receivers:Ljava/util/ArrayList;
    .local v7, receivers:Ljava/util/ArrayList;
    :goto_30
    if-ge v3, v1, :cond_65

    .line 7331
    :try_start_32
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v9, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/PendingThumbnailsRecord;

    .line 7334
    .local v5, pr:Lcom/android/server/am/PendingThumbnailsRecord;
    iget-object v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->pendingRecords:Ljava/util/HashSet;

    invoke-virtual {v9, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    move-result v9

    if-eqz v9, :cond_60

    .line 7335
    if-nez v7, :cond_9c

    .line 7336
    new-instance v6, Ljava/util/ArrayList;

    invoke-direct {v6}, Ljava/util/ArrayList;-><init>()V
    :try_end_49
    .catchall {:try_start_32 .. :try_end_49} :catchall_99

    .line 7338
    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    :goto_49
    :try_start_49
    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 7339
    iget-object v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->pendingRecords:Ljava/util/HashSet;

    invoke-virtual {v9}, Ljava/util/HashSet;->size()I

    move-result v9

    if-nez v9, :cond_61

    .line 7340
    const/4 v9, 0x1

    iput-boolean v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->finished:Z

    .line 7341
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mPendingThumbnails:Ljava/util/ArrayList;

    invoke-virtual {v9, v3}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;
    :try_end_5c
    .catchall {:try_start_49 .. :try_end_5c} :catchall_23

    .line 7342
    add-int/lit8 v1, v1, -0x1

    move-object v7, v6

    .line 7343
    .end local v6           #receivers:Ljava/util/ArrayList;
    .restart local v7       #receivers:Ljava/util/ArrayList;
    goto :goto_30

    :cond_60
    move-object v6, v7

    .line 7346
    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    :cond_61
    add-int/lit8 v3, v3, 0x1

    move-object v7, v6

    .line 7347
    .end local v6           #receivers:Ljava/util/ArrayList;
    .restart local v7       #receivers:Ljava/util/ArrayList;
    goto :goto_30

    .line 7348
    .end local v5           #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_65
    :try_start_65
    monitor-exit p0
    :try_end_66
    .catchall {:try_start_65 .. :try_end_66} :catchall_99

    .line 7350
    if-eqz v7, :cond_96

    .line 7351
    invoke-virtual {v7}, Ljava/util/ArrayList;->size()I

    move-result v1

    .line 7352
    const/4 v3, 0x0

    :goto_6d
    if-ge v3, v1, :cond_96

    .line 7354
    :try_start_6f
    invoke-virtual {v7, v3}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/PendingThumbnailsRecord;

    .line 7356
    .restart local v5       #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    iget-object v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->receiver:Landroid/app/IThumbnailReceiver;

    if-eqz v8, :cond_8a

    iget v10, v8, Lcom/android/server/am/TaskRecord;->taskId:I

    :goto_7b
    invoke-interface {v9, v10, p3, p4}, Landroid/app/IThumbnailReceiver;->newThumbnail(ILandroid/graphics/Bitmap;Ljava/lang/CharSequence;)V

    .line 7358
    iget-boolean v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->finished:Z

    if-eqz v9, :cond_87

    .line 7359
    iget-object v9, v5, Lcom/android/server/am/PendingThumbnailsRecord;->receiver:Landroid/app/IThumbnailReceiver;

    invoke-interface {v9}, Landroid/app/IThumbnailReceiver;->finished()V
    :try_end_87
    .catch Ljava/lang/Exception; {:try_start_6f .. :try_end_87} :catch_8c

    .line 7352
    .end local v5           #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_87
    :goto_87
    add-int/lit8 v3, v3, 0x1

    goto :goto_6d

    .line 7356
    .restart local v5       #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    :cond_8a
    const/4 v10, -0x1

    goto :goto_7b

    .line 7361
    .end local v5           #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    :catch_8c
    move-exception v9

    move-object v2, v9

    .line 7362
    .local v2, e:Ljava/lang/Exception;
    const-string v9, "ActivityManager"

    const-string v10, "Exception thrown when sending thumbnail"

    invoke-static {v9, v10, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_87

    .end local v2           #e:Ljava/lang/Exception;
    :cond_96
    move-object v6, v7

    .line 7366
    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    goto/16 :goto_c

    .line 7348
    .end local v6           #receivers:Ljava/util/ArrayList;
    .restart local v7       #receivers:Ljava/util/ArrayList;
    :catchall_99
    move-exception v9

    move-object v6, v7

    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    goto :goto_24

    .end local v6           #receivers:Ljava/util/ArrayList;
    .restart local v5       #pr:Lcom/android/server/am/PendingThumbnailsRecord;
    .restart local v7       #receivers:Ljava/util/ArrayList;
    :cond_9c
    move-object v6, v7

    .end local v7           #receivers:Ljava/util/ArrayList;
    .restart local v6       #receivers:Ljava/util/ArrayList;
    goto :goto_49
.end method

.method public serviceDoneExecuting(Landroid/os/IBinder;)V
    .registers 10
    .parameter "token"

    .prologue
    const-string v5, "ActivityManager"

    .line 10829
    monitor-enter p0

    .line 10830
    :try_start_3
    instance-of v5, p1, Lcom/android/server/am/ServiceRecord;

    if-nez v5, :cond_12

    .line 10831
    new-instance v5, Ljava/lang/IllegalArgumentException;

    const-string v6, "Invalid service token"

    invoke-direct {v5, v6}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 10853
    :catchall_f
    move-exception v5

    monitor-exit p0
    :try_end_11
    .catchall {:try_start_3 .. :try_end_11} :catchall_f

    throw v5

    .line 10833
    :cond_12
    :try_start_12
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object v4, v0

    .line 10834
    .local v4, r:Lcom/android/server/am/ServiceRecord;
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v5, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v1

    .line 10835
    .local v1, inStopping:Z
    if-eqz v4, :cond_5c

    .line 10839
    if-eq v4, p1, :cond_50

    .line 10840
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Done executing service "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, v4, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " with incorrect token: given "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ", expected "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10843
    monitor-exit p0

    .line 10854
    :goto_4f
    return-void

    .line 10846
    :cond_50
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 10847
    .local v2, origId:J
    invoke-virtual {p0, v4, v1}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 10848
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 10853
    .end local v2           #origId:J
    :goto_5a
    monitor-exit p0

    goto :goto_4f

    .line 10850
    :cond_5c
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Done executing unknown service "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget-object v7, v4, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " with token "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_80
    .catchall {:try_start_12 .. :try_end_80} :catchall_f

    goto :goto_5a
.end method

.method public serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V
    .registers 6
    .parameter "r"
    .parameter "inStopping"

    .prologue
    .line 10857
    iget v0, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    const/4 v1, 0x1

    sub-int/2addr v0, v1

    iput v0, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    .line 10858
    iget v0, p1, Lcom/android/server/am/ServiceRecord;->executeNesting:I

    if-gtz v0, :cond_34

    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_34

    .line 10859
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v0, p1}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 10860
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v0}, Ljava/util/HashSet;->size()I

    move-result v0

    if-nez v0, :cond_28

    .line 10861
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v1, 0xc

    iget-object v2, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v0, v1, v2}, Landroid/os/Handler;->removeMessages(ILjava/lang/Object;)V

    .line 10863
    :cond_28
    if-eqz p2, :cond_2f

    .line 10864
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v0, p1}, Ljava/util/ArrayList;->remove(Ljava/lang/Object;)Z

    .line 10866
    :cond_2f
    iget-object v0, p1, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 10868
    :cond_34
    return-void
.end method

.method serviceTimeout(Lcom/android/server/am/ProcessRecord;)V
    .registers 14
    .parameter "proc"

    .prologue
    const-wide/16 v10, 0x4e20

    .line 10871
    monitor-enter p0

    .line 10872
    :try_start_3
    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v8}, Ljava/util/HashSet;->size()I

    move-result v8

    if-eqz v8, :cond_f

    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v8, :cond_11

    .line 10873
    :cond_f
    monitor-exit p0

    .line 10899
    :goto_10
    return-void

    .line 10875
    :cond_11
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v8

    sub-long v1, v8, v10

    .line 10876
    .local v1, maxTime:J
    iget-object v8, p1, Lcom/android/server/am/ProcessRecord;->executingServices:Ljava/util/HashSet;

    invoke-virtual {v8}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v0

    .line 10877
    .local v0, it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    const/4 v7, 0x0

    .line 10878
    .local v7, timeout:Lcom/android/server/am/ServiceRecord;
    const-wide/16 v4, 0x0

    .line 10879
    .local v4, nextTime:J
    :cond_20
    :goto_20
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_33

    .line 10880
    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/am/ServiceRecord;

    .line 10881
    .local v6, sr:Lcom/android/server/am/ServiceRecord;
    iget-wide v8, v6, Lcom/android/server/am/ServiceRecord;->executingStart:J

    cmp-long v8, v8, v1

    if-gez v8, :cond_74

    .line 10882
    move-object v7, v6

    .line 10889
    .end local v6           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_33
    if-eqz v7, :cond_7d

    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v8, p1}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_7d

    .line 10890
    const-string v8, "ActivityManager"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Timeout executing service: "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-static {v8, v9}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10891
    const/4 v8, 0x0

    const/4 v9, 0x0

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "Executing service "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    iget-object v11, v7, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-virtual {p0, p1, v8, v9, v10}, Lcom/android/server/am/ActivityManagerService;->appNotRespondingLocked(Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;Lcom/android/server/am/HistoryRecord;Ljava/lang/String;)V

    .line 10898
    :goto_6f
    monitor-exit p0

    goto :goto_10

    .end local v0           #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    .end local v1           #maxTime:J
    .end local v4           #nextTime:J
    .end local v7           #timeout:Lcom/android/server/am/ServiceRecord;
    :catchall_71
    move-exception v8

    monitor-exit p0
    :try_end_73
    .catchall {:try_start_3 .. :try_end_73} :catchall_71

    throw v8

    .line 10885
    .restart local v0       #it:Ljava/util/Iterator;,"Ljava/util/Iterator<Lcom/android/server/am/ServiceRecord;>;"
    .restart local v1       #maxTime:J
    .restart local v4       #nextTime:J
    .restart local v6       #sr:Lcom/android/server/am/ServiceRecord;
    .restart local v7       #timeout:Lcom/android/server/am/ServiceRecord;
    :cond_74
    :try_start_74
    iget-wide v8, v6, Lcom/android/server/am/ServiceRecord;->executingStart:J

    cmp-long v8, v8, v4

    if-lez v8, :cond_20

    .line 10886
    iget-wide v4, v6, Lcom/android/server/am/ServiceRecord;->executingStart:J

    goto :goto_20

    .line 10894
    .end local v6           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_7d
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v9, 0xc

    invoke-virtual {v8, v9}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v3

    .line 10895
    .local v3, msg:Landroid/os/Message;
    iput-object p1, v3, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 10896
    iget-object v8, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    add-long v9, v4, v10

    invoke-virtual {v8, v3, v9, v10}, Landroid/os/Handler;->sendMessageAtTime(Landroid/os/Message;J)Z
    :try_end_8e
    .catchall {:try_start_74 .. :try_end_8e} :catchall_71

    goto :goto_6f
.end method

.method public setActivityController(Landroid/app/IActivityController;)V
    .registers 4
    .parameter "controller"

    .prologue
    .line 8021
    const-string v0, "android.permission.SET_ACTIVITY_WATCHER"

    const-string v1, "setActivityController()"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 8023
    monitor-enter p0

    .line 8024
    :try_start_8
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mController:Landroid/app/IActivityController;

    .line 8025
    monitor-exit p0

    .line 8026
    return-void

    .line 8025
    :catchall_c
    move-exception v0

    monitor-exit p0
    :try_end_e
    .catchall {:try_start_8 .. :try_end_e} :catchall_c

    throw v0
.end method

.method public setAlwaysFinish(Z)V
    .registers 5
    .parameter "enabled"

    .prologue
    .line 8008
    const-string v0, "android.permission.SET_ALWAYS_FINISH"

    const-string v1, "setAlwaysFinish()"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 8011
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    const-string v1, "always_finish_activities"

    if-eqz p1, :cond_1a

    const/4 v2, 0x1

    :goto_12
    invoke-static {v0, v1, v2}, Landroid/provider/Settings$System;->putInt(Landroid/content/ContentResolver;Ljava/lang/String;I)Z

    .line 8015
    monitor-enter p0

    .line 8016
    :try_start_16
    iput-boolean p1, p0, Lcom/android/server/am/ActivityManagerService;->mAlwaysFinishActivities:Z

    .line 8017
    monitor-exit p0

    .line 8018
    return-void

    .line 8011
    :cond_1a
    const/4 v2, 0x0

    goto :goto_12

    .line 8017
    :catchall_1c
    move-exception v0

    monitor-exit p0
    :try_end_1e
    .catchall {:try_start_16 .. :try_end_1e} :catchall_1c

    throw v0
.end method

.method public setDebugApp(Ljava/lang/String;ZZ)V
    .registers 11
    .parameter "packageName"
    .parameter "waitForDebugger"
    .parameter "persistent"

    .prologue
    const/4 v6, 0x1

    const/4 v5, 0x0

    .line 7975
    const-string v3, "android.permission.SET_DEBUG_APP"

    const-string v4, "setDebugApp()"

    invoke-virtual {p0, v3, v4}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 7981
    if-eqz p3, :cond_1e

    .line 7982
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v2

    .line 7983
    .local v2, resolver:Landroid/content/ContentResolver;
    const-string v3, "debug_app"

    invoke-static {v2, v3, p1}, Landroid/provider/Settings$System;->putString(Landroid/content/ContentResolver;Ljava/lang/String;Ljava/lang/String;)Z

    .line 7986
    const-string v3, "wait_for_debugger"

    if-eqz p2, :cond_42

    move v4, v6

    :goto_1b
    invoke-static {v2, v3, v4}, Landroid/provider/Settings$System;->putInt(Landroid/content/ContentResolver;Ljava/lang/String;I)Z

    .line 7991
    .end local v2           #resolver:Landroid/content/ContentResolver;
    :cond_1e
    monitor-enter p0

    .line 7992
    if-nez p3, :cond_29

    .line 7993
    :try_start_21
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    iput-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mOrigDebugApp:Ljava/lang/String;

    .line 7994
    iget-boolean v3, p0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    iput-boolean v3, p0, Lcom/android/server/am/ActivityManagerService;->mOrigWaitForDebugger:Z

    .line 7996
    :cond_29
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mDebugApp:Ljava/lang/String;

    .line 7997
    iput-boolean p2, p0, Lcom/android/server/am/ActivityManagerService;->mWaitForDebugger:Z

    .line 7998
    if-nez p3, :cond_44

    move v3, v6

    :goto_30
    iput-boolean v3, p0, Lcom/android/server/am/ActivityManagerService;->mDebugTransient:Z

    .line 7999
    if-eqz p1, :cond_40

    .line 8000
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 8001
    .local v0, origId:J
    const/4 v3, -0x1

    const/4 v4, 0x0

    invoke-direct {p0, p1, v3, v4}, Lcom/android/server/am/ActivityManagerService;->uninstallPackageLocked(Ljava/lang/String;IZ)V

    .line 8002
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 8004
    .end local v0           #origId:J
    :cond_40
    monitor-exit p0

    .line 8005
    return-void

    .restart local v2       #resolver:Landroid/content/ContentResolver;
    :cond_42
    move v4, v5

    .line 7986
    goto :goto_1b

    .end local v2           #resolver:Landroid/content/ContentResolver;
    :cond_44
    move v3, v5

    .line 7998
    goto :goto_30

    .line 8004
    :catchall_46
    move-exception v3

    monitor-exit p0
    :try_end_48
    .catchall {:try_start_21 .. :try_end_48} :catchall_46

    throw v3
.end method

.method public setPersistent(Landroid/os/IBinder;Z)V
    .registers 12
    .parameter "token"
    .parameter "isPersistent"

    .prologue
    const/4 v7, 0x1

    const-string v8, "android.permission.PERSISTENT_ACTIVITY"

    .line 4750
    const-string v6, "android.permission.PERSISTENT_ACTIVITY"

    invoke-virtual {p0, v8}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v6

    if-eqz v6, :cond_47

    .line 4752
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Permission Denial: setPersistent() from pid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ", uid="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " requires "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "android.permission.PERSISTENT_ACTIVITY"

    invoke-virtual {v6, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    .line 4756
    .local v2, msg:Ljava/lang/String;
    const-string v6, "ActivityManager"

    invoke-static {v6, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 4757
    new-instance v6, Ljava/lang/SecurityException;

    invoke-direct {v6, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 4760
    .end local v2           #msg:Ljava/lang/String;
    :cond_47
    monitor-enter p0

    .line 4761
    :try_start_48
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v1

    .line 4762
    .local v1, index:I
    if-gez v1, :cond_50

    .line 4763
    monitor-exit p0

    .line 4809
    :goto_4f
    return-void

    .line 4765
    :cond_50
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v6, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/am/HistoryRecord;

    .line 4766
    .local v5, r:Lcom/android/server/am/HistoryRecord;
    iget-object v0, v5, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 4771
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    if-eqz p2, :cond_86

    .line 4772
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-eqz v6, :cond_65

    .line 4775
    monitor-exit p0

    goto :goto_4f

    .line 4808
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    .end local v1           #index:I
    .end local v5           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_62
    move-exception v6

    monitor-exit p0
    :try_end_64
    .catchall {:try_start_48 .. :try_end_64} :catchall_62

    throw v6

    .line 4777
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v1       #index:I
    .restart local v5       #r:Lcom/android/server/am/HistoryRecord;
    :cond_65
    const/4 v6, 0x1

    :try_start_66
    iput-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->persistent:Z

    .line 4778
    iget v6, v0, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    add-int/lit8 v6, v6, 0x1

    iput v6, v0, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    .line 4780
    iget v6, v0, Lcom/android/server/am/ProcessRecord;->persistentActivities:I

    if-le v6, v7, :cond_74

    .line 4783
    monitor-exit p0

    goto :goto_4f

    .line 4785
    :cond_74
    iget-boolean v6, v0, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v6, :cond_7a

    .line 4788
    monitor-exit p0

    goto :goto_4f

    .line 4793
    :cond_7a
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v3

    .line 4794
    .local v3, origId:J
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 4795
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 4808
    :goto_84
    monitor-exit p0

    goto :goto_4f

    .line 4798
    .end local v3           #origId:J
    :cond_86
    iget-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->persistent:Z

    if-nez v6, :cond_8c

    .line 4800
    monitor-exit p0

    goto :goto_4f

    .line 4802
    :cond_8c
    const/4 v6, 0x0

    iput-boolean v6, v5, Lcom/android/server/am/HistoryRecord;->persistent:Z

    .line 4803
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v3

    .line 4804
    .restart local v3       #origId:J
    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->decPersistentCountLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 4805
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V
    :try_end_99
    .catchall {:try_start_66 .. :try_end_99} :catchall_62

    goto :goto_84
.end method

.method public setProcessForeground(Landroid/os/IBinder;IZ)V
    .registers 12
    .parameter "token"
    .parameter "pid"
    .parameter "isForeground"

    .prologue
    .line 5825
    const-string v4, "android.permission.SET_PROCESS_LIMIT"

    const-string v5, "setProcessForeground()"

    invoke-virtual {p0, v4, v5}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 5827
    monitor-enter p0

    .line 5828
    const/4 v0, 0x0

    .line 5830
    .local v0, changed:Z
    :try_start_9
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    monitor-enter v4
    :try_end_c
    .catchall {:try_start_9 .. :try_end_c} :catchall_6b

    .line 5831
    :try_start_c
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    invoke-virtual {v5, p2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ProcessRecord;

    .line 5832
    .local v3, pr:Lcom/android/server/am/ProcessRecord;
    if-nez v3, :cond_31

    .line 5833
    const-string v5, "ActivityManager"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "setProcessForeground called on unknown pid: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 5834
    monitor-exit v4
    :try_end_2f
    .catchall {:try_start_c .. :try_end_2f} :catchall_6e

    :try_start_2f
    monitor-exit p0
    :try_end_30
    .catchall {:try_start_2f .. :try_end_30} :catchall_6b

    .line 5867
    :goto_30
    return-void

    .line 5836
    :cond_31
    :try_start_31
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    invoke-virtual {v5, p2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ActivityManagerService$ForegroundToken;

    .line 5837
    .local v2, oldToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    if-eqz v2, :cond_4a

    .line 5838
    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->token:Landroid/os/IBinder;

    const/4 v6, 0x0

    invoke-interface {v5, v2, v6}, Landroid/os/IBinder;->unlinkToDeath(Landroid/os/IBinder$DeathRecipient;I)Z

    .line 5839
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    invoke-virtual {v5, p2}, Landroid/util/SparseArray;->remove(I)V

    .line 5840
    const/4 v5, 0x0

    iput-object v5, v3, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;

    .line 5841
    const/4 v0, 0x1

    .line 5843
    :cond_4a
    if-eqz p3, :cond_63

    if-eqz p1, :cond_63

    .line 5844
    new-instance v1, Lcom/android/server/am/ActivityManagerService$4;

    invoke-direct {v1, p0}, Lcom/android/server/am/ActivityManagerService$4;-><init>(Lcom/android/server/am/ActivityManagerService;)V

    .line 5849
    .local v1, newToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    iput p2, v1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->pid:I

    .line 5850
    iput-object p1, v1, Lcom/android/server/am/ActivityManagerService$ForegroundToken;->token:Landroid/os/IBinder;
    :try_end_57
    .catchall {:try_start_31 .. :try_end_57} :catchall_6e

    .line 5852
    const/4 v5, 0x0

    :try_start_58
    invoke-interface {p1, v1, v5}, Landroid/os/IBinder;->linkToDeath(Landroid/os/IBinder$DeathRecipient;I)V

    .line 5853
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mForegroundProcesses:Landroid/util/SparseArray;

    invoke-virtual {v5, p2, v1}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    .line 5854
    iput-object p1, v3, Lcom/android/server/am/ProcessRecord;->forcingToForeground:Landroid/os/IBinder;
    :try_end_62
    .catchall {:try_start_58 .. :try_end_62} :catchall_6e
    .catch Landroid/os/RemoteException; {:try_start_58 .. :try_end_62} :catch_71

    .line 5855
    const/4 v0, 0x1

    .line 5861
    .end local v1           #newToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    :cond_63
    :goto_63
    :try_start_63
    monitor-exit v4
    :try_end_64
    .catchall {:try_start_63 .. :try_end_64} :catchall_6e

    .line 5863
    if-eqz v0, :cond_69

    .line 5864
    :try_start_66
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 5866
    :cond_69
    monitor-exit p0

    goto :goto_30

    .end local v2           #oldToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .end local v3           #pr:Lcom/android/server/am/ProcessRecord;
    :catchall_6b
    move-exception v4

    monitor-exit p0
    :try_end_6d
    .catchall {:try_start_66 .. :try_end_6d} :catchall_6b

    throw v4

    .line 5861
    :catchall_6e
    move-exception v5

    :try_start_6f
    monitor-exit v4
    :try_end_70
    .catchall {:try_start_6f .. :try_end_70} :catchall_6e

    :try_start_70
    throw v5
    :try_end_71
    .catchall {:try_start_70 .. :try_end_71} :catchall_6b

    .line 5856
    .restart local v1       #newToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .restart local v2       #oldToken:Lcom/android/server/am/ActivityManagerService$ForegroundToken;
    .restart local v3       #pr:Lcom/android/server/am/ProcessRecord;
    :catch_71
    move-exception v5

    goto :goto_63
.end method

.method public setProcessLimit(I)V
    .registers 4
    .parameter "max"

    .prologue
    .line 5795
    const-string v0, "android.permission.SET_PROCESS_LIMIT"

    const-string v1, "setProcessLimit()"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 5797
    iput p1, p0, Lcom/android/server/am/ActivityManagerService;->mProcessLimit:I

    .line 5798
    return-void
.end method

.method public setRequestedOrientation(Landroid/os/IBinder;I)V
    .registers 12
    .parameter "token"
    .parameter "requestedOrientation"

    .prologue
    const/4 v8, 0x0

    .line 3804
    monitor-enter p0

    .line 3805
    :try_start_2
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v1

    .line 3806
    .local v1, index:I
    if-gez v1, :cond_a

    .line 3807
    monitor-exit p0

    .line 3823
    :goto_9
    return-void

    .line 3809
    :cond_a
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v5, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/am/HistoryRecord;

    .line 3810
    .local v4, r:Lcom/android/server/am/HistoryRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v2

    .line 3811
    .local v2, origId:J
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v5, v4, p2}, Lcom/android/server/WindowManagerService;->setAppOrientation(Landroid/view/IApplicationToken;I)V

    .line 3812
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    iget-object v7, v4, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-virtual {v4, v7}, Lcom/android/server/am/HistoryRecord;->mayFreezeScreenLocked(Lcom/android/server/am/ProcessRecord;)Z

    move-result v7

    if-eqz v7, :cond_43

    move-object v7, v4

    :goto_28
    invoke-virtual {v5, v6, v7}, Lcom/android/server/WindowManagerService;->updateOrientationFromAppTokens(Landroid/content/res/Configuration;Landroid/os/IBinder;)Landroid/content/res/Configuration;

    move-result-object v0

    .line 3815
    .local v0, config:Landroid/content/res/Configuration;
    if-eqz v0, :cond_3b

    .line 3816
    const/4 v5, 0x1

    iput-boolean v5, v4, Lcom/android/server/am/HistoryRecord;->frozenBeforeDestroy:Z

    .line 3817
    invoke-virtual {p0, v0, v4}, Lcom/android/server/am/ActivityManagerService;->updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z

    move-result v5

    if-nez v5, :cond_3b

    .line 3818
    const/4 v5, 0x0

    invoke-direct {p0, v5}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 3821
    :cond_3b
    invoke-static {v2, v3}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 3822
    monitor-exit p0

    goto :goto_9

    .end local v0           #config:Landroid/content/res/Configuration;
    .end local v1           #index:I
    .end local v2           #origId:J
    .end local v4           #r:Lcom/android/server/am/HistoryRecord;
    :catchall_40
    move-exception v5

    monitor-exit p0
    :try_end_42
    .catchall {:try_start_2 .. :try_end_42} :catchall_40

    throw v5

    .restart local v1       #index:I
    .restart local v2       #origId:J
    .restart local v4       #r:Lcom/android/server/am/HistoryRecord;
    :cond_43
    move-object v7, v8

    .line 3812
    goto :goto_28
.end method

.method public setServiceForeground(Landroid/content/ComponentName;Landroid/os/IBinder;Z)V
    .registers 9
    .parameter "className"
    .parameter "token"
    .parameter "isForeground"

    .prologue
    .line 10522
    monitor-enter p0

    .line 10523
    :try_start_1
    invoke-direct {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->findServiceLocked(Landroid/content/ComponentName;Landroid/os/IBinder;)Lcom/android/server/am/ServiceRecord;

    move-result-object v2

    .line 10524
    .local v2, r:Lcom/android/server/am/ServiceRecord;
    if-eqz v2, :cond_1e

    .line 10525
    iget-boolean v3, v2, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    if-eq v3, p3, :cond_1e

    .line 10526
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 10527
    .local v0, origId:J
    iput-boolean p3, v2, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    .line 10528
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v3, :cond_1b

    .line 10529
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    const/4 v4, 0x1

    invoke-virtual {p0, v3, v4}, Lcom/android/server/am/ActivityManagerService;->updateServiceForegroundLocked(Lcom/android/server/am/ProcessRecord;Z)V

    .line 10531
    :cond_1b
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 10534
    .end local v0           #origId:J
    :cond_1e
    monitor-exit p0

    .line 10535
    return-void

    .line 10534
    .end local v2           #r:Lcom/android/server/am/ServiceRecord;
    :catchall_20
    move-exception v3

    monitor-exit p0
    :try_end_22
    .catchall {:try_start_1 .. :try_end_22} :catchall_20

    throw v3
.end method

.method public setWindowManager(Lcom/android/server/WindowManagerService;)V
    .registers 2
    .parameter "wm"

    .prologue
    .line 1237
    iput-object p1, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    .line 1238
    return-void
.end method

.method public showWaitingForDebugger(Landroid/app/IApplicationThread;Z)V
    .registers 6
    .parameter "who"
    .parameter "waiting"

    .prologue
    .line 6434
    monitor-enter p0

    .line 6435
    if-eqz p1, :cond_c

    :try_start_3
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v2

    move-object v0, v2

    .line 6437
    .local v0, app:Lcom/android/server/am/ProcessRecord;
    :goto_8
    if-nez v0, :cond_f

    monitor-exit p0

    .line 6445
    :goto_b
    return-void

    .line 6435
    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    :cond_c
    const/4 v2, 0x0

    move-object v0, v2

    goto :goto_8

    .line 6439
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    :cond_f
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v1

    .line 6440
    .local v1, msg:Landroid/os/Message;
    const/4 v2, 0x6

    iput v2, v1, Landroid/os/Message;->what:I

    .line 6441
    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 6442
    if-eqz p2, :cond_27

    const/4 v2, 0x1

    :goto_1b
    iput v2, v1, Landroid/os/Message;->arg1:I

    .line 6443
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v2, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 6444
    monitor-exit p0

    goto :goto_b

    .end local v0           #app:Lcom/android/server/am/ProcessRecord;
    .end local v1           #msg:Landroid/os/Message;
    :catchall_24
    move-exception v2

    monitor-exit p0
    :try_end_26
    .catchall {:try_start_3 .. :try_end_26} :catchall_24

    throw v2

    .line 6442
    .restart local v0       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v1       #msg:Landroid/os/Message;
    :cond_27
    const/4 v2, 0x0

    goto :goto_1b
.end method

.method public shutdown(I)Z
    .registers 11
    .parameter "timeout"

    .prologue
    .line 7856
    const-string v5, "android.permission.SHUTDOWN"

    invoke-virtual {p0, v5}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v5

    if-eqz v5, :cond_10

    .line 7858
    new-instance v5, Ljava/lang/SecurityException;

    const-string v6, "Requires permission android.permission.SHUTDOWN"

    invoke-direct {v5, v6}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 7862
    :cond_10
    const/4 v4, 0x0

    .line 7864
    .local v4, timedout:Z
    monitor-enter p0

    .line 7865
    const/4 v5, 0x1

    :try_start_13
    iput-boolean v5, p0, Lcom/android/server/am/ActivityManagerService;->mShuttingDown:Z

    .line 7866
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v6, 0x0

    invoke-virtual {v5, v6}, Lcom/android/server/WindowManagerService;->setEventDispatching(Z)V

    .line 7868
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_45

    .line 7869
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->pauseIfSleepingLocked()V

    .line 7870
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v5

    int-to-long v7, p1

    add-long v2, v5, v7

    .line 7871
    .local v2, endTime:J
    :goto_29
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mResumedActivity:Lcom/android/server/am/HistoryRecord;

    if-nez v5, :cond_31

    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mPausingActivity:Lcom/android/server/am/HistoryRecord;

    if-eqz v5, :cond_45

    .line 7872
    :cond_31
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v5

    sub-long v0, v2, v5

    .line 7873
    .local v0, delay:J
    const-wide/16 v5, 0x0

    cmp-long v5, v0, v5

    if-gtz v5, :cond_51

    .line 7874
    const-string v5, "ActivityManager"

    const-string v6, "Activity manager shutdown timed out"

    invoke-static {v5, v6}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 7875
    const/4 v4, 0x1

    .line 7884
    .end local v0           #delay:J
    .end local v2           #endTime:J
    :cond_45
    monitor-exit p0
    :try_end_46
    .catchall {:try_start_13 .. :try_end_46} :catchall_57

    .line 7886
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mUsageStatsService:Lcom/android/server/am/UsageStatsService;

    invoke-virtual {v5}, Lcom/android/server/am/UsageStatsService;->shutdown()V

    .line 7887
    iget-object v5, p0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    invoke-virtual {v5}, Lcom/android/server/am/BatteryStatsService;->shutdown()V

    .line 7889
    return v4

    .line 7879
    .restart local v0       #delay:J
    .restart local v2       #endTime:J
    :cond_51
    :try_start_51
    invoke-virtual {p0}, Ljava/lang/Object;->wait()V
    :try_end_54
    .catchall {:try_start_51 .. :try_end_54} :catchall_57
    .catch Ljava/lang/InterruptedException; {:try_start_51 .. :try_end_54} :catch_55

    goto :goto_29

    .line 7880
    :catch_55
    move-exception v5

    goto :goto_29

    .line 7884
    .end local v0           #delay:J
    .end local v2           #endTime:J
    :catchall_57
    move-exception v5

    :try_start_58
    monitor-exit p0
    :try_end_59
    .catchall {:try_start_58 .. :try_end_59} :catchall_57

    throw v5
.end method

.method public signalAllProcesses(I)V
    .registers 6
    .parameter "sig"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 13229
    const/16 v2, 0xa

    if-eq p1, v2, :cond_c

    .line 13230
    new-instance v2, Ljava/lang/SecurityException;

    const-string v3, "Only SIGNAL_USR1 is allowed"

    invoke-direct {v2, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 13233
    :cond_c
    monitor-enter p0

    .line 13234
    :try_start_d
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .local v0, i:I
    :goto_16
    if-ltz v0, :cond_2c

    .line 13235
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 13236
    .local v1, r:Lcom/android/server/am/ProcessRecord;
    iget-object v2, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v2, :cond_29

    .line 13237
    iget v2, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v2, p1}, Landroid/os/Process;->sendSignal(II)V

    .line 13234
    :cond_29
    add-int/lit8 v0, v0, -0x1

    goto :goto_16

    .line 13240
    .end local v1           #r:Lcom/android/server/am/ProcessRecord;
    :cond_2c
    monitor-exit p0

    .line 13241
    return-void

    .line 13240
    .end local v0           #i:I
    :catchall_2e
    move-exception v2

    monitor-exit p0
    :try_end_30
    .catchall {:try_start_d .. :try_end_30} :catchall_2e

    throw v2
.end method

.method public signalPersistentProcesses(I)V
    .registers 6
    .parameter "sig"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Landroid/os/RemoteException;
        }
    .end annotation

    .prologue
    .line 13206
    const/16 v2, 0xa

    if-eq p1, v2, :cond_c

    .line 13207
    new-instance v2, Ljava/lang/SecurityException;

    const-string v3, "Only SIGNAL_USR1 is allowed"

    invoke-direct {v2, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 13210
    :cond_c
    monitor-enter p0

    .line 13211
    :try_start_d
    const-string v2, "android.permission.SIGNAL_PERSISTENT_PROCESSES"

    invoke-virtual {p0, v2}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v2

    if-eqz v2, :cond_20

    .line 13213
    new-instance v2, Ljava/lang/SecurityException;

    const-string v3, "Requires permission android.permission.SIGNAL_PERSISTENT_PROCESSES"

    invoke-direct {v2, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v2

    .line 13223
    :catchall_1d
    move-exception v2

    monitor-exit p0
    :try_end_1f
    .catchall {:try_start_d .. :try_end_1f} :catchall_1d

    throw v2

    .line 13217
    :cond_20
    :try_start_20
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    const/4 v3, 0x1

    sub-int v0, v2, v3

    .local v0, i:I
    :goto_29
    if-ltz v0, :cond_43

    .line 13218
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/ProcessRecord;

    .line 13219
    .local v1, r:Lcom/android/server/am/ProcessRecord;
    iget-object v2, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-eqz v2, :cond_40

    iget-boolean v2, v1, Lcom/android/server/am/ProcessRecord;->persistent:Z

    if-eqz v2, :cond_40

    .line 13220
    iget v2, v1, Lcom/android/server/am/ProcessRecord;->pid:I

    invoke-static {v2, p1}, Landroid/os/Process;->sendSignal(II)V

    .line 13217
    :cond_40
    add-int/lit8 v0, v0, -0x1

    goto :goto_29

    .line 13223
    .end local v1           #r:Lcom/android/server/am/ProcessRecord;
    :cond_43
    monitor-exit p0
    :try_end_44
    .catchall {:try_start_20 .. :try_end_44} :catchall_1d

    .line 13224
    return-void
.end method

.method skipCurrentReceiverLocked(Lcom/android/server/am/ProcessRecord;)V
    .registers 11
    .parameter "app"

    .prologue
    const/4 v6, 0x1

    .line 8545
    const/4 v8, 0x0

    .line 8546
    .local v8, reschedule:Z
    iget-object v7, p1, Lcom/android/server/am/ProcessRecord;->curReceiver:Lcom/android/server/am/BroadcastRecord;

    .line 8547
    .local v7, r:Lcom/android/server/am/BroadcastRecord;
    if-eqz v7, :cond_18

    .line 8551
    invoke-direct {p0, v7}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 8552
    iget-object v1, v7, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    iget v2, v7, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v3, v7, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v4, v7, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v5, v7, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move-object v0, p0

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 8554
    const/4 v8, 0x1

    .line 8556
    :cond_18
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 8557
    if-eqz v7, :cond_32

    iget-object v0, v7, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;

    if-ne v0, p1, :cond_32

    .line 8560
    invoke-direct {p0, v7}, Lcom/android/server/am/ActivityManagerService;->logBroadcastReceiverDiscard(Lcom/android/server/am/BroadcastRecord;)V

    .line 8561
    iget-object v1, v7, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;

    iget v2, v7, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v3, v7, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v4, v7, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v5, v7, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    move-object v0, p0

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    .line 8563
    const/4 v8, 0x1

    .line 8565
    :cond_32
    if-eqz v8, :cond_37

    .line 8566
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->scheduleBroadcastsLocked()V

    .line 8568
    :cond_37
    return-void
.end method

.method public final startActivity(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/os/IBinder;Ljava/lang/String;IZZ)I
    .registers 37
    .parameter "caller"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "grantedUriPermissions"
    .parameter "grantedMode"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "onlyIfNeeded"
    .parameter "debug"

    .prologue
    .line 3582
    if-eqz p2, :cond_10

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v4

    if-eqz v4, :cond_10

    .line 3583
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "File descriptors passed in Intent"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 3586
    :cond_10
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v4

    const/4 v5, 0x1

    sub-int v25, v4, v5

    .line 3587
    .local v25, top:I
    if-ltz v25, :cond_4e

    .line 3588
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move/from16 v1, v25

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v22

    check-cast v22, Lcom/android/server/am/HistoryRecord;

    .line 3589
    .local v22, p:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v22

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v4, v0

    const-string v5, "android.intent.category.HOME"

    invoke-virtual {v4, v5}, Landroid/content/Intent;->hasCategory(Ljava/lang/String;)Z

    move-result v4

    if-eqz v4, :cond_4e

    .line 3590
    new-instance v18, Landroid/content/Intent;

    const-string v4, "android.intent.action.stk.busy_screen"

    move-object/from16 v0, v18

    move-object v1, v4

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 3591
    .local v18, StkIntent:Landroid/content/Intent;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v18

    invoke-virtual {v0, v1}, Landroid/content/Context;->sendBroadcast(Landroid/content/Intent;)V

    .line 3595
    .end local v18           #StkIntent:Landroid/content/Intent;
    .end local v22           #p:Lcom/android/server/am/HistoryRecord;
    :cond_4e
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v4

    if-eqz v4, :cond_c1

    const/4 v4, 0x1

    move/from16 v17, v4

    .line 3598
    .local v17, componentSpecified:Z
    :goto_57
    new-instance v6, Landroid/content/Intent;

    move-object v0, v6

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    .line 3603
    .end local p2
    .local v6, intent:Landroid/content/Intent;
    :try_start_5f
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    const v5, 0x10400

    move-object v0, v4

    move-object v1, v6

    move-object/from16 v2, p3

    move v3, v5

    invoke-interface {v0, v1, v2, v3}, Landroid/content/pm/IPackageManager;->resolveIntent(Landroid/content/Intent;Ljava/lang/String;I)Landroid/content/pm/ResolveInfo;

    move-result-object v23

    .line 3608
    .local v23, rInfo:Landroid/content/pm/ResolveInfo;
    if-eqz v23, :cond_c5

    move-object/from16 v0, v23

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0
    :try_end_76
    .catch Landroid/os/RemoteException; {:try_start_5f .. :try_end_76} :catch_c8

    move-object v10, v4

    .line 3613
    .end local v23           #rInfo:Landroid/content/pm/ResolveInfo;
    .local v10, aInfo:Landroid/content/pm/ActivityInfo;
    :goto_77
    if-eqz v10, :cond_9f

    .line 3618
    new-instance v4, Landroid/content/ComponentName;

    iget-object v5, v10, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v7, v10, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v5, v7}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 3622
    if-eqz p10, :cond_9f

    .line 3623
    iget-object v4, v10, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;

    const-string v5, "system"

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_9f

    .line 3624
    iget-object v4, v10, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;

    const/4 v5, 0x1

    const/4 v7, 0x0

    move-object/from16 v0, p0

    move-object v1, v4

    move v2, v5

    move v3, v7

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->setDebugApp(Ljava/lang/String;ZZ)V

    .line 3629
    :cond_9f
    monitor-enter p0

    .line 3630
    :try_start_a0
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v20

    .line 3631
    .local v20, origId:J
    const/4 v14, -0x1

    const/4 v15, -0x1

    move-object/from16 v4, p0

    move-object/from16 v5, p1

    move-object/from16 v7, p3

    move-object/from16 v8, p4

    move/from16 v9, p5

    move-object/from16 v11, p6

    move-object/from16 v12, p7

    move/from16 v13, p8

    move/from16 v16, p9

    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    move-result v24

    .line 3635
    .local v24, res:I
    invoke-static/range {v20 .. v21}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 3636
    monitor-exit p0

    return v24

    .line 3595
    .end local v6           #intent:Landroid/content/Intent;
    .end local v10           #aInfo:Landroid/content/pm/ActivityInfo;
    .end local v17           #componentSpecified:Z
    .end local v20           #origId:J
    .end local v24           #res:I
    .restart local p2
    :cond_c1
    const/4 v4, 0x0

    move/from16 v17, v4

    goto :goto_57

    .line 3608
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v17       #componentSpecified:Z
    .restart local v23       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_c5
    const/4 v4, 0x0

    move-object v10, v4

    goto :goto_77

    .line 3609
    .end local v23           #rInfo:Landroid/content/pm/ResolveInfo;
    :catch_c8
    move-exception v4

    move-object/from16 v19, v4

    .line 3610
    .local v19, e:Landroid/os/RemoteException;
    const/4 v10, 0x0

    .restart local v10       #aInfo:Landroid/content/pm/ActivityInfo;
    goto :goto_77

    .line 3637
    .end local v19           #e:Landroid/os/RemoteException;
    :catchall_cd
    move-exception v4

    monitor-exit p0
    :try_end_cf
    .catchall {:try_start_a0 .. :try_end_cf} :catchall_cd

    throw v4
.end method

.method public final startActivityInPackage(ILandroid/content/Intent;Ljava/lang/String;Landroid/os/IBinder;Ljava/lang/String;IZ)I
    .registers 29
    .parameter "uid"
    .parameter "intent"
    .parameter "resolvedType"
    .parameter "resultTo"
    .parameter "resultWho"
    .parameter "requestCode"
    .parameter "onlyIfNeeded"

    .prologue
    .line 3740
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v18

    .line 3741
    .local v18, callingUid:I
    if-eqz v18, :cond_17

    invoke-static {}, Landroid/os/Process;->myUid()I

    move-result v4

    move/from16 v0, v18

    move v1, v4

    if-eq v0, v1, :cond_17

    .line 3742
    new-instance v4, Ljava/lang/SecurityException;

    const-string v5, "startActivityInPackage only available to the system"

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 3746
    :cond_17
    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->getComponent()Landroid/content/ComponentName;

    move-result-object v4

    if-eqz v4, :cond_69

    const/4 v4, 0x1

    move/from16 v17, v4

    .line 3749
    .local v17, componentSpecified:Z
    :goto_20
    new-instance v6, Landroid/content/Intent;

    move-object v0, v6

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V

    .line 3754
    .end local p2
    .local v6, intent:Landroid/content/Intent;
    :try_start_28
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    const v5, 0x10400

    move-object v0, v4

    move-object v1, v6

    move-object/from16 v2, p3

    move v3, v5

    invoke-interface {v0, v1, v2, v3}, Landroid/content/pm/IPackageManager;->resolveIntent(Landroid/content/Intent;Ljava/lang/String;I)Landroid/content/pm/ResolveInfo;

    move-result-object v20

    .line 3758
    .local v20, rInfo:Landroid/content/pm/ResolveInfo;
    if-eqz v20, :cond_6d

    move-object/from16 v0, v20

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0
    :try_end_3f
    .catch Landroid/os/RemoteException; {:try_start_28 .. :try_end_3f} :catch_70

    move-object v10, v4

    .line 3763
    .end local v20           #rInfo:Landroid/content/pm/ResolveInfo;
    .local v10, aInfo:Landroid/content/pm/ActivityInfo;
    :goto_40
    if-eqz v10, :cond_50

    .line 3768
    new-instance v4, Landroid/content/ComponentName;

    iget-object v5, v10, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v7, v10, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v5, v7}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 3772
    :cond_50
    monitor-enter p0

    .line 3773
    const/4 v5, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v14, -0x1

    move-object/from16 v4, p0

    move-object/from16 v7, p3

    move-object/from16 v11, p4

    move-object/from16 v12, p5

    move/from16 v13, p6

    move/from16 v15, p1

    move/from16 v16, p7

    :try_start_63
    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    move-result v4

    monitor-exit p0

    return v4

    .line 3746
    .end local v6           #intent:Landroid/content/Intent;
    .end local v10           #aInfo:Landroid/content/pm/ActivityInfo;
    .end local v17           #componentSpecified:Z
    .restart local p2
    :cond_69
    const/4 v4, 0x0

    move/from16 v17, v4

    goto :goto_20

    .line 3758
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v17       #componentSpecified:Z
    .restart local v20       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_6d
    const/4 v4, 0x0

    move-object v10, v4

    goto :goto_40

    .line 3759
    .end local v20           #rInfo:Landroid/content/pm/ResolveInfo;
    :catch_70
    move-exception v4

    move-object/from16 v19, v4

    .line 3760
    .local v19, e:Landroid/os/RemoteException;
    const/4 v10, 0x0

    .restart local v10       #aInfo:Landroid/content/pm/ActivityInfo;
    goto :goto_40

    .line 3776
    .end local v19           #e:Landroid/os/RemoteException;
    :catchall_75
    move-exception v4

    monitor-exit p0
    :try_end_77
    .catchall {:try_start_63 .. :try_end_77} :catchall_75

    throw v4
.end method

.method startAppProblemLocked(Lcom/android/server/am/ProcessRecord;)V
    .registers 3
    .parameter "app"

    .prologue
    .line 8540
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getErrorReportReceiver(Lcom/android/server/am/ProcessRecord;)Landroid/content/ComponentName;

    move-result-object v0

    iput-object v0, p1, Lcom/android/server/am/ProcessRecord;->errorReportReceiver:Landroid/content/ComponentName;

    .line 8541
    invoke-virtual {p0, p1}, Lcom/android/server/am/ActivityManagerService;->skipCurrentReceiverLocked(Lcom/android/server/am/ProcessRecord;)V

    .line 8542
    return-void
.end method

.method public startInstrumentation(Landroid/content/ComponentName;Ljava/lang/String;ILandroid/os/Bundle;Landroid/app/IInstrumentationWatcher;)Z
    .registers 16
    .parameter "className"
    .parameter "profileFile"
    .parameter "flags"
    .parameter "arguments"
    .parameter "watcher"

    .prologue
    .line 12101
    if-eqz p4, :cond_10

    invoke-virtual {p4}, Landroid/os/Bundle;->hasFileDescriptors()Z

    move-result v7

    if-eqz v7, :cond_10

    .line 12102
    new-instance v7, Ljava/lang/IllegalArgumentException;

    const-string v8, "File descriptors passed in Bundle"

    invoke-direct {v7, v8}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v7

    .line 12105
    :cond_10
    monitor-enter p0

    .line 12106
    const/4 v2, 0x0

    .line 12107
    .local v2, ii:Landroid/content/pm/InstrumentationInfo;
    const/4 v0, 0x0

    .line 12109
    .local v0, ai:Landroid/content/pm/ApplicationInfo;
    :try_start_13
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v7}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v7

    const/16 v8, 0x400

    invoke-virtual {v7, p1, v8}, Landroid/content/pm/PackageManager;->getInstrumentationInfo(Landroid/content/ComponentName;I)Landroid/content/pm/InstrumentationInfo;

    move-result-object v2

    .line 12111
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v7}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v7

    iget-object v8, v2, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    const/16 v9, 0x400

    invoke-virtual {v7, v8, v9}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;
    :try_end_2c
    .catchall {:try_start_13 .. :try_end_2c} :catchall_65
    .catch Landroid/content/pm/PackageManager$NameNotFoundException; {:try_start_13 .. :try_end_2c} :catch_ed

    move-result-object v0

    .line 12115
    :goto_2d
    if-nez v2, :cond_48

    .line 12116
    :try_start_2f
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unable to find instrumentation info for: "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-direct {p0, p5, p1, v7}, Lcom/android/server/am/ActivityManagerService;->reportStartInstrumentationFailure(Landroid/app/IInstrumentationWatcher;Landroid/content/ComponentName;Ljava/lang/String;)V

    .line 12118
    const/4 v7, 0x0

    monitor-exit p0

    .line 12152
    :goto_47
    return v7

    .line 12120
    :cond_48
    if-nez v0, :cond_68

    .line 12121
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Unable to find instrumentation target package: "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, v2, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-direct {p0, p5, p1, v7}, Lcom/android/server/am/ActivityManagerService;->reportStartInstrumentationFailure(Landroid/app/IInstrumentationWatcher;Landroid/content/ComponentName;Ljava/lang/String;)V

    .line 12123
    const/4 v7, 0x0

    monitor-exit p0

    goto :goto_47

    .line 12150
    :catchall_65
    move-exception v7

    monitor-exit p0
    :try_end_67
    .catchall {:try_start_2f .. :try_end_67} :catchall_65

    throw v7

    .line 12126
    :cond_68
    :try_start_68
    iget-object v7, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v7}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v7

    iget-object v8, v2, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    iget-object v9, v2, Landroid/content/pm/InstrumentationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v7, v8, v9}, Landroid/content/pm/PackageManager;->checkSignatures(Ljava/lang/String;Ljava/lang/String;)I

    move-result v3

    .line 12128
    .local v3, match:I
    if-gez v3, :cond_cb

    const/4 v7, -0x1

    if-eq v3, v7, :cond_cb

    .line 12129
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "Permission Denial: starting instrumentation "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " from pid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, ", uid="

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v8

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " not allowed because package "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, v2, Landroid/content/pm/InstrumentationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v8, " does not have a signature matching the target "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    iget-object v8, v2, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    .line 12136
    .local v4, msg:Ljava/lang/String;
    invoke-direct {p0, p5, p1, v4}, Lcom/android/server/am/ActivityManagerService;->reportStartInstrumentationFailure(Landroid/app/IInstrumentationWatcher;Landroid/content/ComponentName;Ljava/lang/String;)V

    .line 12137
    new-instance v7, Ljava/lang/SecurityException;

    invoke-direct {v7, v4}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v7

    .line 12140
    .end local v4           #msg:Ljava/lang/String;
    :cond_cb
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v5

    .line 12141
    .local v5, origId:J
    iget-object v7, v2, Landroid/content/pm/InstrumentationInfo;->targetPackage:Ljava/lang/String;

    const/4 v8, -0x1

    const/4 v9, 0x1

    invoke-direct {p0, v7, v8, v9}, Lcom/android/server/am/ActivityManagerService;->uninstallPackageLocked(Ljava/lang/String;IZ)V

    .line 12142
    invoke-virtual {p0, v0}, Lcom/android/server/am/ActivityManagerService;->addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;

    move-result-object v1

    .line 12143
    .local v1, app:Lcom/android/server/am/ProcessRecord;
    iput-object p1, v1, Lcom/android/server/am/ProcessRecord;->instrumentationClass:Landroid/content/ComponentName;

    .line 12144
    iput-object v0, v1, Lcom/android/server/am/ProcessRecord;->instrumentationInfo:Landroid/content/pm/ApplicationInfo;

    .line 12145
    iput-object p2, v1, Lcom/android/server/am/ProcessRecord;->instrumentationProfileFile:Ljava/lang/String;

    .line 12146
    iput-object p4, v1, Lcom/android/server/am/ProcessRecord;->instrumentationArguments:Landroid/os/Bundle;

    .line 12147
    iput-object p5, v1, Lcom/android/server/am/ProcessRecord;->instrumentationWatcher:Landroid/app/IInstrumentationWatcher;

    .line 12148
    iput-object p1, v1, Lcom/android/server/am/ProcessRecord;->instrumentationResultClass:Landroid/content/ComponentName;

    .line 12149
    invoke-static {v5, v6}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 12150
    monitor-exit p0
    :try_end_ea
    .catchall {:try_start_68 .. :try_end_ea} :catchall_65

    .line 12152
    const/4 v7, 0x1

    goto/16 :goto_47

    .line 12113
    .end local v1           #app:Lcom/android/server/am/ProcessRecord;
    .end local v3           #match:I
    .end local v5           #origId:J
    :catch_ed
    move-exception v7

    goto/16 :goto_2d
.end method

.method public startNextMatchingActivity(Landroid/os/IBinder;Landroid/content/Intent;)Z
    .registers 31
    .parameter "callingActivity"
    .parameter "intent"

    .prologue
    .line 3643
    if-eqz p2, :cond_11

    invoke-virtual/range {p2 .. p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v4

    const/4 v5, 0x1

    if-ne v4, v5, :cond_11

    .line 3644
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "File descriptors passed in Intent"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 3647
    :cond_11
    monitor-enter p0

    .line 3648
    :try_start_12
    invoke-direct/range {p0 .. p1}, Lcom/android/server/am/ActivityManagerService;->indexOfTokenLocked(Landroid/os/IBinder;)I

    move-result v20

    .line 3649
    .local v20, index:I
    if-gez v20, :cond_1b

    .line 3650
    const/4 v4, 0x0

    monitor-exit p0

    .line 3730
    .end local p1
    :goto_1a
    return v4

    .line 3652
    .restart local p1
    :cond_1b
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move/from16 v1, v20

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Lcom/android/server/am/HistoryRecord;

    .line 3653
    .local v23, r:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    if-eqz v4, :cond_39

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    if-nez v4, :cond_3f

    .line 3655
    :cond_39
    const/4 v4, 0x0

    monitor-exit p0

    goto :goto_1a

    .line 3731
    .end local v20           #index:I
    .end local v23           #r:Lcom/android/server/am/HistoryRecord;
    .end local p1
    :catchall_3c
    move-exception v4

    :goto_3d
    monitor-exit p0
    :try_end_3e
    .catchall {:try_start_12 .. :try_end_3e} :catchall_3c

    throw v4

    .line 3657
    .restart local v20       #index:I
    .restart local v23       #r:Lcom/android/server/am/HistoryRecord;
    .restart local p1
    :cond_3f
    :try_start_3f
    new-instance v6, Landroid/content/Intent;

    move-object v0, v6

    move-object/from16 v1, p2

    invoke-direct {v0, v1}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V
    :try_end_47
    .catchall {:try_start_3f .. :try_end_47} :catchall_3c

    .line 3659
    .end local p2
    .local v6, intent:Landroid/content/Intent;
    :try_start_47
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v4, v0

    invoke-virtual {v4}, Landroid/content/Intent;->getData()Landroid/net/Uri;

    move-result-object v4

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->intent:Landroid/content/Intent;

    move-object v5, v0

    invoke-virtual {v5}, Landroid/content/Intent;->getType()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v6, v4, v5}, Landroid/content/Intent;->setDataAndType(Landroid/net/Uri;Ljava/lang/String;)Landroid/content/Intent;

    .line 3661
    const/4 v4, 0x0

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;
    :try_end_60
    .catchall {:try_start_47 .. :try_end_60} :catchall_154

    .line 3663
    const/4 v10, 0x0

    .line 3665
    .local v10, aInfo:Landroid/content/pm/ActivityInfo;
    :try_start_61
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v4

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resolvedType:Ljava/lang/String;

    move-object v5, v0

    const v7, 0x10400

    invoke-interface {v4, v6, v5, v7}, Landroid/content/pm/IPackageManager;->queryIntentActivities(Landroid/content/Intent;Ljava/lang/String;I)Ljava/util/List;

    move-result-object v26

    .line 3671
    .local v26, resolves:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    if-eqz v26, :cond_d0

    invoke-interface/range {v26 .. v26}, Ljava/util/List;->size()I

    move-result v4

    move/from16 v18, v4

    .line 3672
    .local v18, N:I
    :goto_79
    const/16 v19, 0x0

    .local v19, i:I
    :goto_7b
    move/from16 v0, v19

    move/from16 v1, v18

    if-ge v0, v1, :cond_c8

    .line 3673
    move-object/from16 v0, v26

    move/from16 v1, v19

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v24

    check-cast v24, Landroid/content/pm/ResolveInfo;

    .line 3674
    .local v24, rInfo:Landroid/content/pm/ResolveInfo;
    move-object/from16 v0, v24

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->packageName:Ljava/lang/String;

    move-object v5, v0

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_d4

    move-object/from16 v0, v24

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v4, v0

    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->info:Landroid/content/pm/ActivityInfo;

    move-object v5, v0

    iget-object v5, v5, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_d4

    .line 3678
    add-int/lit8 v19, v19, 0x1

    .line 3679
    move/from16 v0, v19

    move/from16 v1, v18

    if-ge v0, v1, :cond_c8

    .line 3680
    move-object/from16 v0, v26

    move/from16 v1, v19

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object p1

    .end local p1
    check-cast p1, Landroid/content/pm/ResolveInfo;

    move-object/from16 v0, p1

    iget-object v0, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    move-object v10, v0
    :try_end_c8
    .catchall {:try_start_61 .. :try_end_c8} :catchall_154
    .catch Landroid/os/RemoteException; {:try_start_61 .. :try_end_c8} :catch_159

    .line 3688
    .end local v18           #N:I
    .end local v19           #i:I
    .end local v24           #rInfo:Landroid/content/pm/ResolveInfo;
    .end local v26           #resolves:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    :cond_c8
    :goto_c8
    if-nez v10, :cond_d7

    .line 3690
    const/4 v4, 0x0

    :try_start_cb
    monitor-exit p0

    move-object/from16 p2, v6

    .end local v6           #intent:Landroid/content/Intent;
    .restart local p2
    goto/16 :goto_1a

    .line 3671
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v26       #resolves:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .restart local p1
    :cond_d0
    const/4 v4, 0x0

    move/from16 v18, v4

    goto :goto_79

    .line 3672
    .restart local v18       #N:I
    .restart local v19       #i:I
    .restart local v24       #rInfo:Landroid/content/pm/ResolveInfo;
    :cond_d4
    add-int/lit8 v19, v19, 0x1

    goto :goto_7b

    .line 3693
    .end local v18           #N:I
    .end local v19           #i:I
    .end local v24           #rInfo:Landroid/content/pm/ResolveInfo;
    .end local v26           #resolves:Ljava/util/List;,"Ljava/util/List<Landroid/content/pm/ResolveInfo;>;"
    .end local p1
    :cond_d7
    new-instance v4, Landroid/content/ComponentName;

    iget-object v5, v10, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    iget-object v5, v5, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v7, v10, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v4, v5, v7}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setComponent(Landroid/content/ComponentName;)Landroid/content/Intent;

    .line 3695
    invoke-virtual {v6}, Landroid/content/Intent;->getFlags()I

    move-result v4

    const v5, -0x1e000001

    and-int/2addr v4, v5

    invoke-virtual {v6, v4}, Landroid/content/Intent;->setFlags(I)Landroid/content/Intent;

    .line 3706
    move-object/from16 v0, v23

    iget-boolean v0, v0, Lcom/android/server/am/HistoryRecord;->finishing:Z

    move/from16 v27, v0

    .line 3707
    .local v27, wasFinishing:Z
    const/4 v4, 0x1

    move v0, v4

    move-object/from16 v1, v23

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    .line 3710
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    move-object v11, v0

    .line 3711
    .local v11, resultTo:Lcom/android/server/am/HistoryRecord;
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resultWho:Ljava/lang/String;

    move-object v12, v0

    .line 3712
    .local v12, resultWho:Ljava/lang/String;
    move-object/from16 v0, v23

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->requestCode:I

    move v13, v0

    .line 3713
    .local v13, requestCode:I
    const/4 v4, 0x0

    move-object v0, v4

    move-object/from16 v1, v23

    iput-object v0, v1, Lcom/android/server/am/HistoryRecord;->resultTo:Lcom/android/server/am/HistoryRecord;

    .line 3714
    if-eqz v11, :cond_11b

    .line 3715
    move-object v0, v11

    move-object/from16 v1, v23

    move-object v2, v12

    move v3, v13

    invoke-virtual {v0, v1, v2, v3}, Lcom/android/server/am/HistoryRecord;->removeResultsLocked(Lcom/android/server/am/HistoryRecord;Ljava/lang/String;I)V

    .line 3718
    :cond_11b
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v21

    .line 3721
    .local v21, origId:J
    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->app:Lcom/android/server/am/ProcessRecord;

    move-object v4, v0

    iget-object v5, v4, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object/from16 v0, v23

    iget-object v0, v0, Lcom/android/server/am/HistoryRecord;->resolvedType:Ljava/lang/String;

    move-object v7, v0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v14, -0x1

    move-object/from16 v0, v23

    iget v0, v0, Lcom/android/server/am/HistoryRecord;->launchedFromUid:I

    move v15, v0

    const/16 v16, 0x0

    const/16 v17, 0x0

    move-object/from16 v4, p0

    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->startActivityLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;[Landroid/net/Uri;ILandroid/content/pm/ActivityInfo;Landroid/os/IBinder;Ljava/lang/String;IIIZZ)I

    move-result v25

    .line 3724
    .local v25, res:I
    invoke-static/range {v21 .. v22}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 3726
    move/from16 v0, v27

    move-object/from16 v1, v23

    iput-boolean v0, v1, Lcom/android/server/am/HistoryRecord;->finishing:Z

    .line 3727
    if-eqz v25, :cond_14e

    .line 3728
    const/4 v4, 0x0

    monitor-exit p0

    move-object/from16 p2, v6

    .end local v6           #intent:Landroid/content/Intent;
    .restart local p2
    goto/16 :goto_1a

    .line 3730
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    :cond_14e
    const/4 v4, 0x1

    monitor-exit p0
    :try_end_150
    .catchall {:try_start_cb .. :try_end_150} :catchall_154

    move-object/from16 p2, v6

    .end local v6           #intent:Landroid/content/Intent;
    .restart local p2
    goto/16 :goto_1a

    .line 3731
    .end local v10           #aInfo:Landroid/content/pm/ActivityInfo;
    .end local v11           #resultTo:Lcom/android/server/am/HistoryRecord;
    .end local v12           #resultWho:Ljava/lang/String;
    .end local v13           #requestCode:I
    .end local v21           #origId:J
    .end local v25           #res:I
    .end local v27           #wasFinishing:Z
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    :catchall_154
    move-exception v4

    move-object/from16 p2, v6

    .end local v6           #intent:Landroid/content/Intent;
    .restart local p2
    goto/16 :goto_3d

    .line 3685
    .end local p2
    .restart local v6       #intent:Landroid/content/Intent;
    .restart local v10       #aInfo:Landroid/content/pm/ActivityInfo;
    :catch_159
    move-exception v4

    goto/16 :goto_c8
.end method

.method public final startRunning(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
    .registers 6
    .parameter "pkg"
    .parameter "cls"
    .parameter "action"
    .parameter "data"

    .prologue
    .line 8248
    monitor-enter p0

    .line 8249
    :try_start_1
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    if-eqz v0, :cond_7

    .line 8250
    monitor-exit p0

    .line 8263
    :goto_6
    return-void

    .line 8252
    :cond_7
    const/4 v0, 0x1

    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    .line 8253
    if-eqz p1, :cond_25

    if-eqz p2, :cond_25

    new-instance v0, Landroid/content/ComponentName;

    invoke-direct {v0, p1, p2}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    :goto_13
    iput-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    .line 8255
    if-eqz p3, :cond_27

    move-object v0, p3

    :goto_18
    iput-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    .line 8256
    iput-object p4, p0, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    .line 8257
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    if-nez v0, :cond_2a

    .line 8258
    monitor-exit p0

    goto :goto_6

    .line 8260
    :catchall_22
    move-exception v0

    monitor-exit p0
    :try_end_24
    .catchall {:try_start_1 .. :try_end_24} :catchall_22

    throw v0

    .line 8253
    :cond_25
    const/4 v0, 0x0

    goto :goto_13

    .line 8255
    :cond_27
    :try_start_27
    const-string v0, "android.intent.action.MAIN"

    goto :goto_18

    .line 8260
    :cond_2a
    monitor-exit p0
    :try_end_2b
    .catchall {:try_start_27 .. :try_end_2b} :catchall_22

    .line 8262
    invoke-virtual {p0}, Lcom/android/server/am/ActivityManagerService;->systemReady()V

    goto :goto_6
.end method

.method public startService(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;)Landroid/content/ComponentName;
    .registers 13
    .parameter "caller"
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    .line 10405
    if-eqz p2, :cond_11

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v0

    const/4 v1, 0x1

    if-ne v0, v1, :cond_11

    .line 10406
    new-instance v0, Ljava/lang/IllegalArgumentException;

    const-string v1, "File descriptors passed in Intent"

    invoke-direct {v0, v1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 10409
    :cond_11
    monitor-enter p0

    .line 10410
    :try_start_12
    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v4

    .line 10411
    .local v4, callingPid:I
    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    .line 10412
    .local v5, callingUid:I
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .local v6, origId:J
    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move-object v3, p3

    .line 10413
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->startServiceLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/ComponentName;

    move-result-object v8

    .line 10415
    .local v8, res:Landroid/content/ComponentName;
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 10416
    monitor-exit p0

    return-object v8

    .line 10417
    .end local v4           #callingPid:I
    .end local v5           #callingUid:I
    .end local v6           #origId:J
    .end local v8           #res:Landroid/content/ComponentName;
    :catchall_2b
    move-exception v0

    monitor-exit p0
    :try_end_2d
    .catchall {:try_start_12 .. :try_end_2d} :catchall_2b

    throw v0
.end method

.method startServiceInPackage(ILandroid/content/Intent;Ljava/lang/String;)Landroid/content/ComponentName;
    .registers 13
    .parameter "uid"
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    .line 10422
    monitor-enter p0

    .line 10423
    :try_start_1
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v6

    .line 10424
    .local v6, origId:J
    const/4 v1, 0x0

    const/4 v4, -0x1

    move-object v0, p0

    move-object v2, p2

    move-object v3, p3

    move v5, p1

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->startServiceLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/ComponentName;

    move-result-object v8

    .line 10426
    .local v8, res:Landroid/content/ComponentName;
    invoke-static {v6, v7}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 10427
    monitor-exit p0

    return-object v8

    .line 10428
    .end local v6           #origId:J
    .end local v8           #res:Landroid/content/ComponentName;
    :catchall_14
    move-exception v0

    monitor-exit p0
    :try_end_16
    .catchall {:try_start_1 .. :try_end_16} :catchall_14

    throw v0
.end method

.method startServiceLocked(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;II)Landroid/content/ComponentName;
    .registers 12
    .parameter "caller"
    .parameter "service"
    .parameter "resolvedType"
    .parameter "callingPid"
    .parameter "callingUid"

    .prologue
    const/4 v4, 0x1

    const-string v3, "!"

    .line 10356
    monitor-enter p0

    .line 10360
    if-eqz p1, :cond_40

    .line 10361
    :try_start_6
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 10362
    .local v0, callerApp:Lcom/android/server/am/ProcessRecord;
    if-nez v0, :cond_40

    .line 10363
    new-instance v3, Ljava/lang/SecurityException;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Unable to find app for caller "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " (pid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ") when starting service "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 10399
    .end local v0           #callerApp:Lcom/android/server/am/ProcessRecord;
    :catchall_3d
    move-exception v3

    monitor-exit p0
    :try_end_3f
    .catchall {:try_start_6 .. :try_end_3f} :catchall_3d

    throw v3

    .line 10370
    :cond_40
    :try_start_40
    invoke-direct {p0, p2, p3, p4, p5}, Lcom/android/server/am/ActivityManagerService;->retrieveServiceLocked(Landroid/content/Intent;Ljava/lang/String;II)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    move-result-object v2

    .line 10373
    .local v2, res:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    if-nez v2, :cond_49

    .line 10374
    const/4 v3, 0x0

    monitor-exit p0

    .line 10398
    :goto_48
    return-object v3

    .line 10376
    :cond_49
    iget-object v3, v2, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    if-nez v3, :cond_5f

    .line 10377
    new-instance v3, Landroid/content/ComponentName;

    const-string v4, "!"

    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->permission:Ljava/lang/String;

    if-eqz v5, :cond_5c

    iget-object v5, v2, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->permission:Ljava/lang/String;

    :goto_57
    invoke-direct {v3, v4, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    monitor-exit p0

    goto :goto_48

    :cond_5c
    const-string v5, "private to package"

    goto :goto_57

    .line 10380
    :cond_5f
    iget-object v1, v2, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    .line 10381
    .local v1, r:Lcom/android/server/am/ServiceRecord;
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->unscheduleServiceRestartLocked(Lcom/android/server/am/ServiceRecord;)Z

    move-result v3

    if-eqz v3, :cond_67

    .line 10385
    :cond_67
    const/4 v3, 0x1

    iput-boolean v3, v1, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    .line 10386
    iget-object v3, v1, Lcom/android/server/am/ServiceRecord;->startArgs:Ljava/util/List;

    invoke-interface {v3, p2}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 10387
    iget v3, v1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    add-int/lit8 v3, v3, 0x1

    iput v3, v1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    .line 10388
    iget v3, v1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    if-ge v3, v4, :cond_7c

    .line 10389
    const/4 v3, 0x1

    iput v3, v1, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    .line 10391
    :cond_7c
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v3

    iput-wide v3, v1, Lcom/android/server/am/ServiceRecord;->lastActivity:J

    .line 10392
    iget-object v3, v1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v3}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v3

    monitor-enter v3
    :try_end_89
    .catchall {:try_start_40 .. :try_end_89} :catchall_3d

    .line 10393
    :try_start_89
    iget-object v4, v1, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->startRunningLocked()V

    .line 10394
    monitor-exit v3
    :try_end_8f
    .catchall {:try_start_89 .. :try_end_8f} :catchall_a5

    .line 10395
    :try_start_8f
    invoke-virtual {p2}, Landroid/content/Intent;->getFlags()I

    move-result v3

    const/4 v4, 0x0

    invoke-direct {p0, v1, v3, v4}, Lcom/android/server/am/ActivityManagerService;->bringUpServiceLocked(Lcom/android/server/am/ServiceRecord;IZ)Z

    move-result v3

    if-nez v3, :cond_a8

    .line 10396
    new-instance v3, Landroid/content/ComponentName;

    const-string v4, "!"

    const-string v5, "Service process is bad"

    invoke-direct {v3, v4, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    monitor-exit p0
    :try_end_a4
    .catchall {:try_start_8f .. :try_end_a4} :catchall_3d

    goto :goto_48

    .line 10394
    :catchall_a5
    move-exception v4

    :try_start_a6
    monitor-exit v3
    :try_end_a7
    .catchall {:try_start_a6 .. :try_end_a7} :catchall_a5

    :try_start_a7
    throw v4

    .line 10398
    :cond_a8
    iget-object v3, v1, Lcom/android/server/am/ServiceRecord;->name:Landroid/content/ComponentName;

    monitor-exit p0
    :try_end_ab
    .catchall {:try_start_a7 .. :try_end_ab} :catchall_3d

    goto :goto_48
.end method

.method public stopAppSwitches()V
    .registers 6

    .prologue
    const-wide/16 v3, 0x1388

    .line 7925
    const-string v1, "android.permission.STOP_APP_SWITCHES"

    invoke-virtual {p0, v1}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v1

    if-eqz v1, :cond_12

    .line 7927
    new-instance v1, Ljava/lang/SecurityException;

    const-string v2, "Requires permission android.permission.STOP_APP_SWITCHES"

    invoke-direct {v1, v2}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 7931
    :cond_12
    monitor-enter p0

    .line 7932
    :try_start_13
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    add-long/2addr v1, v3

    iput-wide v1, p0, Lcom/android/server/am/ActivityManagerService;->mAppSwitchesAllowedTime:J

    .line 7934
    const/4 v1, 0x0

    iput-boolean v1, p0, Lcom/android/server/am/ActivityManagerService;->mDidAppSwitch:Z

    .line 7935
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v2, 0x15

    invoke-virtual {v1, v2}, Landroid/os/Handler;->removeMessages(I)V

    .line 7936
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const/16 v2, 0x15

    invoke-virtual {v1, v2}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v0

    .line 7937
    .local v0, msg:Landroid/os/Message;
    iget-object v1, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    const-wide/16 v2, 0x1388

    invoke-virtual {v1, v0, v2, v3}, Landroid/os/Handler;->sendMessageDelayed(Landroid/os/Message;J)Z

    .line 7938
    monitor-exit p0

    .line 7939
    return-void

    .line 7938
    .end local v0           #msg:Landroid/os/Message;
    :catchall_35
    move-exception v1

    monitor-exit p0
    :try_end_37
    .catchall {:try_start_13 .. :try_end_37} :catchall_35

    throw v1
.end method

.method public stopService(Landroid/app/IApplicationThread;Landroid/content/Intent;Ljava/lang/String;)I
    .registers 11
    .parameter "caller"
    .parameter "service"
    .parameter "resolvedType"

    .prologue
    const/4 v6, 0x1

    const/4 v5, 0x0

    .line 10434
    if-eqz p2, :cond_12

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v4

    if-ne v4, v6, :cond_12

    .line 10435
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "File descriptors passed in Intent"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 10438
    :cond_12
    monitor-enter p0

    .line 10442
    :try_start_13
    invoke-direct {p0, p1}, Lcom/android/server/am/ActivityManagerService;->getRecordForAppLocked(Landroid/app/IApplicationThread;)Lcom/android/server/am/ProcessRecord;

    move-result-object v0

    .line 10443
    .local v0, callerApp:Lcom/android/server/am/ProcessRecord;
    if-eqz p1, :cond_4f

    if-nez v0, :cond_4f

    .line 10444
    new-instance v4, Ljava/lang/SecurityException;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unable to find app for caller "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, " (pid="

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ") when stopping service "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v4, v5}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 10465
    .end local v0           #callerApp:Lcom/android/server/am/ProcessRecord;
    :catchall_4c
    move-exception v4

    monitor-exit p0
    :try_end_4e
    .catchall {:try_start_13 .. :try_end_4e} :catchall_4c

    throw v4

    .line 10451
    .restart local v0       #callerApp:Lcom/android/server/am/ProcessRecord;
    :cond_4f
    :try_start_4f
    invoke-direct {p0, p2, p3}, Lcom/android/server/am/ActivityManagerService;->findServiceLocked(Landroid/content/Intent;Ljava/lang/String;)Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;

    move-result-object v3

    .line 10452
    .local v3, r:Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;
    if-eqz v3, :cond_85

    .line 10453
    iget-object v4, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    if-eqz v4, :cond_82

    .line 10454
    iget-object v4, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v4, v4, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v4

    monitor-enter v4
    :try_end_62
    .catchall {:try_start_4f .. :try_end_62} :catchall_4c

    .line 10455
    :try_start_62
    iget-object v5, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    iget-object v5, v5, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v5}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->stopRunningLocked()V

    .line 10456
    monitor-exit v4
    :try_end_6a
    .catchall {:try_start_62 .. :try_end_6a} :catchall_7f

    .line 10457
    :try_start_6a
    iget-object v4, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    const/4 v5, 0x0

    iput-boolean v5, v4, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    .line 10458
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 10459
    .local v1, origId:J
    iget-object v4, v3, Lcom/android/server/am/ActivityManagerService$ServiceLookupResult;->record:Lcom/android/server/am/ServiceRecord;

    const/4 v5, 0x0

    invoke-direct {p0, v4, v5}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 10460
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 10461
    monitor-exit p0
    :try_end_7d
    .catchall {:try_start_6a .. :try_end_7d} :catchall_4c

    move v4, v6

    .line 10467
    .end local v1           #origId:J
    :goto_7e
    return v4

    .line 10456
    :catchall_7f
    move-exception v5

    :try_start_80
    monitor-exit v4
    :try_end_81
    .catchall {:try_start_80 .. :try_end_81} :catchall_7f

    :try_start_81
    throw v5

    .line 10463
    :cond_82
    const/4 v4, -0x1

    monitor-exit p0

    goto :goto_7e

    .line 10465
    :cond_85
    monitor-exit p0
    :try_end_86
    .catchall {:try_start_81 .. :try_end_86} :catchall_4c

    move v4, v5

    .line 10467
    goto :goto_7e
.end method

.method public stopServiceToken(Landroid/content/ComponentName;Landroid/os/IBinder;I)Z
    .registers 9
    .parameter "className"
    .parameter "token"
    .parameter "startId"

    .prologue
    const/4 v4, 0x0

    .line 10502
    monitor-enter p0

    .line 10505
    :try_start_2
    invoke-direct {p0, p1, p2}, Lcom/android/server/am/ActivityManagerService;->findServiceLocked(Landroid/content/ComponentName;Landroid/os/IBinder;)Lcom/android/server/am/ServiceRecord;

    move-result-object v2

    .line 10506
    .local v2, r:Lcom/android/server/am/ServiceRecord;
    if-eqz v2, :cond_32

    if-ltz p3, :cond_e

    iget v3, v2, Lcom/android/server/am/ServiceRecord;->lastStartId:I

    if-ne v3, p3, :cond_32

    .line 10507
    :cond_e
    iget-object v3, v2, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v3}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->getBatteryStats()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v3

    monitor-enter v3
    :try_end_15
    .catchall {:try_start_2 .. :try_end_15} :catchall_2f

    .line 10508
    :try_start_15
    iget-object v4, v2, Lcom/android/server/am/ServiceRecord;->stats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;

    invoke-virtual {v4}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Pkg$Serv;->stopRunningLocked()V

    .line 10509
    const/4 v4, 0x0

    iput-boolean v4, v2, Lcom/android/server/am/ServiceRecord;->startRequested:Z

    .line 10510
    monitor-exit v3
    :try_end_1e
    .catchall {:try_start_15 .. :try_end_1e} :catchall_2c

    .line 10511
    :try_start_1e
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 10512
    .local v0, origId:J
    const/4 v3, 0x0

    invoke-direct {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->bringDownServiceLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 10513
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 10514
    const/4 v3, 0x1

    monitor-exit p0
    :try_end_2b
    .catchall {:try_start_1e .. :try_end_2b} :catchall_2f

    .line 10517
    .end local v0           #origId:J
    :goto_2b
    return v3

    .line 10510
    :catchall_2c
    move-exception v4

    :try_start_2d
    monitor-exit v3
    :try_end_2e
    .catchall {:try_start_2d .. :try_end_2e} :catchall_2c

    :try_start_2e
    throw v4

    .line 10516
    .end local v2           #r:Lcom/android/server/am/ServiceRecord;
    :catchall_2f
    move-exception v3

    monitor-exit p0
    :try_end_31
    .catchall {:try_start_2e .. :try_end_31} :catchall_2f

    throw v3

    .restart local v2       #r:Lcom/android/server/am/ServiceRecord;
    :cond_32
    :try_start_32
    monitor-exit p0
    :try_end_33
    .catchall {:try_start_32 .. :try_end_33} :catchall_2f

    move v3, v4

    .line 10517
    goto :goto_2b
.end method

.method public systemReady()V
    .registers 14

    .prologue
    const/4 v12, 0x1

    const-string v9, "android.intent.action.FACTORY_TEST"

    .line 8295
    invoke-static {}, Landroid/os/Process;->supportsProcesses()Z

    move-result v9

    if-nez v9, :cond_f

    .line 8296
    iput-boolean v12, p0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    .line 8297
    const-string v9, "android.intent.action.MAIN"

    iput-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    .line 8300
    :cond_f
    monitor-enter p0

    .line 8301
    :try_start_10
    iget-boolean v9, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    if-eqz v9, :cond_16

    .line 8302
    monitor-exit p0

    .line 8385
    :goto_15
    return-void

    .line 8304
    :cond_16
    const/4 v9, 0x1

    iput-boolean v9, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    .line 8305
    iget-boolean v9, p0, Lcom/android/server/am/ActivityManagerService;->mStartRunning:Z

    if-nez v9, :cond_22

    .line 8306
    monitor-exit p0

    goto :goto_15

    .line 8308
    :catchall_1f
    move-exception v9

    monitor-exit p0
    :try_end_21
    .catchall {:try_start_10 .. :try_end_21} :catchall_1f

    throw v9

    :cond_22
    :try_start_22
    monitor-exit p0
    :try_end_23
    .catchall {:try_start_22 .. :try_end_23} :catchall_1f

    .line 8310
    const-string v9, "ActivityManager"

    const-string v10, "Start running!"

    invoke-static {v9, v10}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 8311
    const/16 v9, 0xbe0

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v10

    invoke-static {v9, v10, v11}, Landroid/util/EventLog;->writeEvent(IJ)I

    .line 8314
    monitor-enter p0

    .line 8315
    :try_start_34
    iget v9, p0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I

    if-ne v9, v12, :cond_8a

    .line 8316
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v9}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v9

    new-instance v10, Landroid/content/Intent;

    const-string v11, "android.intent.action.FACTORY_TEST"

    invoke-direct {v10, v11}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    const/16 v11, 0x400

    invoke-virtual {v9, v10, v11}, Landroid/content/pm/PackageManager;->resolveActivity(Landroid/content/Intent;I)Landroid/content/pm/ResolveInfo;

    move-result-object v8

    .line 8319
    .local v8, ri:Landroid/content/pm/ResolveInfo;
    const/4 v4, 0x0

    .line 8320
    .local v4, errorMsg:Ljava/lang/CharSequence;
    if-eqz v8, :cond_cc

    .line 8321
    iget-object v1, v8, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;

    .line 8322
    .local v1, ai:Landroid/content/pm/ActivityInfo;
    iget-object v2, v1, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;

    .line 8323
    .local v2, app:Landroid/content/pm/ApplicationInfo;
    iget v9, v2, Landroid/content/pm/ApplicationInfo;->flags:I

    and-int/lit8 v9, v9, 0x1

    if-eqz v9, :cond_be

    .line 8324
    const-string v9, "android.intent.action.FACTORY_TEST"

    iput-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    .line 8325
    const/4 v9, 0x0

    iput-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    .line 8326
    new-instance v9, Landroid/content/ComponentName;

    iget-object v10, v2, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    iget-object v11, v1, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;

    invoke-direct {v9, v10, v11}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    iput-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    .line 8336
    .end local v1           #ai:Landroid/content/pm/ActivityInfo;
    .end local v2           #app:Landroid/content/pm/ApplicationInfo;
    :goto_6a
    if-eqz v4, :cond_8a

    .line 8337
    const/4 v9, 0x0

    iput-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mTopAction:Ljava/lang/String;

    .line 8338
    const/4 v9, 0x0

    iput-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mTopData:Ljava/lang/String;

    .line 8339
    const/4 v9, 0x0

    iput-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mTopComponent:Landroid/content/ComponentName;

    .line 8340
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v7

    .line 8341
    .local v7, msg:Landroid/os/Message;
    const/4 v9, 0x3

    iput v9, v7, Landroid/os/Message;->what:I

    .line 8342
    invoke-virtual {v7}, Landroid/os/Message;->getData()Landroid/os/Bundle;

    move-result-object v9

    const-string v10, "msg"

    invoke-virtual {v9, v10, v4}, Landroid/os/Bundle;->putCharSequence(Ljava/lang/String;Ljava/lang/CharSequence;)V

    .line 8343
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v9, v7}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 8346
    .end local v4           #errorMsg:Ljava/lang/CharSequence;
    .end local v7           #msg:Landroid/os/Message;
    .end local v8           #ri:Landroid/content/pm/ResolveInfo;
    :cond_8a
    monitor-exit p0
    :try_end_8b
    .catchall {:try_start_34 .. :try_end_8b} :catchall_da

    .line 8348
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->retrieveSettings()V

    .line 8350
    monitor-enter p0

    .line 8351
    :try_start_8f
    iget v9, p0, Lcom/android/server/am/ActivityManagerService;->mFactoryTest:I
    :try_end_91
    .catchall {:try_start_8f .. :try_end_91} :catchall_ff

    if-eq v9, v12, :cond_de

    .line 8353
    :try_start_93
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v9

    const/16 v10, 0x400

    invoke-interface {v9, v10}, Landroid/content/pm/IPackageManager;->getPersistentApplications(I)Ljava/util/List;

    move-result-object v3

    .line 8355
    .local v3, apps:Ljava/util/List;
    if-eqz v3, :cond_de

    .line 8356
    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v0

    .line 8358
    .local v0, N:I
    const/4 v5, 0x0

    .local v5, i:I
    :goto_a4
    if-ge v5, v0, :cond_de

    .line 8359
    invoke-interface {v3, v5}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Landroid/content/pm/ApplicationInfo;

    .line 8361
    .local v6, info:Landroid/content/pm/ApplicationInfo;
    if-eqz v6, :cond_bb

    iget-object v9, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    const-string v10, "android"

    invoke-virtual {v9, v10}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v9

    if-nez v9, :cond_bb

    .line 8363
    invoke-virtual {p0, v6}, Lcom/android/server/am/ActivityManagerService;->addAppLocked(Landroid/content/pm/ApplicationInfo;)Lcom/android/server/am/ProcessRecord;
    :try_end_bb
    .catchall {:try_start_93 .. :try_end_bb} :catchall_ff
    .catch Landroid/os/RemoteException; {:try_start_93 .. :try_end_bb} :catch_dd

    .line 8358
    :cond_bb
    add-int/lit8 v5, v5, 0x1

    goto :goto_a4

    .line 8329
    .end local v0           #N:I
    .end local v3           #apps:Ljava/util/List;
    .end local v5           #i:I
    .end local v6           #info:Landroid/content/pm/ApplicationInfo;
    .restart local v1       #ai:Landroid/content/pm/ActivityInfo;
    .restart local v2       #app:Landroid/content/pm/ApplicationInfo;
    .restart local v4       #errorMsg:Ljava/lang/CharSequence;
    .restart local v8       #ri:Landroid/content/pm/ResolveInfo;
    :cond_be
    :try_start_be
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v9}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v9

    const v10, 0x10401b8

    invoke-virtual {v9, v10}, Landroid/content/res/Resources;->getText(I)Ljava/lang/CharSequence;

    move-result-object v4

    goto :goto_6a

    .line 8333
    .end local v1           #ai:Landroid/content/pm/ActivityInfo;
    .end local v2           #app:Landroid/content/pm/ApplicationInfo;
    :cond_cc
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mContext:Landroid/content/Context;

    invoke-virtual {v9}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;

    move-result-object v9

    const v10, 0x10401b9

    invoke-virtual {v9, v10}, Landroid/content/res/Resources;->getText(I)Ljava/lang/CharSequence;

    move-result-object v4

    goto :goto_6a

    .line 8346
    .end local v4           #errorMsg:Ljava/lang/CharSequence;
    .end local v8           #ri:Landroid/content/pm/ResolveInfo;
    :catchall_da
    move-exception v9

    monitor-exit p0
    :try_end_dc
    .catchall {:try_start_be .. :try_end_dc} :catchall_da

    throw v9

    .line 8367
    :catch_dd
    move-exception v9

    .line 8373
    :cond_de
    :try_start_de
    invoke-static {}, Landroid/app/ActivityThread;->getPackageManager()Landroid/content/pm/IPackageManager;

    move-result-object v9

    invoke-interface {v9}, Landroid/content/pm/IPackageManager;->hasSystemUidErrors()Z

    move-result v9

    if-eqz v9, :cond_f5

    .line 8374
    invoke-static {}, Landroid/os/Message;->obtain()Landroid/os/Message;

    move-result-object v7

    .line 8375
    .restart local v7       #msg:Landroid/os/Message;
    const/16 v9, 0xe

    iput v9, v7, Landroid/os/Message;->what:I

    .line 8376
    iget-object v9, p0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    invoke-virtual {v9, v7}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z
    :try_end_f5
    .catchall {:try_start_de .. :try_end_f5} :catchall_ff
    .catch Landroid/os/RemoteException; {:try_start_de .. :try_end_f5} :catch_102

    .line 8382
    .end local v7           #msg:Landroid/os/Message;
    :cond_f5
    :goto_f5
    const/4 v9, 0x1

    :try_start_f6
    iput-boolean v9, p0, Lcom/android/server/am/ActivityManagerService;->mBooting:Z

    .line 8383
    const/4 v9, 0x0

    invoke-direct {p0, v9}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 8384
    monitor-exit p0

    goto/16 :goto_15

    :catchall_ff
    move-exception v9

    monitor-exit p0
    :try_end_101
    .catchall {:try_start_f6 .. :try_end_101} :catchall_ff

    throw v9

    .line 8378
    :catch_102
    move-exception v9

    goto :goto_f5
.end method

.method public testIsSystemReady()Z
    .registers 2

    .prologue
    .line 8289
    iget-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSystemReady:Z

    return v0
.end method

.method public unbindBackupAgent(Landroid/content/pm/ApplicationInfo;)V
    .registers 7
    .parameter "appInfo"

    .prologue
    const-string v4, "ActivityManager"

    .line 10988
    const-string v2, "ActivityManager"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "unbindBackupAgent: "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v4, v2}, Landroid/util/Log;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 10989
    if-nez p1, :cond_24

    .line 10990
    const-string v2, "ActivityManager"

    const-string v2, "unbind backup agent for null app"

    invoke-static {v4, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11022
    :goto_23
    return-void

    .line 10994
    :cond_24
    monitor-enter p0

    .line 10995
    :try_start_25
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    if-nez v2, :cond_35

    .line 10996
    const-string v2, "ActivityManager"

    const-string v3, "Unbinding backup agent with no active backup"

    invoke-static {v2, v3}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10997
    monitor-exit p0

    goto :goto_23

    .line 11021
    :catchall_32
    move-exception v2

    monitor-exit p0
    :try_end_34
    .catchall {:try_start_25 .. :try_end_34} :catchall_32

    throw v2

    .line 11000
    :cond_35
    :try_start_35
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    iget-object v3, p1, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_5f

    .line 11001
    const-string v2, "ActivityManager"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Unbind of "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " but is not the current backup target"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 11002
    monitor-exit p0

    goto :goto_23

    .line 11005
    :cond_5f
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    iget-object v1, v2, Lcom/android/server/am/BackupRecord;->app:Lcom/android/server/am/ProcessRecord;

    .line 11006
    .local v1, proc:Lcom/android/server/am/ProcessRecord;
    const/4 v2, 0x0

    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupTarget:Lcom/android/server/am/BackupRecord;

    .line 11007
    const/4 v2, 0x0

    iput-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mBackupAppName:Ljava/lang/String;

    .line 11010
    invoke-direct {p0, v1}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 11013
    iget-object v2, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;
    :try_end_6e
    .catchall {:try_start_35 .. :try_end_6e} :catchall_32

    if-eqz v2, :cond_75

    .line 11015
    :try_start_70
    iget-object v2, v1, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    invoke-interface {v2, p1}, Landroid/app/IApplicationThread;->scheduleDestroyBackupAgent(Landroid/content/pm/ApplicationInfo;)V
    :try_end_75
    .catchall {:try_start_70 .. :try_end_75} :catchall_32
    .catch Ljava/lang/Exception; {:try_start_70 .. :try_end_75} :catch_77

    .line 11021
    :cond_75
    :goto_75
    :try_start_75
    monitor-exit p0

    goto :goto_23

    .line 11016
    :catch_77
    move-exception v2

    move-object v0, v2

    .line 11017
    .local v0, e:Ljava/lang/Exception;
    const-string v2, "ActivityManager"

    const-string v3, "Exception when unbinding backup agent:"

    invoke-static {v2, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 11018
    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V
    :try_end_83
    .catchall {:try_start_75 .. :try_end_83} :catchall_32

    goto :goto_75
.end method

.method public unbindFinished(Landroid/os/IBinder;Landroid/content/Intent;Z)V
    .registers 12
    .parameter "token"
    .parameter "intent"
    .parameter "doRebind"

    .prologue
    const/4 v7, 0x1

    .line 10790
    if-eqz p2, :cond_11

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v6

    if-ne v6, v7, :cond_11

    .line 10791
    new-instance v6, Ljava/lang/IllegalArgumentException;

    const-string v7, "File descriptors passed in Intent"

    invoke-direct {v6, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 10794
    :cond_11
    monitor-enter p0

    .line 10795
    :try_start_12
    instance-of v6, p1, Lcom/android/server/am/ServiceRecord;

    if-nez v6, :cond_21

    .line 10796
    new-instance v6, Ljava/lang/IllegalArgumentException;

    const-string v7, "Invalid service token"

    invoke-direct {v6, v7}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v6

    .line 10825
    :catchall_1e
    move-exception v6

    monitor-exit p0
    :try_end_20
    .catchall {:try_start_12 .. :try_end_20} :catchall_1e

    throw v6

    .line 10798
    :cond_21
    :try_start_21
    move-object v0, p1

    check-cast v0, Lcom/android/server/am/ServiceRecord;

    move-object v5, v0

    .line 10800
    .local v5, r:Lcom/android/server/am/ServiceRecord;
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v3

    .line 10802
    .local v3, origId:J
    if-eqz v5, :cond_52

    .line 10803
    new-instance v2, Landroid/content/Intent$FilterComparison;

    invoke-direct {v2, p2}, Landroid/content/Intent$FilterComparison;-><init>(Landroid/content/Intent;)V

    .line 10805
    .local v2, filter:Landroid/content/Intent$FilterComparison;
    iget-object v6, v5, Lcom/android/server/am/ServiceRecord;->bindings:Ljava/util/HashMap;

    invoke-virtual {v6, v2}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/IntentBindRecord;

    .line 10809
    .local v1, b:Lcom/android/server/am/IntentBindRecord;
    if-eqz v1, :cond_46

    .line 10810
    iget-object v6, v1, Lcom/android/server/am/IntentBindRecord;->apps:Ljava/util/HashMap;

    invoke-virtual {v6}, Ljava/util/HashMap;->size()I

    move-result v6

    if-lez v6, :cond_54

    .line 10813
    const/4 v6, 0x1

    invoke-direct {p0, v5, v1, v6}, Lcom/android/server/am/ActivityManagerService;->requestServiceBindingLocked(Lcom/android/server/am/ServiceRecord;Lcom/android/server/am/IntentBindRecord;Z)Z

    .line 10821
    :cond_46
    :goto_46
    iget-object v6, p0, Lcom/android/server/am/ActivityManagerService;->mStoppingServices:Ljava/util/ArrayList;

    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->contains(Ljava/lang/Object;)Z

    move-result v6

    invoke-virtual {p0, v5, v6}, Lcom/android/server/am/ActivityManagerService;->serviceDoneExecutingLocked(Lcom/android/server/am/ServiceRecord;Z)V

    .line 10823
    invoke-static {v3, v4}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 10825
    .end local v1           #b:Lcom/android/server/am/IntentBindRecord;
    .end local v2           #filter:Landroid/content/Intent$FilterComparison;
    :cond_52
    monitor-exit p0

    .line 10826
    return-void

    .line 10817
    .restart local v1       #b:Lcom/android/server/am/IntentBindRecord;
    .restart local v2       #filter:Landroid/content/Intent$FilterComparison;
    :cond_54
    const/4 v6, 0x1

    iput-boolean v6, v1, Lcom/android/server/am/IntentBindRecord;->doRebind:Z
    :try_end_57
    .catchall {:try_start_21 .. :try_end_57} :catchall_1e

    goto :goto_46
.end method

.method public unbindService(Landroid/app/IServiceConnection;)Z
    .registers 9
    .parameter "connection"

    .prologue
    .line 10706
    monitor-enter p0

    .line 10707
    :try_start_1
    invoke-interface {p1}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v0

    .line 10709
    .local v0, binder:Landroid/os/IBinder;
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mServiceConnections:Ljava/util/HashMap;

    invoke-virtual {v4, v0}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/am/ConnectionRecord;

    .line 10710
    .local v3, r:Lcom/android/server/am/ConnectionRecord;
    if-nez v3, :cond_2e

    .line 10711
    const-string v4, "ActivityManager"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unbind failed: could not find connection for "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-interface {p1}, Landroid/app/IServiceConnection;->asBinder()Landroid/os/IBinder;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 10713
    const/4 v4, 0x0

    monitor-exit p0

    .line 10728
    :goto_2d
    return v4

    .line 10716
    :cond_2e
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v1

    .line 10718
    .local v1, origId:J
    const/4 v4, 0x0

    const/4 v5, 0x0

    invoke-direct {p0, v3, v4, v5}, Lcom/android/server/am/ActivityManagerService;->removeConnectionLocked(Lcom/android/server/am/ConnectionRecord;Lcom/android/server/am/ProcessRecord;Lcom/android/server/am/HistoryRecord;)V

    .line 10720
    iget-object v4, v3, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v4, v4, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    iget-object v4, v4, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v4, :cond_48

    .line 10722
    iget-object v4, v3, Lcom/android/server/am/ConnectionRecord;->binding:Lcom/android/server/am/AppBindRecord;

    iget-object v4, v4, Lcom/android/server/am/AppBindRecord;->service:Lcom/android/server/am/ServiceRecord;

    iget-object v4, v4, Lcom/android/server/am/ServiceRecord;->app:Lcom/android/server/am/ProcessRecord;

    invoke-direct {p0, v4}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked(Lcom/android/server/am/ProcessRecord;)Z

    .line 10725
    :cond_48
    invoke-static {v1, v2}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 10726
    monitor-exit p0

    .line 10728
    const/4 v4, 0x1

    goto :goto_2d

    .line 10726
    .end local v0           #binder:Landroid/os/IBinder;
    .end local v1           #origId:J
    .end local v3           #r:Lcom/android/server/am/ConnectionRecord;
    :catchall_4e
    move-exception v4

    monitor-exit p0
    :try_end_50
    .catchall {:try_start_1 .. :try_end_50} :catchall_4e

    throw v4
.end method

.method public final unbroadcastIntent(Landroid/app/IApplicationThread;Landroid/content/Intent;)V
    .registers 9
    .parameter "caller"
    .parameter "intent"

    .prologue
    const-string v4, "android.permission.BROADCAST_STICKY"

    .line 11506
    if-eqz p2, :cond_13

    invoke-virtual {p2}, Landroid/content/Intent;->hasFileDescriptors()Z

    move-result v4

    const/4 v5, 0x1

    if-ne v4, v5, :cond_13

    .line 11507
    new-instance v4, Ljava/lang/IllegalArgumentException;

    const-string v5, "File descriptors passed in Intent"

    invoke-direct {v4, v5}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 11510
    :cond_13
    monitor-enter p0

    .line 11511
    :try_start_14
    const-string v4, "android.permission.BROADCAST_STICKY"

    invoke-virtual {p0, v4}, Lcom/android/server/am/ActivityManagerService;->checkCallingPermission(Ljava/lang/String;)I

    move-result v4

    if-eqz v4, :cond_5b

    .line 11513
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Permission Denial: unbroadcastIntent() from pid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingPid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, ", uid="

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-static {}, Landroid/os/Binder;->getCallingUid()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " requires "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "android.permission.BROADCAST_STICKY"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 11517
    .local v3, msg:Ljava/lang/String;
    const-string v4, "ActivityManager"

    invoke-static {v4, v3}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 11518
    new-instance v4, Ljava/lang/SecurityException;

    invoke-direct {v4, v3}, Ljava/lang/SecurityException;-><init>(Ljava/lang/String;)V

    throw v4

    .line 11531
    .end local v3           #msg:Ljava/lang/String;
    :catchall_58
    move-exception v4

    monitor-exit p0
    :try_end_5a
    .catchall {:try_start_14 .. :try_end_5a} :catchall_58

    throw v4

    .line 11520
    :cond_5b
    :try_start_5b
    iget-object v4, p0, Lcom/android/server/am/ActivityManagerService;->mStickyBroadcasts:Ljava/util/HashMap;

    invoke-virtual {p2}, Landroid/content/Intent;->getAction()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/util/ArrayList;

    .line 11521
    .local v2, list:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/Intent;>;"
    if-eqz v2, :cond_7f

    .line 11522
    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v0

    .line 11524
    .local v0, N:I
    const/4 v1, 0x0

    .local v1, i:I
    :goto_6e
    if-ge v1, v0, :cond_7f

    .line 11525
    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/content/Intent;

    invoke-virtual {p2, v4}, Landroid/content/Intent;->filterEquals(Landroid/content/Intent;)Z

    move-result v4

    if-eqz v4, :cond_81

    .line 11526
    invoke-virtual {v2, v1}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    .line 11531
    .end local v0           #N:I
    .end local v1           #i:I
    :cond_7f
    monitor-exit p0
    :try_end_80
    .catchall {:try_start_5b .. :try_end_80} :catchall_58

    .line 11532
    return-void

    .line 11524
    .restart local v0       #N:I
    .restart local v1       #i:I
    :cond_81
    add-int/lit8 v1, v1, 0x1

    goto :goto_6e
.end method

.method public unhandledBack()V
    .registers 10

    .prologue
    const/4 v3, 0x1

    .line 7795
    const-string v0, "android.permission.FORCE_BACK"

    const-string v1, "unhandledBack()"

    invoke-virtual {p0, v0, v1}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 7798
    monitor-enter p0

    .line 7799
    :try_start_9
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v6

    .line 7800
    .local v6, count:I
    const-string v0, "ActivityManager"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Performing unhandledBack(): stack size = "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 7802
    if-le v6, v3, :cond_44

    .line 7803
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v7

    .line 7804
    .local v7, origId:J
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mHistory:Ljava/util/ArrayList;

    sub-int v1, v6, v3

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/am/HistoryRecord;

    sub-int v2, v6, v3

    const/4 v3, 0x0

    const/4 v4, 0x0

    const-string v5, "unhandled-back"

    move-object v0, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/am/ActivityManagerService;->finishActivityLocked(Lcom/android/server/am/HistoryRecord;IILandroid/content/Intent;Ljava/lang/String;)Z

    .line 7806
    invoke-static {v7, v8}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 7808
    .end local v7           #origId:J
    :cond_44
    monitor-exit p0

    .line 7809
    return-void

    .line 7808
    .end local v6           #count:I
    :catchall_46
    move-exception v0

    monitor-exit p0
    :try_end_48
    .catchall {:try_start_9 .. :try_end_48} :catchall_46

    throw v0
.end method

.method public unregisterActivityWatcher(Landroid/app/IActivityWatcher;)V
    .registers 3
    .parameter "watcher"

    .prologue
    .line 8033
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWatchers:Landroid/os/RemoteCallbackList;

    invoke-virtual {v0, p1}, Landroid/os/RemoteCallbackList;->unregister(Landroid/os/IInterface;)Z

    .line 8034
    return-void
.end method

.method public unregisterReceiver(Landroid/content/IIntentReceiver;)V
    .registers 15
    .parameter "receiver"

    .prologue
    const/4 v12, 0x0

    .line 11147
    const/4 v7, 0x0

    .line 11149
    .local v7, doNext:Z
    monitor-enter p0

    .line 11150
    :try_start_3
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mRegisteredReceivers:Ljava/util/HashMap;

    invoke-interface {p1}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/am/ReceiverList;

    .line 11152
    .local v11, rl:Lcom/android/server/am/ReceiverList;
    if-eqz v11, :cond_48

    .line 11153
    iget-object v0, v11, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    if-eqz v0, :cond_29

    .line 11154
    iget-object v10, v11, Lcom/android/server/am/ReceiverList;->curBroadcast:Lcom/android/server/am/BroadcastRecord;

    .line 11155
    .local v10, r:Lcom/android/server/am/BroadcastRecord;
    invoke-interface {p1}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v1

    iget v2, v10, Lcom/android/server/am/BroadcastRecord;->resultCode:I

    iget-object v3, v10, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;

    iget-object v4, v10, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;

    iget-boolean v5, v10, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z

    const/4 v6, 0x1

    move-object v0, p0

    invoke-direct/range {v0 .. v6}, Lcom/android/server/am/ActivityManagerService;->finishReceiverLocked(Landroid/os/IBinder;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z

    move-result v7

    .line 11160
    .end local v10           #r:Lcom/android/server/am/BroadcastRecord;
    :cond_29
    iget-object v0, v11, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    if-eqz v0, :cond_34

    .line 11161
    iget-object v0, v11, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->receivers:Ljava/util/HashSet;

    invoke-virtual {v0, v11}, Ljava/util/HashSet;->remove(Ljava/lang/Object;)Z

    .line 11163
    :cond_34
    invoke-virtual {p0, v11}, Lcom/android/server/am/ActivityManagerService;->removeReceiverLocked(Lcom/android/server/am/ReceiverList;)V

    .line 11164
    iget-boolean v0, v11, Lcom/android/server/am/ReceiverList;->linkedToDeath:Z

    if-eqz v0, :cond_48

    .line 11165
    const/4 v0, 0x0

    iput-boolean v0, v11, Lcom/android/server/am/ReceiverList;->linkedToDeath:Z

    .line 11166
    iget-object v0, v11, Lcom/android/server/am/ReceiverList;->receiver:Landroid/content/IIntentReceiver;

    invoke-interface {v0}, Landroid/content/IIntentReceiver;->asBinder()Landroid/os/IBinder;

    move-result-object v0

    const/4 v1, 0x0

    invoke-interface {v0, v11, v1}, Landroid/os/IBinder;->unlinkToDeath(Landroid/os/IBinder$DeathRecipient;I)Z

    .line 11169
    :cond_48
    monitor-exit p0

    .line 11171
    if-nez v7, :cond_4f

    .line 11179
    :goto_4b
    return-void

    .line 11169
    .end local v11           #rl:Lcom/android/server/am/ReceiverList;
    :catchall_4c
    move-exception v0

    monitor-exit p0
    :try_end_4e
    .catchall {:try_start_3 .. :try_end_4e} :catchall_4c

    throw v0

    .line 11175
    .restart local v11       #rl:Lcom/android/server/am/ReceiverList;
    :cond_4f
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v8

    .line 11176
    .local v8, origId:J
    invoke-direct {p0, v12}, Lcom/android/server/am/ActivityManagerService;->processNextBroadcast(Z)V

    .line 11177
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->trimApplications()V

    .line 11178
    invoke-static {v8, v9}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    goto :goto_4b
.end method

.method public updateConfiguration(Landroid/content/res/Configuration;)V
    .registers 6
    .parameter "values"

    .prologue
    .line 12250
    const-string v2, "android.permission.CHANGE_CONFIGURATION"

    const-string v3, "updateConfiguration()"

    invoke-virtual {p0, v2, v3}, Lcom/android/server/am/ActivityManagerService;->enforceCallingPermission(Ljava/lang/String;Ljava/lang/String;)V

    .line 12253
    monitor-enter p0

    .line 12254
    if-nez p1, :cond_14

    :try_start_a
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    if-eqz v2, :cond_14

    .line 12256
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    invoke-virtual {v2}, Lcom/android/server/WindowManagerService;->computeNewConfiguration()Landroid/content/res/Configuration;

    move-result-object p1

    .line 12259
    :cond_14
    invoke-static {}, Landroid/os/Binder;->clearCallingIdentity()J

    move-result-wide v0

    .line 12260
    .local v0, origId:J
    const/4 v2, 0x0

    invoke-virtual {p0, p1, v2}, Lcom/android/server/am/ActivityManagerService;->updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z

    .line 12261
    invoke-static {v0, v1}, Landroid/os/Binder;->restoreCallingIdentity(J)V

    .line 12262
    monitor-exit p0

    .line 12263
    return-void

    .line 12262
    .end local v0           #origId:J
    :catchall_21
    move-exception v2

    monitor-exit p0
    :try_end_23
    .catchall {:try_start_a .. :try_end_23} :catchall_21

    throw v2
.end method

.method public updateConfigurationLocked(Landroid/content/res/Configuration;Lcom/android/server/am/HistoryRecord;)Z
    .registers 29
    .parameter "values"
    .parameter "starting"

    .prologue
    .line 12274
    const/16 v21, 0x0

    .line 12276
    .local v21, changes:I
    const/16 v23, 0x1

    .line 12278
    .local v23, kept:Z
    if-eqz p1, :cond_e2

    .line 12279
    new-instance v25, Landroid/content/res/Configuration;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v4, v0

    move-object/from16 v0, v25

    move-object v1, v4

    invoke-direct {v0, v1}, Landroid/content/res/Configuration;-><init>(Landroid/content/res/Configuration;)V

    .line 12280
    .local v25, newConfig:Landroid/content/res/Configuration;
    move-object/from16 v0, v25

    move-object/from16 v1, p1

    invoke-virtual {v0, v1}, Landroid/content/res/Configuration;->updateFrom(Landroid/content/res/Configuration;)I

    move-result v21

    .line 12281
    if-eqz v21, :cond_e2

    .line 12286
    const/16 v4, 0xa9f

    move v0, v4

    move/from16 v1, v21

    invoke-static {v0, v1}, Landroid/util/EventLog;->writeEvent(II)I

    .line 12288
    move-object/from16 v0, p1

    iget-object v0, v0, Landroid/content/res/Configuration;->locale:Ljava/util/Locale;

    move-object v4, v0

    if-eqz v4, :cond_51

    .line 12289
    move-object/from16 v0, p1

    iget-object v0, v0, Landroid/content/res/Configuration;->locale:Ljava/util/Locale;

    move-object v4, v0

    move-object/from16 v0, p1

    iget-object v0, v0, Landroid/content/res/Configuration;->locale:Ljava/util/Locale;

    move-object v5, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v6, v0

    iget-object v6, v6, Landroid/content/res/Configuration;->locale:Ljava/util/Locale;

    invoke-virtual {v5, v6}, Ljava/util/Locale;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_b1

    const/4 v5, 0x1

    :goto_44
    move-object/from16 v0, p1

    iget-boolean v0, v0, Landroid/content/res/Configuration;->userSetLocale:Z

    move v6, v0

    move-object/from16 v0, p0

    move-object v1, v4

    move v2, v5

    move v3, v6

    invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/ActivityManagerService;->saveLocaleLocked(Ljava/util/Locale;ZZ)V

    .line 12294
    :cond_51
    move-object/from16 v0, v25

    move-object/from16 v1, p0

    iput-object v0, v1, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    .line 12296
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v4, v0

    const/4 v5, 0x4

    invoke-virtual {v4, v5}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v24

    .line 12297
    .local v24, msg:Landroid/os/Message;
    new-instance v4, Landroid/content/res/Configuration;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v5, v0

    invoke-direct {v4, v5}, Landroid/content/res/Configuration;-><init>(Landroid/content/res/Configuration;)V

    move-object v0, v4

    move-object/from16 v1, v24

    iput-object v0, v1, Landroid/os/Message;->obj:Ljava/lang/Object;

    .line 12298
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mHandler:Landroid/os/Handler;

    move-object v4, v0

    move-object v0, v4

    move-object/from16 v1, v24

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    .line 12300
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    move-object v4, v0

    invoke-virtual {v4}, Ljava/util/ArrayList;->size()I

    move-result v18

    .line 12301
    .local v18, N:I
    const/16 v22, 0x0

    .local v22, i:I
    :goto_86
    move/from16 v0, v22

    move/from16 v1, v18

    if-ge v0, v1, :cond_b3

    .line 12302
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mLRUProcesses:Ljava/util/ArrayList;

    move-object v4, v0

    move-object v0, v4

    move/from16 v1, v22

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v20

    check-cast v20, Lcom/android/server/am/ProcessRecord;

    .line 12304
    .local v20, app:Lcom/android/server/am/ProcessRecord;
    :try_start_9a
    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v4, v0

    if-eqz v4, :cond_ae

    .line 12305
    move-object/from16 v0, v20

    iget-object v0, v0, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;

    move-object v4, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v5, v0

    invoke-interface {v4, v5}, Landroid/app/IApplicationThread;->scheduleConfigurationChanged(Landroid/content/res/Configuration;)V
    :try_end_ae
    .catch Ljava/lang/Exception; {:try_start_9a .. :try_end_ae} :catch_106

    .line 12301
    :cond_ae
    :goto_ae
    add-int/lit8 v22, v22, 0x1

    goto :goto_86

    .line 12289
    .end local v18           #N:I
    .end local v20           #app:Lcom/android/server/am/ProcessRecord;
    .end local v22           #i:I
    .end local v24           #msg:Landroid/os/Message;
    :cond_b1
    const/4 v5, 0x0

    goto :goto_44

    .line 12310
    .restart local v18       #N:I
    .restart local v22       #i:I
    .restart local v24       #msg:Landroid/os/Message;
    :cond_b3
    new-instance v7, Landroid/content/Intent;

    const-string v4, "android.intent.action.CONFIGURATION_CHANGED"

    invoke-direct {v7, v4}, Landroid/content/Intent;-><init>(Ljava/lang/String;)V

    .line 12311
    .local v7, intent:Landroid/content/Intent;
    const/4 v5, 0x0

    const/4 v6, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    const/4 v14, 0x0

    const/4 v15, 0x0

    move-object/from16 v0, p0

    iget v0, v0, Lcom/android/server/am/ActivityManagerService;->MY_PID:I

    move/from16 v16, v0

    const/16 v17, 0x3e8

    move-object/from16 v4, p0

    invoke-direct/range {v4 .. v17}, Lcom/android/server/am/ActivityManagerService;->broadcastIntentLocked(Lcom/android/server/am/ProcessRecord;Ljava/lang/String;Landroid/content/Intent;Ljava/lang/String;Landroid/content/IIntentReceiver;ILjava/lang/String;Landroid/os/Bundle;Ljava/lang/String;ZZII)I

    .line 12314
    invoke-static {}, Lcom/android/server/AttributeCache;->instance()Lcom/android/server/AttributeCache;

    move-result-object v19

    .line 12315
    .local v19, ac:Lcom/android/server/AttributeCache;
    if-eqz v19, :cond_e2

    .line 12316
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mConfiguration:Landroid/content/res/Configuration;

    move-object v4, v0

    move-object/from16 v0, v19

    move-object v1, v4

    invoke-virtual {v0, v1}, Lcom/android/server/AttributeCache;->updateConfiguration(Landroid/content/res/Configuration;)V

    .line 12321
    .end local v7           #intent:Landroid/content/Intent;
    .end local v18           #N:I
    .end local v19           #ac:Lcom/android/server/AttributeCache;
    .end local v22           #i:I
    .end local v24           #msg:Landroid/os/Message;
    .end local v25           #newConfig:Landroid/content/res/Configuration;
    :cond_e2
    if-eqz v21, :cond_ee

    if-nez p2, :cond_ee

    .line 12325
    const/4 v4, 0x0

    move-object/from16 v0, p0

    move-object v1, v4

    invoke-direct {v0, v1}, Lcom/android/server/am/ActivityManagerService;->topRunningActivityLocked(Lcom/android/server/am/HistoryRecord;)Lcom/android/server/am/HistoryRecord;

    move-result-object p2

    .line 12328
    :cond_ee
    if-eqz p2, :cond_105

    .line 12329
    move-object/from16 v0, p0

    move-object/from16 v1, p2

    move/from16 v2, v21

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->ensureActivityConfigurationLocked(Lcom/android/server/am/HistoryRecord;I)Z

    move-result v23

    .line 12330
    if-eqz v23, :cond_105

    .line 12336
    move-object/from16 v0, p0

    move-object/from16 v1, p2

    move/from16 v2, v21

    invoke-direct {v0, v1, v2}, Lcom/android/server/am/ActivityManagerService;->ensureActivitiesVisibleLocked(Lcom/android/server/am/HistoryRecord;I)V

    .line 12340
    :cond_105
    return v23

    .line 12307
    .restart local v18       #N:I
    .restart local v20       #app:Lcom/android/server/am/ProcessRecord;
    .restart local v22       #i:I
    .restart local v24       #msg:Landroid/os/Message;
    .restart local v25       #newConfig:Landroid/content/res/Configuration;
    :catch_106
    move-exception v4

    goto :goto_ae
.end method

.method updateCpuStats()V
    .registers 8

    .prologue
    .line 1531
    iget-object v2, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    monitor-enter v2

    .line 1532
    :try_start_3
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v0

    .line 1533
    .local v0, now:J
    iget-wide v3, p0, Lcom/android/server/am/ActivityManagerService;->mLastCpuTime:J

    const-wide/16 v5, 0x1388

    sub-long v5, v0, v5

    cmp-long v3, v3, v5

    if-gez v3, :cond_16

    .line 1534
    iget-object v3, p0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    invoke-virtual {v3}, Ljava/lang/Object;->notify()V

    .line 1536
    :cond_16
    monitor-exit v2

    .line 1537
    return-void

    .line 1536
    .end local v0           #now:J
    :catchall_18
    move-exception v3

    monitor-exit v2
    :try_end_1a
    .catchall {:try_start_3 .. :try_end_1a} :catchall_18

    throw v3
.end method

.method updateCpuStatsNow()V
    .registers 25

    .prologue
    .line 1540
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStatsThread:Ljava/lang/Thread;

    move-object/from16 v19, v0

    monitor-enter v19

    .line 1541
    :try_start_7
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v10

    .line 1542
    .local v10, now:J
    const/4 v5, 0x0

    .line 1544
    .local v5, haveNewCpuStats:Z
    move-object/from16 v0, p0

    iget-wide v0, v0, Lcom/android/server/am/ActivityManagerService;->mLastCpuTime:J

    move-wide/from16 v20, v0

    const-wide/16 v22, 0x1388

    sub-long v22, v10, v22

    cmp-long v20, v20, v22

    if-gez v20, :cond_de

    .line 1546
    move-wide v0, v10

    move-object/from16 v2, p0

    iput-wide v0, v2, Lcom/android/server/am/ActivityManagerService;->mLastCpuTime:J

    .line 1547
    const/4 v5, 0x1

    .line 1548
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v20, v0

    invoke-virtual/range {v20 .. v20}, Lcom/android/server/ProcessStats;->update()V

    .line 1554
    const-string v20, "true"

    const-string v21, "events.cpu"

    invoke-static/range {v21 .. v21}, Landroid/os/SystemProperties;->get(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v21

    invoke-virtual/range {v20 .. v21}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v20

    if-eqz v20, :cond_de

    .line 1555
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v20, v0

    invoke-virtual/range {v20 .. v20}, Lcom/android/server/ProcessStats;->getLastUserTime()I

    move-result v18

    .line 1556
    .local v18, user:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v20, v0

    invoke-virtual/range {v20 .. v20}, Lcom/android/server/ProcessStats;->getLastSystemTime()I

    move-result v16

    .line 1557
    .local v16, system:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v20, v0

    invoke-virtual/range {v20 .. v20}, Lcom/android/server/ProcessStats;->getLastIoWaitTime()I

    move-result v8

    .line 1558
    .local v8, iowait:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v20, v0

    invoke-virtual/range {v20 .. v20}, Lcom/android/server/ProcessStats;->getLastIrqTime()I

    move-result v9

    .line 1559
    .local v9, irq:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v20, v0

    invoke-virtual/range {v20 .. v20}, Lcom/android/server/ProcessStats;->getLastSoftIrqTime()I

    move-result v14

    .line 1560
    .local v14, softIrq:I
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v20, v0

    invoke-virtual/range {v20 .. v20}, Lcom/android/server/ProcessStats;->getLastIdleTime()I

    move-result v7

    .line 1562
    .local v7, idle:I
    add-int v20, v18, v16

    add-int v20, v20, v8

    add-int v20, v20, v9

    add-int v20, v20, v14

    add-int v17, v20, v7

    .line 1563
    .local v17, total:I
    if-nez v17, :cond_81

    const/16 v17, 0x1

    .line 1565
    :cond_81
    const/16 v20, 0xaa1

    const/16 v21, 0x6

    move/from16 v0, v21

    new-array v0, v0, [Ljava/lang/Object;

    move-object/from16 v21, v0

    const/16 v22, 0x0

    add-int v23, v18, v16

    add-int v23, v23, v8

    add-int v23, v23, v9

    add-int v23, v23, v14

    mul-int/lit8 v23, v23, 0x64

    div-int v23, v23, v17

    invoke-static/range {v23 .. v23}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v23

    aput-object v23, v21, v22

    const/16 v22, 0x1

    mul-int/lit8 v23, v18, 0x64

    div-int v23, v23, v17

    invoke-static/range {v23 .. v23}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v23

    aput-object v23, v21, v22

    const/16 v22, 0x2

    mul-int/lit8 v23, v16, 0x64

    div-int v23, v23, v17

    invoke-static/range {v23 .. v23}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v23

    aput-object v23, v21, v22

    const/16 v22, 0x3

    mul-int/lit8 v23, v8, 0x64

    div-int v23, v23, v17

    invoke-static/range {v23 .. v23}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v23

    aput-object v23, v21, v22

    const/16 v22, 0x4

    mul-int/lit8 v23, v9, 0x64

    div-int v23, v23, v17

    invoke-static/range {v23 .. v23}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v23

    aput-object v23, v21, v22

    const/16 v22, 0x5

    mul-int/lit8 v23, v14, 0x64

    div-int v23, v23, v17

    invoke-static/range {v23 .. v23}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v23

    aput-object v23, v21, v22

    invoke-static/range {v20 .. v21}, Landroid/util/EventLog;->writeEvent(I[Ljava/lang/Object;)I

    .line 1575
    .end local v7           #idle:I
    .end local v8           #iowait:I
    .end local v9           #irq:I
    .end local v14           #softIrq:I
    .end local v16           #system:I
    .end local v17           #total:I
    .end local v18           #user:I
    :cond_de
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object/from16 v20, v0

    invoke-virtual/range {v20 .. v20}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v4

    .line 1576
    .local v4, bstats:Lcom/android/internal/os/BatteryStatsImpl;
    monitor-enter v4
    :try_end_e9
    .catchall {:try_start_7 .. :try_end_e9} :catchall_170

    .line 1577
    :try_start_e9
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object/from16 v20, v0

    monitor-enter v20
    :try_end_f0
    .catchall {:try_start_e9 .. :try_end_f0} :catchall_16d

    .line 1578
    if-eqz v5, :cond_173

    .line 1579
    :try_start_f2
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/am/BatteryStatsService;->isOnBattery()Z

    move-result v21

    if-eqz v21, :cond_173

    .line 1580
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    invoke-virtual/range {v21 .. v21}, Lcom/android/server/ProcessStats;->countWorkingStats()I

    move-result v3

    .line 1581
    .local v3, N:I
    const/4 v6, 0x0

    .local v6, i:I
    :goto_109
    if-ge v6, v3, :cond_173

    .line 1582
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mProcessStats:Lcom/android/server/ProcessStats;

    move-object/from16 v21, v0

    move-object/from16 v0, v21

    move v1, v6

    invoke-virtual {v0, v1}, Lcom/android/server/ProcessStats;->getWorkingStats(I)Lcom/android/server/ProcessStats$Stats;

    move-result-object v15

    .line 1584
    .local v15, st:Lcom/android/server/ProcessStats$Stats;
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mPidsSelfLocked:Landroid/util/SparseArray;

    move-object/from16 v21, v0

    move-object v0, v15

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->pid:I

    move/from16 v22, v0

    invoke-virtual/range {v21 .. v22}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v12

    check-cast v12, Lcom/android/server/am/ProcessRecord;

    .line 1585
    .local v12, pr:Lcom/android/server/am/ProcessRecord;
    if-eqz v12, :cond_142

    .line 1586
    iget-object v13, v12, Lcom/android/server/am/ProcessRecord;->batteryStats:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    .line 1587
    .local v13, ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    move-object v0, v15

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->rel_utime:I

    move/from16 v21, v0

    move-object v0, v15

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->rel_stime:I

    move/from16 v22, v0

    move-object v0, v13

    move/from16 v1, v21

    move/from16 v2, v22

    invoke-virtual {v0, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->addCpuTimeLocked(II)V

    .line 1581
    :cond_13f
    :goto_13f
    add-int/lit8 v6, v6, 0x1

    goto :goto_109

    .line 1589
    .end local v13           #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    :cond_142
    move-object v0, v15

    iget-object v0, v0, Lcom/android/server/ProcessStats$Stats;->name:Ljava/lang/String;

    move-object/from16 v21, v0

    move-object v0, v15

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->pid:I

    move/from16 v22, v0

    move-object v0, v4

    move-object/from16 v1, v21

    move/from16 v2, v22

    invoke-virtual {v0, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl;->getProcessStatsLocked(Ljava/lang/String;I)Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;

    move-result-object v13

    .line 1591
    .restart local v13       #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    if-eqz v13, :cond_13f

    .line 1592
    move-object v0, v15

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->rel_utime:I

    move/from16 v21, v0

    move-object v0, v15

    iget v0, v0, Lcom/android/server/ProcessStats$Stats;->rel_stime:I

    move/from16 v22, v0

    move-object v0, v13

    move/from16 v1, v21

    move/from16 v2, v22

    invoke-virtual {v0, v1, v2}, Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;->addCpuTimeLocked(II)V

    goto :goto_13f

    .line 1598
    .end local v3           #N:I
    .end local v6           #i:I
    .end local v12           #pr:Lcom/android/server/am/ProcessRecord;
    .end local v13           #ps:Lcom/android/internal/os/BatteryStatsImpl$Uid$Proc;
    .end local v15           #st:Lcom/android/server/ProcessStats$Stats;
    :catchall_16a
    move-exception v21

    monitor-exit v20
    :try_end_16c
    .catchall {:try_start_f2 .. :try_end_16c} :catchall_16a

    :try_start_16c
    throw v21

    .line 1604
    :catchall_16d
    move-exception v20

    monitor-exit v4
    :try_end_16f
    .catchall {:try_start_16c .. :try_end_16f} :catchall_16d

    :try_start_16f
    throw v20

    .line 1605
    .end local v4           #bstats:Lcom/android/internal/os/BatteryStatsImpl;
    .end local v5           #haveNewCpuStats:Z
    .end local v10           #now:J
    :catchall_170
    move-exception v20

    monitor-exit v19
    :try_end_172
    .catchall {:try_start_16f .. :try_end_172} :catchall_170

    throw v20

    .line 1598
    .restart local v4       #bstats:Lcom/android/internal/os/BatteryStatsImpl;
    .restart local v5       #haveNewCpuStats:Z
    .restart local v10       #now:J
    :cond_173
    :try_start_173
    monitor-exit v20
    :try_end_174
    .catchall {:try_start_173 .. :try_end_174} :catchall_16a

    .line 1600
    :try_start_174
    move-object/from16 v0, p0

    iget-wide v0, v0, Lcom/android/server/am/ActivityManagerService;->mLastWriteTime:J

    move-wide/from16 v20, v0

    const-wide/32 v22, 0x1b7740

    sub-long v22, v10, v22

    cmp-long v20, v20, v22

    if-gez v20, :cond_195

    .line 1601
    move-wide v0, v10

    move-object/from16 v2, p0

    iput-wide v0, v2, Lcom/android/server/am/ActivityManagerService;->mLastWriteTime:J

    .line 1602
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/android/server/am/ActivityManagerService;->mBatteryStatsService:Lcom/android/server/am/BatteryStatsService;

    move-object/from16 v20, v0

    invoke-virtual/range {v20 .. v20}, Lcom/android/server/am/BatteryStatsService;->getActiveStatistics()Lcom/android/internal/os/BatteryStatsImpl;

    move-result-object v20

    invoke-virtual/range {v20 .. v20}, Lcom/android/internal/os/BatteryStatsImpl;->writeLocked()V

    .line 1604
    :cond_195
    monitor-exit v4
    :try_end_196
    .catchall {:try_start_174 .. :try_end_196} :catchall_16d

    .line 1605
    :try_start_196
    monitor-exit v19
    :try_end_197
    .catchall {:try_start_196 .. :try_end_197} :catchall_170

    .line 1606
    return-void
.end method

.method public updateServiceForegroundLocked(Lcom/android/server/am/ProcessRecord;Z)V
    .registers 7
    .parameter "proc"
    .parameter "oomAdj"

    .prologue
    .line 10538
    const/4 v0, 0x0

    .line 10539
    .local v0, anyForeground:Z
    iget-object v3, p1, Lcom/android/server/am/ProcessRecord;->services:Ljava/util/HashSet;

    invoke-virtual {v3}, Ljava/util/HashSet;->iterator()Ljava/util/Iterator;

    move-result-object v1

    .local v1, i$:Ljava/util/Iterator;
    :cond_7
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_18

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/am/ServiceRecord;

    .line 10540
    .local v2, sr:Lcom/android/server/am/ServiceRecord;
    iget-boolean v3, v2, Lcom/android/server/am/ServiceRecord;->isForeground:Z

    if-eqz v3, :cond_7

    .line 10541
    const/4 v0, 0x1

    .line 10545
    .end local v2           #sr:Lcom/android/server/am/ServiceRecord;
    :cond_18
    iget-boolean v3, p1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    if-eq v0, v3, :cond_23

    .line 10546
    iput-boolean v0, p1, Lcom/android/server/am/ProcessRecord;->foregroundServices:Z

    .line 10547
    if-eqz p2, :cond_23

    .line 10548
    invoke-direct {p0}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()Z

    .line 10551
    :cond_23
    return-void
.end method

.method public wakingUp()V
    .registers 3

    .prologue
    .line 7914
    monitor-enter p0

    .line 7915
    :try_start_1
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->isHeld()Z

    move-result v0

    if-eqz v0, :cond_e

    .line 7916
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mGoingToSleep:Landroid/os/PowerManager$WakeLock;

    invoke-virtual {v0}, Landroid/os/PowerManager$WakeLock;->release()V

    .line 7918
    :cond_e
    iget-object v0, p0, Lcom/android/server/am/ActivityManagerService;->mWindowManager:Lcom/android/server/WindowManagerService;

    const/4 v1, 0x1

    invoke-virtual {v0, v1}, Lcom/android/server/WindowManagerService;->setEventDispatching(Z)V

    .line 7919
    const/4 v0, 0x0

    iput-boolean v0, p0, Lcom/android/server/am/ActivityManagerService;->mSleeping:Z

    .line 7920
    const/4 v0, 0x0

    invoke-direct {p0, v0}, Lcom/android/server/am/ActivityManagerService;->resumeTopActivityLocked(Lcom/android/server/am/HistoryRecord;)Z

    .line 7921
    monitor-exit p0

    .line 7922
    return-void

    .line 7921
    :catchall_1d
    move-exception v0

    monitor-exit p0
    :try_end_1f
    .catchall {:try_start_1 .. :try_end_1f} :catchall_1d

    throw v0
.end method
